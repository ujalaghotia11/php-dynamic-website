window.adthrive.core = {"partners":[{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"33across","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.95},{"name":"pmp","type":"percent","value":0.95},{"name":"stickyOutstream","type":"percent","value":0.66},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_amazon","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.85},{"name":"stickyOutstream","type":"percent","value":0.6},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_appnexus","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.94},{"name":"stickyOutstream","type":"percent","value":0.56},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_gumgum","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.93},{"name":"stickyOutstream","type":"percent","value":0.5},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_ix","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.91}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_ogury","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.94},{"name":"stickyOutstream","type":"percent","value":0.45},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_openx","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"stickyOutstream","type":"percent","value":0.25},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_pubmatic","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_rubicon","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_seedtag","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_sharethrough","enabled":true},{"secondary":false,"cpm":[{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_spotx","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.95},{"name":"stickyOutstream","type":"percent","value":0.34},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_triplelift","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.9},{"name":"stickyOutstream","type":"percent","value":0.5},{"name":"instream","type":"percent","value":0.9}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_unruly","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.3},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_verizon","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.4},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_yieldmo","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.6},{"name":"stickyOutstream","type":"percent","value":0.59},{"name":"instream","type":"percent","value":0.9}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"adform","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"aidem_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"amazonASR","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.75},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"appnexus","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.01},{"name":"pmp","type":"percent","value":0.01},{"name":"instream","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"col_ss","enabled":false},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.01},{"name":"pmp","type":"percent","value":0.01},{"name":"instream","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"colossus","enabled":false},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"concert","enabled":false},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"conversant","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.75},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"crit_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.74},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"criteo","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"pmp","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"flipp","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.9},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"G-TRUSTX-b827d08da2714822","type":"percent","value":0.975},{"name":"G-JW_PLAYER-cc4da3eff85746e0","type":"percent","value":0.25},{"name":"G-JW_PLAYER-8d9e8049ca4947cf","type":"percent","value":0.25},{"name":"G-JW_PLAYER-15fae286f8a54614","type":"percent","value":0.25},{"name":"G-JW_PLAYER-48b6dc41e71d4585","type":"percent","value":0.25},{"name":"G-JW_PLAYER-3625d1d8189843b9","type":"percent","value":0.25},{"name":"G-JAKALA-ad18dc54f13645f6","type":"percent","value":0.25},{"name":"G-GOODNET-c64f9ad88c37454b","type":"percent","value":0.25},{"name":"G-JW_PLAYER-8f16946ae7db4d0b","type":"percent","value":0.25},{"name":"G-IPONWEB-8eb9cd8d9c074fdb","type":"percent","value":0.25},{"name":"G-GOODNET-1760a8d1849646d4","type":"percent","value":0.25},{"name":"G-JW_PLAYER-1ffec6b669524e6c","type":"percent","value":0.25},{"name":"G-JW_PLAYER-a3eb7128094c4360","type":"percent","value":0.25},{"name":"G-ORACLE-29af695dcd484d86","type":"percent","value":0.25},{"name":"G-JW_PLAYER-acb2ef7c2dc24255","type":"percent","value":0.25},{"name":"G-IPONWEB-4e2af46faa364ea3","type":"percent","value":0.25},{"name":"G-GOODNET-a81896d35fab407f","type":"percent","value":0.25},{"name":"G-JW_PLAYER-5c0fc3ff3b4f4a8b","type":"percent","value":0.25},{"name":"G-JW_PLAYER-3a20f33920ba4e1d","type":"percent","value":0.25},{"name":"G-IPONWEB-b2694d271dbe4183","type":"percent","value":0.25},{"name":"G-GOODNET-376e7a125b6c404f","type":"percent","value":0.25}]},{"name":"stickyOutstream","type":"percent","value":0.8}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"grid","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"gridnat","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.94},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"g-trustx-69dcdccd456a4d4a","type":"percent","value":1}]}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"gridvid","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.983},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"gumgum","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.98},{"name":"stickyOutstream","type":"percent","value":0.75},{"name":"instream","type":"percent","value":0.99}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"improve_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.98},{"name":"outstream","type":"percent","value":0.98},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"M1IX203202022021992","type":"flat","value":0.5},{"name":"M1IX203202022021991","type":"flat","value":0.5},{"name":"203209212021995","type":"flat","value":1},{"name":"203209212021996","type":"flat","value":1},{"name":"203210122021995","type":"flat","value":1},{"name":"203210122021996","type":"flat","value":1},{"name":"M1IX203212162021995","type":"flat","value":1},{"name":"M1IX203212162021996","type":"flat","value":1},{"name":"9311192021991","type":"percent","value":0.97},{"name":"9311192021992","type":"percent","value":0.97},{"name":"146002182022991","type":"flat","value":1},{"name":"146002182022992","type":"flat","value":1},{"name":"146002182022993","type":"flat","value":1},{"name":"146002182022994","type":"flat","value":1},{"name":"146002182022995","type":"flat","value":1},{"name":"2251041120229923","type":"percent","value":0.97},{"name":"2251041120229922","type":"percent","value":0.97},{"name":"2251041120229921","type":"percent","value":0.97},{"name":"2251041120229920","type":"percent","value":0.97},{"name":"2251041120229919","type":"percent","value":0.97},{"name":"2251041120229918","type":"percent","value":0.97},{"name":"2251041120229917","type":"percent","value":0.97},{"name":"2251041120229916","type":"percent","value":0.97},{"name":"2251041120229915","type":"percent","value":0.97},{"name":"2251041120229914","type":"percent","value":0.97},{"name":"2251041120229913","type":"percent","value":0.97},{"name":"2251041120229912","type":"percent","value":0.97},{"name":"2251041120229911","type":"percent","value":0.97},{"name":"2251041120229910","type":"percent","value":0.97},{"name":"225104112022999","type":"percent","value":0.97},{"name":"225104112022998","type":"percent","value":0.97},{"name":"225104112022997","type":"percent","value":0.97},{"name":"225104112022996","type":"percent","value":0.97},{"name":"225104112022995","type":"percent","value":0.97},{"name":"225104112022994","type":"percent","value":0.97},{"name":"225104112022993","type":"percent","value":0.97},{"name":"225104112022992","type":"percent","value":0.97},{"name":"225104112022991","type":"percent","value":0.97},{"name":"400104282022991","type":"percent","value":0.97},{"name":"335305022022991","type":"flat","value":1},{"name":"335305022022992","type":"flat","value":1},{"name":"905172022991","type":"flat","value":0.5},{"name":"140408052022991","type":"flat","value":1},{"name":"140408052022992","type":"flat","value":1},{"name":"140408052022993","type":"flat","value":1},{"name":"140408052022994","type":"flat","value":1},{"name":"51210172022991","type":"flat","value":1},{"name":"51210172022992","type":"flat","value":1},{"name":"140410122022991","type":"flat","value":1},{"name":"140410122022992","type":"flat","value":1},{"name":"51211082022991","type":"flat","value":1},{"name":"270111082022991","type":"flat","value":1.5},{"name":"270111082022992","type":"flat","value":1.5},{"name":"270111082022993","type":"flat","value":1},{"name":"270111082022994","type":"flat","value":1},{"name":"140412152022995","type":"flat","value":1},{"name":"140412152022996","type":"flat","value":1},{"name":"140412152022997","type":"flat","value":1},{"name":"515112212022991","type":"flat","value":1.5},{"name":"515112212022992","type":"flat","value":1.5},{"name":"683401262023991","type":"percent","value":0.97},{"name":"683401262023992","type":"percent","value":0.97},{"name":"1404013123991","type":"flat","value":1},{"name":"1404013123992","type":"flat","value":1},{"name":"1404013123993","type":"flat","value":1},{"name":"1404013123994","type":"flat","value":1},{"name":"140402282023991","type":"flat","value":1},{"name":"121503022023991","type":"flat","value":1.5},{"name":"121503022023992","type":"flat","value":1.5},{"name":"9063003102023991","type":"flat","value":1},{"name":"9063003102023992","type":"flat","value":1},{"name":"9063003102023993","type":"flat","value":1},{"name":"9063003102023994","type":"flat","value":1},{"name":"140403242023991","type":"flat","value":1},{"name":"140403242023992","type":"flat","value":1},{"name":"140403242023993","type":"flat","value":1},{"name":"15105022023993","type":"flat","value":1},{"name":"15105022023994","type":"flat","value":1},{"name":"15105022023995","type":"flat","value":1},{"name":"15105022023996","type":"flat","value":1},{"name":"20706162023991","type":"flat","value":1},{"name":"20706162023992","type":"flat","value":1},{"name":"72206142023991","type":"flat","value":1.5},{"name":"72206142023992","type":"flat","value":1.5},{"name":"23107122023991","type":"flat","value":1},{"name":"23107122023992","type":"flat","value":1},{"name":"23107122023993","type":"flat","value":1},{"name":"23107122023994","type":"flat","value":1},{"name":"23107122023995","type":"flat","value":1},{"name":"23107122023996","type":"flat","value":1},{"name":"23107122023997","type":"flat","value":1},{"name":"23107122023998","type":"flat","value":1},{"name":"23107122023999","type":"flat","value":1},{"name":"231071220239910","type":"flat","value":1},{"name":"231071220239911","type":"flat","value":1},{"name":"231071220239912","type":"flat","value":1},{"name":"231071220239913","type":"flat","value":1},{"name":"231071220239914","type":"flat","value":1},{"name":"231071220239915","type":"flat","value":1},{"name":"231071220239916","type":"flat","value":1},{"name":"231071220239917","type":"flat","value":1},{"name":"231071220239918","type":"flat","value":1},{"name":"231071220239919","type":"flat","value":1},{"name":"231071220239920","type":"flat","value":1},{"name":"231071220239921","type":"flat","value":1},{"name":"231071220239922","type":"flat","value":1},{"name":"303208092023991","type":"flat","value":0.28},{"name":"303208092023992","type":"flat","value":0.28},{"name":"303208092023993","type":"flat","value":0.28},{"name":"303208092023994","type":"flat","value":0.28},{"name":"303208092023995","type":"flat","value":0.28},{"name":"320809082023991","type":"flat","value":1},{"name":"320809082023992","type":"flat","value":1},{"name":"320809082023993","type":"flat","value":1},{"name":"320809082023994","type":"flat","value":1},{"name":"320809082023995","type":"flat","value":1},{"name":"320809082023996","type":"flat","value":1},{"name":"320809082023997","type":"flat","value":1.5},{"name":"320809082023998","type":"flat","value":1.5},{"name":"536509082023991","type":"flat","value":1},{"name":"536509082023992","type":"flat","value":1},{"name":"536509082023993","type":"flat","value":1},{"name":"536509082023994","type":"flat","value":1},{"name":"536509082023995","type":"flat","value":1},{"name":"536509082023996","type":"flat","value":1},{"name":"20709262023991","type":"flat","value":1},{"name":"20709262023992","type":"flat","value":1},{"name":"110010052023991","type":"flat","value":4.97},{"name":"110010052023992","type":"flat","value":4.97},{"name":"152910052023991","type":"flat","value":1},{"name":"152910052023992","type":"flat","value":1},{"name":"515110202023991","type":"flat","value":1.5},{"name":"515110202023992","type":"flat","value":1.5},{"name":"15110132023991","type":"flat","value":1},{"name":"15110132023992","type":"flat","value":1},{"name":"15110172023992","type":"flat","value":1},{"name":"15110172023991","type":"flat","value":1},{"name":"20710262023995","type":"flat","value":1},{"name":"20710262023996","type":"flat","value":1},{"name":"20710262023997","type":"flat","value":1},{"name":"20710262023998","type":"flat","value":1},{"name":"20710262023999","type":"flat","value":1},{"name":"20710232023910","type":"flat","value":1},{"name":"20710262023911","type":"flat","value":1},{"name":"20710262023912","type":"flat","value":1},{"name":"20710262023913","type":"flat","value":1},{"name":"20710262023914","type":"flat","value":1},{"name":"20710262023915","type":"flat","value":1},{"name":"20710262023916","type":"flat","value":1},{"name":"20710262023917","type":"flat","value":1},{"name":"20710262023918","type":"flat","value":1},{"name":"20710262023919","type":"flat","value":1},{"name":"20710262023920","type":"flat","value":1},{"name":"110010262023991","type":"flat","value":4.97},{"name":"110010262023992","type":"flat","value":4.97},{"name":"110010262023993","type":"flat","value":1.47},{"name":"110010272023994","type":"flat","value":1.47},{"name":"110010272023995","type":"flat","value":1.47},{"name":"212210182023991","type":"percent","value":0.9},{"name":"146006052023995","type":"percent","value":0.9},{"name":"146006052023992","type":"percent","value":0.9},{"name":"146006052023991","type":"percent","value":0.9},{"name":"146006052023993","type":"percent","value":0.9},{"name":"483412152023991","type":"flat","value":1},{"name":"483412152023992","type":"flat","value":1},{"name":"9901242024992","type":"flat","value":4.24},{"name":"9901242024993","type":"flat","value":3.24},{"name":"9901242024994","type":"flat","value":4.24},{"name":"193102232024991","type":"flat","value":0.8},{"name":"193102223024992","type":"flat","value":0.8},{"name":"20701262024995","type":"flat","value":1},{"name":"20701262024996","type":"flat","value":1},{"name":"20701262024997","type":"flat","value":1},{"name":"20701262024998","type":"flat","value":1},{"name":"264202292024992","type":"flat","value":1},{"name":"815104172024991","type":"flat","value":1},{"name":"815104172024992","type":"flat","value":1},{"name":"815104172024993","type":"flat","value":1},{"name":"815104172024994","type":"flat","value":1},{"name":"815104172024995","type":"flat","value":1},{"name":"815104172024996","type":"flat","value":1},{"name":"121503272024991","type":"flat","value":1},{"name":"121503272024992","type":"flat","value":1},{"name":"121503272024993","type":"flat","value":1},{"name":"121503272024994","type":"flat","value":1},{"name":"BB515107222024992","type":"flat","value":3.6},{"name":"BB515107222024991","type":"flat","value":3.6},{"name":"502908152024991","type":"percent","value":0.95},{"name":"502908152024992","type":"percent","value":0.95},{"name":"502908152024993","type":"percent","value":0.95},{"name":"502908152024994","type":"percent","value":0.95},{"name":"PAN457408292024991","type":"flat","value":2.6},{"name":"PAN457408292024992","type":"flat","value":2.6},{"name":"PAN49008292024995","type":"flat","value":2.6},{"name":"PAN49008292024996","type":"flat","value":2.6},{"name":"BB49008292024991","type":"flat","value":2.6},{"name":"BB49008292024993","type":"flat","value":2.6},{"name":"MRL154505152024991","type":"flat","value":3.8},{"name":"MRL154505152024991","type":"percent","value":0.95},{"name":"PAN515108302024991","type":"flat","value":2.6},{"name":"PAN515108302024992","type":"flat","value":2.6},{"name":"BB73109192024991","type":"flat","value":3.6},{"name":"BB73109192024992","type":"flat","value":3.6},{"name":"PAN193110042024991","type":"flat","value":2.6},{"name":"PAN193110042024992","type":"flat","value":2.6},{"name":"BB73110222024991","type":"flat","value":3.6},{"name":"BB73110222024992","type":"flat","value":3.6},{"name":"PAN10010232024991","type":"flat","value":2.6},{"name":"PAN10010232024992","type":"flat","value":2.6},{"name":"PAN10010232024993","type":"flat","value":2.6},{"name":"PAN10010232024994","type":"flat","value":2.6},{"name":"PAN10010232024995","type":"flat","value":2.6},{"name":"PAN10010232024996","type":"flat","value":2.6},{"name":"PAN10010232024997","type":"flat","value":2.6},{"name":"PAN10010232024998","type":"flat","value":2.6}]},{"name":"stickyOutstream","type":"percent","value":0.85},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ix","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"outstream","type":"percent","value":0.99},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"kargo","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"krgo_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"nativo","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"pmp","type":"percent","value":0.99,"deals":[{"name":"OX-caf-ypSBrR","type":"flat","value":1}]},{"name":"stickyOutstream","type":"percent","value":0.77},{"name":"instream","type":"percent","value":0.97}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"openx","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"pmp","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.76},{"name":"instream","type":"percent","value":0.98}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"opnx_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.89}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ozone","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"inBannerVideo","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"PM-KINC-9618","type":"flat","value":2},{"name":"PM-JUHD-8401","type":"flat","value":2.6},{"name":"PM-HATE-1895","type":"flat","value":2.6},{"name":"PM-MQZI-5216","type":"flat","value":2.6},{"name":"PM-TTRW-3858","type":"flat","value":2.6},{"name":"PM-PAFH-7243","type":"flat","value":2.6},{"name":"PM-VZSB-1140","type":"flat","value":2.6},{"name":"PM-VAWX-8475","type":"flat","value":1.25},{"name":"PM-KTOG-0862","type":"flat","value":1.25}]},{"name":"stickyOutstream","type":"percent","value":0.98},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"pubm_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"inBannerVideo","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"PM-KINC-9618","type":"flat","value":2},{"name":"PM-VAWX-8475","type":"flat","value":1.25},{"name":"PM-KTOG-0862","type":"flat","value":1.25},{"name":"PM-JUHD-8401","type":"flat","value":2.6},{"name":"PM-HATE-1895","type":"flat","value":2.6},{"name":"PM-MQZI-5216","type":"flat","value":2.6},{"name":"PM-TTRW-3858","type":"flat","value":2.6},{"name":"PM-PAFH-7243","type":"flat","value":2.6},{"name":"PM-VZSB-1140","type":"flat","value":2.6}]},{"name":"stickyOutstream","type":"percent","value":0.98},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"pubmatic","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.01},{"name":"instream","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"resetdigital","enabled":false},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"rise","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.35}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"rtbhouse","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"829398","type":"percent","value":0.95},{"name":"832174","type":"percent","value":0.97},{"name":"832176","type":"percent","value":0.97},{"name":"855776","type":"percent","value":0.97},{"name":"855778","type":"percent","value":0.97},{"name":"855780","type":"percent","value":0.97},{"name":"855782","type":"percent","value":0.97},{"name":"855784","type":"percent","value":0.97},{"name":"855786","type":"percent","value":0.97},{"name":"855788","type":"percent","value":0.97},{"name":"855790","type":"percent","value":0.97},{"name":"855792","type":"percent","value":0.97},{"name":"855794","type":"percent","value":0.97},{"name":"855796","type":"percent","value":0.97},{"name":"855798","type":"percent","value":0.97},{"name":"855800","type":"percent","value":0.97},{"name":"855802","type":"percent","value":0.97},{"name":"855804","type":"percent","value":0.97},{"name":"855806","type":"percent","value":0.97},{"name":"855808","type":"percent","value":0.97},{"name":"855810","type":"percent","value":0.97},{"name":"855812","type":"percent","value":0.97},{"name":"855814","type":"percent","value":0.97},{"name":"855816","type":"percent","value":0.97},{"name":"855824","type":"percent","value":0.97},{"name":"855828","type":"percent","value":0.97},{"name":"859888","type":"percent","value":0.97},{"name":"944042","type":"percent","value":0.97},{"name":"944044","type":"percent","value":0.97},{"name":"1130968","type":"percent","value":0.9},{"name":"1130970","type":"percent","value":0.9},{"name":"1130976","type":"percent","value":0.9},{"name":"1130978","type":"percent","value":0.9},{"name":"1623874","type":"percent","value":0.88},{"name":"1623876","type":"percent","value":0.88},{"name":"1751440","type":"percent","value":0.88},{"name":"1751442","type":"percent","value":0.88},{"name":"1751444","type":"percent","value":0.88},{"name":"1751448","type":"percent","value":0.88},{"name":"1751450","type":"percent","value":0.88},{"name":"1751452","type":"percent","value":0.88},{"name":"1751454","type":"percent","value":0.88},{"name":"1751456","type":"percent","value":0.88},{"name":"1751472","type":"percent","value":0.88},{"name":"1751474","type":"percent","value":0.88},{"name":"1751476","type":"percent","value":0.88},{"name":"1751478","type":"percent","value":0.88},{"name":"1751480","type":"percent","value":0.88},{"name":"1751482","type":"percent","value":0.88},{"name":"1751632","type":"percent","value":0.88},{"name":"1751634","type":"percent","value":0.88},{"name":"1751636","type":"percent","value":0.88},{"name":"1751638","type":"percent","value":0.88},{"name":"1751640","type":"percent","value":0.88},{"name":"1751642","type":"percent","value":0.88},{"name":"1751644","type":"percent","value":0.88},{"name":"1751646","type":"percent","value":0.88},{"name":"1751648","type":"percent","value":0.88},{"name":"1751650","type":"percent","value":0.88},{"name":"1751652","type":"percent","value":0.88},{"name":"1751654","type":"percent","value":0.88},{"name":"1751656","type":"percent","value":0.88},{"name":"1751660","type":"percent","value":0.88},{"name":"1751662","type":"percent","value":0.88},{"name":"1751664","type":"percent","value":0.88},{"name":"1751666","type":"percent","value":0.88},{"name":"1751668","type":"percent","value":0.88},{"name":"1751670","type":"percent","value":0.88},{"name":"1751672","type":"percent","value":0.88},{"name":"1751674","type":"percent","value":0.88},{"name":"1751676","type":"percent","value":0.88},{"name":"1751678","type":"percent","value":0.88},{"name":"1751680","type":"percent","value":0.88},{"name":"1751682","type":"percent","value":0.88},{"name":"1751684","type":"percent","value":0.88},{"name":"1751686","type":"percent","value":0.88},{"name":"1751688","type":"percent","value":0.88},{"name":"1751690","type":"percent","value":0.88},{"name":"1751692","type":"percent","value":0.88},{"name":"1751694","type":"percent","value":0.88},{"name":"1751696","type":"percent","value":0.88},{"name":"1751698","type":"percent","value":0.88},{"name":"1751700","type":"percent","value":0.88},{"name":"1751702","type":"percent","value":0.88},{"name":"1751706","type":"percent","value":0.88},{"name":"1751708","type":"percent","value":0.88},{"name":"1751710","type":"percent","value":0.88},{"name":"1751712","type":"percent","value":0.88},{"name":"1751714","type":"percent","value":0.88},{"name":"1751716","type":"percent","value":0.88},{"name":"1751718","type":"percent","value":0.88},{"name":"1791050","type":"percent","value":0.9},{"name":"1791052","type":"percent","value":0.9},{"name":"1791054","type":"percent","value":0.9},{"name":"1792390","type":"percent","value":0.88},{"name":"1792400","type":"percent","value":0.88},{"name":"1883724","type":"percent","value":0.9},{"name":"1883726","type":"percent","value":0.9},{"name":"1883728","type":"percent","value":0.9},{"name":"1909612","type":"percent","value":0.9},{"name":"1910078","type":"percent","value":0.9},{"name":"1913794","type":"percent","value":0.9},{"name":"1914770","type":"percent","value":0.9},{"name":"1915132","type":"percent","value":0.9},{"name":"1915136","type":"percent","value":0.9},{"name":"1915534","type":"percent","value":0.9},{"name":"1915928","type":"percent","value":0.9},{"name":"1915930","type":"percent","value":0.9},{"name":"1916326","type":"percent","value":0.9},{"name":"1916722","type":"percent","value":0.9},{"name":"1917116","type":"percent","value":0.9},{"name":"1917120","type":"percent","value":0.9},{"name":"1917122","type":"percent","value":0.9},{"name":"1917124","type":"percent","value":0.9},{"name":"1917126","type":"percent","value":0.9},{"name":"1917128","type":"percent","value":0.9},{"name":"1917130","type":"percent","value":0.9},{"name":"1917132","type":"percent","value":0.88},{"name":"1917134","type":"percent","value":0.88},{"name":"1917136","type":"percent","value":0.88},{"name":"1917138","type":"percent","value":0.88},{"name":"1917142","type":"percent","value":0.9},{"name":"1917144","type":"percent","value":0.9},{"name":"1921048","type":"percent","value":0.9},{"name":"1921898","type":"percent","value":0.9},{"name":"1921906","type":"percent","value":0.9},{"name":"1950010","type":"percent","value":0.88},{"name":"1950020","type":"percent","value":0.88},{"name":"2003186","type":"percent","value":0.88},{"name":"2003188","type":"percent","value":0.88},{"name":"2003190","type":"percent","value":0.88},{"name":"2003192","type":"percent","value":0.88},{"name":"2032118","type":"percent","value":0.88},{"name":"2040506","type":"percent","value":0.9},{"name":"2076190","type":"percent","value":0.9},{"name":"2091612","type":"percent","value":0.9},{"name":"2092510","type":"percent","value":0.9},{"name":"2100546","type":"percent","value":0.9},{"name":"2127668","type":"percent","value":0.9},{"name":"2127670","type":"percent","value":0.9},{"name":"2212644","type":"percent","value":0.9},{"name":"2212648","type":"percent","value":0.9},{"name":"2256280","type":"percent","value":0.9},{"name":"2256286","type":"percent","value":0.9},{"name":"2256288","type":"percent","value":0.9},{"name":"2256292","type":"percent","value":0.9},{"name":"2302618","type":"percent","value":0.88},{"name":"2302620","type":"percent","value":0.88},{"name":"2302622","type":"percent","value":0.88},{"name":"2331334","type":"percent","value":0.88},{"name":"2339448","type":"percent","value":0.9},{"name":"2356286","type":"percent","value":0.9},{"name":"2394816","type":"percent","value":0.9},{"name":"2394818","type":"percent","value":0.9},{"name":"2395892","type":"percent","value":0.9},{"name":"2397458","type":"percent","value":0.9},{"name":"2397466","type":"percent","value":0.9},{"name":"2452690","type":"percent","value":0.88},{"name":"2464274","type":"percent","value":0.88},{"name":"2464278","type":"percent","value":0.88},{"name":"2464280","type":"percent","value":0.88},{"name":"2464282","type":"percent","value":0.88},{"name":"2464284","type":"percent","value":0.88},{"name":"2464286","type":"percent","value":0.88},{"name":"2479038","type":"percent","value":0.88},{"name":"2479456","type":"percent","value":0.88},{"name":"2484526","type":"percent","value":0.9},{"name":"2484530","type":"percent","value":0.9},{"name":"2484532","type":"percent","value":0.9},{"name":"2486688","type":"percent","value":0.9},{"name":"2511840","type":"percent","value":0.88},{"name":"2669970","type":"percent","value":0.88},{"name":"2674258","type":"percent","value":0.88},{"name":"2674260","type":"percent","value":0.88},{"name":"2674262","type":"percent","value":0.88},{"name":"2674264","type":"percent","value":0.88},{"name":"2674268","type":"percent","value":0.88},{"name":"2674270","type":"percent","value":0.88},{"name":"2674272","type":"percent","value":0.88},{"name":"2674276","type":"percent","value":0.88},{"name":"2674278","type":"percent","value":0.88},{"name":"2674280","type":"percent","value":0.88},{"name":"2674282","type":"percent","value":0.88},{"name":"2674284","type":"percent","value":0.88},{"name":"2674286","type":"percent","value":0.88},{"name":"2674288","type":"percent","value":0.88},{"name":"2674290","type":"percent","value":0.88},{"name":"2674292","type":"percent","value":0.88},{"name":"2674296","type":"percent","value":0.88},{"name":"2674298","type":"percent","value":0.88},{"name":"2674300","type":"percent","value":0.88},{"name":"2674302","type":"percent","value":0.88},{"name":"2674304","type":"percent","value":0.88},{"name":"2674306","type":"percent","value":0.88},{"name":"2680696","type":"percent","value":0.88},{"name":"2680698","type":"percent","value":0.88},{"name":"2734898","type":"percent","value":0.9},{"name":"2734902","type":"percent","value":0.9},{"name":"2734904","type":"percent","value":0.9},{"name":"2734908","type":"percent","value":0.9},{"name":"2734910","type":"percent","value":0.9},{"name":"2734914","type":"percent","value":0.9},{"name":"2734918","type":"percent","value":0.9},{"name":"2734920","type":"percent","value":0.9},{"name":"2734922","type":"percent","value":0.9},{"name":"2734924","type":"percent","value":0.9},{"name":"2734926","type":"percent","value":0.9},{"name":"2734928","type":"percent","value":0.9},{"name":"2734930","type":"percent","value":0.9},{"name":"2734932","type":"percent","value":0.9},{"name":"2734934","type":"percent","value":0.9},{"name":"2734936","type":"percent","value":0.9},{"name":"2734938","type":"percent","value":0.9},{"name":"2734940","type":"percent","value":0.9},{"name":"2734942","type":"percent","value":0.9},{"name":"2734944","type":"percent","value":0.9},{"name":"2734946","type":"percent","value":0.9},{"name":"2734948","type":"percent","value":0.9},{"name":"2734950","type":"percent","value":0.9},{"name":"2734952","type":"percent","value":0.9},{"name":"2734954","type":"percent","value":0.9},{"name":"2734956","type":"percent","value":0.9},{"name":"2734958","type":"percent","value":0.9},{"name":"2734960","type":"percent","value":0.9},{"name":"2734962","type":"percent","value":0.9},{"name":"2734964","type":"percent","value":0.9},{"name":"2734966","type":"percent","value":0.9},{"name":"2734968","type":"percent","value":0.9},{"name":"2734970","type":"percent","value":0.9},{"name":"2734972","type":"percent","value":0.9},{"name":"2734974","type":"percent","value":0.9},{"name":"2734976","type":"percent","value":0.9},{"name":"2749170","type":"percent","value":0.88},{"name":"2756148","type":"flat","value":0.8},{"name":"2811442","type":"percent","value":0.9},{"name":"2811450","type":"percent","value":0.9},{"name":"2823770","type":"percent","value":0.88},{"name":"2824402","type":"percent","value":0.9},{"name":"2825204","type":"percent","value":0.9},{"name":"2837520","type":"percent","value":0.88},{"name":"2837534","type":"percent","value":0.88},{"name":"2877500","type":"percent","value":0.88},{"name":"2877504","type":"percent","value":0.88},{"name":"2877506","type":"percent","value":0.88},{"name":"2877510","type":"percent","value":0.88},{"name":"2990692","type":"percent","value":0.88},{"name":"2990750","type":"percent","value":0.88},{"name":"2990752","type":"percent","value":0.88},{"name":"2990756","type":"percent","value":0.88},{"name":"2990760","type":"percent","value":0.88},{"name":"2990762","type":"percent","value":0.88},{"name":"2990764","type":"percent","value":0.88},{"name":"2990766","type":"percent","value":0.88},{"name":"2990768","type":"percent","value":0.88},{"name":"2990770","type":"percent","value":0.88},{"name":"2990772","type":"percent","value":0.88},{"name":"3064682","type":"flat","value":2.6},{"name":"3064682","type":"percent","value":0.88},{"name":"3073482","type":"flat","value":2.6},{"name":"3073482","type":"percent","value":0.88},{"name":"3073502","type":"flat","value":2.6},{"name":"3073502","type":"percent","value":0.88},{"name":"3073504","type":"flat","value":2.6},{"name":"3073504","type":"percent","value":0.88},{"name":"3073506","type":"flat","value":2.6},{"name":"3073506","type":"percent","value":0.88},{"name":"3073508","type":"flat","value":2.6},{"name":"3073508","type":"percent","value":0.88},{"name":"3141208","type":"percent","value":0.9},{"name":"3141658","type":"percent","value":0.9},{"name":"3141660","type":"percent","value":0.9},{"name":"3141662","type":"percent","value":0.9},{"name":"3243288","type":"percent","value":0.9},{"name":"3243290","type":"percent","value":0.9},{"name":"3243292","type":"percent","value":0.9},{"name":"3243294","type":"percent","value":0.9},{"name":"3281928","type":"percent","value":0.88},{"name":"3281930","type":"percent","value":0.88},{"name":"3283836","type":"percent","value":0.88},{"name":"3283952","type":"percent","value":0.88},{"name":"3284646","type":"percent","value":0.88},{"name":"3285126","type":"percent","value":0.88},{"name":"3285302","type":"percent","value":0.88},{"name":"3285458","type":"percent","value":0.88},{"name":"3285460","type":"percent","value":0.88},{"name":"3285814","type":"percent","value":0.88},{"name":"3286008","type":"percent","value":0.88},{"name":"3286010","type":"percent","value":0.88},{"name":"3286014","type":"percent","value":0.88},{"name":"3286016","type":"percent","value":0.88},{"name":"3286020","type":"percent","value":0.88},{"name":"3286548","type":"percent","value":0.88},{"name":"3286564","type":"percent","value":0.88},{"name":"3286566","type":"percent","value":0.88},{"name":"3286568","type":"percent","value":0.88},{"name":"3286574","type":"percent","value":0.88},{"name":"3286576","type":"percent","value":0.88},{"name":"3286578","type":"percent","value":0.88},{"name":"3286580","type":"percent","value":0.88},{"name":"3309310","type":"flat","value":3.6},{"name":"3309310","type":"percent","value":0.88},{"name":"3309804","type":"flat","value":3.6},{"name":"3309804","type":"percent","value":0.88},{"name":"3309806","type":"flat","value":3.6},{"name":"3309806","type":"percent","value":0.88},{"name":"3309808","type":"flat","value":3.6},{"name":"3309808","type":"percent","value":0.88},{"name":"3317338","type":"percent","value":0.95},{"name":"3317342","type":"percent","value":0.95},{"name":"3317344","type":"percent","value":0.95},{"name":"3317346","type":"percent","value":0.95},{"name":"3331634","type":"percent","value":0.88},{"name":"3359410","type":"percent","value":0.9},{"name":"3359414","type":"percent","value":0.9},{"name":"3359416","type":"percent","value":0.9},{"name":"3401148","type":"percent","value":0.9},{"name":"3401150","type":"percent","value":0.9},{"name":"3401152","type":"percent","value":0.9},{"name":"3401154","type":"percent","value":0.9},{"name":"3419972","type":"percent","value":0.9},{"name":"3427182","type":"percent","value":0.88},{"name":"3464904","type":"percent","value":0.95},{"name":"3464906","type":"percent","value":0.95},{"name":"3492808","type":"flat","value":2.6},{"name":"3494148","type":"percent","value":0.9},{"name":"3494152","type":"percent","value":0.9},{"name":"3507294","type":"flat","value":2.6},{"name":"3507302","type":"flat","value":3.6},{"name":"3507316","type":"flat","value":3.6},{"name":"3532524","type":"percent","value":0.95},{"name":"3532624","type":"percent","value":0.95},{"name":"3561446","type":"percent","value":0.9},{"name":"3561448","type":"percent","value":0.9},{"name":"3577514","type":"percent","value":0.95},{"name":"3577516","type":"percent","value":0.95},{"name":"3577518","type":"percent","value":0.95},{"name":"3577520","type":"percent","value":0.95},{"name":"3577522","type":"percent","value":0.95},{"name":"3577524","type":"percent","value":0.95},{"name":"3578846","type":"percent","value":0.95},{"name":"3578870","type":"percent","value":0.95},{"name":"3626028","type":"percent","value":0.88},{"name":"3626030","type":"percent","value":0.88},{"name":"3626032","type":"percent","value":0.88},{"name":"3626038","type":"percent","value":0.88},{"name":"3650122","type":"percent","value":0.95},{"name":"3650124","type":"percent","value":0.95},{"name":"3691624","type":"percent","value":0.95},{"name":"3691626","type":"percent","value":0.95},{"name":"3693074","type":"flat","value":2.6},{"name":"3693074","type":"percent","value":0.88},{"name":"3693076","type":"flat","value":2.6},{"name":"3693076","type":"percent","value":0.88},{"name":"3744900","type":"percent","value":0.95},{"name":"3744902","type":"percent","value":0.95},{"name":"3766636","type":"percent","value":0.95},{"name":"3766638","type":"percent","value":0.95},{"name":"3766640","type":"percent","value":0.95},{"name":"3766646","type":"percent","value":0.95},{"name":"3766690","type":"percent","value":0.88},{"name":"3765924","type":"percent","value":0.95},{"name":"3765922","type":"percent","value":0.95},{"name":"3765926","type":"percent","value":0.95},{"name":"3765920","type":"percent","value":0.95}]},{"name":"stickyOutstream","type":"percent","value":0.8},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"media_type":"display"},{"s2s_value":0,"media_type":"video"}],"bidder_name":"rubi_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"outstream","type":"percent","value":0.99},{"name":"pmp","type":"percent","value":0.99,"deals":[{"name":"829398","type":"percent","value":0.95},{"name":"832174","type":"percent","value":0.97},{"name":"832176","type":"percent","value":0.97},{"name":"855776","type":"percent","value":0.97},{"name":"855778","type":"percent","value":0.97},{"name":"855780","type":"percent","value":0.97},{"name":"855782","type":"percent","value":0.97},{"name":"855784","type":"percent","value":0.97},{"name":"855786","type":"percent","value":0.97},{"name":"855788","type":"percent","value":0.97},{"name":"855790","type":"percent","value":0.97},{"name":"855792","type":"percent","value":0.97},{"name":"855794","type":"percent","value":0.97},{"name":"855796","type":"percent","value":0.97},{"name":"855798","type":"percent","value":0.97},{"name":"855800","type":"percent","value":0.97},{"name":"855802","type":"percent","value":0.97},{"name":"855804","type":"percent","value":0.97},{"name":"855806","type":"percent","value":0.97},{"name":"855808","type":"percent","value":0.97},{"name":"855810","type":"percent","value":0.97},{"name":"855812","type":"percent","value":0.97},{"name":"855814","type":"percent","value":0.97},{"name":"855816","type":"percent","value":0.97},{"name":"855824","type":"percent","value":0.97},{"name":"855828","type":"percent","value":0.97},{"name":"859888","type":"percent","value":0.97},{"name":"944042","type":"percent","value":0.97},{"name":"944044","type":"percent","value":0.97},{"name":"1130968","type":"percent","value":0.9},{"name":"1130970","type":"percent","value":0.9},{"name":"1130976","type":"percent","value":0.9},{"name":"1130978","type":"percent","value":0.9},{"name":"1623874","type":"percent","value":0.88},{"name":"1623876","type":"percent","value":0.88},{"name":"1751440","type":"percent","value":0.88},{"name":"1751442","type":"percent","value":0.88},{"name":"1751444","type":"percent","value":0.88},{"name":"1751448","type":"percent","value":0.88},{"name":"1751450","type":"percent","value":0.88},{"name":"1751452","type":"percent","value":0.88},{"name":"1751454","type":"percent","value":0.88},{"name":"1751456","type":"percent","value":0.88},{"name":"1751472","type":"percent","value":0.88},{"name":"1751474","type":"percent","value":0.88},{"name":"1751476","type":"percent","value":0.88},{"name":"1751478","type":"percent","value":0.88},{"name":"1751480","type":"percent","value":0.88},{"name":"1751482","type":"percent","value":0.88},{"name":"1751632","type":"percent","value":0.88},{"name":"1751634","type":"percent","value":0.88},{"name":"1751636","type":"percent","value":0.88},{"name":"1751638","type":"percent","value":0.88},{"name":"1751640","type":"percent","value":0.88},{"name":"1751642","type":"percent","value":0.88},{"name":"1751644","type":"percent","value":0.88},{"name":"1751646","type":"percent","value":0.88},{"name":"1751648","type":"percent","value":0.88},{"name":"1751650","type":"percent","value":0.88},{"name":"1751652","type":"percent","value":0.88},{"name":"1751654","type":"percent","value":0.88},{"name":"1751656","type":"percent","value":0.88},{"name":"1751660","type":"percent","value":0.88},{"name":"1751662","type":"percent","value":0.88},{"name":"1751664","type":"percent","value":0.88},{"name":"1751666","type":"percent","value":0.88},{"name":"1751668","type":"percent","value":0.88},{"name":"1751670","type":"percent","value":0.88},{"name":"1751672","type":"percent","value":0.88},{"name":"1751674","type":"percent","value":0.88},{"name":"1751676","type":"percent","value":0.88},{"name":"1751678","type":"percent","value":0.88},{"name":"1751680","type":"percent","value":0.88},{"name":"1751682","type":"percent","value":0.88},{"name":"1751684","type":"percent","value":0.88},{"name":"1751686","type":"percent","value":0.88},{"name":"1751688","type":"percent","value":0.88},{"name":"1751690","type":"percent","value":0.88},{"name":"1751692","type":"percent","value":0.88},{"name":"1751694","type":"percent","value":0.88},{"name":"1751696","type":"percent","value":0.88},{"name":"1751698","type":"percent","value":0.88},{"name":"1751700","type":"percent","value":0.88},{"name":"1751702","type":"percent","value":0.88},{"name":"1751706","type":"percent","value":0.88},{"name":"1751708","type":"percent","value":0.88},{"name":"1751710","type":"percent","value":0.88},{"name":"1751712","type":"percent","value":0.88},{"name":"1751714","type":"percent","value":0.88},{"name":"1751716","type":"percent","value":0.88},{"name":"1751718","type":"percent","value":0.88},{"name":"1791050","type":"percent","value":0.9},{"name":"1791052","type":"percent","value":0.9},{"name":"1791054","type":"percent","value":0.9},{"name":"1792390","type":"percent","value":0.88},{"name":"1792400","type":"percent","value":0.88},{"name":"1883724","type":"percent","value":0.9},{"name":"1883726","type":"percent","value":0.9},{"name":"1883728","type":"percent","value":0.9},{"name":"1909612","type":"percent","value":0.9},{"name":"1910078","type":"percent","value":0.9},{"name":"1913794","type":"percent","value":0.9},{"name":"1914770","type":"percent","value":0.9},{"name":"1915132","type":"percent","value":0.9},{"name":"1915136","type":"percent","value":0.9},{"name":"1915534","type":"percent","value":0.9},{"name":"1915928","type":"percent","value":0.9},{"name":"1915930","type":"percent","value":0.9},{"name":"1916326","type":"percent","value":0.9},{"name":"1916722","type":"percent","value":0.9},{"name":"1917116","type":"percent","value":0.9},{"name":"1917120","type":"percent","value":0.9},{"name":"1917122","type":"percent","value":0.9},{"name":"1917124","type":"percent","value":0.9},{"name":"1917126","type":"percent","value":0.9},{"name":"1917128","type":"percent","value":0.9},{"name":"1917130","type":"percent","value":0.9},{"name":"1917132","type":"percent","value":0.88},{"name":"1917134","type":"percent","value":0.88},{"name":"1917136","type":"percent","value":0.88},{"name":"1917138","type":"percent","value":0.88},{"name":"1917142","type":"percent","value":0.9},{"name":"1917144","type":"percent","value":0.9},{"name":"1921048","type":"percent","value":0.9},{"name":"1921898","type":"percent","value":0.9},{"name":"1921906","type":"percent","value":0.9},{"name":"1950010","type":"percent","value":0.88},{"name":"1950020","type":"percent","value":0.88},{"name":"2003186","type":"percent","value":0.88},{"name":"2003188","type":"percent","value":0.88},{"name":"2003190","type":"percent","value":0.88},{"name":"2003192","type":"percent","value":0.88},{"name":"2032118","type":"percent","value":0.88},{"name":"2040506","type":"percent","value":0.9},{"name":"2076190","type":"percent","value":0.9},{"name":"2091612","type":"percent","value":0.9},{"name":"2092510","type":"percent","value":0.9},{"name":"2100546","type":"percent","value":0.9},{"name":"2127668","type":"percent","value":0.9},{"name":"2127670","type":"percent","value":0.9},{"name":"2212644","type":"percent","value":0.9},{"name":"2212648","type":"percent","value":0.9},{"name":"2256280","type":"percent","value":0.9},{"name":"2256286","type":"percent","value":0.9},{"name":"2256288","type":"percent","value":0.9},{"name":"2256292","type":"percent","value":0.9},{"name":"2302618","type":"percent","value":0.88},{"name":"2302620","type":"percent","value":0.88},{"name":"2302622","type":"percent","value":0.88},{"name":"2331334","type":"percent","value":0.88},{"name":"2339448","type":"percent","value":0.9},{"name":"2356286","type":"percent","value":0.9},{"name":"2394816","type":"percent","value":0.9},{"name":"2394818","type":"percent","value":0.9},{"name":"2395892","type":"percent","value":0.9},{"name":"2397458","type":"percent","value":0.9},{"name":"2397466","type":"percent","value":0.9},{"name":"2452690","type":"percent","value":0.88},{"name":"2464274","type":"percent","value":0.88},{"name":"2464278","type":"percent","value":0.88},{"name":"2464280","type":"percent","value":0.88},{"name":"2464282","type":"percent","value":0.88},{"name":"2464284","type":"percent","value":0.88},{"name":"2464286","type":"percent","value":0.88},{"name":"2479038","type":"percent","value":0.88},{"name":"2479456","type":"percent","value":0.88},{"name":"2484526","type":"percent","value":0.9},{"name":"2484530","type":"percent","value":0.9},{"name":"2484532","type":"percent","value":0.9},{"name":"2486688","type":"percent","value":0.9},{"name":"2511840","type":"percent","value":0.88},{"name":"2669970","type":"percent","value":0.88},{"name":"2674258","type":"percent","value":0.88},{"name":"2674260","type":"percent","value":0.88},{"name":"2674262","type":"percent","value":0.88},{"name":"2674264","type":"percent","value":0.88},{"name":"2674268","type":"percent","value":0.88},{"name":"2674270","type":"percent","value":0.88},{"name":"2674272","type":"percent","value":0.88},{"name":"2674276","type":"percent","value":0.88},{"name":"2674278","type":"percent","value":0.88},{"name":"2674280","type":"percent","value":0.88},{"name":"2674282","type":"percent","value":0.88},{"name":"2674284","type":"percent","value":0.88},{"name":"2674286","type":"percent","value":0.88},{"name":"2674288","type":"percent","value":0.88},{"name":"2674290","type":"percent","value":0.88},{"name":"2674292","type":"percent","value":0.88},{"name":"2674296","type":"percent","value":0.88},{"name":"2674298","type":"percent","value":0.88},{"name":"2674300","type":"percent","value":0.88},{"name":"2674302","type":"percent","value":0.88},{"name":"2674304","type":"percent","value":0.88},{"name":"2674306","type":"percent","value":0.88},{"name":"2680696","type":"percent","value":0.88},{"name":"2680698","type":"percent","value":0.88},{"name":"2734898","type":"percent","value":0.9},{"name":"2734902","type":"percent","value":0.9},{"name":"2734904","type":"percent","value":0.9},{"name":"2734908","type":"percent","value":0.9},{"name":"2734910","type":"percent","value":0.9},{"name":"2734914","type":"percent","value":0.9},{"name":"2734918","type":"percent","value":0.9},{"name":"2734920","type":"percent","value":0.9},{"name":"2734922","type":"percent","value":0.9},{"name":"2734924","type":"percent","value":0.9},{"name":"2734926","type":"percent","value":0.9},{"name":"2734928","type":"percent","value":0.9},{"name":"2734930","type":"percent","value":0.9},{"name":"2734932","type":"percent","value":0.9},{"name":"2734934","type":"percent","value":0.9},{"name":"2734936","type":"percent","value":0.9},{"name":"2734938","type":"percent","value":0.9},{"name":"2734940","type":"percent","value":0.9},{"name":"2734942","type":"percent","value":0.9},{"name":"2734944","type":"percent","value":0.9},{"name":"2734946","type":"percent","value":0.9},{"name":"2734948","type":"percent","value":0.9},{"name":"2734950","type":"percent","value":0.9},{"name":"2734952","type":"percent","value":0.9},{"name":"2734954","type":"percent","value":0.9},{"name":"2734956","type":"percent","value":0.9},{"name":"2734958","type":"percent","value":0.9},{"name":"2734960","type":"percent","value":0.9},{"name":"2734962","type":"percent","value":0.9},{"name":"2734964","type":"percent","value":0.9},{"name":"2734966","type":"percent","value":0.9},{"name":"2734968","type":"percent","value":0.9},{"name":"2734970","type":"percent","value":0.9},{"name":"2734972","type":"percent","value":0.9},{"name":"2734974","type":"percent","value":0.9},{"name":"2734976","type":"percent","value":0.9},{"name":"2749170","type":"percent","value":0.88},{"name":"2756148","type":"flat","value":0.8},{"name":"2811442","type":"percent","value":0.9},{"name":"2811450","type":"percent","value":0.9},{"name":"2823770","type":"percent","value":0.88},{"name":"2824402","type":"percent","value":0.9},{"name":"2825204","type":"percent","value":0.9},{"name":"2837520","type":"percent","value":0.88},{"name":"2837534","type":"percent","value":0.88},{"name":"2877500","type":"percent","value":0.88},{"name":"2877504","type":"percent","value":0.88},{"name":"2877506","type":"percent","value":0.88},{"name":"2877510","type":"percent","value":0.88},{"name":"2990692","type":"percent","value":0.88},{"name":"2990750","type":"percent","value":0.88},{"name":"2990752","type":"percent","value":0.88},{"name":"2990756","type":"percent","value":0.88},{"name":"2990760","type":"percent","value":0.88},{"name":"2990762","type":"percent","value":0.88},{"name":"2990764","type":"percent","value":0.88},{"name":"2990766","type":"percent","value":0.88},{"name":"2990768","type":"percent","value":0.88},{"name":"2990770","type":"percent","value":0.88},{"name":"2990772","type":"percent","value":0.88},{"name":"3064682","type":"flat","value":2.6},{"name":"3064682","type":"percent","value":0.88},{"name":"3073482","type":"flat","value":2.6},{"name":"3073482","type":"percent","value":0.88},{"name":"3073502","type":"flat","value":2.6},{"name":"3073502","type":"percent","value":0.88},{"name":"3073504","type":"flat","value":2.6},{"name":"3073504","type":"percent","value":0.88},{"name":"3073506","type":"flat","value":2.6},{"name":"3073506","type":"percent","value":0.88},{"name":"3073508","type":"flat","value":2.6},{"name":"3073508","type":"percent","value":0.88},{"name":"3141208","type":"percent","value":0.9},{"name":"3141658","type":"percent","value":0.9},{"name":"3141660","type":"percent","value":0.9},{"name":"3141662","type":"percent","value":0.9},{"name":"3243288","type":"percent","value":0.9},{"name":"3243290","type":"percent","value":0.9},{"name":"3243292","type":"percent","value":0.9},{"name":"3243294","type":"percent","value":0.9},{"name":"3281928","type":"percent","value":0.88},{"name":"3281930","type":"percent","value":0.88},{"name":"3283836","type":"percent","value":0.88},{"name":"3283952","type":"percent","value":0.88},{"name":"3284646","type":"percent","value":0.88},{"name":"3285126","type":"percent","value":0.88},{"name":"3285302","type":"percent","value":0.88},{"name":"3285458","type":"percent","value":0.88},{"name":"3285460","type":"percent","value":0.88},{"name":"3285814","type":"percent","value":0.88},{"name":"3286008","type":"percent","value":0.88},{"name":"3286010","type":"percent","value":0.88},{"name":"3286014","type":"percent","value":0.88},{"name":"3286016","type":"percent","value":0.88},{"name":"3286020","type":"percent","value":0.88},{"name":"3286548","type":"percent","value":0.88},{"name":"3286564","type":"percent","value":0.88},{"name":"3286566","type":"percent","value":0.88},{"name":"3286568","type":"percent","value":0.88},{"name":"3286574","type":"percent","value":0.88},{"name":"3286576","type":"percent","value":0.88},{"name":"3286578","type":"percent","value":0.88},{"name":"3286580","type":"percent","value":0.88},{"name":"3309310","type":"flat","value":3.6},{"name":"3309310","type":"percent","value":0.88},{"name":"3309804","type":"flat","value":3.6},{"name":"3309804","type":"percent","value":0.88},{"name":"3309806","type":"flat","value":3.6},{"name":"3309806","type":"percent","value":0.88},{"name":"3309808","type":"flat","value":3.6},{"name":"3309808","type":"percent","value":0.88},{"name":"3317338","type":"percent","value":0.95},{"name":"3317342","type":"percent","value":0.95},{"name":"3317344","type":"percent","value":0.95},{"name":"3317346","type":"percent","value":0.95},{"name":"3331634","type":"percent","value":0.88},{"name":"3359410","type":"percent","value":0.9},{"name":"3359414","type":"percent","value":0.9},{"name":"3359416","type":"percent","value":0.9},{"name":"3401148","type":"percent","value":0.9},{"name":"3401150","type":"percent","value":0.9},{"name":"3401152","type":"percent","value":0.9},{"name":"3401154","type":"percent","value":0.9},{"name":"3419972","type":"percent","value":0.9},{"name":"3427182","type":"percent","value":0.88},{"name":"3464904","type":"percent","value":0.95},{"name":"3464906","type":"percent","value":0.95},{"name":"3492808","type":"flat","value":2.6},{"name":"3494148","type":"percent","value":0.9},{"name":"3494152","type":"percent","value":0.9},{"name":"3507294","type":"flat","value":2.6},{"name":"3507302","type":"flat","value":3.6},{"name":"3507316","type":"flat","value":3.6},{"name":"3532524","type":"percent","value":0.95},{"name":"3532624","type":"percent","value":0.95},{"name":"3561446","type":"percent","value":0.9},{"name":"3561448","type":"percent","value":0.9},{"name":"3577514","type":"percent","value":0.95},{"name":"3577516","type":"percent","value":0.95},{"name":"3577518","type":"percent","value":0.95},{"name":"3577520","type":"percent","value":0.95},{"name":"3577522","type":"percent","value":0.95},{"name":"3577524","type":"percent","value":0.95},{"name":"3578846","type":"percent","value":0.95},{"name":"3578870","type":"percent","value":0.95},{"name":"3626028","type":"percent","value":0.88},{"name":"3626030","type":"percent","value":0.88},{"name":"3626032","type":"percent","value":0.88},{"name":"3626038","type":"percent","value":0.88},{"name":"3650122","type":"percent","value":0.95},{"name":"3650124","type":"percent","value":0.95},{"name":"3691624","type":"percent","value":0.95},{"name":"3691626","type":"percent","value":0.95},{"name":"3693074","type":"flat","value":2.6},{"name":"3693074","type":"percent","value":0.88},{"name":"3693076","type":"flat","value":2.6},{"name":"3693076","type":"percent","value":0.88},{"name":"3744900","type":"percent","value":0.95},{"name":"3744902","type":"percent","value":0.95},{"name":"3766636","type":"percent","value":0.95},{"name":"3766638","type":"percent","value":0.95},{"name":"3766640","type":"percent","value":0.95},{"name":"3766646","type":"percent","value":0.95},{"name":"3766690","type":"percent","value":0.88},{"name":"3765924","type":"percent","value":0.95},{"name":"3765922","type":"percent","value":0.95},{"name":"3765926","type":"percent","value":0.95},{"name":"3765920","type":"percent","value":0.95}]},{"name":"stickyOutstream","type":"percent","value":0.8},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"media_type":"display"},{"s2s_value":0,"media_type":"video"}],"bidder_name":"rubicon","enabled":true},{"secondary":false,"cpm":[{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"rubiv_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":1},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"share_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.96},{"name":"stickyOutstream","type":"percent","value":0.85},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"sharethrough","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[],"bidder_name":"teads","enabled":true},{"secondary":false,"cpm":[{"name":"inBannerVideo","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"test","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"outstream","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"tripl_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"outstream","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"triplelift","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"pmp","type":"percent","value":0.97},{"name":"stickyOutstream","type":"percent","value":0.8},{"name":"instream","type":"percent","value":0.99}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ttd","enabled":true},{"secondary":false,"cpm":[{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"under_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"undertone","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.95},{"name":"outstream","type":"percent","value":0.95},{"name":"instream","type":"percent","value":0.98}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"unruly","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.6},{"name":"instream","type":"percent","value":0.99}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"yah_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.75},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"yahoossp","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.98},{"name":"stickyOutstream","type":"percent","value":0.85},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"yieldmo","enabled":true}],"liveIntent":[{"bidder":"pubmatic","month":11,"day":13,"multiplier":99.14576247671755,"browser":"Chrome"},{"bidder":"r","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"rtbhouse","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"rubi_ss","month":11,"day":13,"multiplier":99.87388100355118,"browser":"Chrome"},{"bidder":"rubicon","month":11,"day":13,"multiplier":98.53322005425514,"browser":"Chrome"},{"bidder":"s","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"criteo","month":11,"day":13,"multiplier":99.41210865724463,"browser":"Chrome"},{"bidder":"g","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"grid","month":11,"day":13,"multiplier":98.99854098978639,"browser":"Chrome"},{"bidder":"gridvid","month":11,"day":13,"multiplier":98.79427355904018,"browser":"Chrome"},{"bidder":"ix","month":11,"day":13,"multiplier":99.18938181494687,"browser":"Chrome"},{"bidder":"nativo","month":11,"day":13,"multiplier":99.3301355807376,"browser":"Chrome"},{"bidder":"a_seedtag","month":11,"day":13,"multiplier":99.280010958486,"browser":"Chrome"},{"bidder":"a_triplelift","month":11,"day":13,"multiplier":99.4135883498831,"browser":"Chrome"},{"bidder":"appnexus","month":11,"day":13,"multiplier":99.82149808877722,"browser":"Chrome"},{"bidder":"conversant","month":11,"day":13,"multiplier":99.37396326708075,"browser":"Chrome"},{"bidder":"crit_ss","month":11,"day":13,"multiplier":99.27280989208232,"browser":"Chrome"},{"bidder":"crite","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"onetag","month":11,"day":13,"multiplier":98.01702441359895,"browser":"Chrome"},{"bidder":"op","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"openx","month":11,"day":13,"multiplier":99.44106755590836,"browser":"Chrome"},{"bidder":"pubm","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"pubm_s","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"pubm_ss","month":11,"day":13,"multiplier":99.01335811868185,"browser":"Chrome"},{"bidder":"33across","month":11,"day":13,"multiplier":97.64998858015804,"browser":"Chrome"},{"bidder":"a_appnexus","month":11,"day":13,"multiplier":99.81030133621344,"browser":"Chrome"},{"bidder":"a_ogury","month":11,"day":13,"multiplier":99.29927504747785,"browser":"Chrome"},{"bidder":"a_pubmatic","month":11,"day":13,"multiplier":98.73212138628368,"browser":"Chrome"},{"bidder":"tripl_s","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"tripl_ss","month":11,"day":13,"multiplier":99.51465554717365,"browser":"Chrome"},{"bidder":"tripleli","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"triplelif","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"triplelift","month":11,"day":13,"multiplier":99.17711257989927,"browser":"Chrome"},{"bidder":null,"month":11,"day":13,"multiplier":99.81485807651902,"browser":"Chrome"},{"bidder":"33across","month":11,"day":13,"multiplier":99.59542568339923,"browser":"Not Chrome"},{"bidder":"a_ix","month":11,"day":13,"multiplier":99.91152036942675,"browser":"Not Chrome"},{"bidder":"a_ogury","month":11,"day":13,"multiplier":98.31045161506773,"browser":"Not Chrome"},{"bidder":"a_openx","month":11,"day":13,"multiplier":97.22400511354036,"browser":"Not Chrome"},{"bidder":"a_pubmatic","month":11,"day":13,"multiplier":96.78673592747683,"browser":"Not Chrome"},{"bidder":"improve_ss","month":11,"day":13,"multiplier":99.81562036842605,"browser":"Not Chrome"},{"bidder":"ix","month":11,"day":13,"multiplier":98.06909622725985,"browser":"Not Chrome"},{"bidder":"krgo_ss","month":11,"day":13,"multiplier":99.2443117002048,"browser":"Not Chrome"},{"bidder":"openx","month":11,"day":13,"multiplier":99.89685130336103,"browser":"Not Chrome"},{"bidder":"pubm_ss","month":11,"day":13,"multiplier":97.13591370697092,"browser":"Not Chrome"},{"bidder":"pubmatic","month":11,"day":13,"multiplier":97.57865413497892,"browser":"Not Chrome"},{"bidder":"ttd","month":11,"day":13,"multiplier":99.54296818227009,"browser":"Chrome"},{"bidder":"unde","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"unrul","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"unruly","month":11,"day":13,"multiplier":97.96293924280239,"browser":"Chrome"},{"bidder":"yiel","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"yieldmo","month":11,"day":13,"multiplier":99.56380469587695,"browser":"Chrome"},{"bidder":"sh","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"shareth","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"sharethrou","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"sharethrough","month":11,"day":13,"multiplier":99.51885738740629,"browser":"Chrome"},{"bidder":"t","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"tr","month":11,"day":13,"multiplier":94.89273932632751,"browser":"Chrome"},{"bidder":"rubi_ss","month":11,"day":13,"multiplier":99.53548936433289,"browser":"Not Chrome"},{"bidder":"rubicon","month":11,"day":13,"multiplier":98.0113260323494,"browser":"Not Chrome"},{"bidder":"sharethrough","month":11,"day":13,"multiplier":99.89911933534997,"browser":"Not Chrome"},{"bidder":"tripl_ss","month":11,"day":13,"multiplier":97.50517732524537,"browser":"Not Chrome"},{"bidder":"triplelift","month":11,"day":13,"multiplier":97.5968886693656,"browser":"Not Chrome"},{"bidder":"a_rubicon","month":11,"day":13,"multiplier":98.33983813226749,"browser":"Not Chrome"},{"bidder":"a_seedtag","month":11,"day":13,"multiplier":99.07504613169371,"browser":"Not Chrome"},{"bidder":"a_sharethrough","month":11,"day":13,"multiplier":99.56581326905238,"browser":"Not Chrome"},{"bidder":"a_triplelift","month":11,"day":13,"multiplier":99.51274961695951,"browser":"Not Chrome"},{"bidder":"adform","month":11,"day":13,"multiplier":95.72492358105103,"browser":"Not Chrome"},{"bidder":"aidem_ss","month":11,"day":13,"multiplier":96.78278830574806,"browser":"Not Chrome"},{"bidder":"conversant","month":11,"day":13,"multiplier":99.89147645076288,"browser":"Not Chrome"},{"bidder":"crit_ss","month":11,"day":13,"multiplier":99.02759883969914,"browser":"Not Chrome"},{"bidder":"criteo","month":11,"day":13,"multiplier":98.53852694068372,"browser":"Not Chrome"},{"bidder":"flipp","month":11,"day":13,"multiplier":99.34675419588133,"browser":"Not Chrome"},{"bidder":"grid","month":11,"day":13,"multiplier":98.14583407191644,"browser":"Not Chrome"},{"bidder":"gridvid","month":11,"day":13,"multiplier":97.02919003093834,"browser":"Not Chrome"}],"predictiveAnalysis":[{"error_rate":"0.9981913183279743","chrome":"0","adomain":"beechershandmadecheese.com","bidder":"ttd","domain":"beechershandmadecheese.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9912193175014967","chrome":"0","adomain":"beechershandmadecheese.com","bidder":"ttd","domain":"beechershandmadecheese.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9454091133357737","chrome":"0","adomain":"medicare.gov","bidder":"ttd","domain":"medicare.gov","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9672697073814137","chrome":"0","adomain":"medicare.gov","bidder":"ttd","domain":"medicare.gov","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9998385273696109","chrome":"0","adomain":"nurtec.com","bidder":"rubicon","domain":"nurtec.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9202168167361018","chrome":"0","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9435920992191089","chrome":"0","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.985623800093725","chrome":"0","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9868769582393631","chrome":"0","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9960268948655256","chrome":"1","adomain":"zillow.com","bidder":"ttd","domain":"zillow.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9151645317174196","chrome":"1","adomain":"sap.com","bidder":"openx","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9379716981132076","chrome":"1","adomain":"sap.com","bidder":"openx","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9861001785474303","chrome":"1","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9834756634626431","chrome":"1","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9515583474269147","chrome":"1","adomain":"nervivehealth.com","bidder":"gridvid","domain":"nervivehealth.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"1.0","chrome":"1","adomain":"destinationindigenous.ca","bidder":"ttd","domain":"destinationindigenous.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9687914029147652","chrome":"1","adomain":"globalpetfoods.com","bidder":"gridvid","domain":"globalpetfoods.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9897861779305078","chrome":"1","adomain":"boehringer-ingelheim.com","bidder":"gridvid","domain":"boehringer-ingelheim.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9137421499815294","chrome":"0","adomain":"mcdonalds.com","bidder":"triplelift","domain":"mcdonalds.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9350722994045931","chrome":"0","adomain":"mcdonalds.com","bidder":"triplelift","domain":"mcdonalds.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9905797656429501","chrome":"0","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9948465502653642","chrome":"0","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"1.0","chrome":"1","adomain":"destinationindigenous.ca","bidder":"ttd","domain":"destinationindigenous.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9434234656053689","chrome":"0","adomain":"foodlion.com","bidder":"triplelift","domain":"foodlion.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9535057969871441","chrome":"0","adomain":"foodlion.com","bidder":"triplelift","domain":"foodlion.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9965150403521643","chrome":"0","adomain":"nike.com","bidder":"triplelift","domain":"nike.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9622944550669216","chrome":"1","adomain":"sap.com","bidder":"tripl_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9564787715230529","chrome":"1","adomain":"sap.com","bidder":"tripl_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9717996923602803","chrome":"0","adomain":"cuisinart.com","bidder":"ttd","domain":"cuisinart.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9589719770862363","chrome":"0","adomain":"bountytowels.ca","bidder":"gridvid","domain":"bountytowels.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9737976782752902","chrome":"1","adomain":"diageo.ca","bidder":"gridvid","domain":"diageo.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9946641822647582","chrome":"1","adomain":"diageo.ca","bidder":"gridvid","domain":"diageo.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9835442162760146","chrome":"1","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9638839951212902","chrome":"1","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9108818011257036","chrome":"0","adomain":"progressive.com","bidder":"triplelift","domain":"progressive.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9752272727272727","chrome":"1","adomain":"mounjaro.com","bidder":"gridvid","domain":"mounjaro.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9458712856502912","chrome":"0","adomain":"foodlion.com","bidder":"triplelift","domain":"foodlion.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9555379567824415","chrome":"0","adomain":"foodlion.com","bidder":"triplelift","domain":"foodlion.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9893775062271717","chrome":"0","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9903066757599812","chrome":"0","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"1.0","chrome":"0","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9372541674470874","chrome":"0","adomain":"nicorette.fr","bidder":"ttd","domain":"nicorette.fr","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9286926994906621","chrome":"0","adomain":"mountaindew.com","bidder":"rubicon","domain":"mountaindew.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9881588999236058","chrome":"1","adomain":"meta.com","bidder":"triplelift","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9731966519326625","chrome":"1","adomain":"meta.com","bidder":"triplelift","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9884822516608357","chrome":"0","adomain":"heineken.com","bidder":"triplelift","domain":"heineken.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9909363177805801","chrome":"0","adomain":"heineken.com","bidder":"triplelift","domain":"heineken.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"1.0","chrome":"0","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9827660879922041","chrome":"1","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9879542114906663","chrome":"1","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9992835393157801","chrome":"0","adomain":"cocktailcollection.com","bidder":"gridvid","domain":"cocktailcollection.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.956638957537632","chrome":"0","adomain":"diageo.ca","bidder":"gridvid","domain":"diageo.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9948598130841122","chrome":"0","adomain":"diageo.ca","bidder":"gridvid","domain":"diageo.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9137496217088672","chrome":"0","adomain":"progressive.com","bidder":"triplelift","domain":"progressive.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9985687022900763","chrome":"0","adomain":"bulleit.com","bidder":"gridvid","domain":"bulleit.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9188055618873946","chrome":"0","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9425685155738471","chrome":"0","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9839057602211062","chrome":"1","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9887547208156214","chrome":"1","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9999171568221357","chrome":"0","adomain":"amazon.jobs","bidder":"rubicon","domain":"amazon.jobs","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.901427447454198","chrome":"1","adomain":"sap.com","bidder":"opnx_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9350588783957094","chrome":"1","adomain":"sap.com","bidder":"opnx_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9627906976744186","chrome":"1","adomain":"aligngi.ca","bidder":"gridvid","domain":"aligngi.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9657439446366782","chrome":"1","adomain":"pampers.ca","bidder":"gridvid","domain":"pampers.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9776339022954679","chrome":"1","adomain":"oralb.ca","bidder":"gridvid","domain":"oralb.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9875460574797347","chrome":"0","adomain":"sap.com","bidder":"tripl_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9860201604002649","chrome":"0","adomain":"sap.com","bidder":"tripl_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9991696650982563","chrome":"0","adomain":"nurtec.com","bidder":"rubi_ss","domain":"nurtec.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9419043792687827","chrome":"0","adomain":"honda.com","bidder":"triplelift","domain":"honda.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9906726321377114","chrome":"0","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9948975706343767","chrome":"0","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9633678557729191","chrome":"0","adomain":"pantene.ca","bidder":"gridvid","domain":"pantene.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9948962232051718","chrome":"0","adomain":"donjulio.com","bidder":"gridvid","domain":"donjulio.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9736244879884867","chrome":"1","adomain":"taltz.com","bidder":"gridvid","domain":"taltz.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9750066401062417","chrome":"1","adomain":"nervivehealth.com","bidder":"gridvid","domain":"nervivehealth.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9853004755728492","chrome":"1","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9676695377896397","chrome":"1","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9304630510624802","chrome":"1","adomain":"sap.com","bidder":"opnx_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9546859746176375","chrome":"1","adomain":"sap.com","bidder":"opnx_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9925759802026138","chrome":"1","adomain":"zillow.com","bidder":"ttd","domain":"zillow.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9101670179990271","chrome":"0","adomain":"medicare.gov","bidder":"ix","domain":"medicare.gov","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9367407270543674","chrome":"0","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9181333544611833","chrome":"0","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"1.0","chrome":"1","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9687279822231858","chrome":"0","adomain":"taltz.com","bidder":"gridvid","domain":"taltz.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9208018402891883","chrome":"0","adomain":"honda.com","bidder":"triplelift","domain":"honda.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9822246162133046","chrome":"0","adomain":"irvingconsumerproducts.com","bidder":"rubicon","domain":"irvingconsumerproducts.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9095735855317737","chrome":"0","adomain":"andersenwindows.com","bidder":"ttd","domain":"andersenwindows.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9135144142642893","chrome":"0","adomain":"andersenwindows.com","bidder":"ttd","domain":"andersenwindows.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9889630618602582","chrome":"1","adomain":"meta.com","bidder":"triplelift","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.974991224991225","chrome":"1","adomain":"meta.com","bidder":"triplelift","domain":"meta.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9902212729032474","chrome":"0","adomain":"heineken.com","bidder":"triplelift","domain":"heineken.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9923076923076923","chrome":"0","adomain":"heineken.com","bidder":"triplelift","domain":"heineken.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9696412143514259","chrome":"1","adomain":"taltz.com","bidder":"gridvid","domain":"taltz.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9162482065997131","chrome":"0","adomain":"mcdonalds.com","bidder":"triplelift","domain":"mcdonalds.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9370013755158184","chrome":"0","adomain":"mcdonalds.com","bidder":"triplelift","domain":"mcdonalds.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"1.0","chrome":"1","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9899225434932479","chrome":"1","adomain":"meta.com","bidder":"triplelift","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9677681527147303","chrome":"1","adomain":"meta.com","bidder":"triplelift","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.910917918030936","chrome":"1","adomain":"sap.com","bidder":"openx","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9645390070921985","chrome":"0","adomain":"mounjaro.com","bidder":"gridvid","domain":"mounjaro.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9337810401374356","chrome":"1","adomain":"thehersheycompany.com","bidder":"gridvid","domain":"thehersheycompany.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9826420522656437","chrome":"1","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9793782408181796","chrome":"1","adomain":"sap.com","bidder":"triplelift","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9930681006595807","chrome":"0","adomain":"nationalgeographic.com","bidder":"rubicon","domain":"nationalgeographic.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9719563392107473","chrome":"1","adomain":"emgality.com","bidder":"gridvid","domain":"emgality.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9845167652859961","chrome":"0","adomain":"facebook.com","bidder":"unruly","domain":"facebook.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9978783592644979","chrome":"0","adomain":"nike.com","bidder":"triplelift","domain":"nike.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9541217593941159","chrome":"0","adomain":"mattel.com","bidder":"triplelift","domain":"mattel.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9450375072129256","chrome":"0","adomain":"mattel.com","bidder":"triplelift","domain":"mattel.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9846293769895407","chrome":"0","adomain":"sap.com","bidder":"tripl_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9827523602033406","chrome":"0","adomain":"sap.com","bidder":"tripl_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9478800972184716","chrome":"0","adomain":"toyota.com.au","bidder":"kargo","domain":"toyota.com.au","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9340476763785216","chrome":"0","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9147202735365206","chrome":"0","adomain":"meta.com","bidder":"tripl_ss","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9776282590412111","chrome":"1","adomain":"globalpetfoods.com","bidder":"gridvid","domain":"globalpetfoods.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9432162325863114","chrome":"0","adomain":"lilly.com","bidder":"gridvid","domain":"lilly.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9728682170542635","chrome":"1","adomain":"mounjaro.com","bidder":"gridvid","domain":"mounjaro.com","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9729878115735149","chrome":"1","adomain":"diageo.ca","bidder":"gridvid","domain":"diageo.ca","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.998535046202389","chrome":"1","adomain":"diageo.ca","bidder":"gridvid","domain":"diageo.ca","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9707752672168855","chrome":"1","adomain":"pantene.ca","bidder":"gridvid","domain":"pantene.ca","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.974789283564118","chrome":"1","adomain":"lilly.com","bidder":"gridvid","domain":"lilly.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9661552191672673","chrome":"1","adomain":"sap.com","bidder":"tripl_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9609108288952615","chrome":"1","adomain":"sap.com","bidder":"tripl_ss","domain":"sap.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.915869511896002","chrome":"0","adomain":"medicare.gov","bidder":"ttd","domain":"medicare.gov","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9489199491740787","chrome":"0","adomain":"medicare.gov","bidder":"ttd","domain":"medicare.gov","mobile":"0","report_date":"2024-11-13"},{"error_rate":"0.9892398623048778","chrome":"1","adomain":"meta.com","bidder":"triplelift","domain":"meta.com","mobile":"1","report_date":"2024-11-13"},{"error_rate":"0.9656367555687053","chrome":"1","adomain":"meta.com","bidder":"triplelift","domain":"meta.com","mobile":"1","report_date":"2024-11-13"}],"country":"IN","region":"RJ","coreExperiments":[{"variants":[{"weight":100,"value":"off"},{"weight":0,"value":"extrashort"},{"weight":0,"value":"short"},{"weight":0,"value":"medium"},{"weight":0,"value":"long"},{"weight":0,"value":"mix"}],"type":"weightedChoice","abgroup":"adc","key":"AdDurationControl"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"cmcmp","key":"ConsentManagerCMP"},{"variants":[{"weight":0,"value":"b"},{"weight":100,"value":"w"},{"weight":0,"value":"g25"}],"type":"weightedChoice","abgroup":"tcmb2","key":"TopCenterMobileBackground"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rvps","key":"ReducedVideoPlayerSize"},{"variants":[{"weight":90}],"type":"bernoulliTrial","abgroup":"wl","key":"WakeLock"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"plfx","key":"PlaylistFix"},{"variants":[{"weight":95}],"type":"bernoulliTrial","abgroup":"delload","key":"EnableDelayLoading"},{"variants":[{"weight":99.5}],"type":"bernoulliTrial","abgroup":"amzn","key":"Amazon"},{"variants":[{"weight":25,"value":1.5},{"weight":25,"value":2},{"weight":25,"value":3},{"weight":25,"value":4}],"type":"weightedChoice","abgroup":"fto","key":"FloorBootstrap"},{"variants":[{"weight":25,"value":1.5},{"weight":25,"value":2},{"weight":25,"value":3},{"weight":25,"value":4}],"type":"weightedChoice","abgroup":"mto","key":"MarmaladeBootstrap"},{"variants":[{"weight":99}],"type":"bernoulliTrial","abgroup":"owso","key":"OutstreamWithSOExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"pbm","key":"Playbackmethod"},{"variants":[{"weight":98,"value":30},{"weight":2,"value":15},{"weight":0,"value":10}],"type":"weightedChoice","abgroup":"vmaxdur","key":"VideoDuration"},{"variants":[{"weight":0,"value":"all"},{"weight":100,"value":"adx"},{"weight":0,"value":"off"}],"type":"weightedChoice","abgroup":"inters","key":"Interstitial"},{"variants":[{"weight":0,"value":"all"},{"weight":90,"value":"adx"},{"weight":10,"value":"off"}],"type":"weightedChoice","abgroup":"inters5","key":"InterstitialAlt"},{"variants":[{"weight":100,"value":"both"},{"weight":0,"value":"client"},{"weight":0,"value":"server"}],"type":"weightedChoice","abgroup":"magnitedr","key":"Rubicon"},{"variants":[{"weight":98,"value":"both"},{"weight":1,"value":"client"},{"weight":1,"value":"server"}],"type":"weightedChoice","abgroup":"opnxdr","key":"OpenX"},{"variants":[{"weight":0,"value":"both"},{"weight":99,"value":"client"},{"weight":1,"value":"server"}],"type":"weightedChoice","abgroup":"krgodr","key":"Kargo"},{"variants":[{"weight":0,"value":"both"},{"weight":2,"value":"client"},{"weight":98,"value":"server"}],"type":"weightedChoice","abgroup":"krgodrvid","key":"KargoVideo"},{"variants":[{"weight":98,"value":"none"},{"weight":1,"value":"roxot"},{"weight":1,"value":"generic"}],"type":"weightedChoice","abgroup":"pba","key":"Analytics"},{"variants":[{"weight":100,"value":"both"},{"weight":0,"value":"client"},{"weight":0,"value":"server"}],"type":"weightedChoice","abgroup":"tripleliftdr","key":"Triplelift"},{"variants":[{"weight":50,"value":"both"},{"weight":0,"value":"client"},{"weight":50,"value":"server"}],"type":"weightedChoice","abgroup":"yahoodr","key":"YahooSSP"},{"variants":[{"weight":0,"value":"both"},{"weight":100,"value":"client"},{"weight":0,"value":"server"}],"type":"weightedChoice","abgroup":"yahoodr1","key":"YahooSSP1"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"logfltr","key":"LoggerFilter"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"rpm","key":"RaptivePlayerMobile"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"rpd","key":"RaptivePlayerDesktop"},{"variants":[{"weight":85,"value":10},{"weight":5,"value":15},{"weight":5,"value":20},{"weight":5,"value":25}],"type":"weightedChoice","abgroup":"rpspdbt","key":"staleBufferTime"},{"variants":[{"weight":0,"value":"tc"},{"weight":0,"value":"bl"},{"weight":0,"value":"br"},{"weight":100,"value":"off"}],"type":"weightedChoice","abgroup":"spltv2","key":"VideoCollapsedLocations"},{"variants":[{"weight":5,"value":900000,"abvalue":"900"},{"weight":5,"value":600000,"abvalue":"600"},{"weight":5,"value":300000,"abvalue":"300"},{"weight":5,"value":-1,"abvalue":"tdoc"},{"weight":80,"value":0}],"type":"weightedChoice","abgroup":"rptd","key":"RaptiveTearDownPlayer"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"rpm_test","key":"RaptivePlayerMobile_test"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"rpd_test","key":"RaptivePlayerDesktop_test"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rpm_test2","key":"RaptivePlayerMobile_test2"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rpd_test2","key":"RaptivePlayerDesktop_test2"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"fldg","key":"FledgeGPT"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"fldglog","key":"FledgeLogging"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"aed","key":"ContentAdExpansion"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"aed1","key":"AdExpansion"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"essa","key":"EnhancedStickySidebarAds"},{"variants":[{"weight":40,"value":50},{"weight":20,"value":1000},{"weight":20,"value":3000},{"weight":20,"value":5000}],"type":"weightedChoice","abgroup":"deftimer3","key":"DelayLoading"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"wvtls","key":"WebVitals"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"wvtlscls","key":"WebVitals_CLSRefactor"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"loglev","key":"ImpressionLog"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"sens_off","key":"SensOff"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rtbf","key":"RtbHouseExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"sab","key":"BidLimit"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"dgc","key":"DelayGamCall"},{"variants":[{"weight":95}],"type":"bernoulliTrial","abgroup":"jwb","key":"JwBoost"},{"variants":[{"weight":10}],"type":"bernoulliTrial","abgroup":"logcls","key":"LayoutShift"},{"variants":[{"weight":10}],"type":"bernoulliTrial","abgroup":"confiant1","key":"ConfiantRefresh"},{"variants":[{"weight":40,"value":5000,"abvalue":"5s"},{"weight":40,"value":10000,"abvalue":"10s"},{"weight":20,"value":15000,"abvalue":"15s"}],"type":"weightedChoice","abgroup":"vast_to","key":"VastTimeout"},{"variants":[{"weight":60,"value":15000,"abvalue":"15s"},{"weight":20,"value":18000,"abvalue":"18s"},{"weight":20,"value":20000,"abvalue":"20s"}],"type":"weightedChoice","abgroup":"vasttoisv","key":"VastTimeoutISV"},{"variants":[{"weight":80,"value":3000,"abvalue":"3s"},{"weight":10,"value":2000,"abvalue":"2s"},{"weight":10,"value":1000,"abvalue":"1s"}],"type":"weightedChoice","abgroup":"vasttoosv","key":"VastTimeoutOSV"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sre","key":"SlotResize"},{"variants":[{"weight":25}],"type":"bernoulliTrial","abgroup":"addens","key":"AdDensity"},{"variants":[{"weight":99}],"type":"bernoulliTrial","abgroup":"bmetrics","key":"BrandMetrics"},{"variants":[{"weight":95}],"type":"bernoulliTrial","abgroup":"rebuildslot","key":"RefreshRebuild"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"nlsentrckr","key":"NielsenTracker"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"vadv","key":"AdvancePlaylistExperiment"},{"variants":[{"weight":95}],"type":"bernoulliTrial","abgroup":"tpcapi","key":"TopicsAPI"},{"variants":[{"weight":10}],"type":"bernoulliTrial","abgroup":"crtvmon","key":"CreativeMonitoring"},{"variants":[{"weight":25,"value":"1.00"},{"weight":25,"value":"1.50"},{"weight":25,"value":"2.00"},{"weight":25,"value":"2.50"}],"type":"weightedChoice","abgroup":"faf","key":"FasterAdsFloors"},{"variants":[{"weight":0,"value":"rubi"},{"weight":1,"value":"rapml"},{"weight":0,"value":"cm"},{"weight":0,"value":"fbmag"},{"weight":98,"value":"fbrap"},{"weight":1,"value":"none"}],"type":"weightedChoice","abgroup":"flrml1","key":"Floors"},{"variants":[{"weight":5,"value":"on"},{"weight":95,"value":"off"}],"type":"weightedChoice","abgroup":"pbsflr","key":"PBSFloor"},{"variants":[{"weight":5,"value":"on"},{"weight":95,"value":"off"}],"type":"weightedChoice","abgroup":"pbsflr1","key":"PBSFloor1"},{"variants":[{"weight":19,"value":"1_1"},{"weight":19,"value":"1_2"},{"weight":19,"value":"1_3"},{"weight":19,"value":"1_4"},{"weight":19,"value":"1_5"},{"weight":5,"value":"off"}],"type":"weightedChoice","abgroup":"ttddealflr","key":"TTDDealFloor"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"amzn_hold_load","key":"AmazonHoldLoad"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"rmos1","key":"OneVideoStream"},{"variants":[{"weight":5,"value":900000,"abvalue":"900"},{"weight":5,"value":600000,"abvalue":"600"},{"weight":5,"value":300000,"abvalue":"300"},{"weight":5,"value":-1,"abvalue":"tdoc"},{"weight":80,"value":0}],"type":"weightedChoice","abgroup":"mgtdtw","key":"TearDownPlayer"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"amzn_hold_disp","key":"AmazonHoldDisplay"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"dajto","key":"DisableAjaxTimeout"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"smad300","key":"RemoveLargeSidebar"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rvadv_ab1","key":"AdvancePlaylistRelated"},{"variants":[{"weight":5,"value":6000,"abvalue":"6s"},{"weight":75,"value":4000,"abvalue":"4s"},{"weight":15,"value":2000,"abvalue":"2s"},{"weight":5,"value":0,"abvalue":"0s"}],"type":"weightedChoice","abgroup":"cbt","key":"CloseButtonTimeout"},{"variants":[{"weight":85,"value":0,"abvalue":"0s"},{"weight":5,"value":1000,"abvalue":"1s"},{"weight":5,"value":2000,"abvalue":"2s"},{"weight":5,"value":3000,"abvalue":"3s"}],"type":"weightedChoice","abgroup":"socbde","key":"StickyOutstreamCloseButtonTimeout"},{"variants":[{"weight":20,"value":10000,"abvalue":"10"},{"weight":60,"value":15000,"abvalue":"15"},{"weight":20,"value":20000,"abvalue":"20"}],"type":"weightedChoice","abgroup":"reqTo","key":"JwRequestTimeout"},{"variants":[{"weight":3}],"type":"bernoulliTrial","abgroup":"addur","key":"LogAdDuration"},{"variants":[{"weight":99.5,"value":"ix"},{"weight":96,"value":"mn"},{"weight":99,"value":"ox"},{"weight":95,"value":"pu"},{"weight":90,"value":"un"},{"weight":99,"value":"ma"},{"weight":90,"value":"sh"},{"weight":90,"value":"st"},{"weight":99,"value":"sb"},{"weight":75,"value":"sv"},{"weight":99,"value":"tl"},{"weight":0,"value":"yh"},{"weight":99,"value":"mg"},{"weight":99,"value":"xr"},{"weight":75,"value":"ot"},{"weight":100,"value":"ax"},{"weight":100,"value":"ch"},{"weight":100,"value":"cr"},{"weight":100,"value":"gg"},{"weight":100,"value":"kg"},{"weight":100,"value":"td"},{"weight":90,"value":"ym"}],"type":"multivalueBernoulliTrial","abgroup":"doba","key":"DisplayOpenBidderExperiment"},{"variants":[{"weight":100,"value":"ax"},{"weight":95,"value":"ix"},{"weight":90,"value":"mn"},{"weight":99,"value":"ox"},{"weight":95,"value":"pu"},{"weight":95,"value":"un"},{"weight":95,"value":"ma"},{"weight":100,"value":"sx"},{"weight":90,"value":"tl"},{"weight":80,"value":"yh"},{"weight":80,"value":"sh"},{"weight":55,"value":"ym"},{"weight":99,"value":"mg"},{"weight":99,"value":"xr"},{"weight":95,"value":"gg"},{"weight":75,"value":"ot"},{"weight":75,"value":"sv"}],"type":"multivalueBernoulliTrial","abgroup":"voba","key":"VideoOpenBidderExperiment"},{"variants":[{"weight":100,"value":2},{"weight":0,"value":3},{"weight":0,"value":0}],"type":"weightedChoice","abgroup":"osp","key":"OutstreamPlacementExperiment"},{"variants":[{"weight":0,"value":2},{"weight":100,"value":3}],"type":"weightedChoice","abgroup":"osp2","key":"OutstreamPlacementExperiment2"},{"variants":[{"weight":25,"value":0.8},{"weight":25,"value":1},{"weight":25,"value":1.2},{"weight":25,"value":1.4}],"type":"weightedChoice","abgroup":"flrmltp","key":"SingleFloorMultiplier"},{"variants":[{"weight":20,"value":1.1},{"weight":20,"value":1.2},{"weight":20,"value":1.3},{"weight":20,"value":1.4},{"weight":20,"value":"off"}],"type":"weightedChoice","abgroup":"bpflmult","key":"LazyFloorMultiplier"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"optd","key":"OptimalDisplayBidders"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"mgncrbn","key":"MagniteCarbon"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"optv","key":"OptimalVideoBidders"},{"variants":[{"weight":10}],"type":"bernoulliTrial","abgroup":"adlifecyc","key":"LogAdLifeCycle"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"sofc","key":"StickyOutstreamFooterCollision"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"fan","key":"FooterAnchorAd"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"nosvp","key":"OutstreamRendererExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"sospp","key":"StickyOutstreamOnStickyPlayerPages"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"sidp","key":"SharedIdPlugin"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"dofre","key":"DisplayBackupRenderer"},{"variants":[{"weight":0,"value":"strict"},{"weight":100,"value":"relaxed"},{"weight":0,"value":"off"}],"type":"weightedChoice","abgroup":"dco","key":"DemandChain"},{"variants":[{"weight":25,"value":100},{"weight":50,"value":200,"abvalue":"off"},{"weight":25,"value":300}],"type":"weightedChoice","abgroup":"s2sbuff","key":"S2SBuffer"},{"variants":[{"weight":85,"value":0},{"weight":5,"value":1},{"weight":5,"value":500},{"weight":5,"value":1000}],"type":"weightedChoice","abgroup":"adt","key":"AuctionDelay"},{"variants":[{"weight":5,"value":1},{"weight":5,"value":250},{"weight":85,"value":500},{"weight":5,"value":750}],"type":"weightedChoice","abgroup":"adt2","key":"AuctionDelay_2"},{"variants":[{"weight":70,"value":0},{"weight":10,"value":250},{"weight":10,"value":500},{"weight":10,"value":750}],"type":"weightedChoice","abgroup":"dh_adt","key":"HemAuctionDelay"},{"variants":[{"weight":25,"value":"on5"},{"weight":25,"value":"on7"},{"weight":25,"value":"on10"},{"weight":25,"value":"off"}],"type":"weightedChoice","abgroup":"tckscroll","key":"TrackScrollExperiment"},{"variants":[{"weight":97,"value":1},{"weight":1,"value":1.1},{"weight":1,"value":1.2},{"weight":1,"value":1.3}],"type":"weightedChoice","abgroup":"refvidflr","key":"FloorsInstreamRefresh"},{"variants":[{"weight":25,"value":0.4},{"weight":25,"value":0.5},{"weight":25,"value":0.6},{"weight":25,"value":0.7}],"type":"weightedChoice","abgroup":"sesflrso","key":"SessionFloorStickyOutstreamPercentileExperiment"},{"variants":[{"weight":10,"value":0.6},{"weight":10,"value":0.7},{"weight":10,"value":0.75},{"weight":50,"value":0.8},{"weight":10,"value":0.85},{"weight":10,"value":0.9}],"type":"weightedChoice","abgroup":"sesflrdis","key":"SessionFloorDisplayPercentileExperiment"},{"variants":[{"weight":10,"value":0.7},{"weight":40,"value":0.8},{"weight":40,"value":0.9},{"weight":10,"value":1}],"type":"weightedChoice","abgroup":"sesflrvid","key":"SessionFloorVideoPercentileExperiment"},{"variants":[{"weight":5,"value":0},{"weight":10,"value":1.1},{"weight":10,"value":1.2},{"weight":10,"value":1.3},{"weight":10,"value":1.4},{"weight":55,"value":"ml"}],"type":"weightedChoice","abgroup":"refsoflr","key":"FloorsStickyOutstreamRefresh"},{"variants":[{"weight":33,"value":0},{"weight":33,"value":1},{"weight":34,"value":1.5}],"type":"weightedChoice","abgroup":"socon","key":"SuppressOutreamSlowConnection"},{"variants":[{"weight":0,"value":10000},{"weight":0,"value":15000},{"weight":0,"value":20000},{"weight":100,"value":25000},{"weight":0,"value":30000}],"type":"weightedChoice","abgroup":"cmpto","key":"CMPTimeout"},{"variants":[{"weight":25}],"type":"bernoulliTrial","abgroup":"upl","key":"UserPageDataLogging"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"aos","key":"AdditionalOutstreamUnitsExperiment"},{"variants":[{"weight":10}],"type":"bernoulliTrial","abgroup":"datapriv","key":"UserPageDataPrivacyLogging"},{"variants":[{"weight":25,"value":500},{"weight":25,"value":1000},{"weight":25,"value":1500},{"weight":25,"value":2000}],"type":"weightedChoice","abgroup":"faite","key":"FasterAdsInitialTimeoutExperiment"},{"variants":[{"weight":10,"value":2000},{"weight":15,"value":2100},{"weight":50,"value":2200},{"weight":15,"value":2300},{"weight":10,"value":2400}],"type":"weightedChoice","abgroup":"ito_df","key":"InitialTimeoutDesktopFastExperiment"},{"variants":[{"weight":10,"value":2600},{"weight":15,"value":2700},{"weight":50,"value":2800},{"weight":15,"value":2900},{"weight":10,"value":3000}],"type":"weightedChoice","abgroup":"ito_ds","key":"InitialTimeoutDesktopSlowExperiment"},{"variants":[{"weight":10,"value":2400},{"weight":15,"value":2500},{"weight":50,"value":2600},{"weight":15,"value":2700},{"weight":10,"value":2800}],"type":"weightedChoice","abgroup":"ito_dn","key":"InitialTimeoutDesktopUnknownExperiment"},{"variants":[{"weight":10,"value":2400},{"weight":15,"value":2500},{"weight":50,"value":2600},{"weight":15,"value":2700},{"weight":10,"value":2800}],"type":"weightedChoice","abgroup":"ito_mf","key":"InitialTimeoutMobileFastExperiment"},{"variants":[{"weight":10,"value":2600},{"weight":15,"value":2700},{"weight":50,"value":2800},{"weight":15,"value":2900},{"weight":10,"value":3000}],"type":"weightedChoice","abgroup":"ito_ms","key":"InitialTimeoutMobileSlowExperiment"},{"variants":[{"weight":10,"value":2600},{"weight":15,"value":2700},{"weight":50,"value":2800},{"weight":15,"value":2900},{"weight":10,"value":3000}],"type":"weightedChoice","abgroup":"ito_mn","key":"InitialTimeoutMobileUnknownExperiment"},{"variants":[{"weight":0,"value":"on"},{"weight":60,"value":"off"},{"weight":30,"value":"vpr"},{"weight":10,"value":"dbc"}],"type":"weightedChoice","abgroup":"iroe","key":"InstreamRerequestOnError"},{"variants":[{"weight":0,"value":"on"},{"weight":5,"value":"off"},{"weight":0,"value":"vpr"},{"weight":95,"value":"vpr2"}],"type":"weightedChoice","abgroup":"riroe","key":"RaptiveInstreamRerequestOnError"},{"variants":[{"weight":0,"value":"on"},{"weight":5,"value":"off"},{"weight":0,"value":"vpr"},{"weight":95,"value":"vpr2"},{"weight":0,"value":"dbc"}],"type":"weightedChoice","abgroup":"iroe2","key":"InstreamRerequestOnError2"},{"variants":[{"weight":10,"value":"id5Id"},{"weight":1,"value":"identityLink"},{"weight":1,"value":"pairId"},{"weight":1,"value":"unifiedId"},{"weight":1,"value":"unifiedId2"},{"weight":1,"value":"sharedId"},{"weight":5,"value":"criteo"},{"weight":5,"value":"connectId"},{"weight":50,"value":"fabrickId"},{"weight":95,"value":"FTrackId"},{"weight":5,"value":"33acrossId"},{"weight":1,"value":"liveIntentId"},{"weight":10,"value":"linkedInAdsId"},{"weight":5,"value":"lotamePanoramaId"},{"weight":25,"value":"merkleId"},{"weight":5,"value":"merkuryId"}],"type":"multivalueBernoulliTrial","abgroup":"idho","key":"IDHO"},{"variants":[{"weight":40}],"type":"bernoulliTrial","abgroup":"idguid3","key":"IdGraphUid2"},{"variants":[{"weight":95}],"type":"bernoulliTrial","abgroup":"idglr","key":"IdGraphLiveRamp"},{"variants":[{"weight":20,"value":"aidem"},{"weight":10,"value":"appnexus"},{"weight":35,"value":"colossus"},{"weight":1,"value":"conversant"},{"weight":1,"value":"criteo"},{"weight":30,"value":"gridvid"},{"weight":50,"value":"gumgum"},{"weight":20,"value":"improvedigital"},{"weight":0.5,"value":"ix"},{"weight":1,"value":"openx"},{"weight":1,"value":"pubmatic"},{"weight":100,"value":"resetdigital"},{"weight":1,"value":"rubicon"},{"weight":1,"value":"sharethrough"},{"weight":1,"value":"triplelift"},{"weight":1,"value":"ttd"},{"weight":10,"value":"unruly"},{"weight":10,"value":"undertone"},{"weight":20,"value":"yahoossp"},{"weight":1,"value":"kargo"},{"weight":100,"value":"33across"},{"weight":10,"value":"onetag"},{"weight":95,"value":"adform"},{"weight":1,"value":"rise"}],"type":"multivalueBernoulliTrial","abgroup":"vbho","key":"VBHO"},{"variants":[{"weight":25,"value":"33across"},{"weight":10,"value":"aidem"},{"weight":1,"value":"appnexus"},{"weight":30,"value":"colossus"},{"weight":10,"value":"conversant"},{"weight":25,"value":"concert"},{"weight":1,"value":"criteo"},{"weight":10,"value":"grid"},{"weight":5,"value":"gumgum"},{"weight":1,"value":"kargo"},{"weight":20,"value":"improvedigital"},{"weight":0.5,"value":"ix"},{"weight":1,"value":"nativo"},{"weight":1,"value":"openx"},{"weight":10,"value":"ozone"},{"weight":1,"value":"pubmatic"},{"weight":100,"value":"resetdigital"},{"weight":25,"value":"rtbhouse"},{"weight":1,"value":"rubicon"},{"weight":5,"value":"sharethrough"},{"weight":1,"value":"teads"},{"weight":0.5,"value":"triplelift"},{"weight":1,"value":"ttd"},{"weight":10,"value":"undertone"},{"weight":10,"value":"unruly"},{"weight":10,"value":"yahoossp"},{"weight":1,"value":"yieldmo"},{"weight":95,"value":"adform"},{"weight":5,"value":"flipp"},{"weight":1,"value":"rise"}],"type":"multivalueBernoulliTrial","abgroup":"hbho","key":"HBHO"},{"variants":[{"weight":0,"value":"animatedFooter"},{"weight":0,"value":"expandableFooter"},{"weight":0,"value":"miniscroller"},{"weight":0,"value":"interscroller"}],"type":"multivalueBernoulliTrial","abgroup":"athmb","key":"AdTypeHoldout"},{"variants":[{"weight":0,"value":"33across"},{"weight":0,"value":"appnexus"},{"weight":0,"value":"colossus"},{"weight":0,"value":"conversant"},{"weight":0,"value":"concert"},{"weight":0,"value":"criteo"},{"weight":0,"value":"grid"},{"weight":0,"value":"gridvid"},{"weight":0,"value":"gumgum"},{"weight":0,"value":"kargo"},{"weight":0,"value":"improvedigital"},{"weight":0,"value":"ix"},{"weight":0,"value":"nativo"},{"weight":0,"value":"openx"},{"weight":0,"value":"pubmatic"},{"weight":0,"value":"resetdigital"},{"weight":0,"value":"rtbhouse"},{"weight":0,"value":"rubicon"},{"weight":0,"value":"sharethrough"},{"weight":0,"value":"teads"},{"weight":0,"value":"triplelift"},{"weight":0,"value":"ttd"},{"weight":0,"value":"undertone"},{"weight":0,"value":"unruly"},{"weight":0,"value":"yahoossp"},{"weight":0,"value":"yieldmo"},{"weight":0,"value":"onetag"}],"type":"multivalueBernoulliTrial","abgroup":"allbho","key":"AllBidderHO"},{"variants":[{"weight":25,"value":"amzn"},{"weight":25,"value":"gumgum"},{"weight":25,"value":"kargo"},{"weight":25,"value":"sharethrough"},{"weight":25,"value":"teads"},{"weight":25,"value":"triplelift"},{"weight":25,"value":"undertone"},{"weight":25,"value":"yieldmo"}],"type":"multivalueBernoulliTrial","abgroup":"sfbho","key":"SFBHO"},{"variants":[{"weight":100,"value":"33across"},{"weight":5,"value":"appnexus"},{"weight":100,"value":"conversant"},{"weight":100,"value":"grid"},{"weight":2,"value":"gumgum"},{"weight":100,"value":"improve_ss"},{"weight":1,"value":"openx"},{"weight":100,"value":"pubm_ss"},{"weight":100,"value":"resetdigital"},{"weight":100,"value":"under_ss"},{"weight":100,"value":"unruly"},{"weight":100,"value":"yieldmo"},{"weight":100,"value":"adform"},{"weight":100,"value":"aidem_ss"},{"weight":100,"value":"gridnat"},{"weight":100,"value":"col_ss"},{"weight":100,"value":"rubi_ss"},{"weight":100,"value":"flipp"},{"weight":100,"value":"rise"},{"weight":100,"value":"tripl_ss"}],"type":"multivalueBernoulliTrial","abgroup":"pbs2s","key":"S2S"},{"variants":[{"weight":70,"value":1},{"weight":10,"value":2},{"weight":10,"value":3},{"weight":10,"value":4}],"type":"weightedChoice","abgroup":"usynctrig","key":"UserSyncTrigger"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":5},{"weight":25,"value":10},{"weight":25,"value":25}],"type":"weightedChoice","abgroup":"csync_lim","key":"UserSyncLimit"},{"variants":[{"weight":5}],"type":"bernoulliTrial","abgroup":"forex","key":"CurrencyConversion"},{"variants":[{"weight":95}],"type":"bernoulliTrial","abgroup":"cfip_ho","key":"RaptiveConnectedId"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rog_2","key":"Optable"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"roghem_4","key":"UseOptableHem"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"ottpd","key":"OptableTestThirdPartyDCN"},{"variants":[{"weight":1,"value":15},{"weight":1,"value":30},{"weight":98,"value":90}],"type":"weightedChoice","abgroup":"oclst","key":"OptableClusterLastSeenThreshold"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"rogcu","key":"Uid2TokenCleanup"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"spa","key":"SinglePageAppSupport"},{"variants":[{"weight":99}],"type":"bernoulliTrial","abgroup":"s2sparam","key":"OrtbEnrich"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"jtte","key":"JumpToTracker"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"csp","key":"ContentSpecificPlaylists"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"spa_636bb77b4a063e2c3e3686fb","key":"SinglePageAppSupport_636bb77b4a063e2c3e3686fb"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"spa_62a8f1d2540a6e420ab16977","key":"SinglePageAppSupport_62a8f1d2540a6e420ab16977"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_660a2f0855c0e65b7013b0a2a","key":"StickyOutstreamTopCenter_660a2f0855c0e65b7013b0a2a"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_56d7646348ac34b603d08cdd","key":"StickyOutstreamTopCenter_56d7646348ac34b603d08cdd"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_52e41fac28963d1e058a107e","key":"StickyOutstreamTopCenter_52e41fac28963d1e058a107e"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_553542257a55b2e06135e447","key":"StickyOutstreamTopCenter_553542257a55b2e06135e447"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_53237591208f222c05b9a652","key":"StickyOutstreamTopCenter_53237591208f222c05b9a652"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_530961e8208f222c05b9a319","key":"StickyOutstreamTopCenter_530961e8208f222c05b9a319"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_60a7fa14d53602489a3692c6","key":"StickyOutstreamTopCenter_60a7fa14d53602489a3692c6"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_52e41fac28963d1e058a1132","key":"StickyOutstreamTopCenter_52e41fac28963d1e058a1132"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_58c18d1bf051050f829e3c0b","key":"StickyOutstreamTopCenter_58c18d1bf051050f829e3c0b"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5667530f4856897050e3754f","key":"StickyOutstreamTopCenter_5667530f4856897050e3754f"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_55bccc97303edab84afd77e2","key":"StickyOutstreamTopCenter_55bccc97303edab84afd77e2"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5e7dea4b319b6675881fa756","key":"StickyOutstreamTopCenter_5e7dea4b319b6675881fa756"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_54bdb2d6358b65853f5fe5c4","key":"StickyOutstreamTopCenter_54bdb2d6358b65853f5fe5c4"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5ebac21ff67e7555ae952e51","key":"StickyOutstreamTopCenter_5ebac21ff67e7555ae952e51"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_60241fb76f0af53ee0150fba","key":"StickyOutstreamTopCenter_60241fb76f0af53ee0150fba"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5af420ecfab03c25e571fc36","key":"StickyOutstreamTopCenter_5af420ecfab03c25e571fc36"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5e42febb231faa5bc174c1e9","key":"StickyOutstreamTopCenter_5e42febb231faa5bc174c1e9"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_62f26eb8e4a64b3ce9532c7b","key":"StickyOutstreamTopCenter_62f26eb8e4a64b3ce9532c7b"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5ade026821520f50ab7dc946","key":"StickyOutstreamTopCenter_5ade026821520f50ab7dc946"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5be1d613604fb775e8699c25","key":"StickyOutstreamTopCenter_5be1d613604fb775e8699c25"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"scatcve","key":"StickyContainerAdsTopCenterVideoDependency"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"ssau","key":"SlickstreamAdUnits"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"ssff","key":"StickySidebarFeatureFlag"},{"variants":[{"weight":80,"value":"20sc"},{"weight":10,"value":"20s"},{"weight":10,"value":"off"}],"type":"weightedChoice","abgroup":"multirefauc","key":"MultistagePrebidAuction"},{"variants":[{"weight":25,"value":"20s"},{"weight":25,"value":"20sf1"},{"weight":25,"value":"20sf2"},{"weight":25,"value":"off"}],"type":"weightedChoice","abgroup":"multirefaucd","key":"MultistagePrebidAuctionDisplay"},{"variants":[{"weight":50,"value":1},{"weight":50,"value":0}],"type":"weightedChoice","abgroup":"multis2s","key":"MultistageServer"},{"variants":[{"weight":0,"value":"10s1"},{"weight":0,"value":"10s2"},{"weight":100,"value":"off"}],"type":"weightedChoice","abgroup":"multirefaucv","key":"MultistagePrebidAuctionV"},{"variants":[{"weight":2,"value":"10s1"},{"weight":2,"value":"10s2"},{"weight":96,"value":"off"}],"type":"weightedChoice","abgroup":"multirefaucv2","key":"MultistagePrebidAuctionV2"},{"variants":[{"weight":1,"value":"none"},{"weight":99,"value":"8.30.0"}],"type":"weightedChoice","abgroup":"jwpv","key":"JWPVersionExperiment"},{"variants":[{"weight":70,"value":10000},{"weight":7,"value":15000},{"weight":7,"value":20000},{"weight":10,"value":25000},{"weight":3,"value":1000},{"weight":3,"value":2000}],"type":"weightedChoice","abgroup":"ainv","key":"AdInViewExperiment"},{"variants":[{"weight":100,"value":1000}],"type":"weightedChoice","abgroup":"ainv2","key":"AdInViewExperiment_2"},{"variants":[{"weight":50,"value":10000},{"weight":50,"value":5000}],"type":"weightedChoice","abgroup":"ainvi","key":"AdInViewIOS"},{"variants":[{"weight":25,"value":"noref"},{"weight":25,"value":20},{"weight":25,"value":30},{"weight":25,"value":"off"}],"type":"weightedChoice","abgroup":"asr_re","key":"ASRInViewRefreshExperiment"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"dovh","key":"DetectOverlappingHeader"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"vcsu","key":"VideoCollapseScrollUp"},{"variants":[{"weight":0,"value":"off"},{"weight":100,"value":"1"},{"weight":0,"value":"2"}],"type":"weightedChoice","abgroup":"cosuftc","key":"VideoCollapseScrollUpTopCenter"},{"variants":[{"weight":90}],"type":"bernoulliTrial","abgroup":"intcfg","key":"InterstitialConfig"},{"variants":[{"weight":99,"value":"Continuing without bids"},{"weight":99,"value":"xhr timeout after"},{"weight":90,"value":"marmaladeResponseLoaded"},{"weight":90,"value":"_initializeHls"}],"type":"multivalueBernoulliTrial","abgroup":"dsle","key":"DialDownLogsExperiment"},{"variants":[{"weight":100,"value":"Continuing without bids"},{"weight":100,"value":"xhr timeout after"},{"weight":99,"value":"SlotRenderEnded::adImpression"},{"weight":100,"value":"RaptivePlayer::_initializeHls"},{"weight":100,"value":"RaptivePlayer::_initializeHlsOrMp4"},{"weight":100,"value":"in response for appnexus adapter: unknown"}],"type":"multivalueBernoulliTrial","abgroup":"dsle2","key":"DialDownLogsExperiment2"},{"variants":[{"weight":90}],"type":"bernoulliTrial","abgroup":"iplin","key":"IOSPlayInline"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"csl","key":"ContentSizeLogging"},{"variants":[{"weight":96,"value":0.9},{"weight":1,"value":0.85},{"weight":1,"value":0.8},{"weight":1,"value":0.75},{"weight":1,"value":0}],"type":"weightedChoice","abgroup":"vpred_1","key":"PredictiveAnalysis"},{"variants":[{"weight":95,"value":0.6},{"weight":5,"value":"off"}],"type":"weightedChoice","abgroup":"dsllv","key":"DynamicSlotLazyLoadViewability"},{"variants":[{"weight":55,"value":{"protocols":[1,2,3,4,5,6,7,8],"value":"all","scope":"all"}},{"weight":15,"value":{"protocols":[2,3,5,6,7,8],"value":"nv1","scope":"all"}},{"weight":15,"value":{"protocols":[1,2,3,5,6,7,8],"value":"allr","scope":"limited"}},{"weight":15,"value":{"protocols":[2,3,5,6,7,8],"value":"nv1r","scope":"limited"}}],"type":"weightedChoice","abgroup":"proto","key":"Protocols"},{"variants":[{"weight":30,"value":"off"},{"weight":50,"value":"7.30"},{"weight":10,"value":"5.10"},{"weight":5,"value":"3.00"},{"weight":5,"value":"1.40"}],"type":"weightedChoice","abgroup":"dcsll_ss2","key":"DCSLLSiteSpecific"},{"variants":[{"weight":34,"value":"3"},{"weight":33,"value":"4"},{"weight":33,"value":"5"}],"type":"weightedChoice","abgroup":"dcsll_med","key":"DCSLLMediumCPMTarget"},{"variants":[{"weight":5}],"type":"bernoulliTrial","abgroup":"soblp","key":"StickyOutstreamBottomLeftExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"oxli","key":"OpenXLiveIntent"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"tlli","key":"TripleLiftLiveIntent"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"pale","key":"ParallaxAdLogError"},{"variants":[{"weight":10,"value":1800},{"weight":10,"value":2100},{"weight":10,"value":2400},{"weight":60,"value":2700},{"weight":10,"value":3000}],"type":"weightedChoice","abgroup":"dssmh","key":"DynamicSidebarSlotsMinHeight"},{"variants":[{"weight":16,"value":5},{"weight":16,"value":10},{"weight":17,"value":15},{"weight":17,"value":18},{"weight":17,"value":22},{"weight":17,"value":25}],"type":"weightedChoice","abgroup":"dssc2","key":"DynamicSidebarSlotsCap"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":1},{"weight":25,"value":2},{"weight":25,"value":3}],"type":"weightedChoice","abgroup":"soir","key":"StickyOutstreamIOSRefresh"},{"variants":[{"weight":1,"value":"ats"},{"weight":1,"value":"cmscr"},{"weight":1,"value":"mrk"},{"weight":1,"value":"nlsn"},{"weight":1,"value":"ttdt"},{"weight":1,"value":"conf"},{"weight":1,"value":"hawk"},{"weight":1,"value":"tgtaff"},{"weight":1,"value":"amz"}],"type":"multivalueBernoulliTrial","abgroup":"tkho_2","key":"TKHO"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":1},{"weight":25,"value":5},{"weight":25,"value":15}],"type":"weightedChoice","abgroup":"ettl","key":"EventHistoryTTL"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"aml","key":"AuctionMetricsLogger"},{"variants":[{"weight":0,"value":"control"},{"weight":100,"value":"topLeft"},{"weight":0,"value":"topLeftAboveAd"}],"type":"weightedChoice","abgroup":"fcp","key":"FooterCloseButtonLocation"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rpbs","key":"RaptivePrebidServerExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rpbsp","key":"RaptivePrebidServerProxyExperiment"},{"variants":[{"weight":0,"value":"orcl"},{"weight":0,"value":"east"},{"weight":50,"value":"west"},{"weight":0,"value":"mag"},{"weight":50,"value":"ay"}],"type":"weightedChoice","abgroup":"rrpbs3","key":"RaptiveRegionalPrebidServerExperiment3"},{"variants":[{"weight":0,"value":"off"},{"weight":100,"value":"20s"}],"type":"weightedChoice","abgroup":"multiserverauc","key":"RaptivePBSMultistageAuctionExperiment"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":2},{"weight":20,"value":4},{"weight":20,"value":6},{"weight":20,"value":8}],"type":"weightedChoice","abgroup":"rpbsdr","key":"RaptivePBSDoubleRequestExperiment"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":2},{"weight":20,"value":4},{"weight":20,"value":6},{"weight":20,"value":8}],"label":"RPBS","type":"weightedChoice","abgroup":"r_dr","key":"RPBSDoubleRequestExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"intl","key":"InterstitialLink"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"mrbf","key":"MidrollBugFixExperiment"},{"variants":[{"weight":25,"value":30},{"weight":25,"value":40},{"weight":25,"value":50},{"weight":25,"value":60}],"type":"weightedChoice","abgroup":"ttle","key":"EventHistoryTTLExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"prm","key":"PageRefreshMonitorExperiment"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":60},{"weight":25,"value":150},{"weight":25,"value":300}],"type":"weightedChoice","abgroup":"ttlmbc","key":"MinBidCacheTTLExperiment"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":1000},{"weight":25,"value":2500},{"weight":25,"value":5000}],"type":"weightedChoice","abgroup":"lito","key":"LiveIntentTimeOutExperiment"},{"variants":[{"weight":100,"value":100}],"type":"weightedChoice","abgroup":"lat","key":"LazyLoadThreshold"},{"variants":[{"weight":100,"value":"ix"},{"weight":100,"value":"ttd"}],"type":"multivalueBernoulliTrial","abgroup":"prbi","key":"PriorityBiddersExperiment"},{"variants":[{"weight":100,"value":"ss"},{"weight":100,"value":"td"},{"weight":100,"value":"g_td"},{"weight":100,"value":"g_mw"},{"weight":100,"value":"g_tdmw"},{"weight":100,"value":"g_o"},{"weight":100,"value":"ra_gpid"},{"weight":100,"value":"ra_shid"},{"weight":100,"value":"ra_lpid"},{"weight":100,"value":"ra_rcid"},{"weight":100,"value":"auth"},{"weight":100,"value":"authbr"},{"weight":100,"value":"nl"},{"weight":100,"value":"url"},{"weight":100,"value":"urlh"},{"weight":100,"value":"api"},{"weight":100,"value":"grwm"},{"weight":100,"value":"cki"},{"weight":100,"value":"l"},{"weight":100,"value":"o"},{"weight":100,"value":"c"},{"weight":100,"value":"l_i"},{"weight":100,"value":"ot"},{"weight":100,"value":"slickstream"},{"weight":100,"value":"unknown"},{"weight":100,"value":"undefined"},{"weight":100,"value":"urlhck"}],"type":"multivalueBernoulliTrial","abgroup":"hemsa","key":"hemSourceAllowlist"},{"variants":[{"weight":1,"value":"11"},{"weight":25,"value":"1911"},{"weight":1,"value":"21"},{"weight":72,"value":"169"},{"weight":1,"value":"43"}],"type":"weightedChoice","abgroup":"ntvrat","key":"NativeRatio"},{"variants":[{"weight":20,"value":20},{"weight":20,"value":23},{"weight":20,"value":25},{"weight":20,"value":28},{"weight":20,"value":30}],"type":"weightedChoice","abgroup":"ntvrtl","key":"NativeRecipeTitleLength"},{"variants":[{"weight":90}],"type":"bernoulliTrial","abgroup":"sspus","key":"SSPUserSync"},{"variants":[{"weight":0,"value":"default"},{"weight":100,"value":"ADA-815"}],"type":"weightedChoice","abgroup":"pdls","key":"PaapiDecisionLogicSelection"},{"variants":[{"weight":90,"value":"ec3"},{"weight":5,"value":"arl"},{"weight":5,"value":"off"}],"type":"weightedChoice","abgroup":"ixnt","key":"IxNativeExperiment"},{"variants":[{"weight":20,"value":"none"},{"weight":10,"value":"idl"},{"weight":10,"value":"pubcid"},{"weight":10,"value":"id5"},{"weight":10,"value":"uid1"},{"weight":10,"value":"li_uid2"},{"weight":10,"value":"cid"},{"weight":10,"value":"lpid"},{"weight":10,"value":"li_bdsw"}],"type":"weightedChoice","abgroup":"1st_eid","key":"FirstEidExperiment"},{"variants":[{"weight":33,"value":"er3"},{"weight":33,"value":"arl"},{"weight":34,"value":"off"}],"type":"weightedChoice","abgroup":"ixntr","key":"IxNativeExperimentRecipe"},{"variants":[{"weight":5,"value":1000},{"weight":45,"value":1250},{"weight":45,"value":1500},{"weight":5,"value":1750}],"type":"weightedChoice","abgroup":"s2sto","key":"S2STimeOutExperiment"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"inp","key":"INPExperiment"},{"variants":[{"weight":85,"value":1500},{"weight":5,"value":2000},{"weight":5,"value":3000},{"weight":5,"value":4000}],"type":"weightedChoice","abgroup":"s2store","key":"S2SRefreshTimeout"},{"variants":[{"weight":99}],"type":"bernoulliTrial","abgroup":"opli","key":"OpenPathLiveIntent"},{"variants":[{"weight":20,"value":"rec"},{"weight":20,"value":"old"},{"weight":20,"value":"fr30"},{"weight":20,"value":"fr60"},{"weight":20,"value":"fr90"}],"type":"weightedChoice","abgroup":"td_hsl","key":"TrueDataHemSelectionLogic"},{"variants":[{"weight":10,"value":"rec"},{"weight":90,"value":"perc"}],"type":"weightedChoice","abgroup":"td_hsl_2","key":"TrueDataHemSelectionLogic_2"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"ssptrm","key":"SspTakeRateMonitor"},{"variants":[{"weight":20,"value":1},{"weight":20,"value":2},{"weight":20,"value":3},{"weight":20,"value":4},{"weight":20,"value":5}],"type":"weightedChoice","abgroup":"ttlb","key":"TTLBuffer"},{"variants":[{"weight":20,"value":0},{"weight":5,"value":75},{"weight":20,"value":100},{"weight":20,"value":120},{"weight":35,"value":140}],"type":"weightedChoice","abgroup":"ntvdl","key":"NativeDescriptionLength"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":5},{"weight":20,"value":10},{"weight":20,"value":15},{"weight":20,"value":20}],"type":"weightedChoice","abgroup":"nbho","key":"NoBidHoldouts"},{"variants":[{"weight":25,"value":5},{"weight":25,"value":10},{"weight":25,"value":15},{"weight":25,"value":20}],"type":"weightedChoice","abgroup":"nbl","key":"NoBidLimit"},{"variants":[{"weight":20,"value":300},{"weight":20,"value":400},{"weight":20,"value":500},{"weight":20,"value":600},{"weight":20,"value":700}],"type":"weightedChoice","abgroup":"ftmg","key":"FetchMargin"},{"variants":[{"weight":7,"value":"2_1"},{"weight":7,"value":"2_2"},{"weight":7,"value":"2_3"},{"weight":7,"value":"2_4"},{"weight":7,"value":"2_5"},{"weight":7,"value":"3_1"},{"weight":7,"value":"3_2"},{"weight":7,"value":"3_3"},{"weight":7,"value":"4_1"},{"weight":7,"value":"4_2"},{"weight":7,"value":"4_3"},{"weight":7,"value":"5_1"},{"weight":7,"value":"5_2"},{"weight":7,"value":"5_3"},{"weight":2,"value":"off"}],"type":"weightedChoice","abgroup":"mmsa","key":"MultiMultistagePrebidAuctionDisplay"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":50},{"weight":20,"value":75},{"weight":20,"value":100},{"weight":20,"value":150}],"type":"weightedChoice","abgroup":"lrt","key":"LazyRenderThreshold"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"krpl","key":"KargoPlacement"},{"variants":[{"weight":33,"value":"20sf1"},{"weight":33,"value":"20sf2"},{"weight":33,"value":"off"},{"weight":1,"value":"csdr"}],"type":"weightedChoice","abgroup":"multirefaucd2","key":"MultistagePrebidAuctionDisplay2"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"hscu","key":"HemStorageCleanup"},{"variants":[{"weight":5}],"type":"bernoulliTrial","abgroup":"apprq","key":"AppRequests"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"sgf","key":"ServerGAMFailure"},{"variants":[{"weight":90}],"type":"bernoulliTrial","abgroup":"mr4","key":"DisableMultistageRefresh"},{"variants":[{"weight":25,"value":"mr4"},{"weight":25,"value":"mrt1"},{"weight":25,"value":"mrt2"},{"weight":25,"value":"off"}],"type":"weightedChoice","abgroup":"mrm","key":"MultistageRefreshModifier"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"mnr","key":"MissingNativeParams"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"dbuid2","key":"DeclareBridgedUid2"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"dbgpid","key":"DeclareBridgedGPID"},{"variants":[{"weight":100,"value":"rubi_ss"},{"weight":5,"value":"tripl_ss"}],"type":"multivalueBernoulliTrial","abgroup":"apprqb","key":"AppBiddersList"},{"variants":[{"weight":20}],"type":"bernoulliTrial","abgroup":"bs2se","key":"BrokenS2SEndpoint"},{"variants":[{"weight":20,"value":1000},{"weight":20,"value":2000},{"weight":20,"value":3000},{"weight":20,"value":4000},{"weight":20,"value":5000}],"type":"weightedChoice","abgroup":"pbfs","key":"PrebidFailsafeTimeout"},{"variants":[{"weight":20,"value":500},{"weight":20,"value":750},{"weight":20,"value":1000},{"weight":20,"value":1250},{"weight":20,"value":1500}],"type":"weightedChoice","abgroup":"amzfs","key":"AmazonFailsafeTimeout"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"ntvho","key":"NativeHoldout"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":2},{"weight":20,"value":3},{"weight":20,"value":4},{"weight":20,"value":5}],"type":"weightedChoice","abgroup":"drb","key":"DisplayRequestBatch"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"gbsr","key":"GAMBatchSRARequest"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"ggb","key":"GpidGraphBridge"},{"variants":[{"weight":20,"value":100},{"weight":20,"value":200},{"weight":20,"value":300},{"weight":20,"value":400},{"weight":20,"value":500}],"type":"weightedChoice","abgroup":"vse","key":"VideoScrollExperiment"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":250},{"weight":25,"value":500},{"weight":25,"value":1000}],"type":"weightedChoice","abgroup":"iisw","key":"IdentityIframeSyncWait"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"adxiso","key":"AdxStickyOutstream"},{"variants":[{"weight":33,"value":0.6},{"weight":33,"value":0.7},{"weight":34,"value":0.9}],"type":"weightedChoice","abgroup":"lazyflr","key":"LazyFloorPercentile"},{"variants":[{"weight":4,"value":-1},{"weight":95,"value":500},{"weight":1,"value":1024}],"type":"weightedChoice","abgroup":"imabr","key":"IMABitrate"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":20},{"weight":20,"value":35},{"weight":20,"value":50},{"weight":20,"value":"off"}],"type":"weightedChoice","abgroup":"rpbbl","key":"RaptivePlayerBackBufferLength"},{"variants":[{"weight":20,"value":10},{"weight":20,"value":20},{"weight":20,"value":30},{"weight":20,"value":60},{"weight":20,"value":"off"}],"type":"weightedChoice","abgroup":"rpfbt","key":"RaptivePlayerFrontBufferThreshold"},{"variants":[{"weight":20,"value":1},{"weight":20,"value":5},{"weight":20,"value":10},{"weight":20,"value":20},{"weight":20,"value":30}],"type":"weightedChoice","abgroup":"rpmbl","key":"RaptivePlayerMaxBufferLength"},{"variants":[{"weight":20,"value":10},{"weight":20,"value":50},{"weight":20,"value":100},{"weight":20,"value":250},{"weight":20,"value":600}],"type":"weightedChoice","abgroup":"rpmmbl","key":"RaptivePlayerMaxMaxBufferLength"},{"variants":[{"weight":20,"value":5},{"weight":20,"value":20},{"weight":20,"value":35},{"weight":20,"value":50},{"weight":20,"value":60}],"type":"weightedChoice","abgroup":"rpmbs","key":"RaptivePlayerMaxBufferSize"},{"variants":[{"weight":20,"value":20},{"weight":20,"value":25},{"weight":20,"value":30},{"weight":20,"value":35},{"weight":20,"value":40}],"type":"weightedChoice","abgroup":"rpslt","key":"RaptivePlayerStaleLoadThreshold"},{"variants":[{"weight":90,"value":"d"},{"weight":10,"value":"7"}],"type":"weightedChoice","abgroup":"lifpi","key":"LiveIntentFpiExpiration"},{"variants":[{"weight":95,"value":"both"},{"weight":0,"value":"server"},{"weight":5,"value":"client"}],"type":"weightedChoice","abgroup":"criteodr","key":"CriteoDoubleRequest"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"asri","key":"AmazonASRInitalRequest"},{"variants":[{"weight":10,"value":50},{"weight":30,"value":100},{"weight":30,"value":150},{"weight":20,"value":200},{"weight":10,"value":250}],"type":"weightedChoice","abgroup":"pbrqt","key":"PrebidRequestQueueTimeout"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"gaam","key":"GenericAnalyticsAdMarkup"},{"variants":[{"weight":33,"value":"bc"},{"weight":33,"value":"nobc"},{"weight":34,"value":"off"}],"type":"weightedChoice","abgroup":"pubbcat","key":"PubmaticBCats"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"rpep","key":"RaptivePlayerEnablePreloading"},{"variants":[{"weight":20,"value":4000},{"weight":20,"value":6000},{"weight":20,"value":8000},{"weight":20,"value":10000},{"weight":20,"value":15000}],"type":"weightedChoice","abgroup":"rplvto","key":"RaptivePlayerLoadVideoTimeout"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"pbsintl","key":"PBSInternationalTraffic"},{"variants":[{"weight":33,"value":"ignkrg"},{"weight":33,"value":"nokrginfl"},{"weight":34,"value":"off"}],"type":"weightedChoice","abgroup":"bpkrg","key":"KargoFloorsRefreshExperiment"},{"variants":[{"weight":25,"value":50},{"weight":25,"value":100},{"weight":25,"value":200},{"weight":25,"value":400}],"type":"weightedChoice","abgroup":"echde","key":"EmailCaptureHandlerDebounceExperiment"},{"variants":[{"weight":20,"value":1},{"weight":20,"value":1.5},{"weight":20,"value":2},{"weight":20,"value":3},{"weight":20,"value":4}],"type":"weightedChoice","abgroup":"bcm","key":"BidCacheTimeout"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"mmbr","key":"MaxMaxBufferReset"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":2},{"weight":20,"value":4},{"weight":20,"value":6},{"weight":20,"value":8}],"type":"weightedChoice","abgroup":"icft","key":"InstreamCreativeFailureThreshold"},{"variants":[{"weight":25,"value":1.2},{"weight":25,"value":1.4},{"weight":25,"value":1.6},{"weight":25,"value":"off"}],"label":"RPBS","type":"weightedChoice","abgroup":"r_infmlt","key":"RPBSInflatorMultiplier"},{"variants":[{"weight":34,"value":"off"},{"weight":33,"value":0.8},{"weight":0,"value":0.7},{"weight":0,"value":0.6},{"weight":33,"value":0.5}],"label":"RPBS","type":"weightedChoice","abgroup":"r_stm","key":"RPBSStageTimeoutMultiplier"},{"variants":[{"weight":5}],"type":"bernoulliTrial","abgroup":"ixnr","key":"IXRefresh"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":50},{"weight":20,"value":100},{"weight":20,"value":200},{"weight":20,"value":400}],"type":"weightedChoice","abgroup":"echde2","key":"EmailCaptureHandlerDebounceExperiment_2"},{"variants":[{"weight":5}],"type":"bernoulliTrial","abgroup":"mgnr","key":"MagniteRefresh"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"vpsm","key":"ViewportSampling"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":1},{"weight":20,"value":2},{"weight":20,"value":3},{"weight":20,"value":4}],"type":"weightedChoice","abgroup":"rfavt","key":"RefreshAuctionViewportThreshold"},{"variants":[{"weight":90,"value":"off"},{"weight":10,"value":"nobid"}],"label":"RPBS","type":"weightedChoice","abgroup":"r_shpmlt","key":"RPBSReRequestNoBids"},{"variants":[{"weight":70,"value":"off"},{"weight":10,"value":"nobid"},{"weight":10,"value":"cp1"},{"weight":10,"value":"cp2"}],"label":"RPBS","type":"weightedChoice","abgroup":"shpmlt","key":"RPBSReRequestNoBidsWithRemovedParams"},{"label":"RPBS","variants":[{"weight":20,"value":2},{"weight":40,"value":3},{"weight":40,"value":4}],"type":"weightedChoice","abgroup":"r_mmsa","key":"RPBSMultiMultiStageAuctions"},{"variants":[{"weight":2,"value":"off"},{"weight":98,"value":"sm"}],"type":"weightedChoice","abgroup":"so","key":"SizeOrder"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"rp","key":"RaptivePlayerOverride"},{"label":"RPBS","variants":[{"weight":34,"value":"off"},{"weight":33,"value":1},{"weight":33,"value":2}],"type":"weightedChoice","abgroup":"mfb","key":"RPBSMultistageFixedBidders"},{"label":"RPBS","variants":[{"weight":33,"value":"floor"},{"weight":33,"value":"round"},{"weight":34,"value":"off"}],"type":"weightedChoice","abgroup":"bsa","key":"RPBSBiddersSplitAlgorithm"},{"variants":[{"weight":100,"value":15},{"weight":0,"value":25}],"type":"weightedChoice","abgroup":"advd","key":"AdvancePlaylistDelay"},{"label":"RPBS","variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"tm","key":"Tmax"}]};

    let adtpm=Math.random()<.02&&{startTime:Date.now(),name:"adt-iife-start",duration:null};window.adthrive.branch=window.adthrive.branch||"HEAD bb4aaa2",window.adthrive.bucket=window.adthrive.bucket||"flex",window.adthrive.gdpr="false",window.adthrive.deployment=window.adthrive.deployment||"X";var adthrive=function(){"use strict";window.adthrive.buildDate="2024-11-13";const e=new WeakMap;function t(t,i){return e.get(t)&&e.get(t).get(i)}function i(e,i,s){if(void 0===i)throw new TypeError;const r=t(i,s);return r&&r.get(e)}function s(i,s,r,n){if(n&&!["string","symbol"].includes(typeof n))throw new TypeError;(t(r,n)||function(t,i){const s=e.get(t)||new Map;e.set(t,s);const r=s.get(i)||new Map;return s.set(i,r),r}(r,n)).set(i,s)}function r(e,t,s){return i(e,t,s)?i(e,t,s):Object.getPrototypeOf(t)?r(e,Object.getPrototypeOf(t),s):void 0}const n={decorate:function(e,t,i,s){if(!Array.isArray(e)||0===e.length)throw new TypeError;return void 0!==i?function(e,t,i,s){return e.reverse().forEach((e=>{s=e(t,i,s)||s})),s}(e,t,i,s):"function"==typeof t?function(e,t){return e.reverse().forEach((e=>{const i=e(t);i&&(t=i)})),t}(e,t):void 0},defineMetadata:function(e,t,i,r){s(e,t,i,r)},getMetadata:function(e,t,i){return r(e,t,i)},getOwnMetadata:function(e,t,s){return i(e,t,s)},hasMetadata:function(e,t,i){return!!r(e,t,i)},hasOwnMetadata:function(e,t,s){return!!i(e,t,s)},metadata:function(e,t){return function(i,r){s(e,t,i,r)}}};var a;Object.assign(Reflect,n),function(e){e[e.Transient=0]="Transient",e[e.Singleton=1]="Singleton",e[e.ResolutionScoped=2]="ResolutionScoped",e[e.ContainerScoped=3]="ContainerScoped"}(a||(a={}));var o=a,l=function(e,t){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},l(e,t)};function d(e,t){function i(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function c(e,t,i,s){return new(i||(i=Promise))((function(t,r){function n(e){try{o(s.next(e))}catch(e){r(e)}}function a(e){try{o(s.throw(e))}catch(e){r(e)}}function o(e){var s;e.done?t(e.value):(s=e.value,s instanceof i?s:new i((function(e){e(s)}))).then(n,a)}o((s=s.apply(e,[])).next())}))}function h(e,t){var i,s,r,n,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function o(n){return function(o){return function(n){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,s&&(r=2&n[0]?s.return:n[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,n[1])).done)return r;switch(s=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,s=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){a.label=n[1];break}if(6===n[0]&&a.label<r[1]){a.label=r[1],r=n;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(n);break}r[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],s=0}finally{i=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],s=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var s,r,n=i.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}var m="injectionTokens";function _(e){return!!e.useClass}function f(e){return!!e.useFactory}var v=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,i=this,s=!1;return new Proxy({},this.createHandler((function(){return s||(t=e(i.wrap()),s=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(i){t[i]=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return t[0]=e(),Reflect[i].apply(void 0,g(t))}})),t},e}();function y(e){return"string"==typeof e||"symbol"==typeof e}function b(e){return"object"==typeof e&&"token"in e&&"transform"in e}function S(e){return!!e.useToken}function E(e){return null!=e.useValue}var C=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),t}(C),w=function(){this.scopedResolutions=new Map};function A(e,t,i){var s=p(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1],r=function(e,t){return null===e?"at position #"+t:'"'+e.split(",")[t].trim()+'" at position #'+t}(void 0===s?null:s,t);return function(e,t,i){return void 0===i&&(i="    "),g([e],t.message.split("\n").map((function(e){return i+e}))).join("\n")}("Cannot inject the dependency "+r+' of "'+e.name+'" constructor. Reason:',i)}var k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),t}(C),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),t}(C),P=function(){this.preResolution=new k,this.postResolution=new I},O=new Map,x=function(){function e(e){this.parent=e,this._registry=new T,this.interceptors=new P,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,i){var s;if(void 0===i&&(i={lifecycle:o.Transient}),this.ensureNotDisposed(),s=function(e){return _(e)||E(e)||S(e)||f(e)}(t)?t:{useClass:t},S(s))for(var r=[e],n=s;null!=n;){var a=n.useToken;if(r.includes(a))throw new Error("Token registration cycle detected! "+g(r,[a]).join(" -> "));r.push(a);var l=this._registry.get(a);n=l&&S(l.provider)?l.provider:null}if((i.lifecycle===o.Singleton||i.lifecycle==o.ContainerScoped||i.lifecycle==o.ResolutionScoped)&&(E(s)||f(s)))throw new Error('Cannot use lifecycle "'+o[i.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:s,options:i}),this},e.prototype.registerType=function(e,t){return this.ensureNotDisposed(),y(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),y(e)){if(y(t))return this.register(e,{useToken:t},{lifecycle:o.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:o.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var i=e;return t&&!y(t)&&(i=t),this.register(e,{useClass:i},{lifecycle:o.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new w),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&y(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),i){var s=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}if(function(e){return"function"==typeof e||e instanceof v}(e)){s=this.construct(e,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var i,s;if(this.interceptors.preResolution.has(e)){var r=[];try{for(var n=u(this.interceptors.preResolution.getAll(e)),a=n.next();!a.done;a=n.next()){var o=a.value;"Once"!=o.options.frequency&&r.push(o),o.callback(e,t)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(s=n.return)&&s.call(n)}finally{if(i)throw i.error}}this.interceptors.preResolution.setAll(e,r)}},e.prototype.executePostResolutionInterceptor=function(e,t,i){var s,r;if(this.interceptors.postResolution.has(e)){var n=[];try{for(var a=u(this.interceptors.postResolution.getAll(e)),o=a.next();!o.done;o=a.next()){var l=o.value;"Once"!=l.options.frequency&&n.push(l),l.callback(e,t,i)}}catch(e){s={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(s)throw s.error}}this.interceptors.postResolution.setAll(e,n)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===o.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var i,s=e.options.lifecycle===o.Singleton,r=e.options.lifecycle===o.ContainerScoped,n=s||r;return i=E(e.provider)?e.provider.useValue:S(e.provider)?n?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):_(e.provider)?n?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):f(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===o.ResolutionScoped&&t.scopedResolutions.set(e,i),i},e.prototype.resolveAll=function(e,t){var i=this;void 0===t&&(t=new w),this.ensureNotDisposed();var s=this.getAllRegistrations(e);if(!s&&y(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),s){var r=s.map((function(e){return i.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,r,"All"),r}var n=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,n,"All"),n},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var i=u(this._registry.entries()),s=i.next();!s.done;s=i.next()){var r=p(s.value,2),n=r[0],a=r[1];this._registry.setAll(n,a.filter((function(e){return!E(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,i;this.ensureNotDisposed();var s=new e(this);try{for(var r=u(this._registry.entries()),n=r.next();!n.done;n=r.next()){var a=p(n.value,2),l=a[0],d=a[1];d.some((function(e){return e.options.lifecycle===o.ContainerScoped}))&&s._registry.setAll(l,d.map((function(e){return e.options.lifecycle===o.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}return s},e.prototype.beforeResolution=function(e,t,i){void 0===i&&(i={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:i})},e.prototype.afterResolution=function(e,t,i){void 0===i&&(i={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:i})},e.prototype.dispose=function(){return c(this,0,void 0,(function(){var e;return h(this,(function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach((function(t){var i=t.dispose();i&&e.push(i)})),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var i=this;if(e instanceof v)return e.createProxy((function(e){return i.resolve(e,t)}));var s,r=function(){var s=O.get(e);if(!s||0===s.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var r=s.map(i.resolveParams(t,e));return new(e.bind.apply(e,g([void 0],r)))}();return"function"!=typeof(s=r).dispose||s.dispose.length>0||this.disposables.add(r),r},e.prototype.resolveParams=function(e,t){var i=this;return function(s,r){var n,a,o,l;try{return"object"==typeof(l=s)&&"token"in l&&"multiple"in l?b(s)?s.multiple?(n=i.resolve(s.transform)).transform.apply(n,g([i.resolveAll(s.token)],s.transformArgs)):(a=i.resolve(s.transform)).transform.apply(a,g([i.resolve(s.token,e)],s.transformArgs)):s.multiple?i.resolveAll(s.token):i.resolve(s.token,e):b(s)?(o=i.resolve(s.transform,e)).transform.apply(o,g([i.resolve(s.token,e)],s.transformArgs)):i.resolve(s,e)}catch(e){throw new Error(A(t,r,e))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},e}(),R=new x;function D(e){return t=e,function(e,i,s){var r=Reflect.getOwnMetadata(m,e)||{};r[s]=t,Reflect.defineMetadata(m,r,e)};var t}function L(){return function(e){O.set(e,function(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],i=Reflect.getOwnMetadata(m,e)||{};return Object.keys(i).forEach((function(e){t[+e]=i[e]})),t}(e))}}function M(){return function(e){L()(e),R.registerSingleton(e)}}if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");function B(e,t,i,s){var r,n=arguments.length,a=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(n<3?r(a):n>3?r(t,i,a):r(t,i))||a);return n>3&&a&&Object.defineProperty(t,i,a),a}function F(e,t){return function(i,s){t(i,s,e)}}function j(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}"function"==typeof SuppressedError&&SuppressedError;class N{}const U=e=>"string"==typeof e&&/^[0-9a-f]{64}$/.test(e),V=e=>"string"==typeof e&&/^[0-9a-fA-F-]{36}$/.test(e),z=e=>"string"==typeof e&&/^[0-9a-f]{32}$/.test(e),$=(e,t=Number.MAX_SAFE_INTEGER)=>i=>"string"==typeof i&&(i.length>=e&&i.length<=t),H=e=>null!=e&&!("number"==typeof e&&isNaN(e)),q=(e,t,i,s,r,n=!0)=>{const a="abgroup",o=e.getLocalStorageValue(a,!0,!0,r,n);if(null!==o){const e=o[t];var l;const i=null!=(l=o[`${t}_weight`])?l:null;if(H(e))return[e,i]}const d={...o,[t]:i,[`${t}_weight`]:s};return e.setLocalStorageValue(a,d),[i,s]};class G extends N{init(e){this._gdpr="true"===e.gdpr,this._shouldQueue=this._gdpr}clearQueue(e){e&&(this._shouldQueue=!1,this._storageHandlerQueue.forEach((e=>{if("adthrive_abgroup"===e.key){const t=Object.keys(e.value.value)[0],i=e.value.value[t],s=e.value.value[`${t}_weight`];void 0!==s&&q(this,t,i,s)}else window.localStorage.setItem(e.key,JSON.stringify(e.value))}))),this._storageHandlerQueue=[]}setSessionFpv(){this.setLocalStorageValue("session_fpv",null===this.getLocalStorageValue("session_fpv"))}constructor(...e){super(...e),this.name="StorageHandler",this.disable=!1,this.gdprPurposes=[1],this._storageHandlerQueue=[],this._shouldQueue=!1,this.removeLocalStorageValue=(e,t=!0)=>{const i=t?"adthrive_":"";window.localStorage.removeItem(`${i}${e.toLowerCase()}`)},this.getLocalStorageValue=(e,t=!0,i=!0,s,r)=>{const n=t?"adthrive_":"";if(this.disable)return null;const a=i?e.toLowerCase():e;try{const i=window.localStorage.getItem(`${n}${a}`);if(i){const n=JSON.parse(i),a=void 0!==s&&Date.now()-n.created>=s;if(n&&!a)return r&&this.setLocalStorageValue(e,n.value,t),n.value}}catch(e){return window.localStorage.getItem(`${n}${a}`)}return null},this.setLocalStorageValue=(e,t,i=!0)=>{try{const s=i?"adthrive_":"",r={value:t,created:Date.now()};if(this._gdpr&&this._shouldQueue){const t={key:`${s}${e.toLowerCase()}`,value:r};this._storageHandlerQueue.push(t)}else window.localStorage.setItem(`${s}${e.toLowerCase()}`,JSON.stringify(r))}catch(e){}},this.getOrSetLocalStorageValue=(e,t)=>{const{key:i,timeout:s,lowercase:r=!0,rolling:n=!0,cb:a,adthriveKey:o}=e,l=this.getLocalStorageValue(i,o,r,s,n);if(null!==l)return l;const d=t();return this.setLocalStorageValue(i,d,o),a&&a(d),d}}}const K=new(G=B([M()],G));class W{constructor(){this.emitters=new Set}}W=B([M()],W);const Y=R.resolve(W).emitters;class Q{on(e){return this._listeners.add(e),()=>{this.off(e)}}off(e){this._listeners.delete(e)}once(e,t=!0){const i=this.on(((...t)=>{i(),e(...t)}));t&&(this._onces.push((()=>this.once(e,!1))),this._trackStatefulEmitter())}legacyOnce(){return new Promise((e=>{const t=this.on(((...i)=>(t(),e(...i))))}))}_trackStatefulEmitter(){Y.add(this)}async legacyEmit(e){return Promise.all([...this._listeners].map((t=>t(e)))).then((e=>(this._emitted++,e)))}emit(e){[...this._listeners].forEach((t=>t(e))),this._emitted++,this._trackStatefulEmitter()}clear(){this._listeners.clear()}resetEmitted(){this._emitted=0}resetOnces(){this._onces.forEach((e=>e()))}get count(){return this._listeners.size}get emitted(){return this._emitted}get onces(){return this._onces}constructor(){this._listeners=new Set,this._emitted=0,this._onces=[]}}class X extends Q{on(e,t){return this._listeners.add(e),(null==t?void 0:t.handleEventsAlreadyEmitted)&&this._pastEvents.forEach(e),()=>{this.off(e)}}async legacyEmit(e){return this._pastEvents.push(e),Promise.all([...this._listeners].map((t=>t(e)))).then((e=>(this._emitted++,e)))}emit(e){this._pastEvents.push(e),[...this._listeners].forEach((t=>t(e))),this._emitted++,this._trackStatefulEmitter()}_trackStatefulEmitter(){Y.add(this)}constructor(...e){super(...e),this._pastEvents=[]}}class J{}J=B([M()],J);class Z extends J{constructor(...e){super(...e),this.dialDownLogs=new Q,this.newContextDataEncodingSize=new Q}}Z=B([M()],Z);class ee extends N{init(e){this.logFilter=e.loggerFilters||[],this.siteId=e.siteAds.siteId,this.siteName=e.siteAds.siteName,this.bucket=e.bucket,this.branch=e.branch,this.deployment=e.deployment,this.debug=e.debug,this._gdpr="true"===e.gdpr,this._shouldQueue=this._gdpr,this._setLoggerExperiments()}_setLoggerExperiments(){this.loggerEventBus.dialDownLogs.on((({result:e,choices:t})=>{this._dialDownLogsExperimentResult=e,this._dialDownLogsExperimentChoices=t}))}_isDialedDownLog(e){const t=this._dialDownLogsExperimentResult||[];return e.some((e=>"string"==typeof e&&t.some((t=>e.toLowerCase().indexOf(t.toLowerCase())>-1))))}_dialedDownChoice(e){var t;return null==(t=this._dialDownLogsExperimentChoices)?void 0:t.filter((({choice:t})=>"string"==typeof t&&e.some((e=>"string"==typeof e&&e.toLowerCase().indexOf(t.toLowerCase())>-1)))).map((({weight:e})=>e))}log(e,t,...i){this.call(console.log,e,t,...i)}info(e,t,...i){this.call(console.info,e,t,...i)}warn(e,t,...i){this.call(console.warn,e,t,...i)}_getLogToCheck(e){const t=e&&e[1]&&e[1].arguments&&e[1].arguments[0];return t?[t]:e}error(e,t,...i){this._request("error",e,t,i)}event(e,t,...i){this._request("event",e,t,i)}_request(e,t,i,s){this.shouldLog(t,i)&&this.call(console.error,t,i,...s);const r=`${t}::${i}`,n=s.concat([r]),a=this._getLogToCheck(n);let o=this._uniqueLogMap.get(r)||0;if(!this._uniqueLogExclusionList.includes(r)&&o>this._uniqueLogLimit);else if(!this._isDialedDownLog(a)){const n=this._dialedDownChoice(a);n&&n.length&&s.push(`Sampled at ${100-n[0]} percent`),this.makeRequest("send",e,t,i,...s).catch((e=>{console.error(e)})),this._uniqueLogMap.set(r,++o)}}shouldLog(e,t){return!!this.debug&&!this.suppressedEventLogNames.has(e)&&this.suppressedEventLogNames.get(e)!==t}fetchEvent(e,t,...i){this.debug&&this.call(console.log,e,t,...i),this.makeRequest("fetch","event",e,t,...i).catch((e=>{console.error(e)}))}getBlockedLogCategories(){if("undefined"!=typeof window&&window.location){const e=new URLSearchParams(window.location.search).get("at_block_logs");if(e)return e.split(",").map((e=>e.trim().toLowerCase()))}return[]}getLimitedLogCategories(){if("undefined"!=typeof window&&window.location){const e=new URLSearchParams(window.location.search).get("at_limit_logs");if(e)return e.split(",").map((e=>e.trim().toLowerCase()))}return[]}call(e,t,i,...s){const r=this.logFilter;if(r&&r.length&&r.includes(t))return;const n=t.toLowerCase();if(this.getBlockedLogCategories().includes(n))return;const a=this.getLimitedLogCategories();if(a.length>0&&!a.includes(n))return;const o=[`%c${t}::${i} `],l=["color: #999; font-weight: bold;"];s.length>0&&"string"==typeof s[0]&&o.push(s.shift()),l.push(...s);try{Function.prototype.apply.call(e,console,[o.join(""),...l])}catch(e){return void console.error(e)}}buildRequestUrl(e,t,i,s){const r=`https://logger.adthrive.com/${e}`,n=[`${t}::${i} `];s.length>0&&"string"==typeof s[0]&&n.push(s.shift());const a=s.map((e=>(e&&e.error&&(e=e.error),e instanceof Error&&(e={name:e.name,message:e.message,stack:e.stack}),e))),o=this._addDefaultData(t,i);o&&a.push(o);return`${r}?${[`siteId=${encodeURIComponent(this.siteId||"")}`,`siteName=${encodeURIComponent(this.siteName||"")}`,`bucket=${encodeURIComponent(this.bucket||"")}`,`branch=${encodeURIComponent(this.branch||"")}`,`deployment=${encodeURIComponent(this.deployment||"")}`,`message=${encodeURIComponent(n.join("").trim())}`,`pageurl=${encodeURIComponent(window.location.origin+window.location.pathname)}`,`body=${encodeURIComponent(JSON.stringify(a))}`].join("&")}`}_addDefaultData(e,t){if(!this._data)return;const i={...this._data},s=this.defaultDataFilterList.get(`${e}:${t}`);return s&&Object.keys(i).forEach((e=>{s.includes(e)&&delete i[e]})),i}clearQueue(e){e&&(this._shouldQueue=!1,this.logQueue.forEach((e=>{"send"===e.action&&this.sendRequest(e.type,e.className,e.methodName,...e.args).catch((()=>{})),"fetch"===e.action&&this.fetchRequest(e.type,e.className,e.methodName,...e.args).catch((()=>{}))}))),this.logQueue=[]}async makeRequest(e,t,i,s,...r){if(this.disable)return Promise.resolve(!1);if(this._gdpr&&this._shouldQueue){const n={action:e,type:t,className:i,methodName:s,args:r};return this.logQueue.push(n),Promise.resolve(!0)}return"send"===e?this.sendRequest(t,i,s,...r):this.fetchRequest(t,i,s,...r)}truncateRequestUrl(e,t,i,s,r){const n=[...s[0].arguments],a={...s[0],arguments:n},o=`${i}Truncated`;let l=0;for(;r.length>this.maxCloudFrontUrlSize&&n.length>0&&l<10;)n.pop(),r=this.buildRequestUrl(e,t,o,[a]),l++;return r}async sendRequest(e,t,i,...s){this.sending.emit();let r=this.buildRequestUrl(e,t,i,s);var n;if(r.length>this.maxCloudFrontUrlSize&&("error"===e&&"PrebidAuctionManager"===t&&"_logAuctionDebug"===i&&(null==(n=s[0])?void 0:n.arguments)&&(r=this.truncateRequestUrl(e,t,i,s,r)),r.length>this.maxCloudFrontUrlSize))return this.sendRequest(e,t,i,"Payload too large. Logger cannot send").catch((e=>{console.error(e)}));return new Promise(((e,n)=>{const a=new XMLHttpRequest;a.open("get",r);const o="logger"===t&&"sendRequest"===i;a.addEventListener("load",(()=>200!==a.status?(o||this.error("logger","sendRequest",...s,{className:t,methodName:i}),n(new Error(`Logger send request failed ${a.status}`))):e(a.responseText))),a.addEventListener("error",(()=>(o||this.error("logger","sendRequest",...s,{className:t,methodName:i}),n(new Error("Logger send request failed"))))),a.send()}))}async fetchRequest(e,t,i,...s){this.sending.emit();const r=this.buildRequestUrl(e,t,i,s);return fetch(r,{method:"GET",keepalive:!0,referrerPolicy:"no-referrer-when-downgrade"})}get data(){return this._data}set data(e){this._data=e,this.loggerEventBus.newContextDataEncodingSize.emit(encodeURIComponent(JSON.stringify(this._data)).length)}constructor(){super(),this.name="Logger",this.gdprPurposes=[7],this.disable=!1,this._shouldQueue=!1,this._data={abgroup:{key:"adslogger-err"},pubab:{key:"adslogger-err"},sess:"adslogger-err",pvk:"adslogger-err",hbho:["adslogger-err"],vbho:["adslogger-err"],spa:!1},this._uniqueLogLimit=100,this._uniqueLogMap=new Map,this._uniqueLogExclusionList=["SlotRenderEnded::adImpression","ImpressionLogComponent::bidWon"],this.sending=new Q,this.logQueue=[],this.suppressedEventLogNames=new Map([["SlotRenderEnded","adImpression"],["VideoUtils","getPlacementElement"],["PrebidAuctionManager","_logAuctionDebug"],["PrebidAuctionManager","init"]]),this.defaultDataFilterList=new Map([["SlotRenderEnded:adImpression",["abgroup"]]]),this.maxCloudFrontUrlSize=8192,this.loggerEventBus=R.resolve(Z)}}const te=new(ee=B([L(),j("design:type",Function),j("design:paramtypes",[])],ee));class ie{async limit(e){return new Promise((t=>{this._timeouts.has(e)&&window.clearTimeout(this._timeouts.get(e));const i=window.setTimeout((()=>{t()}),this._wait);this._timeouts.set(e,i)}))}constructor(e){this._wait=e,this._timeouts=new Map}}class se extends ee{}const re=new(se=B([L()],se));var ne,ae,oe,le,de,ce,he,ue,pe,ge,me,_e,fe,ve,ye,be,Se,Ee,Ce,Te;!function(e){e.amznbid="amznbid",e.amzniid="amzniid",e.amznp="amznp",e.amznsz="amznsz"}(ne||(ne={})),function(e){e.ThirtyThreeAcross="33across",e.Adform="adform",e.Aidem="aidem",e.AidemServer="aidem_ss",e.AppNexus="appnexus",e.AmazonTAM="amazon",e.AmazonUAM="AmazonUAM",e.AmazonASR="AmazonASR",e.Colossus="colossus",e.ColossusServer="col_ss",e.Conversant="conversant",e.Concert="concert",e.Criteo="criteo",e.CriteoServer="crit_ss",e.GumGum="gumgum",e.ImproveDigital="improvedigital",e.ImproveDigitalServer="improve_ss",e.IndexExchange="ix",e.Kargo="kargo",e.KargoServer="krgo_ss",e.MediaGrid="grid",e.MediaGridVideo="gridvid",e.Nativo="nativo",e.OpenX="openx",e.Ogury="ogury",e.OpenXServer="opnx_ss",e.Ozone="ozone",e.Pubmatic="pubmatic",e.PubmaticServer="pubm_ss",e.ResetDigital="resetdigital",e.Rtbhouse="rtbhouse",e.Rubicon="rubicon",e.RubiconServer="rubi_ss",e.Seedtag="seedtag",e.Sharethrough="sharethrough",e.Teads="teads",e.Triplelift="triplelift",e.TripleliftServer="tripl_ss",e.TTD="ttd",e.Undertone="undertone",e.UndertoneServer="under_ss",e.Unruly="unruly",e.YahooSSP="yahoossp",e.YahooSSPServer="yah_ss",e.Verizon="verizon",e.Yieldmo="yieldmo",e.Flipp="flipp"}(ae||(ae={})),function(e){e.Prebid="prebid",e.GAM="gam",e.Amazon="amazon",e.Marmalade="marmalade",e.Floors="floors",e.CMP="cmp",e.Optable="optable",e.OptimalBidder="optimalBidder"}(oe||(oe={})),function(e){e.cm="cm",e.fbrap="fbrap",e.rapml="rapml"}(le||(le={})),function(e){e.lazy="lazy",e.raptive="raptive",e.refresh="refresh",e.session="session",e.crossDomain="crossdomain",e.highSequence="highsequence",e.lazyBidPool="lazyBidPool"}(de||(de={})),function(e){e.lazy="l",e.raptive="rapml",e.refresh="r",e.session="s",e.crossdomain="c",e.highsequence="hs",e.lazyBidPool="lbp"}(ce||(ce={})),function(e){e.Version="Version",e.SharingNotice="SharingNotice",e.SaleOptOutNotice="SaleOptOutNotice",e.SharingOptOutNotice="SharingOptOutNotice",e.TargetedAdvertisingOptOutNotice="TargetedAdvertisingOptOutNotice",e.SensitiveDataProcessingOptOutNotice="SensitiveDataProcessingOptOutNotice",e.SensitiveDataLimitUseNotice="SensitiveDataLimitUseNotice",e.SaleOptOut="SaleOptOut",e.SharingOptOut="SharingOptOut",e.TargetedAdvertisingOptOut="TargetedAdvertisingOptOut",e.SensitiveDataProcessing="SensitiveDataProcessing",e.KnownChildSensitiveDataConsents="KnownChildSensitiveDataConsents",e.PersonalDataConsents="PersonalDataConsents",e.MspaCoveredTransaction="MspaCoveredTransaction",e.MspaOptOutOptionMode="MspaOptOutOptionMode",e.MspaServiceProviderMode="MspaServiceProviderMode",e.SubSectionType="SubsectionType",e.Gpc="Gpc"}(he||(he={})),function(e){e[e.NA=0]="NA",e[e.OptedOut=1]="OptedOut",e[e.OptedIn=2]="OptedIn"}(ue||(ue={})),function(e){e.AdDensity="addensity",e.AdLayout="adlayout",e.FooterCloseButton="footerclose",e.Interstitial="interstitial",e.RemoveVideoTitleWrapper="removevideotitlewrapper",e.StickyOutstream="stickyoutstream",e.StickyOutstreamOnStickyPlayer="sospp",e.VideoAdvancePlaylistRelatedPlayer="videoadvanceplaylistrp",e.MobileStickyPlayerPosition="mspp"}(pe||(pe={})),function(e){e.Below_Post_1="Below_Post_1",e.Below_Post="Below_Post",e.Content="Content",e.Content_1="Content_1",e.Content_2="Content_2",e.Content_3="Content_3",e.Content_4="Content_4",e.Content_5="Content_5",e.Content_6="Content_6",e.Content_7="Content_7",e.Content_8="Content_8",e.Content_9="Content_9",e.Recipe="Recipe",e.Recipe_1="Recipe_1",e.Recipe_2="Recipe_2",e.Recipe_3="Recipe_3",e.Recipe_4="Recipe_4",e.Recipe_5="Recipe_5",e.Native_Recipe="Native_Recipe",e.Footer_1="Footer_1",e.Footer="Footer",e.Header_1="Header_1",e.Header_2="Header_2",e.Header="Header",e.Sidebar_1="Sidebar_1",e.Sidebar_2="Sidebar_2",e.Sidebar_3="Sidebar_3",e.Sidebar_4="Sidebar_4",e.Sidebar_5="Sidebar_5",e.Sidebar_9="Sidebar_9",e.Sidebar="Sidebar",e.Interstitial_1="Interstitial_1",e.Interstitial="Interstitial",e.Video_StickyOutstream_1="Video_StickyOutstream_1",e.Video_StickyOutstream="Video_StickyOutstream",e.Video_StickyInstream="Video_StickyInstream",e.Sponsor_Tile="Sponsor_Tile"}(ge||(ge={})),function(e){e.Desktop="desktop",e.Mobile="mobile"}(me||(me={})),function(e){e.Video_Collapse_Autoplay_SoundOff="Video_Collapse_Autoplay_SoundOff",e.Video_Individual_Autoplay_SOff="Video_Individual_Autoplay_SOff",e.Video_Coll_SOff_Smartphone="Video_Coll_SOff_Smartphone",e.Video_In_Post_ClicktoPlay_SoundOn="Video_In-Post_ClicktoPlay_SoundOn"}(_e||(_e={})),function(e){e.vpaidAdPlayError="vpaidAdPlayError",e.adError="adError",e.adLoaded="adLoaded"}(fe||(fe={})),function(e){e.Float="adthrive-collapse-float",e.Sticky="adthrive-collapse-sticky",e.Mobile="adthrive-collapse-mobile"}(ve||(ve={})),function(e){e.Small="adthrive-collapse-small",e.Medium="adthrive-collapse-medium"}(ye||(ye={})),function(e){e.BottomRight="adthrive-collapse-bottom-right"}(be||(be={})),function(e){e[e.Unstarted=0]="Unstarted",e[e.UncollapsedPlay=1]="UncollapsedPlay",e[e.CollapsedPlay=2]="CollapsedPlay",e[e.UserPauseUncollapsed=3]="UserPauseUncollapsed",e[e.UserPauseCollapsed=4]="UserPauseCollapsed",e[e.PausedNotVisible=5]="PausedNotVisible",e[e.Overlapped=6]="Overlapped",e[e.Closed=7]="Closed",e[e.NonLinearAdPlay=8]="NonLinearAdPlay",e[e.NonLinearAdPaused=9]="NonLinearAdPaused",e[e.NonLinearAdOverlapped=10]="NonLinearAdOverlapped",e[e.UserUnPaused=11]="UserUnPaused"}(Se||(Se={})),function(e){e[e.Play=0]="Play",e[e.UserClick=1]="UserClick",e[e.PageSwitch=2]="PageSwitch",e[e.OutOfView=3]="OutOfView",e[e.InView=4]="InView",e[e.Close=5]="Close",e[e.Overlapping=6]="Overlapping",e[e.OtherVideoPlaying=7]="OtherVideoPlaying"}(Ee||(Ee={})),function(e){e.None="none"}(Ce||(Ce={})),function(e){e.Default="default",e.AZ_Animals="5daf495ed42c8605cfc74b0b",e.Natashas_Kitchen="55bccc97303edab84afd77e2",e.RecipeTin_Eats="55cb7e3b4bc841bd0c4ea577",e.Sallys_Baking_Recipes="566aefa94856897050ee7303",e.Spend_With_Pennies="541917f5a90318f9194874cf"}(Te||(Te={}));const we={SIZE_640_360:[640,360],SIZE_400_225:[400,225]},Ae=["17","18","62"],ke="mgn",Ie=e=>"isAmazon"in e||"amzniid"in e||"amzniid_sp"in e,Pe="percent",Oe="flat",xe="pmp",Re="instream",De="default",Le="outstream",Me="stickyOutstream",Be="prebid",Fe="native",je="inBannerVideo",Ne={percent:1,flat:0},Ue=Ne.flat,Ve=Ne.percent,ze=[.1,5,20,100],$e=new Map([[.1,100],[5,20],[20,10],[100,2]]),He=(e,t,i)=>{var s;const r=+(null!=(s=null==e?void 0:e.percent)?s:Ve);var n;const a=+(null!=(n=null==e?void 0:e.flat)?n:Ue);var o;let l=+(null!=(o=null==t?void 0:t.percent)?o:Ve);var d;let c=+(null!=(d=null==t?void 0:t.flat)?d:Ue);if(i){var h;var u;l*=+(null!=(h=i.percent)?h:Ve),c+=+(null!=(u=i.flat)?u:Ue)}return l*=r,c+=a,{percent:l,flat:c}},qe=(e,t,i)=>{const{percent:s,flat:r}=He(e,t);return i*s-r},Ge=(e,t)=>{var i,s,r,n;return{percent:Number(null!=(i=e.percent)?i:1)*Number(null!=(s=t.percent)?s:1),flat:Number(null!=(r=e.flat)?r:0)+Number(null!=(n=t.flat)?n:0)}},Ke=(e,t)=>{const{mediaType:i,adUnitCode:s="",meta:r,vastUrl:n,vastXml:a}=t,o=e.video.instreamAdUnits.has(s),l=s.includes(ge.Video_StickyOutstream),d=!o&&(n||a||"video"===i)&&!l,c=null==r?void 0:r.isInBannerVideo;return o?Re:l?Me:d?Le:"native"===i?Fe:c?je:De},We=(e,t,i)=>{let s=i.mediaType||De;!Ie(i)&&(s=i.dealId&&"prebid"===t?xe:Ke(e,i));const r=e.partners.getBidderConfig(t);return r?r.cpmMap.get(e.partners.getBidderConfig(t).cpmMap.has(s)?s:De):Ne},Ye=(e,t,i)=>{let s,r=i.mediaType||De;Ie(i)||(r=Ke(e,i),s=i.bidderCode),t=t||s||"";const n=e.partners.getBidderConfig(t),a={...n.cpmMap.get(n.cpmMap.has(r)?r:De)||Ne};return r!==Le&&r!==je||((e,t)=>{!Ie(e)&&e.viewability&&(t.percent=(t.percent||1)*e.viewability)})(i,a),a},Qe=(e,t,i,s)=>{const{dealId:r,pmpConfig:n,dealConfig:a}=((e,t,i)=>{var s,r;const n=Ie(e)?e.amzndeal_sp:e.dealId,a=null==(s=t.partners.getBidderConfig(i).cpmMap)?void 0:s.get(xe);return{dealId:n,pmpConfig:a,dealConfig:a&&"deals"in a&&n?null==a||null==(r=a.deals)?void 0:r[n]:void 0}})(s,e,i);var o;const l=null!=(o=We(e,De,s))?o:{};var d;const c=null!=(d=We(e,Be,s))?d:{},h=Ge(l,c),u=((e,t,i)=>e&&t?He(Ne,t,i):void 0)(r,n,a);u&&(h.percent*=u.percent,h.flat+=u.flat);const p=Ye(e,i,s),g=qe(h,p,t);return Math.max(g,0)},Xe=(e,t,i,s,r=!1)=>{var n;const a=null!=(n=We(e,De,i))?n:{};var o;const l=null!=(o=We(e,Be,i))?o:{},d=Ye(e,t,i),c=He(a,d,{}),{percent:h,flat:u}=He(c,l),p=e.prebid.s2s.bidders.includes(t)||"server"===t,g=r?(s+u)/h:s*h-u,m=((e,t,i,s=!1)=>{var r;const n=null!=(r=We(e,De,i))?r:{},a=Ge(n,{}),o=s?(t+a.flat)/a.percent:t*a.percent-a.flat;return Math.max(o,0)})(e,s,i,r);return p?m:g},Je=(e,t,i,s,r=!0)=>{const n={adUnitCode:i.adUnitCode,...i.mediaTypes&&{mediaType:i.mediaTypes.banner?"banner":"video"},...i.viewability&&{viewability:i.viewability}};return Xe(e,t,n,s,r)},Ze=e=>{const t=ze.find((t=>e<=t))||100,i=$e.get(t);return(Math.floor(e*i)/i).toFixed(2)},et=(e,t,i,s,r)=>{var n;const a={...t};a.mediaType=r,a.isAmazon=!0,a.amzndeal_sp=(null==a?void 0:a.amzndeal_sp)||(null==(n=a.targeting)?void 0:n.amzndeal_sp);const o=Qe(e,s,i,a);return Math.max(o,0)},tt=e=>{const t={};return function(...i){const s=JSON.stringify(i);if(t[s])return t[s];const r=e.apply(this,i);return t[s]=r,r}},it=navigator.vendor,st=navigator.userAgent,rt=tt((e=>/Edge\/|Edg\//.test(e||st))),nt=tt((e=>/Firefox/.test(e||st))),at=tt((e=>/Trident|MSIE/.test(e||st))),ot=tt((e=>/Opera|OPR/.test(e||st))),lt=tt(((e,t)=>/Chrom/.test(e||st)&&/Google/.test(t||it)&&!rt(e)&&!ot(e))),dt=tt((e=>/Chrom|Applechromium/.test(e||st))),ct=tt(((e,t)=>/Safari/.test(e||st)&&/Apple Computer/.test(t||it)&&!rt(e)&&!ot(e))),ht=tt((()=>/WebKit/.test(st))),ut=tt(((e,t)=>lt(e,t)?"Chrome":ct(e,t)?"Safari":rt(e)?"Edge":nt(e)?"Firefox":ot(e)?"Opera":at(e)?"IE":"Others")),pt=tt(((e,t)=>{const i=ut(e||st,t||it);return"Chrome"===i?(e=>{const t=e.indexOf("Chrom");if(-1!==t){const i=t+7,s=e.indexOf(" ",i);return e.substring(i,s)}return null})(e||st):"Safari"===i?(e=>{const t=e.indexOf("Version/");if(-1!==t){const i=t+8,s=e.indexOf(" ",i);return e.substring(i,s)}const i=e.indexOf("Safari/");if(-1!==i){const t=i+7,s=e.indexOf(" ",t);return e.substring(t,s)}return null})(e||st):"Firefox"===i?(e=>{const t=e.indexOf("Firefox/");if(-1!==t){const i=t+8;let s=e.indexOf(" ",i);return-1===s&&(s=e.length),e.substring(i,s)}return null})(e||st):"Edge"===i?(e=>{const t=e.indexOf("Edg/");if(-1!==t){const i=t+4;let s=e.indexOf(" ",i);return-1===s&&(s=e.length),e.substring(i,s)}return null})(e||st):"IE"===i?(e=>{const t=e.indexOf("MSIE ");if(-1!==t){const i=t+5;let s=e.indexOf(";",i);return-1===s&&(s=e.length),e.substring(i,s)}})(e||st):"Opera"===i?(e=>{const t=e.indexOf("OPR/");if(-1!==t){const i=t+4,s=e.indexOf(" ",i);return e.substring(i,s)}return"Unknown"})(e||st):void 0})),gt=tt((()=>dt()?"chromium":ht()?"webkit":"other")),mt=(e=window.document)=>!!e.browsingTopics&&!!e.featurePolicy&&e.featurePolicy.allowsFeature("browsing-topics"),_t={"control_1.1":"disabled","control_1.2":"disabled","control_1.3":"disabled","control_1.4":"disabled",label_only_1:"disabled",label_only_2:"experiment",label_only_3:"experiment",label_only_4:"enabled",label_only_5:"enabled",control_2:"disabled","treatment_1.1":"enabled","treatment_1.2":"enabled","treatment_1.3":"enabled",none:"experiment"},ft=(e,t=0,i=!1,s=74)=>{if(!e.parentElement)return;if(t===s)return;const r=getComputedStyle(e.parentElement).overflow;"hidden"!==r&&"auto"!==r||(e.parentElement.style.overflow="visible",i||(i=!0,te.event("util","checkForOverflow","parent element with overflow detected"))),ft(e.parentElement,++t,i,s)},vt=()=>{const e=document.querySelector(".adthrive-footer");let t=52;return e&&"none"===e.style.display?t=102:e&&(t=Math.max(e.getBoundingClientRect().height,t)),t},yt=(e,t,i,s,r)=>{const n=document.createElement(e);return t&&n.setAttribute("id",t),i&&(n.className=i),s&&(n.innerHTML=s),r&&(n.href=r,"a"===e&&n.addEventListener("click",(e=>{e.preventDefault()}))),n},bt=(e,t)=>null==e||e!=e?t:e,St=e=>new Promise((t=>{setTimeout(t,e)})),Et=(e,t)=>{const i=window.innerWidth;return i>=t?"desktop":i>=e?"tablet":"phone"},Ct=()=>new Promise((e=>{if("interactive"===document.readyState||"complete"===document.readyState)return e();document.addEventListener("DOMContentLoaded",(()=>e()))})),Tt=(e,t)=>e.devices.includes(t),wt=(e,t)=>!e.disableAds.locations.has(t.location)&&!e.disableAds.all,At=e=>0===e.pageSelector.length||null!==document.querySelector(e.pageSelector),kt=e=>{let t=e.clientWidth;if(getComputedStyle){const i=getComputedStyle(e,null);t-=parseFloat(i.paddingLeft||"0")+parseFloat(i.paddingRight||"0")}return t},It=e=>{const t=e.offsetHeight,i=e.offsetWidth,s=e.getBoundingClientRect(),r=document.body,n=document.documentElement,a=window.pageYOffset||n.scrollTop||r.scrollTop,o=window.pageXOffset||n.scrollLeft||r.scrollLeft,l=n.clientTop||r.clientTop||0,d=n.clientLeft||r.clientLeft||0,c=Math.round(s.top+a-l),h=Math.round(s.left+o-d);return{top:c,left:h,bottom:c+t,right:h+i,width:i,height:t}},Pt=(e,t=50)=>{const i=e.getBoundingClientRect(),s=window.innerHeight||document.documentElement.clientHeight;return(i.bottom-s)/i.height*100>=t},Ot=(e,t=50)=>{const i=e.getBoundingClientRect();return(0-i.top)/i.height*100>=t},xt=e=>(e=>{const t=e.match(/([a-zA-Z0-9._!#$%+^&*()[\]<>-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);return t?t[0]:""})((e=>e.replace(/\s/g,""))(e.toLowerCase())),Rt=(e=window.location.search)=>{const t=0===e.indexOf("?")?1:0;return e.slice(t).split("&").reduce(((e,t)=>{const[i,s]=t.split("=");return e.set(i,s),e}),new Map)},Dt=e=>e.split("&").reduce(((e,t)=>{const[i,s]=t&&t.split("=");return i&&s&&(e[i]=s),e}),{}),Lt=e=>{let t={};const i=Rt().get(e);if(i)try{const s=decodeURIComponent(i).replace(/\+/g,"");t=JSON.parse(s),te.event("ExperimentOverridesUtil","getExperimentOverrides",e,t)}catch(e){}return t},Mt=(e,t,i)=>i.indexOf(e)===t,Bt=tt(((e=navigator.userAgent)=>/Windows NT|Macintosh/i.test(e))),Ft=(e=navigator.userAgent)=>/iP(hone|od|ad)/i.test(e),jt=(e,t=navigator.userAgent)=>Ft(t)&&((e,t=navigator.userAgent)=>new RegExp(`OS ${e}`,"i").test(t))(e.toString(),t),Nt="Facebook",Ut="Instagram",Vt="Pinterest",zt=new Map([[Nt,{ios:"com.facebook.Facebook",android:"com.facebook.katana"}],[Vt,{ios:"pinterest",android:"com.pinterest"}],[Ut,{ios:"com.burbn.instagram",android:"com.instagram.android"}]]),$t=()=>window.navigator.userAgent.includes("[Pinterest/iOS]")||window.navigator.userAgent.includes("[Pinterest/Android]"),Ht=()=>window.navigator.userAgent.includes("FBAN")||window.navigator.userAgent.includes("FBAV"),qt=()=>window.navigator.userAgent.includes("Instagram"),Gt=(e,t)=>{const i=Ht()?Nt:qt()?Ut:$t()?Vt:"",s=zt.get(i);if(s){const r=Ft()?s.ios:((e=navigator.userAgent)=>e.includes("android")||e.includes("Android"))()?s.android:"";if(!r)return;return{bundle:r,name:i,domain:e,content:t.content}}},Kt=()=>window.adthriveCLS,Wt=tt((()=>{const e=navigator.userAgent,t=/Tablet|iPad|Playbook|Nook|webOS|Kindle|Android (?!.*Mobile).*Safari|CrOS/i.test(e);return/Mobi|iP(hone|od)|Opera Mini/i.test(e)&&!t})),Yt=()=>{const e=navigator.userAgent;return/Tablet|iPad|Playbook|Nook|webOS|Kindle|Android (?!.*Mobile).*Safari/i.test(e)||!/iPhone/i.test(e)&&/Mac/i.test(e)&&(navigator.maxTouchPoints>0||"ontouchstart"in window)},Qt=[50,60,70,80],Xt=e=>Wt()&&e.location===ge.Content&&1===e.refreshCount?60:80,Jt=e=>e.refreshCount>0?Xt(e):e.viewability?Math.min(10*Math.floor(100*e.viewability/10),80):0,Zt=e=>Qt.includes(e)?e:0,ei=(e=new Date)=>{const t=e.getTimezoneOffset();return new Date(e.getTime()-60*t*1e3).toISOString().split("T")[0]},ti=e=>new Promise(((t,i)=>{fetch(e).then((e=>{e.json().then((e=>t(e))).catch((()=>i(!1)))})).catch((()=>i(!1)))})),ii=e=>{const t=e.split("."),i=t.length;return i>2&&(e=t[i-2]+"."+t[i-1],2!==t[i-2].length&&3!==t[i-2].length||2!==t[i-1].length||(e=t[i-3]+"."+e)),e},si=()=>{if(document.referrer&&document.referrer.length){const e=(e=>{const t=document.createElement("a");return t.href=e,t.hostname})(document.referrer);if(ii(e)!==ii(window.location.hostname))return e}},ri=e=>{const t=si();return bt(t,e)},ni="div #comments, section .comments",ai=(e,t=ni)=>{const i=e.querySelector(t);return i?e.offsetHeight-i.offsetHeight:e.offsetHeight},oi=(e,t,i=document)=>{const s=((e=document)=>{const t=e.querySelectorAll("article");if(0===t.length)return null;const i=Array.from(t).reduce(((e,t)=>t.offsetHeight>e.offsetHeight?t:e));return i&&i.offsetHeight>1.5*window.innerHeight?i:null})(i),r=s?[s]:[],n=[];e.forEach((e=>{const s=Array.from(i.querySelectorAll(e.elementSelector)).slice(0,e.skip);var a;(a=e.elementSelector,a.includes(",")?a.split(","):[a]).forEach((a=>{const o=i.querySelectorAll(a);for(let i=0;i<o.length;i++){const a=o[i];if(t.map.some((({el:e})=>e.isEqualNode(a))))continue;const l=a&&a.parentElement;l&&l!==document.body?r.push(l):r.push(a),-1===s.indexOf(a)&&n.push({dynamicAd:e,element:a})}}))}));const a=((e=document)=>(e===document?document.body:e).getBoundingClientRect().top)(i),o=n.sort(((e,t)=>e.element.getBoundingClientRect().top-a-(t.element.getBoundingClientRect().top-a)));return[r,o]},li=(e,t,i=document)=>{const[s,r]=oi(e,t,i);if(0===s.length)throw Error("No Main Content Elements Found");return[Array.from(s).reduce(((e,t)=>t.offsetHeight>e.offsetHeight?t:e))||document.body,r]},di=()=>{var e;const t=window.navigator.userAgent,i=(null==(e=window.navigator.userAgentData)?void 0:e.platform)||window.navigator.platform||"";return["macOS","Macintosh","MacIntel","MacPPC","Mac68K"].includes(i)?"macOS":["iPhone","iPad","iPod"].includes(i)?"iOS":["Win32","Win64","Windows","WinCE"].includes(i)?"windows":/Android/.test(t)?"android":/Linux/.test(i)?"linux":"other"},ci="e:",hi={KEY:"adt_i"},ui={KEY:"adt_ei"},pi={KEY:"adt_emsrc",VALUES:{AUTH:"auth",AUTH_BRIDGED:"authbr",GPID:"gpid",RCID:"rcid",SHID:"shid",LPID:"lpid",TD:"td",API:"api",URL:"url",URLH:"urlh",LOCAL_STORAGE:"l",COOKIE:"cki",COOKIE2:"c",NEWSLETTER:"nl",SLICKSTREAM:"ss",IDENTITY_IFRAME:"l_i",GRWM:"grwm",OTHER:"o"},PREFIXES:{IDG:"g_",IDENTITY_IFRAME:"l_i-",SLICKSTREAM:"ss_",RAPTIVE_AUTH:"ra_"},SUFFIXES:{CAPTURE:"_c",STORAGE:"_s"}},gi={KEY:"adt_emsrc_cd"},mi={KEY:"__lmpid"},_i=e=>"string"==typeof e&&!(e=>"string"==typeof e&&(e.includes(pi.PREFIXES.IDG)||["l_i","l_i-l_i"].includes(e)))(e),fi=e=>{const{source:t,identifierType:i}=e;return"truedata"===i?t.includes(`${pi.PREFIXES.IDG}${pi.VALUES.TD}`):t.includes(pi.PREFIXES.IDG)},vi=(e,t=!1,i=!1,s=!1)=>new Promise(((r,n)=>{const a=document.createElement("script");a.addEventListener("error",(()=>n(new Error(`Failed to import script ${e}`)))),a.addEventListener("load",(()=>r(a))),a.type="text/javascript",a.src=e,a.defer=i,a.async=s,((e,t)=>{const i=document.getElementsByTagName("script")[0];i&&i.parentNode&&!t?i.parentNode.insertBefore(e,i):document.body.appendChild(e)})(a,t)})),yi=(e,t,i)=>{const s=document.createElement("link");s.rel=t,s.href=e,i&&i.length&&i.forEach((e=>{s.setAttribute(e.name,e.value)})),document.head.appendChild(s)},bi=["Refresh","PD","Source","Browser","Topic","MCMP","Sens"],Si=(e,t,i=!1)=>{t.addToQueue((()=>{const s=t.getConfig("ix")||{firstPartyData:{}},r={...s.firstPartyData,...e},n={};bi.forEach((e=>{e in r&&(n[e]=r[e])}));for(const e in r)bi.includes(e)||(n[e]=r[e]);s.firstPartyData=n,i&&delete s.firstPartyData.Refresh,t.setConfig({ix:s})}))},Ei=e=>e?(e=>{const t={google:"google",facebook:"facebook",instagram:"instagram",pinterest:"pinterest"};return e.split(".").filter((e=>t[e]))[0]||"other"})(e):"direct",Ci=({event:e,ignoreOtherCompanyIds:t=!1})=>{const i=new Set([-1,0,1,199612376,2143809321]),s=new Set([4455444655,4460609902,4463579729,4464180925,4466143841,4550726766,4623743690,4623743882,4634020290,4642901988,4697115760,4801442281,4802163255,4805985973,4807636548,4867316569]),r=!e.campaignId||i.has(e.campaignId),n=!e.companyIds||e.companyIds&&!e.companyIds.some((e=>s.has(e)));return t?r:r&&n};class Ti{isSelenium(){return this.runTests()}constructor(){this.runTests=()=>{let e=!1;if(window&&document){e=["webdriver"in window,"_Selenium_IDE_Recorder"in window,"callSelenium"in window,"_selenium"in window,"__webdriver_script_fn"in document,"__driver_evaluate"in document,"__webdriver_evaluate"in document,"__selenium_evaluate"in document,"__fxdriver_evaluate"in document,"__driver_unwrapped"in document,"__webdriver_unwrapped"in document,"__selenium_unwrapped"in document,"__fxdriver_unwrapped"in document,"__webdriver_script_func"in document,null!==document.documentElement.getAttribute("selenium"),null!==document.documentElement.getAttribute("webdriver"),null!==document.documentElement.getAttribute("driver")].some((e=>e))}return e}}}const wi=()=>{if(navigator&&navigator.webdriver)return"wdv"},Ai=()=>{if(navigator&&navigator.hardwareConcurrency>32)return"hwv"},ki=()=>{if(navigator&&navigator.userAgent&&(()=>{const e=window.navigator.userAgent.toLowerCase();return["python","apis","googleweblight","spider","crawler","curl","wget","ia_archiver","insights","baidu","bot","monitor","scraper","A6-Indexer","addthis","admantx","agentslug","alexa","anderspink","apache-httpclient","apachebench","apis-google","appengine-google","ask jeeves","asynchttpclient","awe.sm","baidu","barkrowler","biglotron","bingpreview","brandverify","bubing","butterfly","buzztalk","cf-uc","chatgpt","check_http","cloudflare","cmradar/0.1","coldfusion","comodo ssl checker","convera","copypants","crowsnest","curl","dap/nethttp","daumoa","developers.google.com/+/web/snippet/","digitalpersona fingerprint software","drupact","duckduck","elb-healthchecker","embedly","eoaagent","europarchive","eventmachine httpclient","evrinid","exaleadcloudview","ezooms","ez publish","facebookexternalhit","feedburner","feedfetcher-google","findlink","findthatfile","flipboardproxy","garlik","genieo","getprismatic.com","ghost","gigablast","go http package","google page speed insights","google web preview","google-site-verification","google-structured-data-testing-tool","google-structureddatatestingtool","gpt","gptbot","hatena","headless","heritrix","htmlparser","http(_request2|client|s|unit)","httrack","hubspot","ichiro","icoreservice","idmarch","in(agist|sieve|stapaper)","ips-agent","jack","jakarta commons","java","jetslide","jobseeker","js-kit","kimengi","knows.is","kraken","laconica","libwww","lighthouse","linode","lipperhey","longurl","ltx71","lwp-trivial","mappydata","mastodon","mediapartners-google","megaindex.ru","metauri","mfe_expand","mixnode","mon(tastic|tools)","moreover","mrchrome","nberta","net(craft|researchserver|state|vibes)","newrelicpinger","newspaper","newsme","ning","nightmare","nmap","nutch","online-domain-tools","openai","paessler","page(peek|sinventory|thing)","panopta","peerindex","phantomjs","pingdom","plukkie","proximic","pu_in","publiclibraryarchive.org","python-(httplib2|requests|urllib)","quanti","queryseeker","quicklook","qwanti","re-animator","readability","rebelmouse","relateiq","riddler","rssmicro","ruby","scrapy","seo-audit","seodiver","seokicks","shopwiki","shortlinktranslate","siege","sistrix","site24x7","siteexplorer","skypeuripreview","slack","slurp","socialrank","sogou","spinn3r","squider","statuscake","stripe","summify","teeraid","teoma","test certificate info","tineye","traackr","tweetedtimes","twikle","twitjobsearch","twitmunin","twurly","typhoeus","unwindfetch","uptim(e|ia)","uptm.io","vagabondo","vb project","vigil","vkshare","wappalyzer","watchsumo","webceo","webdatascout","webmon","webscout","wesee","wget","whatsapp","whatweb","wikido","wordpress","wormly","wotbox","xenu link sleuth","xing-contenttabreceiver","yandex","yanga","yeti","yff35","yourls","zelist.ro","zibb","^Mozilla/5\\.0$","Viv/2"].some((t=>e.includes(t)))})())return"uav"},Ii=()=>{const e={width:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)};if(e.width>5e3||e.height>5e3)return"vpv"},Pi=()=>{const e=document.createElement("canvas"),t=e.getContext&&e.getContext("webgl"),i=t&&t.getExtension&&t.getExtension("WEBGL_debug_renderer_info");if(i&&i.UNMASKED_RENDERER_WEBGL){if("Google SwiftShader"===(t&&t.getParameter(i.UNMASKED_RENDERER_WEBGL)))return"wglv"}},Oi=()=>{if((new Ti).isSelenium())return"selenium"},xi=()=>{let e=0;try{const t=K.getLocalStorageValue("fpv");t&&(e=Date.now()-Date.parse(t));if(!t||e>864e5)return!0}catch(e){}return!1},Ri=e=>!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length),Di=e=>!Ri(e),Li=e=>0===e.indexOf("hbs-q"),Mi=(e,t,i)=>{switch(t){case pe.AdDensity:return((e,t)=>{const i=e.adDensityEnabled,s=e.adDensityLayout.pageOverrides.find((e=>!!document.querySelector(e.pageSelector)&&(e[t].onePerViewport||"number"==typeof e[t].adDensity)));return!i||!s})(e,i);case pe.StickyOutstream:return(e=>{var t,i,s;const r=null==(s=e.videoPlayers)||null==(i=s.partners)||null==(t=i.stickyOutstream)?void 0:t.blockedPageSelectors;return!r||!document.querySelector(r)})(e);case pe.Interstitial:return(e=>{const t=e.adOptions.interstitialBlockedPageSelectors;return!t||!document.querySelector(t)})(e);default:return!0}},Bi=(e,t)=>{if(e.length<=1)return 0;if(e.sort(((e,t)=>e-t)),t<=0)return e[0];if(t>=1)return e[e.length-1];const i=t*(e.length+1),s=Math.floor(i)-1,r=s+1,n=Number((i%1).toFixed(1));return i<1?e[0]:r>=e.length?e[s]:e[s]+n*(e[r]-e[s])},Fi=(e,t=33)=>{const i=Object.keys(e).reduce(((i,s)=>{const r=e[s].map((e=>((e,t)=>parseInt(e,t)/1e5)(e,t)));return{...i,[s]:[...r]}}),{});return i},ji=(e,t=33)=>{const i=Object.keys(e).reduce(((i,s)=>{const r=e[s].map((e=>((e,t)=>Math.floor(1e5*e).toString(t))(e,t)));return{...i,[s]:r}}),{});return i},Ni=e=>{if("string"!=typeof e&&"number"!=typeof e||"string"==typeof e&&isNaN(parseInt(e,10))||"number"==typeof e&&isNaN(e))return"E";const t=Date.now(),i="string"==typeof e?parseInt(e,10):e,s=Math.floor((t-i)/864e5);return s<=1?"1":s<=2?"2":s<=3?"3":s<=4?"4":s<=14?"14":"15"},Ui=e=>{if(e)return e.includes(".")?`i4:${e}`:e.includes(":")?`i6:${e}`:void 0},Vi=()=>new Promise((e=>{if("complete"===document.readyState)return e();window.addEventListener("load",(()=>e()))})),zi=(e,t)=>{e.length>=t&&e.splice(Math.floor(Math.random()*e.length),1)},$i=e=>e.split("#")[0],Hi=["CA","CT","UT","VA","WA"],qi=e=>{const t=document.getElementsByTagName("meta");return!!Array.from(t).filter((t=>t.name===e&&"true"===t.content)).length},Gi=()=>qi("child-directed-treatment"),Ki=e=>{let t=!1;return e&&(t=Hi.includes(e)),qi("health-directed-treatment")&&t},Wi=()=>(new Date).getTimezoneOffset()<(()=>{const e=new Date((new Date).getFullYear(),0,1),t=new Date((new Date).getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())})(),Yi=()=>Date.now(),Qi=(e,t)=>{if("Intl"in window){const t=Intl.DateTimeFormat().resolvedOptions().timeZone;return e.some((e=>t===e))}return t.some((e=>(new Date).getTimezoneOffset()===(Wi()?e-60:e)))},Xi=(e,t)=>{var i;i=t,(t=Array.isArray(i)?i:[i]).forEach((t=>{e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)}))},Ji=e=>void 0!==e,Zi=(e,t)=>!(!e||"object"!=typeof e||!(t in e)),es=(e,t)=>{if(t)for(const t of window.pbjs.getUserIdsAsEids())if(t.source&&t.source===e&&t.uids&&t.uids.length>0&&t.uids[0].id)return t.uids[0].id;return null},ts=e=>{const t=window.location.href;return e.some((e=>new RegExp(e,"i").test(t)))},is=e=>{try{return{valid:!0,elements:document.querySelectorAll(e)}}catch(e){return{valid:!1,...e}}},ss=e=>""===e?{valid:!0}:is(e),rs=(e,t)=>{if(!e)return!1;const i=!!e.enabled,s=null==e.dateStart||Date.now()>=e.dateStart,r=null==e.dateEnd||Date.now()<=e.dateEnd,n=null===e.selector||""!==e.selector&&!!document.querySelector(e.selector),a="mobile"===e.platform&&"mobile"===t,o="desktop"===e.platform&&"desktop"===t,l=null===e.platform||"all"===e.platform||a||o,d="bernoulliTrial"===e.experimentType?1===e.variants.length:(e=>{const t=e.reduce(((e,t)=>t.weight?t.weight+e:e),0);return e.length>0&&e.every((e=>{const t=e.value,i=e.weight;return!(null==t||"number"==typeof t&&isNaN(t)||!i)}))&&100===t})(e.variants);return d||te.error("SiteTest","validateSiteExperiment","experiment presented invalid choices for key:",e.key,e.variants),i&&s&&r&&n&&l&&d},ns=["siteId","siteName","adOptions","breakpoints","adUnits"],as=(e,t=ns)=>{if(!e)return!1;for(let i=0;i<t.length;i++)if(!e[t[i]])return!1;return!0};window.adthrive.windowPerformance=window.adthrive.windowPerformance||new class{resetTimeOrigin(){this._timeOrigin=window.performance.now()}now(){try{return Math.round(window.performance.now()-this._timeOrigin)}catch(e){return 0}}constructor(){this._timeOrigin=0}};const os=window.adthrive.windowPerformance,ls=os.now.bind(os),ds=(e,t,i,s,r,n)=>{const a=Math.round(n-r),o=[],l=[];o.push("(",i.map((()=>"%o")).join(", "),")"),l.push(...i),void 0!==s&&(o.push(" => %o"),l.push(s)),o.push(` %c(${a}ms)`),l.push("color: #999;")},cs=(e,t,i)=>{const s=void 0!==i.get?i.get:i.value;return function(...i){try{const r=ls(),n=s.apply(this,i);if(n instanceof Promise)return n.then((e=>{const t=ls();return ds(0,0,i,e,r,t),Promise.resolve(e)})).catch((i=>{throw i.logged||(te.error(e,t,i),i.logged=!0),i}));{const e=ls();return ds(0,0,i,n,r,e),n}}catch(i){throw i.logged||(te.error(e,t,i),i.logged=!0),i}}},hs=(e,t=!1)=>i=>{const s=Object.getOwnPropertyNames(i.prototype).filter((e=>t||0!==e.indexOf("_"))).map((e=>[e,Object.getOwnPropertyDescriptor(i.prototype,e)]));for(const[t,r]of s)void 0!==r&&"function"==typeof r.value?i.prototype[t]=cs(e,t,r):void 0!==r&&void 0!==r.get&&"function"==typeof r.get&&Object.defineProperty(i.prototype,t,{...r,get:cs(e,t,r)})},us=()=>(e,t,i)=>{const s=i.value;s&&(i.value=function(...e){const t=(e=>{if(null===e)return null;const t=e.map((({choice:e})=>e));return(e=>{let t=5381,i=e.length;for(;i;)t=33*t^e.charCodeAt(--i);return t>>>0})(JSON.stringify(t)).toString(16)})(this._choices),i=this._expConfigABGroup?this._expConfigABGroup:this.abgroup,r=i?i.toLowerCase():this.key?this.key.toLowerCase():"",n=t?`${r}_${t}`:r,a=this.localStoragePrefix?`${this.localStoragePrefix}-${n}`:n,o=K.getLocalStorageValue("branch");!1===(o&&o.enabled)&&K.removeLocalStorageValue(a);const l=(()=>s.apply(this,e))(),d=(c=this._choices,h=l,null!=(p=null==(u=c.find((({choice:e})=>e===h)))?void 0:u.weight)?p:null);var c,h,u,p;const[g,m]=q(K,a,l,d,864e5);return this._stickyResult=g,this._stickyWeight=m,g})},ps="0123456789ABCDEFGHJKMNPQRSTVWXYZ",gs=Math.pow(2,48)-1,ms=e=>{let t=Math.floor(32*e());return 32===t&&(t=31),ps.charAt(t)},_s=(e,t)=>{if(isNaN(e))throw new Error(`${e} must be a number`);if(e>gs)throw(e=>{const t=new Error(e);return t.source="ulid",t})(`cannot encode time greater than ${gs}`);let i,s="";for(;t>0;t--)i=e%32,s=ps.charAt(i)+s,e=(e-i)/32;return s},fs=()=>_s(Date.now(),10)+((e,t)=>{let i="";for(;e>0;e--)i=ms(t)+i;return i})(16,(()=>(()=>{if(window.crypto){const e=new Uint8Array(1);return crypto.getRandomValues(e),e[0]/255}return Math.random()})())),vs=e=>new Promise((t=>setTimeout(t,e))),ys=async({condition:e,delay:t=500,maxAttempts:i=10,executedAttempts:s=0})=>{if(!e()){if(s>=i)throw new Error("Max waitFor attempts reached without resolution");return await vs(t),await ys({condition:e,delay:t,maxAttempts:i,executedAttempts:s+1})}};class bs{getBidWithBsidForSlot(e,t){const i=e.filter((e=>e.meta&&e.meta.dchain)),s=new RegExp(`${t.location}_${t.sequence}(?!d)`,"i");for(let t=e.length-1;t>=0;t--){const{adUnitCode:r,meta:n}=e[t];if(s.test(r)&&this.getLastBsid(n))return i[t]}}getLastBsid(e={}){const{dchain:t}=e,i=t&&t.nodes||[];for(let e=i.length-1;e>=0;e--)if(i[e].bsid)return i[e].bsid}}bs=B([hs("DemandChain"),L()],bs);class Ss{addAdUnits(e){this.addToQueue((()=>{window.pbjs.addAdUnits(e)}))}getPrebidAdUnits(){return window.pbjs&&window.pbjs.adUnits}addToQueue(e){window.pbjs.que.push(e)}enableAnalytics(e){this.addToQueue((()=>{window.pbjs.enableAnalytics(e)}))}isPrebidLoaded(){return window.pbjs&&window.pbjs.libLoaded}getVersion(){return window.pbjs&&window.pbjs.version||"nl"}markWinningBidAsUsed(e){this.addToQueue((()=>{window.pbjs.markWinningBidAsUsed(e)}))}offEvent(e,t){this.addToQueue((()=>{window.pbjs.offEvent(e,t)}))}onEvent(e,t){this.addToQueue((()=>{window.pbjs.onEvent(e,t)}))}refreshUserIds(e,t){this.addToQueue((()=>{window.pbjs.refreshUserIds(e,t)}))}requestBids(e){this.addToQueue((()=>{window.pbjs.requestBids(e)}))}setAliasBidder(e,t,i){this.addToQueue((()=>{i?window.pbjs.aliasBidder(e,t,i):window.pbjs.aliasBidder(e,t)}))}setBidderConfig(e,t=!1){this.addToQueue((()=>{window.pbjs.setBidderConfig(e,t)}))}setBidderSettings(e){this.addToQueue((()=>{window.pbjs.bidderSettings=e}))}setBidsReceivedFilter(e){this.addToQueue((()=>{window.pbjs.setBidsReceivedFilter(e)}))}setConfig(e){this.addToQueue((()=>{window.pbjs.setConfig(e)}))}setTargetingForGPTAsync(e,t=null,i="",s,r,n){this.addToQueue((()=>{window.pbjs.setTargetingForGPTAsync(e,t,i,s,r,n)}))}triggerUserSyncs(){this.addToQueue((()=>{window.pbjs.triggerUserSyncs()}))}registerSignalSources(){this.addToQueue((()=>{window.pbjs.registerSignalSources()}))}clearTargetingForSharedBidPool(e){this.addToQueue((()=>{window.pbjs.clearTargetingForSharedBidPool(e)}))}renderAd(e,t){this.addToQueue((()=>{window.pbjs.renderAd(e,t)}))}clearAllAuctions(){this.addToQueue((()=>{window.pbjs.clearAllAuctions()}))}waitForQueue(){return new Promise((e=>{this.isPrebidLoaded()||e(!1),window.pbjs.que.push((()=>{e(!0)}))}))}getBidResponsesForAdUnitCode(e){return window.pbjs.getBidResponsesForAdUnitCode(e)}getUserIdsAsEids(){return window.pbjs.getUserIdsAsEids()}getUserIdsAsEidBySource(e){return window.pbjs.getUserIdsAsEidBySource(e)}getBidResponsesForBidPoolId(e){return pbjs.getBidResponsesForBidPoolId(e)}getAdserverTargetingForAdUnitCode(e,t){return window.pbjs.getAdserverTargetingForAdUnitCode(e,t)}getAllPrebidWinningBids(){return window.pbjs.getAllPrebidWinningBids()}getConfig(e,t){return t?window.pbjs.getConfig(e,t):window.pbjs.getConfig(e)}getHighestCpmBids(e){return window.pbjs.getHighestCpmBids(e)}getHighestCpmBidsForPoolId(e){return window.pbjs.getHighestCpmBidsForPoolId(e)}getUserIds(){return window.pbjs.getUserIds()}getUserIdsAsync(){return new Promise((e=>{this.isPrebidLoaded()||e(!1),window.pbjs.getUserIdsAsync().then((t=>e(t))).catch((()=>{}))}))}removeAdUnit(e){return window.pbjs.removeAdUnit(e)}removeAllAdUnits(){var e;const t=[...null!=(e=pbjs.adUnits)?e:[]];return window.pbjs.adUnits=[],t}updateAdUnit(e,t){var i;const s=null==(i=window.pbjs.adUnits)?void 0:i.find((t=>t.code===e));s&&Object.assign(s,t)}setPAAPIConfigForGPT(e){return window.pbjs.setPAAPIConfigForGPT(e)}}class Es extends J{constructor(...e){super(...e),this.addSlots=new Q,this.requestingBids=new Q,this.preRequestBids=new Q,this.refreshingBids=new Q,this.beforeGoogleAdManagerRefreshSlots=new Q,this.addPrebidSlotTargeting=new Q,this.displaySlot=new Q,this.triggerRenderOutsideGam=new Q,this.adRenderingOutsideGAM=new Q,this.adRenderedOutsideGAM=new Q,this.googleAdManagerFallbackDivAdded=new Q,this.amazonBidResponseReceived=new Q,this.noBidResponses=new Q,this.auctionsCompleted=new Q,this.gamEmptyNoBidResponse=new Q}}Es=B([M()],Es);class Cs{get enabled(){return!0}}class Ts{constructor(e){this.prefix="AdThrive",this.networkCode="18190176",this._gamMCMEnabled=bt(e.siteAds.adOptions.gamMCMEnabled,!1),this._gamMCMChildNetworkCode=bt(e.siteAds.adOptions.gamMCMChildNetworkCode,""),this.account=this._gamMCMEnabled&&""!==this._gamMCMChildNetworkCode?`${this.networkCode},${this._gamMCMChildNetworkCode}`:this.networkCode;const t=new Set(["service","bidding","dynamicVersion"]);this.targeting=e.siteAds.targeting.length&&e.siteAds.targeting.filter((({key:e})=>!t.has(e))).map((({key:e,value:t})=>("boolean"==typeof t&&(t=String(t)),{key:e,value:t})))||[]}}Ts=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],Ts);class ws{hasValidOverride(e,t){if(e in this.adthriveExperimentOverrides){const i=this.adthriveExperimentOverrides[e];return this.isValidExperimentOverride(t,i)}return!1}useOverride(e){return this.adthriveExperimentOverrides[e]}isValidExperimentOverride(e,t){if(0===e.length)return!1;const i=Array.isArray(e[0])?"array":typeof e[0];if("array"===i){if(!Array.isArray(t))return!1;if(t.some((t=>!e.includes(t)))&&t.map((e=>"["+JSON.stringify(e)+"]")).some((t=>!e.map((e=>JSON.stringify(e))).includes(t)))&&!e.map((e=>JSON.stringify(e))).includes(JSON.stringify(t)))return!1}else if("object"===i){if(!e.map((e=>JSON.stringify(e))).includes(JSON.stringify(t)))return!1}else if(!e.includes(t))return!1;return!0}constructor(){this.adthriveExperimentOverrides=Lt("at_features")}}ws=B([M(),j("design:type",Function),j("design:paramtypes",[])],ws);class As{constructor(){this.shouldUseCoreExperimentsConfig=!0;const e=this.run.bind(this);this.run=()=>{var t;const i=R.resolve(ws),s=null==(t=this._choices)?void 0:t.map((e=>e.choice)),r=this._expConfigABGroup?this._expConfigABGroup:this.abgroup?this.abgroup:this.key;return s&&i.hasValidOverride(r,s)?i.useOverride(r):e()}}}class ks{}class Is extends ks{get(){if(this._probability<0||this._probability>1)throw new Error(`Invalid probability: ${this._probability}`);return Math.random()<this._probability}constructor(e){super(),this._probability=e}}class Ps extends ks{static fromArray(e,t){return new Ps(e.map((([e,t])=>({choice:e,weight:t}))),t)}addChoice(e,t){this._choices.push({choice:e,weight:t})}get(){const e=(t=0,i=100,Math.random()*(i-t)+t);var t,i;let s=0;for(const{choice:t,weight:i}of this._choices)if(s+=i,s>=e)return t;return this._default}get totalWeight(){return this._choices.reduce(((e,{weight:t})=>e+t),0)}constructor(e=[],t){super(),this._choices=e,this._default=t}}class Os extends J{constructor(...e){super(...e),this.libraryLoadFailed=new X}}Os=B([M()],Os);class xs extends J{constructor(){super(),this.topicsReceived=new X}}xs=B([M(),j("design:type",Function),j("design:paramtypes",[])],xs);class Rs extends J{constructor(...e){super(...e),this.act25consentCaptured=new X}}Rs=B([M()],Rs);class Ds extends J{constructor(...e){super(...e),this.footerElementAdded=new X,this.comscoreInitialized=new X,this.footerHeightChanged=new Q,this.footerRefreshed=new Q}}Ds=B([M()],Ds);class Ls extends J{constructor(...e){super(...e),this.dataCaptured=new X,this.dataCapturedForIframe=new X,this.dataSentFromIframe=new Q,this.iframeReady=new X,this.iframeDataSynced=new X,this.optableResolved=new X,this.optableIdentitiesCaptured=new X,this.optableTraitsCaptured=new X}}Ls=B([M()],Ls);class Ms extends J{constructor(){super(),this.adRenderFailed=new Q,this.adRenderSucceeded=new Q,this.auctionDebug=new Q,this.auctionEnd=new Q,this.auctionInit=new Q,this.beforeRequestBids=new Q,this.bidRequested=new Q,this.bidWon=new Q,this.initialized=new Q,this.rubiconBidError=new Q,this.setTargeting=new Q,this.staleRender=new Q,this.tcf2Enforcement=new Q,this.vastExceededLimit=new Q}}Ms=B([M(),j("design:type",Function),j("design:paramtypes",[])],Ms);class Bs extends J{constructor(...e){super(...e),this.iframeReady=new X}}Bs=B([M()],Bs);class Fs extends J{constructor(...e){super(...e),this.userIdNeedsRefresh=new Q,this.uid2Refreshed=new Q}}Fs=B([M()],Fs);class js extends J{constructor(){super(),this.marmaladeResponseLoaded=new X,this.recencyFrequencyDataSet=new X,this.resetMarmaladeData=new Q}}js=B([M(),j("design:type",Function),j("design:paramtypes",[])],js);class Ns extends J{constructor(...e){super(...e),this.routeChanged=new Q,this.resetCompleted=new Q}}Ns=B([M()],Ns);class Us extends J{constructor(...e){super(...e),this.targetingReady=new Q}}Us=B([M()],Us);class Vs{constructor(){this.added=new Q,this.cleared=new Q,this.displayed=new Q,this.displaying=new Q,this.refreshed=new Q,this.refreshing=new Q,this.refreshAuctionStart=new Q,this.refreshingBids=new Q,this.refreshedBids=new Q,this.requestingBids=new Q,this.requestedBids=new Q}}Vs=B([M()],Vs);class zs extends J{constructor(...e){super(...e),this.videoAdUnitAdded=new Q,this.videoPlayerAdded=new Q,this.videoCollapsed=new Q,this.videoUnCollapsed=new Q,this.preRequestVideoBids=new Q,this.requestingVideoBids=new Q,this.addAPStagSlotBidResponse=new Q,this.topCenterVideoClosed=new Q,this.topCenterVideoCollapsed=new Q,this.topCenterVideoUnCollapsed=new Q,this.amazonVideoBidResponseReceived=new Q,this.auctionsCompleted=new Q}}zs=B([M()],zs);class $s extends J{constructor(...e){super(...e),this.realizedAdDensityCompReady=new Q,this.metricsRequested=new Q}}$s=B([M()],$s);class Hs{get result(){return this._isTargeted||(this._siteExperimentEventBus.targetingReady.emit(),this._isTargeted=!0),this._result}get enabled(){return void 0!==this.experimentConfig}_isValidResult(e,t=()=>!0){return t()&&H(e)}constructor(){this._siteExperimentEventBus=R.resolve(Us),this._isTargeted=!1}}class qs extends Hs{_isValidResult(e){return super._isValidResult(e,(()=>this._resultValidator(e)||"control"===e))}run(){if(!this.experimentConfig)return te.error("WeightedChoiceSiteExperiment","run","No experiment config found"),"control";if(!this._mappedChoices||0===this._mappedChoices.length)return te.error("WeightedChoiceSiteExperiment","run","No experiment config found"),"control";const e=new Ps(this._mappedChoices).get();return this._isValidResult(e)?e:(te.error("WeightedChoiceSiteExperiment","run","Invalid result from experiment choices. Defaulting to control.",e),"control")}constructor(...e){super(...e),this._resultValidator=()=>!0}}class Gs{getSiteExperimentByKey(e){const t=this.siteExperiments.filter((t=>t.key.toLowerCase()===e.toLowerCase()))[0],i=Lt("at_site_features"),s=(r=(null==t?void 0:t.variants[1])?null==t?void 0:t.variants[1].value:null==t?void 0:t.variants[0].value,n=i[e],typeof r==typeof n);var r,n;return t&&i[e]&&s&&(t.variants=[{displayName:"test",value:i[e],weight:100,id:0}]),t}constructor(e){var t,i;this.siteExperiments=[],this._device=Wt()?"mobile":"desktop",this.siteExperiments=null!=(i=null==e||null==(t=e.siteExperiments)?void 0:t.filter((t=>{const i=t.key,s=rs(t,this._device),r=Mi(e,i,this._device);return s&&r})))?i:[]}}class Ks extends Gs{getVideoPlaylistByType(e){var t,i;return null!=(i=null==(t=this._players)?void 0:t.filter((t=>t.type===e)))?i:[]}constructor(e){var t;super(e.siteAds),this._players=null==(t=e.siteAds.videoPlayers)?void 0:t.players}}Ks=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],Ks);class Ws extends As{get result(){return this._result}run(){return this._sensCategories.filter((()=>new Is(.01).get()))}constructor(e){super(),this.key="SensOff",this.abgroup="SensOffExperiment",this._choices=[],this._sensCategories=bt(e.siteAds.adOptions.sensitiveCategories,[]),this._choices=this._sensCategories.map((e=>({choice:[e]}))),this._result=this.run()}}Ws=B([hs("SensOffExperiment"),M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],Ws);class Ys{constructor(e,t){var i,s;this._sensOffExperiment=t,this.enableCategoriesNetworkWide=["drg","conl"],this.disableCategoriesNetworkWide=["dlu"],this.id=e.siteAds.siteId,this.name=e.siteAds.siteName,this.verticals=e.siteAds.adOptions.verticals,this.sensitiveCategories=bt(e.siteAds.adOptions.sensitiveCategories,[]).filter((e=>!this.enableCategoriesNetworkWide.includes(e)&&!this.disableCategoriesNetworkWide.includes(e))),this.sensCategoriesOff=this._sensOffExperiment.result,this.filteredSensitiveCategories=this.sensitiveCategories.filter((e=>-1===this.sensCategoriesOff.indexOf(e))),this.breakpoints=e.siteAds.breakpoints,this.style=e.style,this.spa=bt(e.siteAds.adOptions.spa,!1),this.deployedCloudflareVersion=null!=(s=null==(i=e.siteAds.cloudflare)?void 0:i.version)?s:null}}Ys=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Ws?Object:Ws])],Ys);class Qs{set(e,t){this.setAbGroup&&this._map.set(e,t)}get(e){return this._map.get(e)}get groups(){const e=[];for(const[t,i]of this._map)Array.isArray(i)?i.forEach((i=>{e.push(`${t}:${i}`)})):e.push(`${t}:${i}`);return e}get groupsAsObject(){const e={};for(const t of this._map.keys()){const i=this._map.get(t);i&&(e[t]=i)}return e}constructor(){this._map=new Map,this.setAbGroup=!Rt().has("at_features")}}Qs=B([M(),j("design:type",Function),j("design:paramtypes",[])],Qs);class Xs extends Qs{}Xs=B([M()],Xs);class Js{getCoreExperimentButMutateWeights(e){const t=this._validExperiments.find((({key:t})=>t===e));return"bernoulliTrial"===(null==t?void 0:t.type)&&(t.variants[0].weight=t.variants[0].weight/100),t}getCoreExperiment(e){return this._validExperiments.find((({key:t})=>t===e))}getAllMatchingCoreExperiments(e){return this._validExperiments.filter((({label:t})=>null==t?void 0:t.includes(e)))}getWeightedChoiceVariants(e){const t=this.getCoreExperimentButMutateWeights(e);return t&&"weightedChoice"===t.type?t.variants.map((e=>({choice:e.value,weight:e.weight,...e.abvalue?{abvalue:e.abvalue}:{}}))):null}getMultivalueBernoulliVariants(e){const t=this.getCoreExperimentButMutateWeights(e);return t&&"multivalueBernoulliTrial"===t.type?t.variants.map((e=>({choice:e.value,weight:e.weight}))):null}getMultivalueWeightedChoiceVariants(e){const t=this.getCoreExperimentButMutateWeights(e);return t&&"multivalueWeightedChoice"===t.type?t.variants.map((e=>({choice:e.value,options:e.choices.map((e=>({choice:e.value,weight:e.weight,...e.abvalue&&{abvalue:e.abvalue}})))}))):null}_getValidExperiments(e=[]){return e.filter((({type:e,variants:t,key:i})=>"weightedChoice"===e?this._isValidWeightedChoice(t,i):"bernoulliTrial"===e?this._isValidBernoulliTrial(t,i):"multivalueBernoulliTrial"===e?this._isValidMultivalueBernoulliTrial(t,i):"multivalueWeightedChoice"===e&&this._isValidMultivalueWeightChoiceTrial(t,i)))}_isValidWeightedChoice(e,t){const i=(e=>{let t=0;return e.forEach((e=>{e.weight&&(t+=e.weight)})),e.length>0&&e.every((e=>!(!e.hasOwnProperty("value")||!e.hasOwnProperty("weight"))))&&100===t})(e);return i||this._invalidExperiment(t),i}_isValidBernoulliTrial(e,t){const i=1===e.length;return i||this._invalidExperiment(t),i}_isValidMultivalueBernoulliTrial(e,t){const i=(s=e).length>0&&s.every((e=>!(!e.hasOwnProperty("value")||!e.hasOwnProperty("weight"))));var s;return i||this._invalidExperiment(t),i}_isValidMultivalueWeightChoiceTrial(e,t){const i=(s=e).length>0&&s.every((e=>{let t=0,i=!(!e.value||!e.choices);for(const s of e.choices||[]){if(!s.hasOwnProperty("weight")||!s.hasOwnProperty("value")){i=!1;break}t+=s.weight}return!(!i||100!==t)}));var s;return i||this._invalidExperiment(t),i}_invalidExperiment(e){te.error("CoreExperimentConfig","_invalidExperiment","Experiment Validation failed for key: ",e)}constructor(e){this._validExperiments=this._getValidExperiments(e).map((e=>({...e,_expConfigABGroup:e.abgroup}))),this.coreExperiments=this._validExperiments.map((({variants:e,abgroup:t,key:i})=>({variants:e,abgroup:t,key:i})))}}Js=B([M(),F(0,D("CoreExperimentValues")),j("design:type",Function),j("design:paramtypes",[Array])],Js);const Zs="You need to set \"this._key\" in the init method for this experiment. The code should look something like this:\n\n  protected init() {\n    this._key = 'my_key';\n  }";class er extends As{get _choices(){return null}get key(){if(!this._key)throw new Error(Zs);return this._key}_isMultiValueChoice(e){return"multivalueWeightedChoice"===this._type}_isGenericChoice(e){return"multivalueWeightedChoice"!==this._type}_isMultiValueResult(e){return"multivalueWeightedChoice"===this._type}_isGenericResult(e){return"multivalueWeightedChoice"!==this._type}_runAndSetABGroup(){const e=this._choices;if(e){const t=this._result=this.run();if(void 0===t)return;this._isMultiValueResult(t)&&this._isMultiValueChoice(e)?this._setMultivalueABGroup(e,t):this._isGenericResult(t)&&this._isGenericChoice(e)&&this._setStandardABGroup(e,t)}return this._result}_setStandardABGroup(e,t){const i=e.filter((({choice:e})=>e===t))[0],s=i&&i.abvalue||t;if(this._setAbGroup&&void 0!==s){var r;const e=null!=(r=null==i?void 0:i.weight)?r:-1,t=this.getResultWeight(s,e);100!==t&&this.setABGroup(s,void 0,t)}}_setMultivalueABGroup(e,t){const i=[],s=this._experiment;if(!s)return;const r={};e.forEach((e=>{const t=`${e.choice}`;r[t]||(r[t]=[]),e.options.forEach((e=>{const i=Array.isArray(e.choice)?e.choice.join("%7C"):`${e.choice}`;r[t].push({weight:e.weight,option:i,abvalue:e.abvalue})}))})),t.forEach((e=>{if(r[e.choice])for(const t of r[e.choice]){(Array.isArray(e.option)?e.option.join("%7C"):`${e.option}`)===t.option&&100!==t.weight&&i.push(`${e.choice}_${t.abvalue||t.option}@${t.weight}`)}})),i.length&&this.abgroupClass.set(s.abgroup,i)}getResultWeight(e,t=-1){const i=this._experiment;if(!i)return-1;if("bernoulliTrial"===i.type){const t=i.variants[0].weight;return e?t:100-t}if("multivalueBernoulliTrial"===i.type){const e=new Map;return i.variants.forEach((t=>{e.set(t.value,t.weight)})),e}return t}setABGroup(e,t,i){const s=this._experiment;var r;const n=null!=(r=this._stickyWeight)?r:i;if(s)if(Array.isArray(e)){const i=e.filter((e=>"number"==typeof n?100!==n:n&&100!==n.get(e))).map((e=>`${e}@${"number"==typeof n?n:n&&n.get(e)||0}`));this.abgroupClass.set(t||s.abgroup,i)}else this.abgroupClass.set(t||s.abgroup,`${e}@${n}`)}init(){throw new Error(Zs)}get result(){return!1===this._autorun&&void 0===this._result&&void 0===this.abgroupClass.get(this.key)&&(this._result=this._runAndSetABGroup()),this._result}isEnabled(){if(this.shouldUseCoreExperimentsConfig){return!!(this._experiment=this._coreExperimentConfig.getCoreExperiment(this.key))}return!0}constructor(e,t){super(),this.abgroupClass=e,this._coreExperimentConfig=t,this._setAbGroup=!0,this._autorun=!0,this.init();const i=this._experiment=this._coreExperimentConfig.getCoreExperiment(this.key);this._type=(null==i?void 0:i.type)||"Unknown",this.isEnabled()&&(this._expConfigABGroup=null==i?void 0:i.abgroup,this._autorun&&this._runAndSetABGroup())}}er=B([F(0,D(Qs)),F(1,D(Js)),j("design:type",Function),j("design:paramtypes",[void 0===Qs?Object:Qs,void 0===Js?Object:Js])],er);class tr extends er{get _choices(){const e=this._coreExperimentConfig.getMultivalueBernoulliVariants(this.key);return!e||e.length,e}run(){const e=this._choices;if(e){const t=e.filter((e=>new Is(e.weight/100).get())).map((e=>e.choice));t.length&&(this._result=t)}return this._result||this._default}get choices(){return this._choices}}class ir extends tr{init(){this._setAbGroup=!0,this._key="S2S",this._default=["none"]}}ir=B([hs("S2SExperiment"),M()],ir);class sr extends er{get _choices(){const e=this._coreExperimentConfig.getWeightedChoiceVariants(this.key);return!e||e.length,e}run(){if(this._choices)return new Ps(this._choices).get()}}class rr extends sr{init(){this._key="AuctionDelay_2"}get result(){return this._result}}rr=B([hs("AuctionDelayExperiment"),M()],rr);class nr extends er{get _choices(){var e;const t=null==(e=this._coreExperimentConfig.getCoreExperiment(this.key))?void 0:e.variants;return t?[{choice:!0,weight:t[0].weight},{choice:!1,weight:100-t[0].weight}]:[{choice:!0,weight:-1},{choice:!1,weight:-1}]}run(){const e=this._coreExperimentConfig.getCoreExperiment(this.key);if(e){const t=e.variants[0];return new Is(t.weight/100).get()}}setABGroup(e,t){const i=this._coreExperimentConfig.getCoreExperiment(this.key);let s,r;if(i){const n=i.variants[0];void 0!==this._stickyResult&&void 0!==this._stickyWeight?(s=this._stickyResult?"on":"off",r=this._stickyWeight):(s=e?"on":"off",r=e?n.weight:100-n.weight),100!==r&&0!==r&&this.abgroupClass.set(t||i.abgroup,`${s}@${r}`)}}get result(){if(void 0===this._default)throw new Error("You need to set \"this._default\" in the init method for this experiment. The code should look something like this:\n  protected init() {\n    this._key = 'my_key';\n    this._default = false;\n  }");var e;return!1===this._autorun&&void 0===this._result&&void 0===this.abgroupClass.get(this.key)&&(this._result=this._runAndSetABGroup()),null!=(e=this._result)?e:this._default}}class ar extends nr{init(){this._key="OrtbEnrich",this._default=!1}}ar=B([hs("OrtbEnrichExperiment"),M()],ar);class or extends sr{init(){this._key="CriteoDoubleRequest"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],or.prototype,"run",null),or=B([hs("CriteoDoubleRequest"),M()],or);class lr extends sr{init(){this._key="Kargo"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],lr.prototype,"run",null),lr=B([hs("KargoExperiment"),M()],lr);class dr extends sr{init(){this._key="OpenX"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],dr.prototype,"run",null),dr=B([hs("OpenXExperiment"),M()],dr);class cr extends sr{init(){this._key="Triplelift"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],cr.prototype,"run",null),cr=B([hs("TripleLiftExperiment"),M()],cr);class hr extends sr{init(){this._key="YahooSSP"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],hr.prototype,"run",null),hr=B([hs("YahooSSPExperiment"),M()],hr);class ur extends sr{init(){this._key="MultistagePrebidAuctionDisplay2"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ur.prototype,"run",null),ur=B([hs("MultistagePrebidAuctionExperiment"),M()],ur);const pr=new Map([[ae.Adform,{enabled:!0,nameFromAdmin:"adform"}],[ae.AidemServer,{enabled:!0,nameFromAdmin:ae.Aidem}],[ae.AmazonASR,{enabled:!1,nameFromAdmin:"amazonASR"}],[ae.AmazonUAM,{enabled:!0,nameFromAdmin:"amazonUAM"}],[ae.AppNexus,{enabled:!0,nameFromAdmin:"appNexus"}],[ae.Colossus,{enabled:!0}],[ae.Concert,{enabled:!1}],[ae.Conversant,{enabled:!0}],[ae.Criteo,{enabled:!0}],[ae.GumGum,{enabled:!0}],[ae.ImproveDigital,{enabled:!0}],[ae.IndexExchange,{enabled:!0,nameFromAdmin:"indexExchange"}],[ae.Kargo,{enabled:!0}],[ae.MediaGrid,{enabled:!0,nameFromAdmin:"mediaGrid"}],[ae.MediaGridVideo,{enabled:!0,nameFromAdmin:"mediaGrid"}],[ae.Nativo,{enabled:!0}],[ae.OpenX,{enabled:!0}],[ae.Ozone,{enabled:!1}],[ae.Pubmatic,{enabled:!0,nameFromAdmin:"pubMatic"}],[ae.ResetDigital,{enabled:!0}],[ae.Rtbhouse,{enabled:!0}],[ae.Rubicon,{enabled:!0}],[ae.Sharethrough,{enabled:!0}],[ae.Teads,{enabled:!0}],[ae.ThirtyThreeAcross,{enabled:!0,nameFromAdmin:"thirtyThreeAcross"}],[ae.Triplelift,{enabled:!0,nameFromAdmin:"tripleLift"}],[ae.TTD,{enabled:!0,nameFromAdmin:"theTradeDesk"}],[ae.Undertone,{enabled:!0}],[ae.UndertoneServer,{enabled:!0}],[ae.Unruly,{enabled:!0}],[ae.YahooSSP,{enabled:!0}],[ae.Yieldmo,{enabled:!0}],[ae.Flipp,{enabled:!1}]]),gr=new Map([[ae.Adform,!0],[ae.AidemServer,!1],[ae.AmazonASR,!1],[ae.AmazonUAM,!0],[ae.AppNexus,!1],[ae.Colossus,!0],[ae.Concert,!1],[ae.Conversant,!1],[ae.Criteo,!0],[ae.GumGum,!0],[ae.ImproveDigital,!0],[ae.IndexExchange,!1],[ae.Kargo,!0],[ae.MediaGrid,!0],[ae.MediaGridVideo,!0],[ae.Nativo,!0],[ae.OpenX,!1],[ae.Ozone,!1],[ae.Pubmatic,!0],[ae.ResetDigital,!0],[ae.Rtbhouse,!0],[ae.Rubicon,!0],[ae.Sharethrough,!0],[ae.Teads,!0],[ae.ThirtyThreeAcross,!0],[ae.Triplelift,!0],[ae.TTD,!0],[ae.Undertone,!0],[ae.Unruly,!0],[ae.YahooSSP,!0],[ae.Yieldmo,!0],[ae.Flipp,!1]]),mr=new Map([[ae.Adform,!0],[ae.AidemServer,!1],[ae.AmazonUAM,!0],[ae.AppNexus,!0],[ae.Colossus,!0],[ae.Criteo,!0],[ae.GumGum,!0],[ae.ImproveDigital,!0],[ae.IndexExchange,!0],[ae.Kargo,!0],[ae.MediaGridVideo,!0],[ae.OpenX,!0],[ae.Pubmatic,!0],[ae.ResetDigital,!0],[ae.Rubicon,!0],[ae.Sharethrough,!0],[ae.ThirtyThreeAcross,!0],[ae.Triplelift,!0],[ae.TTD,!0],[ae.Unruly,!0],[ae.UndertoneServer,!0],[ae.YahooSSP,!0]]),_r=[{choice:ae.ThirtyThreeAcross,weight:.0033},{choice:ae.AppNexus,weight:.0033},{choice:ae.ColossusServer,weight:.0033},{choice:ae.Colossus,weight:.0033},{choice:ae.Concert,weight:33e-5},{choice:ae.Conversant,weight:33e-5},{choice:ae.GumGum,weight:33e-5},{choice:ae.ImproveDigitalServer,weight:.0033},{choice:ae.IndexExchange,weight:.0033},{choice:ae.Kargo,weight:33e-5},{choice:ae.KargoServer,weight:0},{choice:ae.MediaGrid,weight:.0033},{choice:ae.Nativo,weight:33e-5},{choice:ae.OpenX,weight:.0033},{choice:ae.OpenXServer,weight:.0033},{choice:ae.Ozone,weight:.0033},{choice:ae.Pubmatic,weight:.0033},{choice:ae.PubmaticServer,weight:.0033},{choice:ae.Rtbhouse,weight:33e-5},{choice:ae.Rubicon,weight:.0033},{choice:ae.RubiconServer,weight:.0033},{choice:ae.Sharethrough,weight:33e-5},{choice:ae.Triplelift,weight:.00158},{choice:ae.TripleliftServer,weight:.00236},{choice:ae.TTD,weight:.0033},{choice:ae.Undertone,weight:33e-5},{choice:ae.Unruly,weight:.0033},{choice:ae.YahooSSP,weight:.0033},{choice:ae.YahooSSPServer,weight:.0033},{choice:ae.Yieldmo,weight:.0033},{choice:ae.AidemServer,weight:.0033}];class fr{getBidderConfig(e,t=!0){const i={bidder_name:e,enabled:t,cpmMap:new Map};return bt(this._biddersCoreConfig.get(e),i)}get bidderPriceAdjustments(){return this._bidderPriceAdjustments}_enableConfiantPriceAdjustments(){const e=[De,Le,Me];this._setBidderPriceAdjustments(_r,e,Oe)}_setBidderPriceAdjustments(e,t,i){e&&t.forEach((t=>{e.forEach((e=>this._setBidderPriceAdjustmentMap(e,t,i)))}))}_enableLiveIntentPriceAdjustments(e){const t=e.filter((e=>lt()?"Chrome"===e.browser:"Not Chrome"===e.browser)).map((e=>({choice:e.bidder,weight:e.multiplier/100,browser:e.browser})));t.forEach((e=>{(e.weight<0||e.weight>1)&&this._invalidBidAdjustments.push({source:"LiveIntent",bidder:e.choice,value:e.weight})})),this._setBidderPriceAdjustments(t,this.configTypes,Pe)}_setBidderPriceAdjustmentMap(e,t,i){if(!e||t===xe)return;const{choice:s,weight:r}=e,n=this._bidderPriceAdjustments[e.choice];if(n){const s=n.get(t);if(s){var a;const e=null!=(a=s.percent)?a:1;var o;const l=Number(null!=(o=s.flat)?o:0),d=i===Pe?Number(r)*e:e,c=i===Oe?Number(r)+l:l;n.set(t,{percent:d,flat:c})}else n.set(t,{[i]:e.weight})}else this._bidderPriceAdjustments[s]=new Map([[t,{[i]:e.weight}]])}_displayPartnerEnabled(e){var t,i,s;const r=(null==(t=pr.get(e))?void 0:t.nameFromAdmin)||e,n=r?bt(this._adOptions[r],gr.get(e)):void 0,a=bt(null==(i=this._biddersCoreConfig.get(e))?void 0:i.enabled,null==(s=pr.get(e))?void 0:s.enabled);return e===ae.AmazonUAM||e===ae.AmazonASR?n:!!n&&!!a}_videoPartnerEnabled(e){var t,i,s;const r=(null==(t=pr.get(e))?void 0:t.nameFromAdmin)||e,n=bt(this._videoPartners[r],mr.get(e)),a=bt(null==(i=this._biddersCoreConfig.get(e))?void 0:i.enabled,null==(s=pr.get(e))?void 0:s.enabled);return!!n&&!!a}_createCPMMap(e,t){const i=bt(e.enabled,!0);let s=new Map;if(t){const t=e.cpm,i=this._prepareCPMConfigs(t);t.forEach((t=>{"percent"===t.type&&(t.value<0||t.value>1)&&this._invalidBidAdjustments.push({source:"BidderCoreConfig",bidder:e.bidder_name,value:t.value})})),i.forEach((t=>{s.set(t.name,this._convertToCPMPriceAdjustments(t,e.bidder_name))}))}else s=e.cpm;this._biddersCoreConfig.set(e.bidder_name,{bidder_name:e.bidder_name,enabled:i,cpmMap:s})}_prepareCPMConfigs(e){var t;const i=null!=(t=e.find((e=>e.name===De)))?t:{name:De,type:Pe,value:Ne.percent},s=[];return this.configTypes.forEach((t=>{const r=e.find((e=>e.name===t));r?s.push(r):s.push({...i,name:t})})),s}_isCPMConfigLegacy(e){var t;const i=null==e||null==(t=e[0])?void 0:t.cpm;return i&&Array.isArray(i)}_convertToCPMPriceAdjustments(e,t){return e.name===xe?this._convertToCMPPriceAdjustmentPMP(e,t):this._convertToCMPPriceAdjustment(e,t)}_convertToCMPPriceAdjustmentPMP(e,t){const i=this._convertToCMPPriceAdjustment(e,t);return e.deals&&(i.deals={},e.deals.forEach((e=>{i.deals[e.name]=this._convertToCMPPriceAdjustment(e,t,!1)}))),i}_convertToCMPPriceAdjustment(e,t,i=!0){const s={},r=e.name,n=this._getBidderPriceAdjustment(t,r,i);let a=1,o=0;return e.type===Pe?a*=e.value:e.type===Oe&&(o+=e.value),s.percent=a*n.percent,s.flat=o+Number(n.flat),s}_getBidderPriceAdjustment(e,t,i=!0){if(!i)return{...Ne};const s=this._bidderPriceAdjustments,r=s[e]&&s[e].get(s[e].has(t)?t:De)||{};return{...Ne,...r}}_getDisplayBidders(){return new Map([[ae.Adform,this._displayPartnerEnabled(ae.Adform)],[ae.Aidem,this._displayPartnerEnabled(ae.AidemServer)],[ae.AppNexus,this._displayPartnerEnabled(ae.AppNexus)],[ae.Concert,this._displayPartnerEnabled(ae.Concert)],[ae.Colossus,this._displayPartnerEnabled(ae.Colossus)],[ae.Conversant,this._displayPartnerEnabled(ae.Conversant)],[ae.Criteo,this._displayPartnerEnabled(ae.Criteo)],[ae.ImproveDigital,this._displayPartnerEnabled(ae.ImproveDigital)],[ae.IndexExchange,this._displayPartnerEnabled(ae.IndexExchange)],[ae.GumGum,this._displayPartnerEnabled(ae.GumGum)],[ae.Kargo,this._displayPartnerEnabled(ae.Kargo)],[ae.MediaGrid,this._displayPartnerEnabled(ae.MediaGrid)],[ae.MediaGridVideo,this._displayPartnerEnabled(ae.MediaGridVideo)],[ae.Nativo,this._displayPartnerEnabled(ae.Nativo)],[ae.OpenX,this._displayPartnerEnabled(ae.OpenX)],[ae.Ozone,this._displayPartnerEnabled(ae.Ozone)],[ae.Pubmatic,this._displayPartnerEnabled(ae.Pubmatic)],[ae.ResetDigital,this._displayPartnerEnabled(ae.ResetDigital)],[ae.Rtbhouse,this._displayPartnerEnabled(ae.Rtbhouse)],[ae.Rubicon,this._displayPartnerEnabled(ae.Rubicon)],[ae.Sharethrough,this._displayPartnerEnabled(ae.Sharethrough)],[ae.Teads,this._displayPartnerEnabled(ae.Teads)],[ae.ThirtyThreeAcross,this._displayPartnerEnabled(ae.ThirtyThreeAcross)],[ae.Triplelift,this._displayPartnerEnabled(ae.Triplelift)],[ae.TTD,this._displayPartnerEnabled(ae.TTD)],[ae.Undertone,this._displayPartnerEnabled(ae.Undertone)],[ae.Unruly,this._displayPartnerEnabled(ae.Unruly)],[ae.YahooSSP,this._displayPartnerEnabled(ae.YahooSSP)],[ae.Yieldmo,this._displayPartnerEnabled(ae.Yieldmo)],[ae.AmazonUAM,this._displayPartnerEnabled(ae.AmazonUAM)],[ae.AmazonASR,this._displayPartnerEnabled(ae.AmazonASR)],[ae.Flipp,this._displayPartnerEnabled(ae.Flipp)]])}_getVideoBidders(){return new Map([[ae.Adform,this._videoPartnerEnabled(ae.Adform)],[ae.Aidem,this._videoPartnerEnabled(ae.AidemServer)],[ae.AmazonUAM,this._videoPartnerEnabled(ae.AmazonUAM)],[ae.AppNexus,this._videoPartnerEnabled(ae.AppNexus)],[ae.Colossus,this._videoPartnerEnabled(ae.Colossus)],[ae.Criteo,this._videoPartnerEnabled(ae.Criteo)],[ae.GumGum,this._videoPartnerEnabled(ae.GumGum)],[ae.ImproveDigital,this._videoPartnerEnabled(ae.ImproveDigital)],[ae.IndexExchange,this._videoPartnerEnabled(ae.IndexExchange)],[ae.Kargo,this._videoPartnerEnabled(ae.Kargo)],[ae.MediaGridVideo,this._videoPartnerEnabled(ae.MediaGridVideo)],[ae.OpenX,this._videoPartnerEnabled(ae.OpenX)],[ae.Pubmatic,this._videoPartnerEnabled(ae.Pubmatic)],[ae.ResetDigital,this._videoPartnerEnabled(ae.ResetDigital)],[ae.Rubicon,this._videoPartnerEnabled(ae.Rubicon)],[ae.Sharethrough,this._videoPartnerEnabled(ae.Sharethrough)],[ae.ThirtyThreeAcross,this._videoPartnerEnabled(ae.ThirtyThreeAcross)],[ae.Triplelift,this._videoPartnerEnabled(ae.Triplelift)],[ae.TTD,this._videoPartnerEnabled(ae.TTD)],[ae.Unruly,this._videoPartnerEnabled(ae.Unruly)],[ae.UndertoneServer,this._videoPartnerEnabled(ae.Undertone)],[ae.YahooSSP,this._videoPartnerEnabled(ae.YahooSSP)],[ae.Yieldmo,this._videoPartnerEnabled(ae.Yieldmo)]])}constructor(e){var t,i,s,r,n;this.adthrive=e,this.configTypes=[De,Re,Fe,Le,xe,Me,je],this._biddersCoreConfig=new Map,this._optableGlobalDiscount="US"===(null==(t=this.adthrive.core)?void 0:t.country)?.003:0,this._defaultGlobalDiscount=.0147+this._optableGlobalDiscount,this._instreamGlobalDiscount=.16+this._defaultGlobalDiscount,this._globalPriceAdjustments=new Map([[De,{flat:this._defaultGlobalDiscount}],[Re,{flat:this._instreamGlobalDiscount}]]),this._prebidPriceAdjustments=new Map([[De,{flat:0}],[Re,{flat:0}],[xe,{flat:0}]]),this._bidderPriceAdjustments={ix:new Map([[xe,{flat:.05}]])},this._invalidBidAdjustments=[];const a=null==(i=e.siteAds.videoPlayers)?void 0:i.partners,o=null==(s=e.siteAds.video)?void 0:s.partners,l=De,d=Be;if(this._adOptions=e.siteAds.adOptions,this._videoPartners=a||o||{},null==(n=e.core)||null==(r=n.partners)?void 0:r.length){const t=this._isCPMConfigLegacy(e.core.partners);this._enableConfiantPriceAdjustments(),e.core.liveIntent&&this._enableLiveIntentPriceAdjustments(e.core.liveIntent),e.core.partners.forEach((e=>{e.bidder_name&&this._createCPMMap(e,t)})),this._biddersCoreConfig.set(l,{bidder_name:l,enabled:!0,cpmMap:this._globalPriceAdjustments}),this._biddersCoreConfig.set(d,{bidder_name:d,enabled:!0,cpmMap:this._prebidPriceAdjustments})}this._invalidBidAdjustments.length>0&&te.error("Partners","constructor","Invalid bid adjustments detected",this._invalidBidAdjustments),this.display=this._getDisplayBidders(),this.video=this._getVideoBidders()}}fr=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],fr);class vr extends sr{init(){this._key="MultistageServer"}run(){return super.run()}}vr=B([hs("MultistageServerExperiment"),M()],vr);const yr=new Map([["20sf1",["ttd","appnexus","rtbhouse","teads","kargo","gridvid","col_ss","rubi_ss","tripl_ss","pubm_ss","yah_ss","improve_ss","krgo_ss","opnx_ss","under_ss"]],["20sf2",["ozone","under_ss","33across","nativo","triplelift","grid","undertone","opnx_ss","yieldmo","col_ss","unruly","yah_ss","pubm_ss","krgo_ss","improve_ss","tripl_ss","rubi_ss"]],["20scf",["appnexus","teads","kargo","pubmatic","ix","ttd","rubicon","pubm_ss","yieldmo","yahoossp","yah_ss","colossus","undertone","unruly","opnx_ss","krgo_ss"]]]);class br extends sr{init(){this._key="MultistagePrebidAuctionV2"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],br.prototype,"run",null),br=B([hs("MultistagePrebidAuctionVideoExperiment"),M()],br);class Sr extends nr{init(){this._key="MissingNativeParams",this._default=!1}}Sr=B([hs("NativeParamsExperiment"),M()],Sr);class Er{get siteFeatureRollouts(){return this._featureRollouts}isRolloutEnabled(e){return!(!this._featureRollouts||!this._featureRollouts[e])&&this._featureRollouts[e].enabled}getSiteRolloutConfig(e){var t;return this.isRolloutEnabled(e)&&null!=(t=this._featureRollouts[e].data)?t:{}}constructor(){this._featureRollouts={}}}let Cr=class extends Er{constructor(e){super(),this._featureRollouts=e.siteAds.featureRollouts||{}}};Cr=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],Cr);const Tr=()=>{(()=>{var e;const t=navigator.userAgent,i=navigator.vendor;if(!ct(t,i))return!1;const s=(null==(e=/ Version\/(1\d)\.(\d+)/.exec(t))?void 0:e.slice(-2))||[],r="14"===s[0],n="15"===s[0]&&+s[1]<4;return r||n})()&&window.addEventListener("beforeunload",(()=>{window.addEventListener("visibilitychange",(e=>{e.stopImmediatePropagation()}),!0)}),!0)};class wr{setupOnceEvent(e,t,i=window){const s=()=>{i.removeEventListener(e,s),t()};i.addEventListener(e,s)}setupOnceEventWithPromise(e,t=window){return new Promise((i=>{const s=r=>(t.removeEventListener(e,s),i(r));t.addEventListener(e,s)}))}addEventListener(e,t,i=window){i.addEventListener(e,(()=>{t.emit()}),!1)}constructor(){this.beforeUnload=new Q,this.pageHide=new Q,this.resize=new Q,this.scroll=new Q,this.visibilityChange=new Q,this.keydown=new Q,this.addEventListener("beforeunload",this.beforeUnload),this.addEventListener("pagehide",this.pageHide),this.addEventListener("resize",this.resize),this.addEventListener("scroll",this.scroll),this.addEventListener("visibilitychange",this.visibilityChange,document),this.addEventListener("keydown",this.keydown,document),Tr()}}wr=B([hs("PageManager"),M(),j("design:type",Function),j("design:paramtypes",[])],wr);const Ar=["mcmpfreqrec"];const kr=new class extends N{init(e){this._gdpr="true"===e.gdpr,this._shouldQueue=this._gdpr}clearQueue(e){e&&(this._shouldQueue=!1,this._sessionStorageHandlerQueue.forEach((e=>{this.setSessionStorage(e.key,e.value)})),this._localStorageHandlerQueue.forEach((e=>{e.expiry?"internal"===e.type?this.setExpirableInternalLocalStorage(e.key,e.value):this.setExpirableExternalLocalStorage(e.key,e.value):"internal"===e.type?this.setInternalLocalStorage(e.key,e.value):this.setExternalLocalStorage(e.key,e.value)})),this._cookieHandlerQueue.forEach((e=>{"internal"===e.type?this.setInternalCookie(e.key,e.value):this.setExternalCookie(e.key,e.value)}))),this._sessionStorageHandlerQueue=[],this._localStorageHandlerQueue=[],this._cookieHandlerQueue=[]}readInternalCookie(e){return this._verifyInternalKey(e),this._readCookie(e)}readExternalCookie(e){return this._readCookie(e)}readInternalLocalStorage(e){return this._verifyInternalKey(e),this._readFromLocalStorage(e)}readExternalLocalStorage(e){return this._readFromLocalStorage(e)}readSessionStorage(e){const t=window.sessionStorage.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch(e){return t}}deleteCookie(e){document.cookie=`${e}=; SameSite=None; Secure; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`}deleteLocalStorage(e){window.localStorage.removeItem(e)}deleteSessionStorage(e){window.sessionStorage.removeItem(e)}setInternalCookie(e,t,i){this._verifyInternalKey(e),this._setCookieValue("internal",e,t,i)}setExternalCookie(e,t,i){this._setCookieValue("external",e,t,i)}setInternalLocalStorage(e,t){if(this._verifyInternalKey(e),this._gdpr&&this._shouldQueue){const i={key:e,value:t,type:"internal"};this._localStorageHandlerQueue.push(i)}else{const i="string"==typeof t?t:JSON.stringify(t);window.localStorage.setItem(e,i)}}setExternalLocalStorage(e,t){if(this._gdpr&&this._shouldQueue){const i={key:e,value:t,type:"external"};this._localStorageHandlerQueue.push(i)}else{const i="string"==typeof t?t:JSON.stringify(t);window.localStorage.setItem(e,i)}}setExpirableInternalLocalStorage(e,t,i){this._verifyInternalKey(e);try{const n={value:t,created:Date.now()};var s;const a=null!=(s=null==i?void 0:i.expiry)?s:{value:400,unit:"days"};var r;const o=null!=(r=null==i?void 0:i.resetOnRead)&&r;if(this._gdpr&&this._shouldQueue){const t={key:e,value:JSON.stringify(n),type:"internal",expiry:a,resetOnRead:o};this._localStorageHandlerQueue.push(t)}else{const i={value:t,expires:this._getExpiryDate(a),expiryInfo:a,resetOnRead:o};window.localStorage.setItem(e,JSON.stringify(i))}}catch(e){console.error(e)}}setExpirableExternalLocalStorage(e,t,i){try{const n={value:t,created:Date.now()};var s;const a=null!=(s=null==i?void 0:i.expiry)?s:{value:400,unit:"days"};var r;const o=null!=(r=null==i?void 0:i.resetOnRead)&&r;if(this._gdpr&&this._shouldQueue){const t={key:e,value:JSON.stringify(n),type:"external",expiry:a,resetOnRead:o};this._localStorageHandlerQueue.push(t)}else{const i={value:t,expires:this._getExpiryDate(a),expiryInfo:a,resetOnRead:o};window.localStorage.setItem(e,JSON.stringify(i))}}catch(e){console.error(e)}}setSessionStorage(e,t){if(this._gdpr&&this._shouldQueue){const i={key:e,value:t};this._sessionStorageHandlerQueue.push(i)}else{const i="string"==typeof t?t:JSON.stringify(t);window.sessionStorage.setItem(e,i)}}_getExpiryDate({value:e,unit:t}){const i=new Date;return"minutes"===t?i.setTime(i.getTime()+60*e*1e3):"hours"===t?i.setTime(i.getTime()+60*e*60*1e3):"days"===t?i.setTime(i.getTime()+24*e*60*60*1e3):"months"===t&&i.setTime(i.getTime()+30*e*24*60*60*1e3),i.toUTCString()}_resetExpiry(e,t,i){return t.expires=this._getExpiryDate(t.expiryInfo),e.setItem(i,JSON.stringify(t)),t}_readCookie(e){const t=document.cookie.split("; ").find((t=>t.split("=")[0]===e));if(!t)return null;const i=t.split("=")[1];if(i)try{return JSON.parse(decodeURIComponent(i))}catch(e){return decodeURIComponent(i)}return null}_readFromLocalStorage(e){const t=window.localStorage.getItem(e);if(!t)return null;try{const s=JSON.parse(t);if(s.resetOnRead&&s.expires){const t=this._resetExpiry(window.localStorage,s,e);var i;return null!=(i=t.value)?i:t}if(s.expires&&(new Date).getTime()>new Date(s.expires).getTime())return window.localStorage.removeItem(e),null;if(!s.value)return s;try{return JSON.parse(s.value)}catch(e){return s.value}}catch(e){return t}}_setCookieValue(e,t,i,s){try{if(this._gdpr&&this._shouldQueue){const s={key:t,value:i,type:e};this._cookieHandlerQueue.push(s)}else{var r;const e=this._getExpiryDate(null!=(r=null==s?void 0:s.expiry)?r:{value:400,unit:"days"});var n;const o=null!=(n=null==s?void 0:s.sameSite)?n:"None";var a;const l=null==(a=null==s?void 0:s.secure)||a,d="object"==typeof i?JSON.stringify(i):i;document.cookie=`${t}=${d}; SameSite=${o}; ${l?"Secure;":""} expires=${e}; path=/`}}catch(e){}}_verifyInternalKey(e){const t=e.startsWith("adthrive_"),i=e.startsWith("adt_");if(!t&&!i&&!Ar.includes(e))throw new Error('When reading an internal cookie, the key must start with "adthrive_" or "adt_" or be part of the allowed legacy keys.')}constructor(...e){super(...e),this.name="BrowserStorage",this.disable=!1,this.gdprPurposes=[1],this._sessionStorageHandlerQueue=[],this._localStorageHandlerQueue=[],this._cookieHandlerQueue=[],this._shouldQueue=!1}},Ir=e=>new URLSearchParams(window.location.search).get(e);class Pr{setSessionKey(){return K.getOrSetLocalStorageValue(this.sessionData,(()=>fs()))}get browsingTopicsSupported(){return mt()}get browsingTopicsTaxonomyVersion(){var e,t;return null==(t=this.browsingTopics)||null==(e=t[0])?void 0:e.taxonomy_version}_isWordPressLogin(){return!!document.getElementById("wpadminbar")||!!window.location.href&&window.location.href.includes("/wp-admin")}_getPrivacySandboxHost(){var e;return null!=(e=Ir("at_privacy_sandbox_host"))?e:"privacysandbox.adthrive.com"}constructor(e,t){this.connectionTargeting=[],this.sessionData={key:"session_key",timeout:864e5,rolling:!0,lowercase:!0,cb:e=>{K.removeLocalStorageValue("fpv"),(()=>{const e=kr.readExternalCookie("_ga"),t=kr.readExternalCookie("_gid");e||t||R.resolve(wr).beforeUnload.on((()=>{}))})()}};const{bucket:i,core:s,plugin:r,branch:n,debug:a,deployment:o,baseUrl:l,host:d,fastAds:c,siteAds:h,styleUrl:u,invalidTraffic:p,integration:g,deliveryVersion:m}=e,{tablet:_,desktop:f}=h.breakpoints;this.host=d,this.privacySandboxHost=this._getPrivacySandboxHost(),this.baseUrl=l,this.branch=n,this.bucket=i,this.country=s&&s.country,this.region=s&&s.region,this.plugin=r,this.fastAds=c,this.invalidTraffic=p,this.deployment=o,this.domain=window.location.host,this.device=Et(_,f),this.pageUrl=window.location.href,this.pageviewKey=t;const v=this.querystring=Rt();this.sessionKey=this.setSessionKey(),this.styleUrl=u,this.debug=a,this.integration=g,this.deliveryVersion=m,this.savedReferrer=K.getLocalStorageValue("referrer",!0,!0,18e5),this.isFirstPageview=xi(),this.isWordPressLogin=this._isWordPressLogin();try{const e=kr.readExternalLocalStorage("pbjs-id5id");this.gpid=e?JSON.parse(decodeURIComponent(e)).gp:void 0}catch(e){}this.ri=v.has("ri")?v.get("ri"):String(Math.floor(200*Math.random())),this.salesThrottle=v.has("st")?v.get("st"):String(Math.floor(200*Math.random()));const y=K.getLocalStorageValue("rsi"),b=this.rsi=y||String(Math.floor(200*Math.random()));y||K.setLocalStorageValue("rsi",b);const S=window.performance.getEntriesByType("resource").filter((e=>e.name.includes("ads.min.js")&&e.name.includes("ads.adthrive.com")))[0];if(S){const e=Math.round(S.responseEnd-S.startTime).toString();"NaN"!==e&&(this.adsMinLoadDuration=[e])}const E=window.navigator&&(window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection);E&&(E.effectiveType&&this.connectionTargeting.push(`niet:${E.effectiveType}`),this.downlink=E.downlink||E.bandwidth,this.downlink&&this.connectionTargeting.push(`dl:${this.downlink}`));const C=K.getLocalStorageValue("browsing_topics");this.browsingTopics=Array.isArray(C)?C:[]}}Pr=B([M(),F(0,D("AdThrive")),F(1,D("PageviewKey")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,String])],Pr);class Or{_isHighRevGeo(e){var t;const i=null!=(t=e.country)?t:"US";return["US","CA","AU","DE","NZ","GB","UK"].includes(i)}get enabled(){return this._enabled}constructor(e){this._enabled=!0;const t=this._isHighRevGeo(e),i=R.resolve(Cr).isRolloutEnabled("only-pb-s2s-non-high-rev-geo-mob-chromium");this._enabled=!!t||!(i&&dt()&&Wt())}}Or=B([hs("PrebidClientSide"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Pr?Object:Pr])],Or);class xr extends nr{init(){this._key="DisableMultistageRefresh",this._default=!1}}xr=B([hs("DisableMultistageRefreshExperiment"),M()],xr);class Rr extends sr{init(){this._key="PrebidFailsafeTimeout"}}Rr=B([hs("PrebidFailsafeTimeoutExperiment"),M()],Rr);class Dr extends nr{init(){this._key="CurrencyConversion",this._default=!1}}Dr=B([hs("CurrencyConversionExperiment"),M()],Dr);class Lr extends sr{init(){this._key="PrebidRequestQueueTimeout"}get result(){return this._result}}Lr=B([hs("RequestQueueExperiment"),M()],Lr);const Mr="You need to set \"this._label\" in the init method for this experiment. The code should look something like this:\n\n  protected init() {\n    this._label = 'my_label';\n  }";class Br{get label(){if(!this._label)throw new Error(Mr);return this._label}get experiments(){return this._experiments}get results(){return!1!==this._autorun||Object.keys(this._results).length||this._run(),this._results}init(){throw new Error(Mr)}_run(){var e;null==(e=this._experiments)||e.forEach((e=>{const{abgroup:t,key:i}=e,s=this._createExperiment(e);if(Object.defineProperty(s,"name",{value:`${i}${i.includes("Experiment")?"":"Experiment"}`}),!s)return;const r=new s(this._abgroupClass,this._coreExperimentConfig);this._results[t]=r.result}))}isEnabled(){if(this.shouldUseCoreExperimentsConfig){const e=this._experiments=this._coreExperimentConfig.getAllMatchingCoreExperiments(this.label);return!(!e||!e.length)}return!0}_createExperiment(e){const{key:t,type:i}=e;switch(i){case"bernoulliTrial":return this._runBernoulliExperiment(t);case"weightedChoice":return this._runWeightedChoiceExperiment(t);case"multivalueBernoulliTrial":return this._runMultivalueBernoulliExperiment(t);default:return}}_runBernoulliExperiment(e){return class extends nr{init(){this._key=e,this._default=!1}}}_runWeightedChoiceExperiment(e){return class extends sr{init(){this._key=e}}}_runMultivalueBernoulliExperiment(e){return class extends tr{init(){this._key=e,this._default=["none"]}}}constructor(e,t){this._coreExperimentConfig=e,this._abgroupClass=t,this.shouldUseCoreExperimentsConfig=!0,this._autorun=!0,this._results={},this.init(),this.isEnabled()&&this._autorun&&this._run()}}Br=B([F(0,D(Js)),j("design:type",Function),j("design:paramtypes",[void 0===Js?Object:Js,void 0===Qs?Object:Qs])],Br);class Fr extends Br{init(){this._label="RPBS"}}Fr=B([hs("PBSBatchExperiments"),M()],Fr);class jr extends sr{init(){this._key="RefreshAuctionViewportThreshold"}}jr=B([hs("RefreshAuctionViewportThresholdExperiment"),M()],jr);class Nr{_setRefreshAuctionCount(e){e.result&&"off"!==e.result&&(this.refreshAuctionCount=2)}_setupS2SBidders(e,t,i,s,r,n){this._addToS2SBidders(ae.CriteoServer,null==t?void 0:t.result),this._addToS2SBidders(ae.KargoServer,null==i?void 0:i.result),this._addToS2SBidders(ae.OpenXServer,null==s?void 0:s.result),this._addToS2SBidders(ae.TripleliftServer,null==r?void 0:r.result),this._addToS2SBidders(ae.YahooSSPServer,null==n?void 0:n.result);const a=e.result||[],o=a.indexOf(ae.GumGum);this._isIOS&&o>-1&&a.splice(o,1);const l=[...a,...this._s2sBidders],d=new Map([[ae.ColossusServer,ae.Colossus],[ae.ImproveDigitalServer,ae.ImproveDigital],[ae.KargoServer,ae.Kargo],[ae.OpenXServer,ae.OpenX],[ae.PubmaticServer,ae.Pubmatic],[ae.RubiconServer,ae.Rubicon],[ae.TripleliftServer,ae.Triplelift],[ae.YahooSSPServer,ae.YahooSSP],[ae.UndertoneServer,ae.Undertone],[ae.AidemServer,ae.Aidem],[ae.CriteoServer,ae.Criteo]]);return{bidders:l.filter((e=>this._partners.display.get(e)||this._partners.video.get(e)||d.has(e)&&(this._partners.display.get(d.get(e))||this._partners.video.get(d.get(e)))))}}_determineBidderLabel(e,t,i){if("off"===e)return;const s="20sc"===e||"20s"===e,r=this.s2s.bidders,n=Object.values(ae),a=[ae.AmazonTAM,ae.AmazonUAM],o=this.getClientSideBiddersArray(n,(e=>!r.includes(e)&&!a.includes(e))),l=1,d=2,c={};if(s){const t="20sc"===e?Math.ceil(i.length/2):0;c[l]=r.concat(this._shuffleArray(i).slice(0,t))}else{const s=yr.get(e);c[l]=this._evaluateMulistageServerBidders(t,r,s)||[...r,...i]}c[d]=this._getLastAuctionBidders(c[l]||[],[...r,...o]);for(const e in c)this._addBidderLabelToAuctionMap(c[e],Number(e))}_evaluateMulistageServerBidders(e,t,i){return i&&1===e?i=i.concat(t).filter(Mt):i&&2===e&&(i=i.filter((e=>!t.includes(e)))),i}_getLastAuctionBidders(e,t){return t.filter((t=>!e.includes(t)))}_addBidderLabelToAuctionMap(e,t){e.forEach((e=>{this.auctionMapping.set(e,`auction-${t}`)}))}_determineVideoBidderLabel(e){const t=Object.values(ae),i=[ae.AmazonTAM,ae.AmazonUAM];let s=this.getClientSideBiddersArray(t,(e=>!this.s2s.bidders.includes(e)&&!i.includes(e)));const{result:r}=e;this.refreshStickyOutstreamAuctionCount="off"===r||Ft()?1:2;const{bidders:n}=this.s2s;if("10s1"!==r||this._isIOS)"10s2"!==r||this._isIOS?(this.firstVideoAuctionBidders=new Set([...n,...s]),this.secondVideoAuctionBidders=this.firstVideoAuctionBidders):(this.firstVideoAuctionBidders=new Set(n),this.secondVideoAuctionBidders=new Set(s));else{s=this._shuffleArray(s);const e=Math.ceil(s.length/2);this.firstVideoAuctionBidders=new Set([...n,...s.slice(0,e)]),this.secondVideoAuctionBidders=new Set(s.slice(e))}}_shuffleArray(e){const t=[...e];for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}_addToS2SBidders(e,t){t&&(this.requestExp[e]=t),"both"!==t&&"server"!==t||this._s2sBidders.push(e)}get pbsExperimentsResults(){return this._pbsExperimentsResults}getVideoBidderLabel(e){const t=this.firstVideoAuctionBidders.has(e),i=this.secondVideoAuctionBidders.has(e);return t&&!i||!t&&i?t?["auction-1"]:["auction-2"]:[]}getBidderLabel(e){return[this.auctionMapping.get(e)||`auction-${this.refreshAuctionCount}`]}get requestQueueTimeout(){return this._requestQueueTimeout}getClientSideBiddersArray(e,t){const i=e.filter(t.bind(this));return this._prebidClientSide.enabled?i:[]}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u,p,g,m,_,f,v,y,b,S){this._gam=n,this._site=a,this._partners=u,this._prebidClientSide=m,this._currencyConversionExperiment=v,this.bidPoolSlots=[ge.Below_Post,ge.Content,ge.Sidebar,ge.Recipe],this.deals=[],this.firstVideoAuctionBidders=new Set,this.secondVideoAuctionBidders=new Set,this.auctionMapping=new Map,this.targetingKeys=["ADOMAIN","AD_ID","BIDDER","CACHE_ID","CACHE_HOST","DEAL","FORMAT","PRICE_BUCKET","SIZE","SOURCE","UUID","INTERSTITIAL","DSP","CRID","ATTR"],this.advertiserId=413678576,this.refreshAuctionCount=1,this.refreshStickyOutstreamAuctionCount=1,this.rubiconS2SBidders=[ae.RubiconServer],this.currencyConversionEnabled=!1,this.sendAllBidsTargetingKeys=this.targetingKeys.filter((e=>!["BIDDER","INTERSTITIAL","CRID"].includes(e))),this.isClientSideDoubleRequest=!1,this.requestExp={},this._s2sBidders=[],this._isIOS=Ft(),this.s2s=this._setupS2SBidders(e,o,l,d,c,h),this.interstitialAdUnitCode=`gpt_unit_/${this._gam.account}/AdThrive_Interstitial_1/${this._site.id}_0`,this.ortbEnrich=i.result;const E=Object.values(ae),C=[ae.AmazonTAM,ae.AmazonUAM],T=this.getClientSideBiddersArray(E,(e=>!this.s2s.bidders.includes(e)&&!C.includes(e))),w=this.multistageValue=s.result||"off",A=s.result||"off";var k;this.multistageActive="off"!==w,this.multistageStickyOutstreamActive="off"!==A;const I=null!=(k=p.result)?k:0,P=this.isClientSideDoubleRequest="csdr"===w;var O;this.isClientSideDoubleRequest||this._determineBidderLabel(w,I,T),this._determineVideoBidderLabel(r),this.auctionDelay=null!=(O=t.result)?O:0,this._setRefreshAuctionCount(s);this.experimentRefreshInterval=3e4-5e3*this.refreshAuctionCount,this.sendAdditionalNativeParams=g.result,this.multiStageLimit=!P&&_.result?4:0,this.failsafeTimeout=f.result||1e3,this.currencyConversionEnabled=this._currencyConversionExperiment.result,this._requestQueueTimeout=y.result||250,this._pbsExperimentsResults=b.results||[],this.auctionThreshold=S.result||0}}Nr=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===ir?Object:ir,void 0===rr?Object:rr,void 0===ar?Object:ar,void 0===ur?Object:ur,void 0===br?Object:br,void 0===Ts?Object:Ts,void 0===Ys?Object:Ys,void 0===or?Object:or,void 0===lr?Object:lr,void 0===dr?Object:dr,void 0===cr?Object:cr,void 0===hr?Object:hr,void 0===fr?Object:fr,void 0===vr?Object:vr,void 0===Sr?Object:Sr,void 0===Or?Object:Or,void 0===xr?Object:xr,void 0===Rr?Object:Rr,void 0===Dr?Object:Dr,void 0===Lr?Object:Lr,void 0===Fr?Object:Fr,void 0===jr?Object:jr])],Nr);const Ur=[ge.Sidebar_3,ge.Sidebar_4,ge.Sidebar_5,ge.Native_Recipe];class Vr{get id(){return this.element.id}get isSticky(){return this.sticky}get hasHighViewability(){return this.sticky||this.location===ge.Recipe}setHighlyViewable(e){const t=this.viewability>=Number(e&&e.hvThreshold);this.highlyViewable=this.lazy||t}setBidPoolId(e){this.location.includes(ge.Sidebar)?this.generateSidebarBidPoolId(e):this.generateContentBidPoolId(e),this.setSlotTargetingFlag("bpe",[this.bidPoolId?"1":"0"])}generateSidebarBidPoolId(e){const t=this.lazy,i=this.sequence,s=`${this.location}_${this.sequence}`;if(!i||Ur.includes(s));else{const i=t?t?"_Lazy":"":"_Nonlazy";if(this.sizes.length<=2||!e.includes(this.location)||!i)return;this.bidPoolId=`${this.location}_BPID${i}`}}generateContentBidPoolId(e){const t=this.lazy,i=this.location.toLowerCase().includes("content"),s=this.sequence,r=i&&s&&s>=4&&!t?"_Nonlazy":i&&t?"_Lazy":"";!e.includes(this.location)||i&&!r||(this.bidPoolId=`${this.location}_BPID${r}`)}setPassiveBidPoolId(){const e=this.lazy,t=this.location,i=`${t}_${this.sequence}`,s=t.includes(ge.Content),r=t.includes(ge.Sidebar)&&!Ur.includes(i);e||!s&&!r||(this.passiveBidPoolId=`${t}_BPID_Lazy`)}isHighlyViewable(){return this.highlyViewable||this.lazy||this.refreshCount>0}get isAboveTheFold(){return(e=>{const t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset,left:t.left+window.pageXOffset,bottom:t.bottom+window.pageYOffset,right:t.right+window.pageXOffset,width:t.right-t.left,height:t.bottom-t.top}})(this.element).top>1e3}hasSize([e,t]){return this.sizes.some((([i,s])=>e===i&&t===s))}get name(){return[this.location,this.sequence].filter(Ji).join("_")}get placementMapName(){return this.location===ge.Content&&this.sequence&&this.sequence>9?ge.Content_9:this.name.includes(ge.Below_Post)?ge.Below_Post:this.location===ge.Sidebar&&this.sequence&&this.sequence>9?ge.Sidebar_9:this.location===ge.Recipe&&this.sequence&&this.sequence>5?ge.Recipe_2:this.name}pushToQueue(e){const t=window.googletag;t&&t.cmd&&t.cmd.push(e)}setViewability(e){const t=e.adViewability.length&&void 0!==e.adViewability[0].home&&void 0!==e.adViewability[0].depth&&void 0!==e.adViewability[0].lazy,i="/"===window.location.pathname?"1":"0",s=K.getLocalStorageValue("session_fpv"),r=!0===s||null===s?"1":"0";e.adViewability.filter((s=>s.speed===e.speed&&window.innerWidth>=s.width[0]&&(!s.width[1]||window.innerWidth<=s.width[1])&&(!t||s.home===i&&s.depth===r&&this.lazy===s.lazy))).forEach((e=>{Object.keys(e.adUnits).forEach((t=>{t===this.name?this.viewability=e.adUnits[t]:this.location===ge.Content&&this.sequence>9?this.viewability=e.adUnits[ge.Content]:this.location===ge.Below_Post&&this.sequence>1&&(this.viewability=e.adUnits[ge.Below_Post])}))}))}clearTargeting(e){this.googleTagSlot?this.googleTagSlot.clearTargeting(e):te.error("Slot","setTargeting","Attempted to clear targeting before slot was defined",e)}setTargeting(e){this.googleTagSlotReady?this.applyTargeting(e):this.googleTagSlotReadyEmitter.once((()=>{this.applyTargeting(e)}))}applyTargeting(e){this.pushToQueue((()=>{if(this.googleTagSlot){const t=Array.isArray(e)?e:[e];for(const e of t)this.googleTagSlot.setTargeting(e.key,e.value)}else te.error("Slot","setTargeting","Attempted to set targeting before slot was defined",e)}))}setSlotTargetingFlag(e,t,i=!1){const s=()=>{if(this.googleTagSlot){const s=this.googleTagSlot.getTargeting("flag_slot").filter((t=>{const[s]=t.split(":");return!i||s!==e}));this.googleTagSlot.setTargeting("flag_slot",[...s,...t.map((t=>`${e}:${t}`))])}};t&&t.length>0&&this.pushToQueue((()=>s()))}clearSlotTargetingFlag(e){const t=()=>{if(this.googleTagSlot){const t=this.googleTagSlot.getTargeting("flag_slot").filter((t=>{const[i]=t.split(":");return!e.includes(i)}));this.googleTagSlot.setTargeting("flag_slot",[...t])}};this.pushToQueue((()=>t()))}getTargeting(e){return this.googleTagSlot?this.googleTagSlot.getTargeting(e):(te.error("Slot","getTargeting","Attempted to get targeting before slot was defined",e),[])}setTransactionId(e){this.transactionId=e}getTargetingMap(){if(this.googleTagSlot){const e=this.googleTagSlot;return e.getTargetingKeys().reduce(((t,i)=>(t[i]=e.getTargeting(i),t)),{})}return te.error("Slot","getTargetingMap","Attempted to get targeting before slot was defined"),{}}setSlotAppBids(e,t){const i=e.filter((e=>e.adUnitCode===t)).map((e=>e.adId));i.length&&(this.slotAppBids=i)}getSlotAppBids(){return this.slotAppBids}addRequestTypeSlotFlag(){var e;if((null==this||null==(e=this.getSlotAppBids())?void 0:e.length)&&(null==this?void 0:this.googleTagSlot)){const e=this.getSlotAppBids();this.googleTagSlot.getTargeting("hb_adid").some((t=>null==e?void 0:e.includes(t)))&&this.setSlotTargetingFlag("reqtype",["app"],!0)}}constructor(e,t,i,s,r,n=!1,a=8,o,l=[],d=!0,c=!1){this.location=e,this.sequence=t,this.sizes=i,this.element=s,this.sticky=r,this.lazy=n,this.auctionPriority=a,this.stickyOverlapSelector=o,this.special=l,this.enabledForAuction=d,this.infinite=c,this.refreshPaused=!1,this.isRefreshing=!1,this.hasRefreshStarted=!1,this.closed=!1,this.viewableDuration=0,this.slotFullyRenderedDuration=0,this.outOfViewIO=!0,this.outOfViewGPT=!0,this.alwaysInView=!1,this.displayed=!1,this.refreshCount=0,this.viewability=0,this.highlyViewable=!1,this.hvp=0,this.servedPrebidBidResponse=void 0,this.lazyDisabled=!1,this.transactionId="",this.stickyOutstreamShortVideo=!1,this.stickyOutstreamLastAdErrored=!1,this.stickyOutstreamRefreshTimeout=5e3,this.multiformat=!1,this.nativeEnabled=!1,this.googleTagSlotReadyEmitter=new Q,this.googleTagSlotReady=!1,this.auctionPromise=null,this.location===ge.Video_StickyOutstream&&(this.stickyOutstreamErrorCount=0,this.noAdRefreshCount=0,this.stickyOutstreamErrorLogged=!1)}}class zr{add(e){const t=kr.readSessionStorage("adthrive_footer_closed");let i=this.castArray(e);t&&(i=i.filter((e=>e.location!==ge.Footer)));for(const e of i)if(!this._slots.has(e.id)){this._slots.set(e.id,e);try{this.added.emit(e)}catch(e){te.error("Slots","add",e)}}return i}remove(e){const t=this.castArray(e);for(const e of t)this._slots.has(e.id)&&(e.closed=!0,this._slots.delete(e.id))}get(e){return e?this._slots.get(e):[...this._slots.values()]}castArray(e){if("string"==typeof e){const t=this.get(e);return void 0!==t?[t]:[]}return Array.isArray(e)?e:[e]}constructor(){this.added=new Q,this.bidServed=new Q,this._slots=new Map}}zr=B([hs("Slots"),M()],zr);class $r{observe(e,t){const i=this.getIntersectionObserver(e);this.slotIntersectionObservers.set(t,i),this.unobservedSlotIntersectionObservers.set(t,i),i.observe(t.element)}unobserve(e){const t=this.unobservedSlotIntersectionObservers.get(e);t&&(t.unobserve(e.element),this.unobservedSlotIntersectionObservers.delete(e))}unobserveAll(e=!0){this.unobservedSlotIntersectionObservers.forEach(((t,i)=>{this.unobserve(i),e&&this._slotEventBus.displaySlot.emit(i)}))}getIntersectionObserver(e){const t=window.innerHeight*(e/100);return new IntersectionObserver((e=>{for(const t of e)this.processEntry(t)}),{rootMargin:`${t}px 0px`,threshold:[0]})}processEntry(e){const t=this._slots.get(e.target.id);t&&e.intersectionRatio>0&&this.unobservedSlotIntersectionObservers.has(t)&&(this._slotEventBus.displaySlot.emit(t),this.unobserve(t))}constructor(e,t){this._slots=e,this._slotEventBus=t,this.slotIntersectionObservers=new Map,this.unobservedSlotIntersectionObservers=new Map}}$r=B([hs("IntersectionObserverManager"),M(),j("design:type",Function),j("design:paramtypes",[void 0===zr?Object:zr,void 0===Es?Object:Es])],$r);class Hr extends sr{init(){this._key="DCSLLSiteSpecific"}}Hr=B([hs("DCSLLSiteSpecificExperiment"),M()],Hr);class qr{get required(){return this._required}get consented(){return this._consented}set consented(e){this._consented=e}_setupListeners(){this._consentEventBus.act25consentCaptured.on((e=>{this._consented=e}))}_isFrenchLanguage(){var e;const t=null!=(e=navigator.language&&navigator.language.toLowerCase())?e:"";var i;const s=null!=(i=navigator.languages&&navigator.languages.map((e=>e.toLowerCase())))?i:[];return"fr"===t||t.includes("fr-")||(null==s?void 0:s.some((e=>"fr"===e||e.includes("fr-"))))}constructor(e,t){this._consentEventBus=t,this._storageKey="act25-consent",this._storageTimeout=33696e6,this._required="CA"===e.core.country&&Qi(["America/Toronto","America/Blanc-Sablon","America/Montreal","America/Nipigon"],[300,240])&&this._isFrenchLanguage(),this._consented=K.getLocalStorageValue(this._storageKey,!0,!1,this._storageTimeout),this._required&&this._setupListeners()}}qr=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Rs?Object:Rs])],qr);class Gr extends sr{init(){this._key="InterstitialAlt"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Gr.prototype,"run",null),Gr=B([hs("InterstitialExperiment"),M()],Gr);const Kr=()=>{try{const e=2500,t=kr.readExternalLocalStorage("__lsv__"),i=t||[];if(window.innerWidth>=e)return{isError:!1,canDisplay:!1};if(i.length){const e=36e5,t=Yi(),s=i[0];return{isError:!1,canDisplay:("number"==typeof s?t-s:0)>e}}return{isError:!1,canDisplay:!0}}catch(e){return{isError:!0,canDisplay:!1,message:e.message}}};class Wr extends Hs{run(){const e=this._choices[0].weight/100;return new Is(e).get()}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig)return void te.error("InterstitialSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config");const e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?"on":"off";this._pubabgroup.set(e,t)}constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,this._choices=[],this._result=!1,this.key=pe.Interstitial;const{isError:i,canDisplay:s,message:r}=Kr();i&&te.error("InterstitialSiteExperiment","constructor",{message:r}),this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&s&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Wr.prototype,"run",null),Wr=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ks?Object:Ks,void 0===Xs?Object:Xs])],Wr);class Yr extends Hs{run(){const e=this._choices[0].weight/100;return new Is(e).get()}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig)return void te.error("RemoveFooterCloseButtonSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config");const e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?"on":"off";this._pubabgroup.set(e,t)}constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,this._choices=[],this._result=!1,this.key=pe.FooterCloseButton,this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Yr.prototype,"run",null),Yr=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ks?Object:Ks,void 0===Xs?Object:Xs])],Yr);class Qr{_isGamInterstitialNetworkExperimentEnabled(e){const{isError:t,canDisplay:i,message:s}=Kr(),r=Wt()&&bt(e.siteAds.adOptions.mobileInterstitial,!1),n=!Wt()&&bt(e.siteAds.adOptions.desktopInterstitial,!1);if(t&&te.error("InterstitialExperiment","canDisplayInterstitial",{message:s}),i&&(r||n)){const e=R.resolve(Gr);return!(!e||!e.result||"off"===e.result)}return!1}constructor(e,t,i){var s,r,n,a,o,l,d;this._interstitialSiteExperiment=t,this._removeFooterCloseButtonSiteExperiment=i,this.footerCloseButtonMigrated=!1;const{allowSmallerAdSizes:c,bgColor:h,footerCloseButton:u,footerCloseButtonMobile:p,footerCloseButtonDesktop:g,footerSelector:m,infiniteScroll:_,infiniteScrollOptions:f,infiniteScrollRefresh:v,isAutoOptimized:y,pmp:b,targetaff:S,stickyContainerConfig:E,sidebarConfig:C,siteAttributes:T,dynamicContentSlotLazyLoading:w,desktopInterstitial:A,mobileInterstitial:k,optimizeVideoPlayersForEarnings:I,secColor:P,wakeLock:O}=e.siteAds.adOptions;this.allowSmallerAdSizes=bt(c,!0),void 0!==p&&void 0!==g&&(this.footerCloseButtonMigrated=!0);const x=this._isGamInterstitialNetworkExperimentEnabled(e),R=this._interstitialSiteExperiment.enabled?this._interstitialSiteExperiment.result:x;if(this.interstitial={gam:R,prebid:!1},this._removeFooterCloseButtonSiteExperiment.enabled){const e=!this._removeFooterCloseButtonSiteExperiment.result;this.footerCloseButton=e,this.footerCloseButtonMobile=e,this.footerCloseButtonDesktop=e}else this.footerCloseButton=bt(u,!0),this.footerCloseButtonMobile=bt(p,!0),this.footerCloseButtonDesktop=bt(g,!0);this.bgColor=bt(h,"#FFFFFF"),this.footerSelector=bt(m,""),this.pmp=bt(b,!0),this.infiniteScroll=bt(_,!1),this.infiniteScrollOptions=bt(f,{}),this.infiniteScrollRefresh=bt(v,!0),this.isAutoOptimized=bt(y,!1),this.targetAff=bt(S,!1),this.spa=bt(e.siteAds.adOptions.spa,!1),this.stickyContentEnabled=null==E||null==(s=E.content)?void 0:s.enabled,this.stickyContentHeight=null==E||null==(r=E.content)?void 0:r.minHeight,this.stickyRecipeHeight=Wt()?null==E||null==(n=E.recipeMobile)?void 0:n.minHeight:null==E||null==(a=E.recipeDesktop)?void 0:a.minHeight,this.stickyHeaderSelectors=null==E?void 0:E.stickyHeaderSelectors,this.stickyBlockedSelectors=null==E?void 0:E.blockedSelectors,this.dynamicStickySidebarEnabled=null==C||null==(o=C.dynamicStickySidebar)?void 0:o.enabled,this.dynamicStickySidebarHeight=null==C||null==(l=C.dynamicStickySidebar)?void 0:l.minHeight,this.dynamicStickySidebarBlockedSelectors=null==C||null==(d=C.dynamicStickySidebar)?void 0:d.blockedSelectors,this.dynamicStickySidebarHeaderSelectors=Wt()?null==T?void 0:T.mobileHeaderSelectors:null==T?void 0:T.desktopHeaderSelectors,this.dynamicContentSlotLazyLoading=bt(w,!1),this.desktopInterstitial=bt(A,!1),this.mobileInterstitial=bt(k,!1),this.optimizeVideoPlayersForEarnings=bt(I,!1),this.secColor=bt(P,"#000000"),this.wakeLock=O}}Qr=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Wr?Object:Wr,void 0===Yr?Object:Yr])],Qr);class Xr extends tr{init(){this._key="AdTypeHoldout",this._default=["none"]}}Xr=B([hs("AdTypeHoldoutExperiment"),M()],Xr);let Jr=class{has(e){return this[e]&&!0===this[e]}get enabled(){return Object.keys(this).filter((e=>!0===this[e]))}get enabledMinified(){const e={outstreamDesktop:{min:"od",val:this.outstreamDesktop},outstreamMobile:{min:"om",val:this.outstreamMobile}};return this.enabled.filter((t=>Object.keys(e).includes(t)&&e[t].val)).map((t=>e[t].min))}get outstreamEnabled(){return Wt()?!0===this.outstreamMobile:!0===this.outstreamDesktop}_overriveAdType(){const e=this._adTypeHoldoutExperiment.result;e&&e.length&&e.forEach((e=>{this[e]&&(this[e]=!1)}))}constructor(e,t){this._adTypeHoldoutExperiment=t;const i=e.siteAds.adTypes||{};var s,r;this.animatedFooter=bt(i.animatedFooter,!0),this.expandableFooter=bt(i.expandableFooter,!0),this.inRecipeRecommendationDesktop=bt(i.inRecipeRecommendationDesktop,!0),this.inRecipeRecommendationMobile=bt(i.inRecipeRecommendationMobile,!0),this.interscroller=!!Wt()&&bt(i.interscroller,!0),this.largeFormatsDesktop=bt(i.largeFormatsDesktop,!0),this.largeFormatsMobile=bt(i.largeFormatsMobile,!0),this.miniscroller=!!Wt()&&bt(i.miniscroller,!0),this.nativeDesktopContent=bt(i.nativeDesktopContent,!0),this.nativeDesktopRecipe=bt(i.nativeDesktopRecipe,!0),this.nativeDesktopSidebar=bt(i.nativeDesktopSidebar,!0),this.nativeDesktopHeader=bt(null!=(s=i.nativeHeaderDesktop)?s:i.nativeDesktopHeader,!0),this.nativeDesktopBelowPost=bt(i.nativeDesktopBelowPost,!0),this.nativeMobileContent=bt(i.nativeMobileContent,!0),this.nativeMobileRecipe=bt(i.nativeMobileRecipe,!0),this.nativeMobileHeader=bt(null!=(r=i.nativeHeaderMobile)?r:i.nativeMobileHeader,!0),this.nativeMobileBelowPost=bt(i.nativeMobileBelowPost,!0),this.outstreamDesktop=bt(i.outstreamDesktop,!0),this.outstreamMobile=bt(i.outstreamMobile,!0),this.sponsorTileDesktop=bt(i.sponsorTileDesktop,!1),this.sponsorTileMobile=bt(i.sponsorTileMobile,!1),this.expandableCatalogAdsDesktop=bt(i.expandableCatalogAdsDesktop,!1),this.expandableCatalogAdsMobile=bt(i.expandableCatalogAdsMobile,!1),this._overriveAdType()}};Jr=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Xr?Object:Xr])],Jr);class Zr extends As{get result(){return this._result}run(){return new Is(this.weight).get()}constructor(e,t,i){super(),this._result=!0,this.key="Amazon",this._choices=[{choice:!0},{choice:!1}],this.weight=.995;const s=e.deliveryFeatures,r=i.getCoreExperimentButMutateWeights(this.key);if((!s||!s.includes("amazonLoad"))&&r){this._expConfigABGroup=r.abgroup;const e=r.variants[0];this.weight=e.weight,this._result=this.run(),t.set(r.abgroup,this._result?"on":"off")}}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Zr.prototype,"run",null),Zr=B([hs("AmazonExperiment"),M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Qs?Object:Qs,void 0===Js?Object:Js])],Zr);class en extends nr{init(){this._key="WebVitals",this._default=!1}}en=B([hs("WebVitalsExperiment"),M()],en);class tn{get host(){return this._host}get baseUrl(){return this._baseUrl}get targetPath(){return this._targetPath}constructor(e,t){this.bootstrapResult=new Map,this.bootstrapLoaders={},this.webVitalsEnabled=!!lt()&&R.resolve(en).result,this.gptLibFailedToLoad=!1,this.isGDPR="true"===e.gdpr;const i=Ft()?"/s2s":"";this._host=e.host,this._baseUrl=e.baseUrl,this._targetPath=`${e.targetPath}${i}`||`/es2018${i}`;const s=e.deliveryFeatures;this.isAmazonPreloaded=!(!s||!s.includes("amazonLoad")),this.isGPTPreloaded=!(!s||!s.includes("gptLoad")),this.isPrebidPreloaded=!(!s||!s.includes("prebidLoad")),this.isCmpPreloaded=!(!s||!s.includes("consentManagerCMP")),this.amazonEnabled=t.result||this.isAmazonPreloaded}}tn=B([hs("BootstrapConfig"),M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Zr?Object:Zr])],tn);class sn{async load(){return this._bootstrapConfig.amazonEnabled&&this._amazonUAM?(this._init(),this._bootstrapConfig.isAmazonPreloaded?Promise.resolve(!0):(this._addAmazonLinks(),this._addApstag())):Promise.resolve(!1)}_addApstag(){return vi(this._url)}_addAmazonLinks(){const e=this._link;yi(e,"dns-prefetch"),yi(e,"preconnect",[{name:"crossorigin",value:""}])}_init(){if(window.apstag)return;const e=(e,t)=>{window.apstag.queue.push([e,t,(new Date).getTime()])};window.apstag={init(){e("i",arguments)},customPlacements:()=>({}),fetchBids(){e("f",arguments)},setDisplayBids(){},targetingKeys:()=>[],dpa(){e("di",arguments)},rpa(){e("ri",arguments)},upa(){e("ui",arguments)},queue:[]}}constructor(e,t){this._bootstrapConfig=t,this.type=oe.Amazon,this.wait=!1,this._url="https://c.aps.amazon-adsystem.com/apstag.js",this._link="https://c.aps.amazon-adsystem.com",this._amazonUAM=e.siteAds.adOptions.amazonUAM}}var rn;sn=B([hs("AmazonBootstrap"),L(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===tn?Object:tn])],sn),function(e){e.GetPiiData="adthrive_GetPiiData",e.SetPiiData="adthrive_SetPiiData",e.SetIdentityData="adthrive_SetIdentityData",e.DeletePiiData="adthrive_DeletePiiData",e.SendPiiData="adthrive_SendPiiData"}(rn||(rn={}));class nn{get enabled(){return this.required&&this.userOptedOut}constructor(e){var t;this.nonCompliantBidders=["unruly"],this.ccpaNotApplicable="1---",this.ccpaOptIn="1YNY",this.ccpaOptOut="1YYY",this.consentChange=new Q,this.optOutText="Do not sell or share my personal information.",this.optInText="Customize my ad experience.";const i=null==e||null==(t=e.core)?void 0:t.region;this.required="true"!==e.gdpr,this.privacyString=kr.readExternalCookie("usprivacy"),this.userOptedOut=this.privacyString===this.ccpaOptOut,this.gpcEnabled=K.getLocalStorageValue("gpc"),this.consentChange=new Q,Gi()&&this.required||Ki(i)&&this.required?this.privacyString=this.ccpaOptOut:!this.privacyString&&this.required&&(this.privacyString=this.ccpaOptIn),this.consentChange.on((e=>{this.privacyString=e})),this.required&&(this.comscoreParams=this.userOptedOut?"0":"1")}}nn=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],nn);class an{setGpcString(){!this.gpcEnabled&&this.globalPrivacyControl?(K.setLocalStorageValue("gpc",`${this.globalPrivacyControl}`),this._updateGPC()):this.gpcEnabled&&!this.globalPrivacyControl&&(K.removeLocalStorageValue("gpc"),this._updateGPC())}_updateGPC(){this.gpcEnabled=!!this.globalPrivacyControl,this.gpcUpdated=!0}constructor(){this.gpcUpdated=!1,this.globalPrivacyControl=!!window.navigator.globalPrivacyControl,this.gpcEnabled="true"===K.getLocalStorageValue("gpc")}}an=B([M(),j("design:type",Function),j("design:paramtypes",[])],an);class on{get enabled(){return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut}deleteData(){try{if(this._frame.contentWindow){const e={action:rn.DeletePiiData};this._frame.contentWindow.postMessage(e,this._host)}}catch(e){te.error("PiiIframeManager","deleteIdentity","Failed to delete identity data",e)}}setIdentityData(e){try{if(this._frame.contentWindow){const t={action:rn.SetIdentityData,identityData:e,siteId:this._siteConfig.id,encrypt:"false"!==this._context.querystring.get("adt_encrypt")};this._frame.contentWindow.postMessage(t,this._host)}}catch(e){te.error("PiiIframeManager","setIdentityData","Failed to set identity data",e)}}setData(e){try{if(this._frame.contentWindow){const t={action:rn.SetPiiData,piiData:e};this._frame.contentWindow.postMessage(t,this._host)}}catch(e){te.error("PiiIframeManager","setIdentity","Failed to set identity data",e)}}getData(){try{if(this._frame.contentWindow){const e={action:rn.GetPiiData};this._frame.contentWindow.postMessage(e,this._host)}}catch(e){te.error("PiiIframeManager","getIdentity","Failed to get identity data",e)}}_addIframeToPage(){return new Promise((e=>{this._frame.src=this._frameSrc,this._frame.id="adt-ii",this._frame.style.display="none",this._frame.onload=()=>{e()},document.body.appendChild(this._frame)}))}_setupEventListeners(){this._identityEventBus.dataCaptured.on((e=>{const{sha1Hash:t,sha256Hash:i,source:s,sourceCollectedDate:r}=e;(i||t||s)&&this.setData({sha1Hash:t,sha256Hash:i,source:s,sourceCollectedDate:r})}),{handleEventsAlreadyEmitted:!0}),this._identityEventBus.dataCapturedForIframe.on((e=>{e&&this.setIdentityData(e)}),{handleEventsAlreadyEmitted:!0}),this._ccpaConfig.consentChange.on((e=>{e===this._ccpaConfig.ccpaOptOut&&this.deleteData()})),this._frame.contentWindow&&window.addEventListener("message",this._handleMessageEvent.bind(this))}_handleMessageEvent(e){const t=e.data.action;if(e.origin===this._host&&t===rn.SendPiiData){const t=e.data.piiData;t&&!t.sourceCollectedDate&&(t.sourceCollectedDate=null),e.data.identityData,this._identityEventBus.dataSentFromIframe.emit(t||null)}}constructor(e,t,i,s,r,n){this._bootstrapConfig=e,this._gpcConfig=t,this._ccpaConfig=i,this._identityEventBus=s,this._siteConfig=r,this._context=n,this._host=`https://${this._bootstrapConfig.host}`,this._frame=document.createElement("iframe"),this._baseUrl=this._bootstrapConfig.baseUrl,this._frameSrc=`${this._baseUrl.replace("/gdpr","")}/html/i.html`,this.enabled&&this._addIframeToPage().then((()=>{this._identityEventBus.iframeReady.emit(),this._setupEventListeners()})).catch((e=>{te.error("PiiIframeManager","constructor","Failed to initialize identity iframe",e)}))}}function ln(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}on=B([hs("PiiIframeManager"),M(),j("design:type",Function),j("design:paramtypes",[void 0===tn?Object:tn,void 0===an?Object:an,void 0===nn?Object:nn,void 0===Ls?Object:Ls,void 0===Ys?Object:Ys,void 0===Pr?Object:Pr])],on);var dn="object"==typeof global&&global&&global.Object===Object&&global,cn="object"==typeof self&&self&&self.Object===Object&&self,hn=dn||cn||Function("return this")(),un=function(){return hn.Date.now()},pn=/\s/;var gn=/^\s+/;function mn(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&pn.test(e.charAt(t)););return t}(e)+1).replace(gn,""):e}var _n=hn.Symbol,fn=Object.prototype,vn=fn.hasOwnProperty,yn=fn.toString,bn=_n?_n.toStringTag:void 0;var Sn=Object.prototype.toString;var En="[object Null]",Cn="[object Undefined]",Tn=_n?_n.toStringTag:void 0;function wn(e){return null==e?void 0===e?Cn:En:Tn&&Tn in Object(e)?function(e){var t=vn.call(e,bn),i=e[bn];try{e[bn]=void 0;var s=!0}catch(e){}var r=yn.call(e);return s&&(t?e[bn]=i:delete e[bn]),r}(e):function(e){return Sn.call(e)}(e)}function An(e){return null!=e&&"object"==typeof e}var kn="[object Symbol]";var In=NaN,Pn=/^[-+]0x[0-9a-f]+$/i,On=/^0b[01]+$/i,xn=/^0o[0-7]+$/i,Rn=parseInt;function Dn(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||An(e)&&wn(e)==kn}(e))return In;if(ln(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ln(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=mn(e);var i=On.test(e);return i||xn.test(e)?Rn(e.slice(2),i?2:8):Pn.test(e)?In:+e}var Ln="Expected a function",Mn=Math.max,Bn=Math.min;function Fn(e,t,i){var s,r,n,a,o,l,d=0,c=!1,h=!1,u=!0;if("function"!=typeof e)throw new TypeError(Ln);function p(t){var i=s,n=r;return s=r=void 0,d=t,a=e.apply(n,i)}function g(e){var i=e-l;return void 0===l||i>=t||i<0||h&&e-d>=n}function m(){var e=un();if(g(e))return _(e);o=setTimeout(m,function(e){var i=t-(e-l);return h?Bn(i,n-(e-d)):i}(e))}function _(e){return o=void 0,u&&s?p(e):(s=r=void 0,a)}function f(){var e=un(),i=g(e);if(s=arguments,r=this,l=e,i){if(void 0===o)return function(e){return d=e,o=setTimeout(m,t),c?p(e):a}(l);if(h)return clearTimeout(o),o=setTimeout(m,t),p(l)}return void 0===o&&(o=setTimeout(m,t)),a}return t=Dn(t)||0,ln(i)&&(c=!!i.leading,n=(h="maxWait"in i)?Mn(Dn(i.maxWait)||0,t):n,u="trailing"in i?!!i.trailing:u),f.cancel=function(){void 0!==o&&clearTimeout(o),d=0,s=l=r=o=void 0},f.flush=function(){return void 0===o?a:_(un())},f}class jn extends sr{init(){this._key="EmailCaptureHandlerDebounceExperiment_2"}}jn=B([M()],jn);class Nn{constructor(e){this.collectionMethod="direct",this.type=e.type,this.sha256Hash=e.sha256Hash,this.sha1Hash=e.sha1Hash,this.collectionSiteId=e.collectionSiteId,this.collectionDate=e.collectionDate,this.collectionSource=e.collectionSource,this.iframe=e.iframe,this.directSource=e.directSource,this.directApiAttribution=e.directApiAttribution}}class Un{constructor(e){this.collectionMethod="graph3p",this.type=e.type,this.sha256Hash=e.sha256Hash,this.sha1Hash=e.sha1Hash,this.collectionSiteId=e.collectionSiteId,this.collectionDate=e.collectionDate,this.collectionSource=e.collectionSource,this.iframe=e.iframe,this.graphSource=e.graphSource,this.graphTraits=e.graphTraits}}class Vn{constructor(e){this.collectionMethod="graph1p",this.type=e.type,this.sha256Hash=e.sha256Hash,this.sha1Hash=e.sha1Hash,this.collectionSiteId=e.collectionSiteId,this.collectionDate=e.collectionDate,this.collectionSource=e.collectionSource,this.iframe=e.iframe,this.bridgingMethod=e.bridgingMethod}}class zn{static createIdentityData(e,t){switch(e){case"direct":return new Nn(t);case"graph3p":return new Un(t);case"graph1p":return new Vn(t)}}}class $n{createIdentityData(e,t,i,s){let r;const n=this._getCollectionSourceFromCaptureSource(s),a={type:"email",sha256Hash:e.sha256Hash,sha1Hash:e.sha1Hash?e.sha1Hash:void 0,collectionSiteId:this._siteConfig.id,collectionDate:"capture"===n?ei():i||void 0,collectionSource:n,collectionMethod:"direct",..."iframe"===s&&{iframe:!0}};let o=this._getCollectionMethod(s);if(void 0===o&&(o=this._isGraph1PSource(t)?"graph1p":_i(t)?"direct":"graph3p"),"direct"===o){const e={...a,collectionMethod:"direct",directSource:this._getDirectSource(t)};r=zn.createIdentityData("direct",e)}else if("graph3p"===o){const e=t.includes(pi.VALUES.TD)?"trueData":"unknown",i={...a,collectionMethod:"graph3p",graphSource:e};r=zn.createIdentityData("graph3p",i)}else{const e={...a,collectionMethod:"graph1p",...t.includes(pi.VALUES.GPID)&&{bridgingMethod:"gpId"}};r=zn.createIdentityData("graph1p",e)}return r}_isGraph1PSource(e){return e.includes(`${pi.PREFIXES.RAPTIVE_AUTH}${pi.VALUES.GPID}`)}_getCollectionSourceFromCaptureSource(e){return"email"===e||"identityApi"===e||"raptiveDCN"===e||"externalDCN"===e||"iframe"===e?"capture":"browserStorage"===e?"storage":void 0}_getCollectionMethod(e){return"identityApi"===e||"email"===e?"direct":"raptiveDCN"===e?"graph1p":"externalDCN"===e?"graph3p":void 0}_getDirectSource(e){const t=e.startsWith(pi.PREFIXES.IDENTITY_IFRAME)?e.slice(pi.PREFIXES.IDENTITY_IFRAME.length):e;return t.includes(pi.VALUES.SLICKSTREAM)||t.includes("slickstream")?"slickstream":t.includes(pi.VALUES.URLH)?"urlHashed":t.includes(pi.VALUES.URL)?"url":t.includes(pi.VALUES.API)?"api":t.includes(pi.VALUES.GPID)?"gpid":t.includes(pi.VALUES.COOKIE)?"cookies":t.includes(pi.VALUES.GRWM)?"growme":t.includes(pi.VALUES.NEWSLETTER)?"newsletter":t.includes(pi.VALUES.LOCAL_STORAGE)?"localStorage":t.includes(pi.VALUES.OTHER)?"other":"unknown"}constructor(e){this._siteConfig=e}}$n=B([hs("IdentityDataMigration"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ys?Object:Ys])],$n);class Hn{captureEmail(e,t){this.checkSources(t),this.emailCaptured.emit({pii:{email:e,source:`${t}_c`,sourceCollectedDate:ei()},identityDataSource:"email"})}checkSources(e){!(e="slickstream"===e?"ss":e)||["url","urlh","c","nl","ss","l_s","l_i","api","grwm","g_td","ra_gpid"].includes(e)||(null==e?void 0:e.startsWith("ss_"))||te.event("EmailCaptureHandler","checkSources","unknown source: ",e)}_processHash(e,t){return e&&"string"==typeof e&&e.match(/value/i)?this._retrieveBitHashString(e,t):e||""}collectEmailFromStorage(){const[e,t]=this._getStoredHashInfo(),i=this._getStoredSource(t),s=this._getStoredSourceCollectedDate();e?this._processStoredHash(e,i,s):this._collectFromIframe()}_getStoredHashInfo(){const e=kr.readInternalCookie(ui.KEY),t=K.getLocalStorageValue(ui.KEY,!1);let i=null,s=!1;return e?(i=e,s=!0):t&&(i="string"==typeof t?{sha256Hash:t,sha1Hash:""}:t),[i,s]}_getStoredSource(e=!1){const t=kr.readInternalCookie(pi.KEY)||K.getLocalStorageValue(pi.KEY,!1)||"o_s";if(t.includes(pi.VALUES.IDENTITY_IFRAME))return this._retrieveIframeSourceString(t);if(t.includes(pi.PREFIXES.IDG)||t.includes(pi.PREFIXES.RAPTIVE_AUTH)){const e=t.includes(pi.SUFFIXES.CAPTURE);return!t.includes(pi.SUFFIXES.CAPTURE)&&!t.includes(pi.SUFFIXES.STORAGE)?`${t}${pi.SUFFIXES.CAPTURE}`:e?t.replace(`${pi.SUFFIXES.CAPTURE}`,`${pi.SUFFIXES.STORAGE}`):t}return this._determineSource(t,e)}_getStoredSourceCollectedDate(){var e;return null!=(e=K.getLocalStorageValue(gi.KEY,!1))?e:null}_determineSource(e,t){const i="url"===e||"urlh"===e||"urlhck"===e,s=e.endsWith("_c");return i?`${e}_c`:s?e.replace(/_c$/,"_s"):t?"cki_s":e}_processStoredHash(e,t,i){const s=[{key:"sha256Hash",length:64},{key:"sha1Hash",length:40}];for(const t of s){const i=e[t.key];(null==i?void 0:i.length)&&(e[t.key]=this._processHash(i,t.length))}if(e&&t&&(e.sha256Hash||e.sha1Hash)){const s={pii:{sha256Hash:e.sha256Hash,sha1Hash:e.sha1Hash,source:t,sourceCollectedDate:i},identityDataSource:"browserStorage"};this.emailCaptured.emit(s)}}_collectFromIframe(){this._identityEventBus.dataSentFromIframe.once((e=>{if(e){e.source&&!e.source.includes(pi.PREFIXES.IDENTITY_IFRAME)&&(e.source=`${pi.PREFIXES.IDENTITY_IFRAME}${e.source}`);const t={pii:e,identityDataSource:"iframe"};this.emailCaptured.emit(t),setTimeout((()=>{this._identityEventBus.iframeDataSynced.emit()}),100)}else this._identityEventBus.iframeDataSynced.emit()})),this._identityEventBus.iframeReady.on((()=>this._piiIframeManager.getData()),{handleEventsAlreadyEmitted:!0})}_retrieveBitHashString(e,t){const i=e.match(`\\w{${t}}`);return i?i[0]:""}_retrieveIframeSourceString(e){const t=e.match(/^(l_i)-(.*)/);return t&&3===t.length?t[0].replace(/_c$/,"_s"):"l_i"}addEmailProviderListeners(){this._eventMap.forEach(((e,t)=>{e.addEventListener(t,this._boundCallEventHandler)}))}removeEmailProviderListeners(){this._eventMap.forEach(((e,t)=>{e.removeEventListener(t,this._boundCallEventHandler)}))}callCheckEmailProviders(e){("mouseleave"!==e.type||e.clientY<=0)&&setTimeout((()=>{this._emailProviderOnPage||this.emailProviderHandler()}),this._emailCheckTimeout)}emailProviderHandler(){for(const e of this._emailProviders){if(document.querySelectorAll(e.divSelector).length){e.divSelector.includes("grow-me")&&(this._growMeOnPage=!0),this.removeEmailProviderListeners(),this._emailProviderOnPage=!0,this._addElementListeners();break}}}setElements(){const e="input[type=text], input[type=email], input[name=email]";if(this._elements=Array.prototype.slice.call(document.querySelectorAll(e)),this._growMeOnPage){var t;const[s]=Array.from(document.querySelectorAll(this._growMeSelector));var i;const r=null!=(i=Array.prototype.slice.call(null==s||null==(t=s.shadowRoot)?void 0:t.querySelectorAll(e)))?i:[];this._elements=[...this._elements,...r]}}_addKeydownEventListener(){document.addEventListener("keydown",(e=>this._keydownEventListener(e)))}_keydownEventListener(e){"keydown"!==e.type||"@"!=e.key||this._keydownListenerAdded||(this._keydownListenerAdded=!0,this._addElementListeners())}_addElementListeners(){this.setElements();for(const e of this._elements)e.addEventListener("blur",this._boundProcessEventHandler),e.addEventListener("change",this._boundProcessEventHandler)}removeElementListeners(){for(const e of this._elements)e.removeEventListener("blur",this._boundProcessEventHandler),e.removeEventListener("change",this._boundProcessEventHandler)}sourceOrigin(e){let t="unknown";if(!e.form)return t;const{id:i}=e.form;return i&&"string"==typeof i&&(i.includes("comment")?t="c":i.includes("subscribe")?t="nl":this._growMeOnPage&&e.form.querySelectorAll(this._growMeFormSelector)&&(t="grwm")),t}processInputChange(e){const t=e.target,i=t.value,s=xt(i);if(s){const e=this.sourceOrigin(t);this.captureEmail(s,e),this.removeElementListeners()}}constructor(e,t,i,s){var r;this._identityEventBus=e,this._piiIframeManager=t,this._identityDataMigration=s,this._elements=[],this._keydownListenerAdded=!1,this._emailProviderOnPage=!1,this._growMeOnPage=!1,this._growMeSelector='[id^="grow-me-inline-subscribe-cta-root-"]',this._growMeFormSelector='[class^="SubscribeCtaWidget___StyledDiv6-"]',this.emailCaptured=new X,this._emailProviders=[{divSelector:'div[id$="-optin"]'},{divSelector:'div[class^="cb-form-group"]'},{divSelector:"div.sumo-form-wrapper.listbuilder-popup"},{divSelector:this._growMeSelector}],this._emailCheckTimeout=1500,this._eventMap=new Map([["mousemove",window],["scroll",window],["mouseleave",document],["om.Campaign.startShow",document]]);const n=null!=(r=i.result)?r:0;this._boundCallEventHandler=Fn(this.callCheckEmailProviders.bind(this),n),this._boundProcessEventHandler=Fn(this.processInputChange.bind(this),n),this.addEmailProviderListeners(),this._addElementListeners(),this._addKeydownEventListener(),this.collectEmailFromStorage()}}Hn=B([hs("EmailCaptureHandler"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ls?Object:Ls,void 0===on?Object:on,void 0===jn?Object:jn,void 0===$n?Object:$n])],Hn);const qn=(e,t)=>e<t?-1:e>t?1:0,Gn=(e,t)=>{var i,s;return(null!=(i=t.lastSeen)?i:0)-(null!=(s=e.lastSeen)?s:0)},Kn=e=>Array.from(new Set(e)).sort(qn);class Wn{async load(e){var t,i,s,r,n;const a=`s-${e}`;(null==(t=window.optable)?void 0:t.instance)&&(null==(i=window.optable)?void 0:i.auth)&&(null==(s=window.optable)?void 0:s.site)===a&&(null==(r=window.optable.auth)?void 0:r.site)===a||(window.optable=window.optable||{cmd:[]},window.optable.site=a,(null==(n=window.optable)?void 0:n.auth)||(window.optable.auth={}),window.optable.auth.site=a,window.optable.instance||(window.optable.instance={}),await vi("https://raptive.solutions.cdn.optable.co/public-assets/raptive-sdk.js"))}loaded(){var e,t,i;return!!(null==(e=window.optable)?void 0:e.site)&&!!(null==(t=window.optable)?void 0:t.instance)&&!!(null==(i=window.optable)?void 0:i.auth)}addToQueue(e){var t,i,s,r;(null==(t=window.optable)?void 0:t.instance)&&(null==(i=window.optable)?void 0:i.auth)?e():(window.optable=window.optable||{cmd:[]},window.optable.cmd=(null==(s=window.optable)?void 0:s.cmd)||[],null==(r=window.optable)||r.cmd.push(e))}async resolveRaptiveClusters(e){return new Promise(((t,i)=>{this.addToQueue((()=>{var s,r;if(!(null==(r=window.optable)||null==(s=r.auth)?void 0:s.resolve))return this._logAndReject("resolveRaptiveClusters","Optable SDK 'auth.resolve' method not available after loading SDK",i);window.optable.auth.resolve(e).then((e=>{const i=(e=>{const t={metadata:{totalClusterCount:0,totalSourceCount:0,uniqueSources:[],uniqueIds:[],uniqueTraits:[],lastSeen:null,lastSeenSource:null,lastSeenSourceClusterCount:0,lastSeenSourceIds:[],lastSeenSourceTraits:[]},sources:{raptive:{clusters:[]}}};if(!e.clusters)return t;let i=[],s=[];return e.clusters.forEach((e=>{const r={cookieDeprecationLabel:[],lastSeen:null,hemCollectionDate:[],hemSites:[],hemSources:[],browser:[],device:[],os:[],trueDataHems:[]};var n;e.traits.forEach((e=>{const{key:t,value:i}=e;switch(t){case"cookieDeprecationLabel":r.cookieDeprecationLabel.push(i);break;case"hem_cd":const e=new Date(i).getTime();var s;r.hemCollectionDate.push(e),e>(null!=(s=r.lastSeen)?s:0)&&(r.lastSeen=e);break;case"hem_dates":const t=new Date(i).getTime();var n;t>(null!=(n=r.lastSeen)?n:0)&&(r.lastSeen=t);break;case"hem_sites":r.hemSites.push(i);break;case"hem_sources":r.hemSources.push(i);break;case"browser":r.browser.push(i);break;case"device":r.device.push(i);break;case"os":r.os.push(i);break;case"td_hems":r.trueDataHems.push(i)}})),Object.entries(r).forEach((([e,t])=>{Array.isArray(t)&&(r[e]=Array.from(new Set(t)).sort(qn))})),t.sources.raptive.clusters.push({ids:Array.from(new Set(null!=(n=e.ids)?n:[])).sort(qn),traits:r}),t.metadata.uniqueIds.push(...e.ids),t.metadata.uniqueTraits.push(...Object.keys(r)),r.lastSeen&&(!t.metadata.lastSeen||r.lastSeen>t.metadata.lastSeen)&&(t.metadata.lastSeen=r.lastSeen,t.metadata.lastSeenSource="raptive",i=e.ids,s=Object.keys(r))})),t.metadata.lastSeenSourceIds=Kn(i),t.metadata.lastSeenSourceTraits=Kn(s),t.metadata.totalClusterCount=t.sources.raptive.clusters.length,t.metadata.lastSeenSourceClusterCount=t.sources.raptive.clusters.length,t.metadata.totalSourceCount=1,t.metadata.uniqueSources.push("raptive"),t.metadata.uniqueIds=Kn(t.metadata.uniqueIds),t.metadata.uniqueTraits=Kn(t.metadata.uniqueTraits),Object.values(t.sources).forEach((e=>{e.clusters.sort(((e,t)=>Gn(e.traits,t.traits)))})),t})(e);t(i)})).catch(i)}))}))}async resolveThirdPartyClusters(e){return new Promise(((t,i)=>{this.addToQueue((()=>{var s,r;if(!(null==(r=window.optable)||null==(s=r.instance)?void 0:s.resolve))return this._logAndReject("resolveThirdPartyClusters","Optable SDK 'instance.resolve' method not available after loading SDK",i);window.optable.instance.resolve(e).then((e=>{const i=(e=>{var t;const i={metadata:{totalClusterCount:0,totalSourceCount:0,uniqueSources:[],uniqueIds:[],uniqueTraits:[],lastSeen:null,lastSeenSource:null,lastSeenSourceClusterCount:0,lastSeenSourceIds:[],lastSeenSourceTraits:[]},sources:{mediawallah:{clusters:[]},truedata:{clusters:[]}},lmpid:null!=(t=e.lmpid)?t:""};return e.clusters?(e.clusters.forEach((e=>{const t={},s={last_seen:e=>({lastSeen:1e3*parseInt(e,10)}),percentile:e=>({percentile:parseInt(e)})},r=Array.from(new Set(e.ids)).sort(qn);e.traits.forEach((e=>{const{key:i,value:r}=e;s[i]&&Object.assign(t,s[i](r))})),i.sources.truedata.clusters.push({ids:r,traits:t}),i.metadata.uniqueIds.push(...r),i.metadata.uniqueTraits.push(...Object.keys(t)),t.lastSeen&&(!i.metadata.lastSeen||t.lastSeen>i.metadata.lastSeen)&&(i.metadata.lastSeen=t.lastSeen,i.metadata.lastSeenSource="truedata",i.metadata.lastSeenSourceIds=r,i.metadata.lastSeenSourceTraits=Object.keys(t).sort(qn))})),i.metadata.totalClusterCount=Object.values(i.sources).reduce(((e,t)=>e+t.clusters.length),0),i.metadata.lastSeenSourceClusterCount="mediawallah"===i.metadata.lastSeenSource?i.sources.mediawallah.clusters.length:i.sources.truedata.clusters.length,i.metadata.uniqueSources=["truedata"],i.metadata.uniqueIds=Kn(i.metadata.uniqueIds),i.metadata.uniqueTraits=Kn(i.metadata.uniqueTraits),i.metadata.totalSourceCount=i.metadata.uniqueSources.length,Object.values(i.sources).forEach((e=>{e.clusters.sort(((e,t)=>Gn(e.traits,t.traits)))})),i):i})(e);t(i)})).catch(i)}))}))}cid(e,t=0){return new Promise(((i,s)=>{this.addToQueue((()=>{var r,n;if(!(null==(n=window.optable)||null==(r=n.SDK)?void 0:r.cid))return this._logAndReject("cid","Optable SDK 'SDK.cid' method not available after loading SDK",s);const a=window.optable.SDK.cid(e,t);i(a)}))}))}eid(e){return new Promise(((t,i)=>{this.addToQueue((()=>{var s,r;if(!(null==(r=window.optable)||null==(s=r.SDK)?void 0:s.eid))return this._logAndReject("eid","Optable SDK 'SDK.eid' method not available after loading SDK",i);const n=window.optable.SDK.eid(e);t(n)}))}))}async identify(...e){return new Promise(((t,i)=>{this.addToQueue((()=>{var s,r;if(!(null==(r=window.optable)||null==(s=r.auth)?void 0:s.identify))return this._logAndReject("identify","Optable SDK 'identify' method not available after loading SDK",i);window.optable.auth.identify(...e).then(t).catch(i)}))}))}async profile(e){return new Promise(((t,i)=>{this.addToQueue((()=>{var s,r;if(!(null==(r=window.optable)||null==(s=r.auth)?void 0:s.profile))return this._logAndReject("profile","Optable SDK 'auth.profile' method not available after loading SDK",i);window.optable.auth.profile(e).then(t).catch(i)}))}))}async targeting(){return new Promise(((e,t)=>{this.addToQueue((()=>{var i,s;if(!(null==(s=window.optable)||null==(i=s.auth)?void 0:i.targeting))return this._logAndReject("targeting","Optable SDK 'auth.targeting' method not available after loading SDK",t);window.optable.auth.targeting().then(e).catch(t)}))}))}async tokenize(e){return new Promise(((t,i)=>{this.addToQueue((()=>{var s,r;if(!(null==(r=window.optable)||null==(s=r.instance)?void 0:s.tokenize))return this._logAndReject("tokenize","Optable SDK 'instance.tokenize' method not available after loading SDK",i);window.optable.instance.tokenize(e).then((e=>t(e))).catch(i)}))}))}installGPTSecureSignals(){return new Promise((e=>{this.addToQueue((()=>{window.googletag=window.googletag||{cmd:[]};const t=window.googletag;t.cmd.push((()=>{t.secureSignalProviders||(t.secureSignalProviders=[]),t.secureSignalProviders.push({id:"loblawmedia.ca",collectorFunction:()=>{var e,t,i;return(null==(t=window.optable)||null==(e=t.auth)?void 0:e.lmpidFromCache)?Promise.resolve(null!=(i=window.optable.auth.lmpidFromCache())?i:""):Promise.resolve("")}})})),e()}))}))}_logAndReject(e,t,i){i(new Error(t))}}class Yn{constructor(){}}class Qn extends Yn{constructor(...e){super(...e),this.truedataHems=[]}}Qn=B([M()],Qn);class Xn extends nr{init(){this._key="Optable",this._default=!1,this._autorun=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",Object)],Xn.prototype,"run",null),Xn=B([hs("OptableExperiment"),M()],Xn);class Jn extends nr{init(){this._key="UseOptableHem",this._default=!1,this._autorun=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",Object)],Jn.prototype,"run",null),Jn=B([hs("UseOptableHemExperiment"),M()],Jn);class Zn{constructor(e){var t,i,s,r;this._optableDisabledRegions=["VT","NE","LA","MO"];const n=null!=(r=null==(t=e.core)?void 0:t.country)?r:"";var a;const o=null!=(a=null==(s=e.core)||null==(i=s.region)?void 0:i.toUpperCase())?a:"";var l;const d=null!=(l=e.deliveryFeatures)?l:[],c=Rt().get("rptbt24"),h=e.invalidTraffic&&"true"!==c,u=Rt().get("optable_identifier");this.enabled=["CA","US"].includes(n)&&!this._optableDisabledRegions.includes(o)&&R.resolve(Xn).result&&!h,this.useOptableHem=this.enabled&&!this._optableDisabledRegions.includes(o)&&R.resolve(Jn).result,this.loblawEnabled=this.enabled&&"CA"===n,this.preloaded=d.includes("optableLoad")&&!d.includes("optableLoad-off"),this.identifierOverride=u?decodeURIComponent(u):void 0}}Zn=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],Zn);class ea extends nr{init(){this._key="GpidGraphBridge",this._default=!1,this._autorun=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ea.prototype,"run",null),ea=B([hs("GpidGraphBridgeExperiment"),M()],ea);class ta extends sr{init(){this._key="IdentityIframeSyncWait"}}ta=B([hs("IdentityIframeSyncWaitExperiment"),M()],ta);class ia extends sr{init(){this._key="OptableClusterLastSeenThreshold",this._autorun=!1}}ia=B([hs("OptableClusterLastSeenThresholdExperiment"),M()],ia);const sa=e=>(new TextEncoder).encode(e),ra=async e=>{const t=sa(e);return crypto.subtle.importKey("raw",t.slice(0,16),{name:"AES-GCM"},!1,["encrypt","decrypt"])},na=async(e,t)=>{const i=await ra(t),s=Uint8Array.from(atob(e),(e=>e.charCodeAt(0))),r=s.slice(0,12),n=s.slice(12),a=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},i,n);return JSON.parse((o=a,(new TextDecoder).decode(o)));var o},aa=async(e,t,i=!0,s)=>{const r=kr.readInternalLocalStorage(hi.KEY);let n={};switch(r&&(n="string"==typeof r?await na(r,t):r),e.collectionMethod){case"direct":n.direct=e;break;case"graph3p":n.graph3p=e;break;case"graph1p":n.graph1p=e}if(i){const e=await(async(e,t)=>{const i=await ra(t),s=sa(JSON.stringify(e)),r=crypto.getRandomValues(new Uint8Array(12)),n=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},i,s);return btoa(String.fromCharCode(...new Uint8Array(r),...new Uint8Array(n)))})(n,t);kr.setInternalLocalStorage(hi.KEY,e)}else kr.setInternalLocalStorage(hi.KEY,n)};class oa extends tr{init(){this._key="hemSourceAllowlist",this._default=["none"]}setABGroup(e,t){const i=this._coreExperimentConfig.getCoreExperiment(this.key);i&&this.abgroupClass.set(i.abgroup,"on")}}oa=B([hs("HemSourceAllowlistExperiment"),M()],oa);class la{_getMatchedHemSource(e){const t=e.match(/^l_i$/);if(t)return t[0];const i=e.match(/^(ss)_.*/);if(i)return i[1];const s=e.match(/(?:g_)(.*?)(?:_c|_s)/);if(s&&s[1])return s[1];const r=e.match(/(?:ra_)(.*?)(?:_c|_s)/);if(r&&r[1])return`ra_${r[1]}`;const n=e.match(/(.*?)(?:_c|_s)/);return n&&n[1]?n[1]:void 0}checkSource(e){if(!e)return this.default;var t;const i=null!=(t=this._getMatchedHemSource(this._removeIdentityIframePrefix(e)))?t:"";return!!this.allowedSources.includes(i)||this.default}_removeIdentityIframePrefix(e){const t=e.match(/^l_i-(.*)/);return t&&t[1]?t[1]:e}constructor(e){var t;this.default=!1,this.allowedSources=null!=(t=e.result)?t:[]}}la=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===oa?Object:oa])],la);class da{get rcid(){return this._rcid}get hash(){const e=K.getLocalStorageValue(ui.KEY,!1);return e&&"object"==typeof e&&e.hasOwnProperty("sha256Hash")?this._retrieveValueFromObject(e.sha256Hash):e&&"string"==typeof e&&e.match(/sha256Hash/i)?this._retrieve64BitString(e):void 0}get source(){const e=K.getLocalStorageValue(pi.KEY,!1);return e||void 0}async retrieveRcidFromLocalStorage(){const e=kr.readExternalCookie("_rcid");return this._rcid="string"==typeof e?await na(e,this._site.id):e,this._rcid}_retrieveValueFromObject(e){return"string"==typeof e?e:"object"==typeof e&&e.hasOwnProperty("sha256Hash")?"object"==typeof e.sha256Hash?this._retrieveValueFromObject(e.sha256Hash):e.sha256Hash:void 0}_retrieve64BitString(e){const t=/\w{64}/.exec(e);return t?t[0]:void 0}constructor(e){this._site=e,this._rcid=null}}da=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ys?Object:Ys])],da);class ca{constructor(e,t,i){this._optableConfig=e,this._user=t,this._hemSourceAllowlist=i,this.share=({blockGraphHem:e}={blockGraphHem:!1})=>{if(this._hash=this._user.hash,this._source=this._user.source,!this._hash||!this._source)return!1;const t=!(!this._source||!fi({source:this._source,identifierType:"truedata"}));var i;const s=null!=(i=t&&e)&&i,r=t&&!this._optableConfig.useOptableHem;return!s&&(!r&&(!(!this._hash||!this._source)&&this._hemSourceAllowlist.checkSource(this._source)))}}}ca=B([L(),j("design:type",Function),j("design:paramtypes",[void 0===Zn?Object:Zn,void 0===da?Object:da,void 0===la?Object:la])],ca);const ha=()=>kr.readExternalLocalStorage("_pubcid"),ua=(e,t)=>{var i;return!(null==(i=e.subModule)?void 0:i.some((e=>e===t)))};class pa{async load(){try{if(this._optableTimingData.bootstrapStarted=ls(),!this._optableConfig.enabled)return;if(this._gpcConfig.gpcEnabled||this._ccpaConfig.userOptedOut)return;await this._initOptableSDK(),await this._start(),this._optableTimingData.bootstrapFinished=ls(),this._shouldLogTimingData()&&te.event("OptableBootstrap","load","Optable timing data",this._optableTimingData)}catch(e){te.error("OptableBootstrap","load","Failed to bootstrap Optable SDK",e)}}_shouldLogTimingData(){return Math.random()>=.95}get _optableSdkPreloaded(){return this._optableConfig.preloaded&&this._optableSdkWrapper.loaded()}async _initOptableSDK(){this._optableSdkPreloaded||await this._optableSdkWrapper.load(this._siteId),this._optableConfig.loblawEnabled&&(this._optableSdkWrapper.installGPTSecureSignals(),this._optableSdkWrapper.targeting())}async _start(){var e;if(!(null==(e=window.optable)?void 0:e.instance))return;const t=kr.readInternalLocalStorage("adt_ei"),i=kr.readInternalLocalStorage("adt_emsrc"),s=null==t?void 0:t.sha256Hash,r=!!s,n=null==i?void 0:i.includes(pi.PREFIXES.IDG),a=r&&n,o=r&&!a;a?await this._resolveHemFromGraph({resolveRaptiveDCN:!0,resolveExternalSourceDCN:!1,storeNewHem:!0,storedHem:s}):o?await this._resolveHemFromGraph({resolveRaptiveDCN:!1,resolveExternalSourceDCN:!0,storeNewHem:!1,storedHem:s}):!r&&xi()&&await this._resolveHemFromGraph({resolveRaptiveDCN:!0,resolveExternalSourceDCN:!0,storeNewHem:!0,storedHem:s})}async _resolveHemFromGraph(e){let t;const i=await this._readRcidCookieValue();if(i&&i.value&&i.value.sharedId&&(t=await this._resolveHemFromRaptiveDCN(i.value.sharedId,3,pi.VALUES.RCID)),!(null==t?void 0:t.hem)&&e.resolveRaptiveDCN){const e=ha();e&&(t=await this._resolveHemFromRaptiveDCN(e,6,pi.VALUES.SHID))}const{gpid:s}=this._context;if(!(null==t?void 0:t.hem)&&s&&e.resolveRaptiveDCN&&this._gpidGraphBridgeExperiment.result&&(t=await this._resolveHemFromRaptiveDCN(s,0,pi.VALUES.GPID)),!(null==t?void 0:t.hem)&&e.resolveRaptiveDCN){const e=(()=>{const e=kr.readExternalCookie("panoramaId"),t=kr.readExternalCookie("panoramaId_expiry");if(e&&t&&Number(t)>Date.now())return e;const i=kr.readExternalLocalStorage("panoramaId"),s=kr.readExternalLocalStorage("panoramaId_expiry");return i&&s&&Number(s)>Date.now()?i:null})();e&&(t=await this._resolveHemFromRaptiveDCN(e,7,pi.VALUES.LPID))}!(null==t?void 0:t.hem)&&e.resolveExternalSourceDCN&&(t=await this._resolveHemFromThirdPartyDCN(e)),await this._waitForIdentityIframeSync();const r=kr.readInternalLocalStorage("adt_emsrc"),n=r&&_i(r);t&&e.storeNewHem&&!n&&this._emailCaptureHandler.emailCaptured.emit({pii:{sha256Hash:t.hem,source:t.source,sourceCollectedDate:ei()},identityDataSource:t.source.startsWith(`${pi.PREFIXES.RAPTIVE_AUTH}${pi.VALUES.GPID}`)?"raptiveDCN":"externalDCN"})}async _resolveHemFromRaptiveDCN(e,t,i){this._optableTimingData.raptiveResolveStarted=ls();const s=await this._optableSdkWrapper.cid(e,t),r=await this._optableSdkWrapper.resolveRaptiveClusters(s);this._optableTimingData.raptiveResolveFinished=ls();const n=r.sources.raptive.clusters.filter((e=>e.ids.includes(s)&&e.ids.some((e=>e.startsWith(ci))))),a=n.reduce(((e,t)=>{const i=t.ids.filter((e=>e.startsWith(ci)));return[...e,...i]}),[]),o=a[Math.floor(Math.random()*a.length)],l=null==o?void 0:o.substring(ci.length);return l?{hem:l,source:`${pi.PREFIXES.RAPTIVE_AUTH}${i}${pi.SUFFIXES.CAPTURE}`}:void 0}async _resolveHemFromThirdPartyDCN(e){var t;const i=await this._readRcidCookieValue();var s;const r=null!=(s=this._optableConfig.identifierOverride)?s:Ui(null==i?void 0:i.metadata.clientIp);this._optableTimingData.resolveStarted=ls();const n=await this._optableSdkWrapper.resolveThirdPartyClusters(r);var a;this._optableTimingData.resolveFinished=ls(),this._optableConfig.loblawEnabled&&n.lmpid&&localStorage.setItem(mi.KEY,n.lmpid);const o=null!=(a=this._optableClusterLastSeenThresholdExperiment.result)?a:90,l=Math.floor(Date.now()/1e3)-24*o*60*60,d=[...n.sources.truedata.clusters,...n.sources.mediawallah.clusters].sort(((e,t)=>t.traits.lastSeen-e.traits.lastSeen)),c=d.filter((e=>{const t=e.traits.lastSeen,i="percentile"in e.traits?e.traits.percentile:void 0;return t?t>=l:!!i&&i>=55})),h=c.reduce(((e,t)=>[...e,...t.ids.filter((e=>e.startsWith(ci)))]),[]),u=n.sources.truedata.clusters.reduce(((e,t)=>[...e,...t.ids.filter((e=>e.startsWith(ci)))]),[]);var p;h.length>0&&(this._optableStore.truedataHems=u);const g={clusterCount:c.length,hemCount:h.length,traits:null!=(p=null==(t=c[0])?void 0:t.traits)?p:{},accuracyResult:{status:"no-stored-hem"},recencyGroup:c[0]?Ni(c[0].traits.lastSeen):"NA"};if(e.storedHem){const t=c.filter((t=>t.ids.some((t=>t.includes(e.storedHem))))),i=c.reduce(((e,i,s)=>t.includes(i)?s:e),-1);var m;if(-1!==i)g.accuracyResult={status:"hem-found",matchingClusterIndex:i},g.traits=(null==(m=c[i])?void 0:m.traits)||[];else g.accuracyResult={status:"no-stored-hem"};te.event("OptableBootstrap","_resolveHemFromExternalSourceDCN",g)}if(this._identityEventBus.optableResolved.emit(g),!h.length)return;if(!e.storeNewHem)return;if(!c.length||c.length>this._optableClusterMatchLimit||!h.length)return;const _=h[Math.floor(Math.random()*h.length)],f=ci.length,v=null==_?void 0:_.substring(f);return v?{hem:v,source:`${pi.PREFIXES.IDG}${pi.VALUES.TD}${pi.SUFFIXES.CAPTURE}`}:void 0}_getHemsFromCluster(e){var t;return null!=(t=null==e?void 0:e.ids.filter((e=>e.startsWith(ci))))?t:[]}_waitForIdentityIframeSync(){var e;const t=null!=(e=this._identityIframeSyncWaitExperiment.result)?e:0;return new Promise((e=>{const i=setTimeout((()=>{this._identityEventBus.iframeDataSynced.off(s),e()}),t),s=()=>{clearTimeout(i),this._identityEventBus.iframeDataSynced.off(s),e()};this._identityEventBus.iframeDataSynced.on(s,{handleEventsAlreadyEmitted:!0})}))}async _readRcidCookieValue(){let e=kr.readExternalCookie("_rcid");return"string"==typeof e&&(e=await na(e,this._siteId)),e}constructor(e,t,i,s,r,n,a,o,l,d,c,h){this._optableConfig=t,this._optableStore=i,this._gpcConfig=s,this._ccpaConfig=r,this._context=n,this._emailCaptureHandler=a,this._identityEventBus=o,this._optableSdkWrapper=l,this._gpidGraphBridgeExperiment=d,this._identityIframeSyncWaitExperiment=c,this._optableClusterLastSeenThresholdExperiment=h,this.type=oe.Optable,this.wait=!1,this._optableClusterMatchLimit=4,this._optableTimingData={},this._siteId="",this._siteId=e.siteAds.siteId}}pa=B([hs("OptableBootstrap"),M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Zn?Object:Zn,void 0===Qn?Object:Qn,void 0===an?Object:an,void 0===nn?Object:nn,void 0===Pr?Object:Pr,void 0===Hn?Object:Hn,void 0===Ls?Object:Ls,void 0===Wn?Object:Wn,void 0===ea?Object:ea,void 0===ta?Object:ta,void 0===ia?Object:ia])],pa);class ga{async load(){return this._isGPTPreloaded?Promise.resolve(!0):(this.init(),vi(this._url))}init(){window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[]}constructor({isGPTPreloaded:e}){this._url="https://securepubads.g.doubleclick.net/tag/js/gpt.js",this._isGPTPreloaded=e}}ga=B([hs("GAMBootstrap"),L(),j("design:type",Function),j("design:paramtypes",[void 0===tn?Object:tn])],ga);class ma extends sr{init(){this._key="MarmaladeBootstrap"}run(){return super.run()}}ma=B([hs("MarmaladeBootstrapTimeoutExperiment"),M()],ma);class _a{setMarmaladeFinishedTimeout(e){this._marmaladeFinishedTimeout=e}async get(){if(window.adthrive.marmalade){const e=await window.adthrive.marmalade;return this._emitMarmaladeResponse(e),e}const e=new Promise((e=>{window.adthrive.marmaladeFinished=t=>(clearTimeout(this._timeoutId),e(t),t)})).then((e=>(this._emitMarmaladeResponse(e),e))),t=new Promise((e=>{this._timeoutId=window.setTimeout((()=>{const t=window.adthrive.marmalade||{};this._emitMarmaladeResponse(t),e(t)}),this._marmaladeFinishedTimeout)}));return Promise.race([e,t])}_emitMarmaladeResponse(e){e&&Object.keys(e).length>0&&this._eventBus.marmaladeResponseLoaded.emit(e)}constructor(e,t){this._eventBus=e,this._timeoutExp=t,this._marmaladeFinishedTimeout=this._timeoutExp.result?1e3*this._timeoutExp.result:3e3}}_a=B([hs("MarmaladeBootstrap"),L(),j("design:type",Function),j("design:paramtypes",[void 0===js?Object:js,void 0===ma?Object:ma])],_a);class fa{async load(){return this.init(),this._isPrebidPreloaded?"preloaded":await vi(this._url)}init(){window.pbjs=window.pbjs||{},window.pbjs.que=window.pbjs.que||[]}constructor({baseUrl:e,targetPath:t,isPrebidPreloaded:i}){this.type=oe.Prebid,this.wait=!1,this._url=`${e}/vendor/prebid${t}/prebid.min.js`,this._isPrebidPreloaded=i}}fa=B([hs("PrebidBootstrap"),L(),j("design:type",Function),j("design:paramtypes",[void 0===tn?Object:tn])],fa);class va extends sr{init(){this._key="Floors"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],va.prototype,"run",null),va=B([hs("FloorsExperiment"),M()],va);class ya{get result(){return this._result}_enableRaptiveFloors(){this._result.raptive=!0}_enableLegacyFloors(){this._result.legacy=!0}_getFloorsExperimentResults(){const e=this._floorsExperiment.result,t=e===le.cm,i=e===le.fbrap;return{cm:t,fbrap:i,rapML:e===le.rapml,enableLegacy:i||t}}_setExpResults({cm:e,fbrap:t}){const i=this._result;e&&(i.cm=e),t&&(i.fbrap=t)}run(){const e=this._getFloorsExperimentResults(),{enableLegacy:t,fbrap:i,rapML:s}=e;this._setExpResults(e),(s||i)&&this._enableRaptiveFloors(),t&&this._enableLegacyFloors()}constructor(e,t){this._floorsExperiment=e,this.abGroup=t,this._result={raptive:!1,legacy:!1,fbrap:!1,cm:!1,percentile:{lazy:0}},this.run()}}ya=B([hs("FloorsExperimentHandler"),M(),j("design:type",Function),j("design:paramtypes",[void 0===va?Object:va,void 0===Qs?Object:Qs])],ya);let ba=class{savePriorityFloorData(e,t,i){const s=this._floorsPriorityData.get(e);this._floorsPriorityData.set(e,{...s,[i]:t})}get floorsData(){return this._floorsData}set floorsData(e){this._floorsData=e}get floorsExperiment(){return this._enabledFloorsExperiments.result}get activeFloorsData(){return this._floorsPriorityData}get cmPriority(){return this._fpv?this._cmFPVPriority:this._cmNonFPVPriority}get activeFloorsTypes(){return this._activeFloorsTypes}addActiveFloorsType(e){return this._activeFloorsTypes.push(e)}get customSchemaFields(){return this._customSchemaFields}getSchemaFieldOrder(e){return this._schemaFieldOrder.get(e)}get raptiveMLRefreshFloors(){return this._raptiveMLRefreshFloors}set raptiveMLRefreshFloors(e){this._raptiveMLRefreshFloors=e}get modelTimestamp(){return this._modelTimestamp}set modelTimestamp(e){this._modelTimestamp=e}setAdditionalSchemaFields(e){for(const t of e)if(this._schemaFieldOrder.set(t,e.indexOf(t)||0),!this._standardSchemaFields.has(t)){const e=this._customFieldsMap.get(t)||this._customFieldsMap.get("*");this._customSchemaFields[t]=e}}constructor(e){this._enabledFloorsExperiments=e,this.floorsDataReady=new Q,this.floorsTypeExcludes=new Set([de.raptive]),this.amazonSlotCpm=new Map,this._activeFloorsTypes=[],this._cmFPVPriority=[de.refresh,de.lazyBidPool,de.lazy,de.session],this._cmNonFPVPriority=[de.refresh,de.lazyBidPool,de.session,de.lazy],this._customFieldsMap=new Map([["hvp",e=>{const t=e.ortb2Imp.ext.data.hvp;return t?`${t}`:"*"}],["hour",()=>"*"],["*",()=>"*"]]),this._customSchemaFields={},this._floorsPriorityData=new Map,this._schemaFieldOrder=new Map([["adUnitCode",1]]),this._standardSchemaFields=new Set(["size","mediaType","gptSlot","domain","adUnitCode"]),this._modelTimestamp=0,this._fpv=!0===K.getLocalStorageValue("session_fpv")||null===K.getLocalStorageValue("session_fpv")}};ba=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===ya?Object:ya])],ba);class Sa extends sr{init(){this._key="FloorBootstrap"}run(){return super.run()}}Sa=B([hs("FloorsBootstrapTimeoutExperiment"),M()],Sa);class Ea{_resolveFloorsData(e){return Promise.resolve(e).then((e=>{if(e&&Object.keys(e).length){const i=e.floors?e.floors:e,s=e.refreshFloors;var t;return this._floorsConfig.floorsData=i,this._floorsConfig.raptiveMLRefreshFloors=s,this._floorsConfig.modelTimestamp=null!=(t=i.modelTimestamp)?t:0,this._floorsConfig.floorsDataReady.emit(),i}return{}}))}async get(){if(!this._isRaptive)return Promise.resolve({});const e=window.adthrive.raptiveFloors;if(e)return this._resolveFloorsData(e);const t=new Promise((e=>{window.adthrive.raptiveFloorsFinished=e})),i=new Promise((e=>{setTimeout((()=>{e({})}),this._floorsFinishedTimeout)}));return Promise.race([t,i]).then((()=>this._resolveFloorsData(window.adthrive.raptiveFloors)))}constructor(e,t){this._floorsConfig=e,this._timeoutExp=t,this._isRaptive=!1,this._floorsFinishedTimeout=this._timeoutExp.result?1e3*this._timeoutExp.result:3e3,this._isRaptive=this._floorsConfig.floorsExperiment.raptive}}Ea=B([hs("FloorsBootstrap"),L(),j("design:type",Function),j("design:paramtypes",[void 0===ba?Object:ba,void 0===Sa?Object:Sa])],Ea);class Ca{async start(){this._ccpaConfig.enabled||(await this.addIframeToPage(),this._marmaladeEventBus.marmaladeResponseLoaded.on((e=>{const t=e.recencyFrequency;Array.isArray(t)&&t.length&&this.setMcmpData(t)}),{handleEventsAlreadyEmitted:!0}),this._ccpaConfig.consentChange.on((e=>{e===this._ccpaConfig.ccpaOptOut&&this.deleteMcmpData()})))}get recencyFrequencyIframeLocation(){return`${this._baseUrl}/html/rnf.html`}addIframeToPage(){let e;const t=new Promise((t=>{e=t}));this._frame.onload=()=>{e()};try{this._frame.src=this.recencyFrequencyIframeLocation,this._frame.id="adthrive-mcmp",this._frame.style.display="none",document.body.appendChild(this._frame)}catch(e){te.error("RecencyAndFrequencyIFrameManager","addIframeToPage","Failed to append rnf iframe to document",e)}return t}deleteMcmpData(){try{this._frame.contentWindow&&this._frame.contentWindow.postMessage({message:"deleteMcmpData"},this._host)}catch(e){te.error("RecencyAndFrequencyIFrameManager","deleteMcmpData","Failed to delete mcmp data",e)}}setMcmpData(e){try{this._frame.contentWindow&&(window.addEventListener("message",(e=>{const t=e.data,i=t.message;e.origin===this._host&&"mcmpDataResponse"===i&&this._marmaladeEventBus.recencyFrequencyDataSet.emit(t.mcmpData)})),this._frame.contentWindow.postMessage({message:"setMcmpData",mcmpData:e},this._host))}catch(e){te.error("RecencyAndFrequencyIFrameManager","setMcmpData","Failed to set mcmp data",e)}}constructor(e,t,i){this._bootstrapConfig=e,this._ccpaConfig=t,this._marmaladeEventBus=i,this._host=`https://${this._bootstrapConfig.host}`,this._baseUrl=this._bootstrapConfig.baseUrl,this._frame=document.createElement("iframe")}}Ca=B([hs("RecencyAndFrequencyIFrameManager"),M(),j("design:type",Function),j("design:paramtypes",[void 0===tn?Object:tn,void 0===nn?Object:nn,void 0===js?Object:js])],Ca);const Ta=e=>{const t={index:-1,weight:-1};if(!e||0===e.length)return t;const i=e.reduce(((e,t)=>e+t),0);if(0===i)return t;const s=Math.random()*i;let r=0,n=e[r];for(;s>n;)n+=e[++r];return{index:r,weight:e[r]}};class wa extends nr{init(){this._key="OptimalDisplayBidders",this._default=!1}}wa=B([hs("OptimalDisplayBiddersExperiment"),M()],wa);class Aa extends nr{init(){this._key="OptimalVideoBidders",this._default=!1}}Aa=B([hs("OptimalVideoBiddersExperiment"),M()],Aa);const ka="no-data",Ia="no-model-group",Pa="network-error";class Oa{setupData(e){this.optimalBidderSchemaData=e,this._setOptimalBidderModelGroup(e),this.setModelVersion()}optimalBidderDataExists(){var e,t;const i=null!=(t=null==(e=window.adthrive.deliveryFeatures)?void 0:e.includes("optimalBidders"))&&t&&!!this.optimalBidderSchemaData&&!!this.optimalBidderModelGroup&&!!this.modelVersion;return i||this.errors.add(ka),i}_setOptimalBidderModelGroup(e){const t=e.modelGroups.map((e=>e.modelWeight)),{index:i}=Ta(t),s=e.modelGroups[i];s?this.optimalBidderModelGroup=s:this.errors.add(Ia)}setModelVersion(){var e,t,i;this.modelVersion=null!=(i=null==(e=this.optimalBidderSchemaData)?void 0:e.modelVersion)?i:null==(t=this.optimalBidderModelGroup)?void 0:t.modelName}constructor(e,t){this.optvExperiment=e,this.optdExperiment=t,this.optimalBidderReady=new Q,this.optvExperimentActive=!1,this.optdExperimentActive=!1,this.errors=new Set,this.optvExperimentActive=this.optvExperiment.result,this.optdExperimentActive=this.optdExperiment.result}}Oa=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Aa?Object:Aa,void 0===wa?Object:wa])],Oa);class xa{resolveOptimalBidderData(e){return Promise.resolve(e).then((e=>{var t;return(null==e||null==(t=e.modelGroups)?void 0:t.length)>0?(this.optimalBidder.setupData(e),this.optimalBidder.optimalBidderReady.emit(),e):(this.optimalBidder.errors.add(ka),{})}))}async get(){if(!this.optimalBidderDeliveryFeatureEnabled||!this.optimalBidder.optvExperimentActive&&!this.optimalBidder.optdExperimentActive)return Promise.resolve({});const e=window.adthrive.optimalBidders;if(e)return this.resolveOptimalBidderData(e);const t=new Promise((e=>{window.adthrive.optimalBiddersFinished=e})),i=new Promise((e=>{setTimeout((()=>{this.optimalBidder.errors.add(Pa),e({})}),this.timeout)}));return Promise.race([t,i]).then((()=>this.resolveOptimalBidderData(window.adthrive.optimalBidders)))}constructor(e,t){var i,s;this.optimalBidder=t,this.timeout=3e3,this.optimalBidderDeliveryFeatureEnabled=!1,this.optimalBidderDeliveryFeatureEnabled=null!=(s=null==(i=e.deliveryFeatures)?void 0:i.includes("optimalBidders"))&&s}}xa=B([hs("OptimalBidderBootstrap"),L(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Oa?Object:Oa])],xa);class Ra{async run(){const e=this._run((()=>this._floors.get()),oe.Floors);let t;this.loadNonBlockingLibraries();const i=this._run((()=>this._gam.load()),oe.GAM,{required:!0}).catch((e=>this.gamFallback(e&&e.result,t))),s=t=this._run((()=>this._marmalade.get()),oe.Marmalade),r=this._run((()=>this._optimalBidder.get()),oe.OptimalBidder),n=this._user.retrieveRcidFromLocalStorage();return Promise.all([i,s,e,r,Ct(),n]).then((([e,t,i,s])=>({gam:e,marmalade:t,floors:i,optimalBidder:s})))}loadNonBlockingLibraries(){[this._prebid,this._amazon,this._optable].forEach((e=>{this._run((()=>this._bootstrapConfig.bootstrapLoaders[e.type]=e.load().catch((t=>{throw this._bootstrapEventBus.libraryLoadFailed.emit({bootstrapType:e.type}),new Error(t)}))),e.type,{wait:e.wait}).catch((()=>!1))}))}gamFallback(e,t){return this._bootstrapConfig.gptLibFailedToLoad=!0,this._bootstrapConfig.webVitalsEnabled||(this._bootstrapConfig.webVitalsEnabled=!0),t.then((t=>Promise.reject({message:e,marmalade:t})))}_run(e,t,{required:i=!1,wait:s=!0}={}){const r=ls(),n=e=>{const i=ls(),s={result:e,started:r,finished:i,duration:i-r};return this._bootstrapConfig.bootstrapResult.set(t,s),s},a=e().then(n,(e=>(te.error("Bootstrap","_start error",t,e),i?Promise.reject(n(e.message)):n(e.message))));return s?a:Promise.resolve(n(!0))}constructor(e,t,i,s,r,n,a,o,l,d){this._bootstrapConfig=e,this._user=t,this._bootstrapEventBus=i,this._amazon=s,this._optable=r,this._gam=n,this._marmalade=a,this._prebid=o,this._floors=l,this._optimalBidder=d;R.resolve(Ca).start().catch((e=>{te.error("Bootstrap","constructor","Failed to start RecencyAndFrequencyIFrameManager",e)}))}}Ra=B([L(),j("design:type",Function),j("design:paramtypes",[void 0===tn?Object:tn,void 0===da?Object:da,void 0===Os?Object:Os,void 0===sn?Object:sn,void 0===pa?Object:pa,void 0===ga?Object:ga,void 0===_a?Object:_a,void 0===fa?Object:fa,void 0===Ea?Object:Ea,void 0===xa?Object:xa])],Ra);class Da extends sr{init(){this._key="AmazonFailsafeTimeout"}}Da=B([hs("AmazonFailsafeTimeoutExperiment"),M()],Da);class La{getEncryptedTargetingKeys(e={dealKeys:!1,nonDealKeys:!1}){return e.dealKeys?this._amznEncryptedTargetingKeys.filter((e=>e.includes("_sp"))).concat("amzndeal_sp"):e.nonDealKeys?this._amznEncryptedTargetingKeys.filter((e=>!e.includes("_sp"))):this._amznEncryptedTargetingKeys}constructor(e,t,i){this.pubId="4fbba76f-7987-4fa2-9733-c27eb3a2170b",this.adUnitExclusions=new Set([ge.Interstitial]),this.amznTargetingKeys=[],this.advertiserId=4526447244,this._availableBids=new Map,this._amznDecryptedTargetingKeys=["amz_pb","amz_bidder","amz_pb_sp","amz_bidder_sp"],this._amznEncryptedTargetingKeys=["amznbid","amzniid","amznp","amznsz","mediaType","amznbid_sp","amzniid_sp","amznp_sp","amznsz_sp","mediaType_sp"];const s=t.amazonEnabled;this.enabled=s&&!0===e.siteAds.adOptions.amazonUAM,this.amznTargetingKeys=["amzndeal_sp",...this._amznEncryptedTargetingKeys,...this._amznDecryptedTargetingKeys],this.failsafeTimeout=i.result||1e3}}La=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===tn?Object:tn,void 0===Da?Object:Da])],La);class Ma extends Er{constructor(e){super(),this._featureRollouts=e.enabled&&e.siteAds.featureRollouts||{}}}class Ba{get enabled(){return!!this._clsGlobalData&&!!this._clsGlobalData.siteAds&&as(this._clsGlobalData.siteAds)}get error(){return!(!this._clsGlobalData||!this._clsGlobalData.error)}set siteAds(e){this._clsGlobalData.siteAds=e}get siteAds(){return this._clsGlobalData.siteAds}set disableAds(e){this._clsGlobalData.disableAds=e}get disableAds(){return this._clsGlobalData.disableAds}set enabledLocations(e){this._clsGlobalData.enabledLocations=e}get enabledLocations(){return this._clsGlobalData.enabledLocations}get injectedFromPlugin(){return this._clsGlobalData.injectedFromPlugin}set injectedFromPlugin(e){this._clsGlobalData.injectedFromPlugin=e}get injectedFromSiteAds(){return this._clsGlobalData.injectedFromSiteAds}set injectedFromSiteAds(e){this._clsGlobalData.injectedFromSiteAds=e}overwriteInjectedSlots(e){this._clsGlobalData.injectedSlots=e}setInjectedSlots(e){this._clsGlobalData.injectedSlots=this._clsGlobalData.injectedSlots||[],this._clsGlobalData.injectedSlots.push(e)}get injectedSlots(){return this._clsGlobalData.injectedSlots}setInjectedVideoSlots(e){this._clsGlobalData.injectedVideoSlots=this._clsGlobalData.injectedVideoSlots||[],this._clsGlobalData.injectedVideoSlots.push(e)}get injectedVideoSlots(){return this._clsGlobalData.injectedVideoSlots}setInjectedScripts(e){this._clsGlobalData.injectedScripts=this._clsGlobalData.injectedScripts||[],this._clsGlobalData.injectedScripts.push(e)}get getInjectedScripts(){return this._clsGlobalData.injectedScripts}setExperiment(e,t,i=!1){this._clsGlobalData.experiments=this._clsGlobalData.experiments||{},this._clsGlobalData.siteExperiments=this._clsGlobalData.siteExperiments||{};(i?this._clsGlobalData.siteExperiments:this._clsGlobalData.experiments)[e]=t}getExperiment(e,t=!1){const i=t?this._clsGlobalData.siteExperiments:this._clsGlobalData.experiments;return i&&i[e]}setWeightedChoiceExperiment(e,t,i=!1){this._clsGlobalData.experimentsWeightedChoice=this._clsGlobalData.experimentsWeightedChoice||{},this._clsGlobalData.siteExperimentsWeightedChoice=this._clsGlobalData.siteExperimentsWeightedChoice||{};(i?this._clsGlobalData.siteExperimentsWeightedChoice:this._clsGlobalData.experimentsWeightedChoice)[e]=t}getWeightedChoiceExperiment(e,t=!1){var i,s;const r=t?null==(i=this._clsGlobalData)?void 0:i.siteExperimentsWeightedChoice:null==(s=this._clsGlobalData)?void 0:s.experimentsWeightedChoice;return r&&r[e]}get branch(){return this._clsGlobalData.branch}get bucket(){return this._clsGlobalData.bucket}set videoDisabledFromPlugin(e){this._clsGlobalData.videoDisabledFromPlugin=e}get videoDisabledFromPlugin(){return this._clsGlobalData.videoDisabledFromPlugin}set targetDensityLog(e){this._clsGlobalData.targetDensityLog=e}get targetDensityLog(){return this._clsGlobalData.targetDensityLog}shouldHalveIOSDensity(){const e=new Ma(this);return Ft()&&e.isRolloutEnabled("iOS-Resolution")}getTargetDensity(e){return this.shouldHalveIOSDensity()?e/2:e}get removeVideoTitleWrapper(){return this._clsGlobalData.siteAds.adOptions.removeVideoTitleWrapper}constructor(){this._clsGlobalData=Kt()}}const Fa=250;class ja{get enabled(){return this._clsOptimizedAds||this._clsOptions.enabled&&(this._clsOptions.injectedFromPlugin||this._clsOptions.injectedFromSiteAds)}getDivHeight(e,t){const i=this._map.get(t);return i&&i[e]||this._defaultHeight}setStyle(e,t){(t===ge.Footer||this.enabled&&this._map.get(this._context.device)[t])&&(e.style.minHeight=`${this._map.get(this._context.device)[t]}px`,e.classList.add("adthrive-ad-cls"))}constructor(e,t,i,s){if(this._context=t,this._abgroup=i,this._clsOptions=s,this._defaultHeight=Fa,this._map=new Map([["phone",{Content:Fa,Recipe:Fa,Header:50,Footer:50,Below_Post:Fa,Sidebar:Fa}],["tablet",{Content:Fa,Recipe:Fa,Header:90,Footer:90,Below_post:Fa,Sidebar:Fa}],["desktop",{Content:Fa,Recipe:Fa,Header:90,Footer:90,Below_Post:Fa,Sidebar:Fa}]]),this._clsOptimizedAds=e.siteAds.adOptions.clsOptimizedAds,this._clsOptions.enabled){const e="clsins_ss",t=this._clsOptions.getExperiment(e);t&&this._abgroup.set(e,String(t));["cls-insertion","cls-header-insertion","cls-disable-ads"].filter((e=>{if(this._clsOptions.branch){const t="script[id^="+`${e}-${this._clsOptions.branch}`+"]";return document.querySelectorAll(t).length>0}return!1})).forEach((e=>this._clsOptions.setInjectedScripts(e)))}}}ja=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Pr?Object:Pr,void 0===Qs?Object:Qs,void 0===Ba?Object:Ba])],ja);class Na{constructor(e,t){this._footerConfigEventBus=t,this.tracker=!0,this.gdpr=!1,this._footerMessages=new Map([["FamilyParenting","CafeMedia Family & Parenting"],["Finance","CafeMedia Finance"],["Food","CafeMedia Food"],["General","CafeMedia"],["HomeDIY","CafeMedia Home/DIY"],["Lifestyle","CafeMedia Lifestyle"],["Pets","CafeMedia Pets"],["Tech","CafeMedia Tech"],["Travel","CafeMedia Travel"]]);const{comscore:i,comscoreFooter:s}=e.siteAds.adOptions;this.category=bt(i,"General"),this.comscore=bt(s,!0),this.comscoreMessage=bt(this._footerMessages.get(this.category),"CafeMedia"),this._footerConfigEventBus.comscoreInitialized.emit(this.comscore)}}Na=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Ds?Object:Ds])],Na);class Ua{removeClsDivs(e){if(!this._clsOptions.enabled)return;const t=this._clsOptions.injectedSlots.filter((t=>{const i=t.element;let s=!1;return i.parentNode&&e.some((e=>i.classList.contains(e)))&&(i.parentNode.removeChild(i),s=!0),!s}));this._clsOptions.overwriteInjectedSlots(t)}disableAllAds(e){e&&!ts(e)||(this.all=!0,this.reasons.add("all_page"),this.removeClsDivs(this._clsDivs)),this._log("disableAllAds")}disableContentAds(e){e&&!ts(e)||(this.content=!0,this.recipe=!0,this.locations.add(ge.Content),this.locations.add(ge.Recipe),this.reasons.add("content_page"),this.removeClsDivs(["adthrive-content","adthrive-recipe"])),this._log("disableContentAds")}disablePlaylistPlayers(e){e&&!ts(e)||(this.video=!0,this.locations.add("Video"),this.reasons.add("video_page"),this.adthrive.siteAds.videoPlayers?this._removeCLSVideoPlayers():this._removeLegacyCLSVideoPlayers()),this._log("disablePlaylistPlayers")}_removeCLSVideoPlayers(){var e;null==(e=this.adthrive.siteAds.videoPlayers)||e.players.filter((e=>"stickyPlaylist"===e.type)).map((e=>document.querySelectorAll(`#cls-video-container-${e.playlistId}`))).forEach((e=>{for(let i=0;i<e.length;i++){var t;const s=e[i];null==(t=s.parentNode)||t.removeChild(s)}}))}_removeLegacyCLSVideoPlayers(){var e;const t=null==(e=this.adthrive.siteAds.video)?void 0:e.jwPlaylistId;if(t){const e=document.querySelectorAll(`#cls-video-container-${t}`);for(let t=0;t<e.length;t++){var i;const s=e[t];null==(i=s.parentNode)||i.removeChild(s)}}}urlHasEmail(e){if(!e)return!1;return null!==/([A-Z0-9._%+-]+(@|%(25)*40)[A-Z0-9.-]+\.[A-Z]{2,})/i.exec(e)}constructor(e,t){this.adthrive=e,this._clsOptions=t,this.all=!1,this.content=!1,this.recipe=!1,this.video=!1,this.locations=new Set,this.reasons=new Set,this._clsDivs=["adthrive-below-post","adthrive-content","adthrive-header","adthrive-recipe","adthrive-sidebar"],this.init=()=>{(this.urlHasEmail(window.location.href)||this.urlHasEmail(window.document.referrer))&&(this.all=!0,this.reasons.add("all_email"),this.removeClsDivs(this._clsDivs));try{document.body.classList.contains("adthrive-disable-all")&&(this.all=!0,this.reasons.add("all_plugin")),document.body.classList.contains("adthrive-disable-content")&&(this.content=!0,this.recipe=!0,this.locations.add(ge.Content),this.locations.add(ge.Recipe),this.reasons.add("content_plugin")),null!==document.querySelector(".tag-novideo")&&(this.video=!0,this.locations.add("Video"),this.reasons.add("video_tag")),document.body.classList.contains("adthrive-disable-video")&&(this.video=!0,this.locations.add("Video"),this.reasons.add("video_plugin"))}catch(e){te.error("DisableAds","constructor",{message:e.message});const t="classList"in document.createElement("_");te.error("BodyDeviceClassComponent","init.support",{support:t});const i="classList"in document.body;te.error("BodyDeviceClassComponent","init.supportBody",{supportBody:i})}this._log("init")},this.clear=()=>{this.all=!1,this.content=!1,this.recipe=!1,this.video=!1,this.locations=new Set,this.reasons=new Set},this._log=e=>{},this.init()}}Ua=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Ba?Object:Ba])],Ua);class Va extends tr{init(){this._setAbGroup=!1,this._key="DisplayOpenBidderExperiment",this._default=["none"]}}Va=B([hs("DisplayOpenBidderExperiment"),M()],Va);class za{constructor(e){this.bidders=e.result||["none"]}}za=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Va?Object:Va])],za);let $a=class extends As{get result(){return this._result}run(){return new Is(this.weight).get()}constructor(e,t){var i;super(),this._abgroup=t,this._result=!1,this.key="ParallaxAdsExperiment",this.abgroup="parallax",this._choices=[{choice:!0},{choice:!1}],this.weight=.5,this.shouldUseCoreOverride=!1;const s=window.adthriveCLS,r=s&&s.experiments,n=null==e||null==(i=e.siteAds)?void 0:i.adTypes,a=!!Wt()&&(null==n?void 0:n.largeFormatsMobile);r&&this.abgroup in r?(this._result=r[this.abgroup],this._abgroup.set(this.abgroup,this._result?"on":"off")):a&&(this._result=this.run(),this._abgroup.set(this.abgroup,this._result?"on":"off"))}};$a=B([M(),hs("ParallaxAdsExperiment"),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Qs?Object:Qs])],$a);class Ha extends As{get result(){return this._result}run(){return new Is(this.weight).get()}constructor(e,t,i){var s,r;super(),this._result=!0,this.key="AdvancePlaylistRelated",this._choices=[{choice:!0},{choice:!1}],this.weight=1;const n=e.siteAds,a=n.adOptions.advancePlaylistOptions||{},o=n.videoPlayers;var l;const d=null!=(l=null==o||null==(s=o.players)?void 0:s.filter((e=>"stickyPlaylist"===e.type)))?l:[],c=i.getCoreExperimentButMutateWeights(this.key);if(c&&d.length&&bt(null==(r=a.relatedPlayer)?void 0:r.enabled,!0)){this._expConfigABGroup=c.abgroup;const e=c.variants[0];this.weight=e.weight,this._result=this.run(),t.set(c.abgroup,this._result?"on":"off")}}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ha.prototype,"run",null),Ha=B([hs("AdvancePlaylistRelatedExperiment"),M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Qs?Object:Qs,void 0===Js?Object:Js])],Ha);class qa extends sr{init(){this._key="AdvancePlaylistDelay"}}qa=B([hs("AdvancePlaylistDelayExperiment"),M()],qa);class Ga extends sr{init(){this._key="RaptivePlayerBackBufferLength"}}Ga=B([hs("BackBufferLengthExperiment"),M()],Ga);class Ka extends nr{init(){this._key="ContentSpecificPlaylists",this._default=!1}}Ka=B([hs("ContentSpecificPlaylistExperiment"),M()],Ka);class Wa extends sr{init(){this._key="RaptivePlayerFrontBufferThreshold"}}Wa=B([hs("FrontBufferThresholdExperiment"),M()],Wa);class Ya extends sr{init(){this._key="InstreamCreativeFailureThreshold"}}Ya=B([hs("InstreamCreativeFailureThresholdExperiment"),M()],Ya);class Qa extends sr{init(){this._key="InstreamRerequestOnError2"}}Qa=B([hs("InstreamRerequestOnErrorExperiment"),M()],Qa);class Xa extends nr{init(){this._default=!1,this._key="IOSPlayInline"}}Xa=B([hs("IOSPlayInlineExperiment"),M()],Xa);class Ja extends nr{init(){this._key="JwBoost",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ja.prototype,"run",null),Ja=B([hs("JwBoostExperiment"),M()],Ja);class Za extends sr{init(){this._key="JwRequestTimeout"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Za.prototype,"run",null),Za=B([hs("JwRequestTimeoutExperiment"),M()],Za);class eo extends sr{init(){this._key="JWPVersionExperiment"}}eo=B([hs("JWPVersionExperiment"),M()],eo);class to extends nr{init(){this._key="LogAdDuration",this._default=!1}}to=B([hs("LogAdDurationExperiment"),M()],to);class io extends nr{init(){this._key="LogAdLifeCycle",this._default=!1}}io=B([hs("LogAdLifeCycleExperiment"),M()],io);class so extends sr{init(){this._key="IMABitrate"}}so=B([hs("MaxBitrateExperiment"),M()],so);class ro extends sr{init(){this._key="RaptivePlayerMaxBufferLength"}}ro=B([hs("MaxBufferLengthExperiment"),M()],ro);class no extends sr{init(){this._key="RaptivePlayerMaxBufferSize"}}no=B([hs("MaxBufferSizeExperiment"),M()],no);class ao extends sr{init(){this._key="RaptivePlayerMaxMaxBufferLength"}}ao=B([hs("MaxMaxBufferLengthExperiment"),M()],ao);class oo extends nr{init(){this._default=!1,this._key="MaxMaxBufferReset"}}oo=B([hs("MaxMaxBufferResetExperiment"),M()],oo);class lo extends nr{init(){this._key="MidrollBugFixExperiment",this._default=!1}}lo=B([hs("MidrollBugFixExperiment"),M()],lo);class co extends sr{init(){this._key="VideoCollapsedLocations"}get mobileLocation(){if(this.result&&"off"!==this.result)return this.locationMap[this.result]}constructor(...e){super(...e),this.locationMap={tc:"top-center",bl:"bottom-left",br:"bottom-right"}}}co=B([hs("MobileStickyPlayerPositionCoreExperiment"),M()],co);class ho extends qs{run(){return super.run()}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig||!this._isValidResult(this._result))return void te.error("MobileStickyPlayerPositionSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config and valid result");const e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=`${this._result}`;this._pubabgroup.set(e,t)}_mapChoices(){return this._choices.map((({weight:e,value:t})=>({weight:e,choice:String(t)})))}constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,this._positions=["bottom-left","bottom-right","bottom-center","top-left","top-right","top-center"],this._choices=[],this._mappedChoices=[],this._resultValidator=e=>this._positions.includes(e),this._result="control",this.key=pe.MobileStickyPlayerPosition,this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),this.setExperimentTargeting())}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ho.prototype,"run",null),ho=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ks?Object:Ks,void 0===Xs?Object:Xs])],ho);class uo extends sr{init(){this._key="OutstreamPlacementExperiment"}run(){return super.run()}}uo=B([hs("OutstreamPlacementExperiment"),M()],uo);class po extends As{get result(){return this._result}run(){return new Is(this.weight).get()}constructor(e,t){super(),this._result=!0,this.key="Playbackmethod",this._choices=[{choice:!0},{choice:!1}],this._map=new Map([[_e.Video_In_Post_ClicktoPlay_SoundOn,[3]],[_e.Video_Collapse_Autoplay_SoundOff,[6]],[_e.Video_Coll_SOff_Smartphone,[6]],[_e.Video_Individual_Autoplay_SOff,[6]]]),this.weight=1;const i=t.getCoreExperimentButMutateWeights(this.key);if(i){this._expConfigABGroup=i.abgroup;const t=i.variants[0];this.weight=t.weight,this._result=this.run(),this.playbackmethod=this._result?this._map:void 0,e.set(i.abgroup,this._result?"on":"off")}}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],po.prototype,"run",null),po=B([hs("PlaybackmethodExperiment"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Qs?Object:Qs,void 0===Js?Object:Js])],po);class go extends nr{init(){this._key="PlaylistFix",this._default=!1}run(){return super.run()}}go=B([hs("PlaylistFixExperiment"),M()],go);class mo extends sr{init(){this._key="Protocols"}setABGroup(){if(this._result){var e;let t=-1;null==(e=this._choices)||e.forEach((e=>{var i;e.choice.value===(null==(i=this._result)?void 0:i.value)&&(t=e.weight)})),super.setABGroup(this._result.value,this.abgroup,t)}}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],mo.prototype,"run",null),mo=B([hs("ProtocolsExperiment"),M()],mo);class _o extends nr{init(){this._key="RaptivePlayerDesktop",this._default=!1}isEnabled(){const e=R.resolve(Cr).isRolloutEnabled("drp");return super.isEnabled()&&!e}}_o=B([hs("RaptiveDesktopPlayerExperiment"),M()],_o);class fo extends sr{init(){this._key="RaptiveInstreamRerequestOnError"}}fo=B([hs("RaptiveInstreamRerequestOnErrorExperiment"),M()],fo);class vo extends nr{init(){const e=R.resolve(Cr),t=e.isRolloutEnabled("erp"),i=e.isRolloutEnabled("drp");this._key="RaptivePlayerMobile",this._default=t&&!i}isEnabled(){const e=R.resolve(Cr),t=e.isRolloutEnabled("erp"),i=e.isRolloutEnabled("drp");return super.isEnabled()&&!i&&!t}}vo=B([hs("RaptiveMobilePlayerExperiment"),M()],vo);class yo extends sr{init(){this._key="RaptiveTearDownPlayer"}}yo=B([hs("RaptiveTearDownPlayerExperiment"),M()],yo);class bo extends nr{init(){this._key="RaptivePlayerOverride",this._default=!1}}bo=B([hs("RaptivePlayerOverride"),M()],bo);class So extends sr{init(){this._key="RaptivePlayerStaleLoadThreshold"}}So=B([hs("RaptivePlayerStaleLoadThresholdExperiment"),M()],So);class Eo extends Hs{run(){const e=this._choices[0].weight/100;return new Is(e).get()}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig)return void te.error("RemoveVideoTitleWrapperSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config");const e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?"on":"off";this._pubabgroup.set(e,t)}constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,this._choices=[],this._result=!1,this.key=pe.RemoveVideoTitleWrapper,this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Eo.prototype,"run",null),Eo=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ks?Object:Ks,void 0===Xs?Object:Xs])],Eo);class Co extends sr{init(){this._key="staleBufferTime"}run(){return super.run()}}Co=B([hs("RPStalePlayerBufferTimeExperiment"),M()],Co);class To extends nr{init(){this._default=!1,this._key="DisplayBackupRenderer"}}To=B([hs("StandardOutstreamBackupRendererExperiment"),M()],To);class wo extends sr{init(){this._key="StickyOutstreamCloseButtonTimeout"}run(){return super.run()}constructor(...e){super(...e),this.abgroup="socbde"}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],wo.prototype,"run",null),wo=B([hs("StickyOutstreamCloseButtonTimeoutExperiment"),M()],wo);class Ao extends nr{init(){this._key="StickyOutstreamFooterCollision",this._default=!1}}Ao=B([hs("StickyOutstreamFooterCollisionExperiment"),M()],Ao);class ko extends Hs{run(){const e=this._choices[0].weight/100;return new Is(e).get()}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig)return void te.error("StickyOutstreamSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config");const e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?"on":"off";this._pubabgroup.set(e,t)}constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,this._choices=[],this._result=!1,this.key=pe.StickyOutstream,this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ko.prototype,"run",null),ko=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ks?Object:Ks,void 0===Xs?Object:Xs])],ko);class Io extends sr{init(){this._key="TearDownPlayer"}}Io=B([hs("TearDownPlayerExperiment"),M()],Io);class Po extends sr{init(){this._key="VastTimeoutISV"}run(){return super.run()}}Po=B([hs("VastTimeoutISVExperiment"),M()],Po);class Oo extends sr{init(){this._key="VastTimeoutOSV"}run(){return super.run()}}Oo=B([hs("VastTimeoutOSVExperiment"),M()],Oo);class xo extends Hs{run(){const e=this._choices[0].weight/100;return new Is(e).get()}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig)return void te.error("VideoAdvancePlaylistRelatedPlayerSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config");const e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?"on":"off";this._pubabgroup.set(e,t)}constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,this._choices=[],this._result=!1,this.key=pe.VideoAdvancePlaylistRelatedPlayer,this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);const i=this._siteExperiments.getVideoPlaylistByType("stickyPlaylist");this.enabled&&this.experimentConfig&&i.length>0&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],xo.prototype,"run",null),xo=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ks?Object:Ks,void 0===Xs?Object:Xs])],xo);class Ro extends sr{init(){this._key="VideoCollapseScrollUpTopCenter"}isEnabled(){return super.isEnabled()&&Wt()}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ro.prototype,"run",null),Ro=B([hs("VideoCollapseScrollUpTopCenterExperiment"),M()],Ro);class Do extends nr{init(){this._key="VideoCollapseScrollUp",this._default=!1}isEnabled(){return super.isEnabled()&&!Wt()}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Do.prototype,"run",null),Do=B([hs("VideoCollapseScrollUpExperiment"),M()],Do);class Lo extends sr{init(){this._key="VideoDuration"}constructor(...e){super(...e),this.abgroup="vmaxdur"}}Lo=B([hs("VideoMaxDurationExperiment"),M()],Lo);class Mo extends nr{init(){this._key="RaptivePlayerEnablePreloading",this._default=!0}}Mo=B([hs("EnablePreloadingExperiment"),M()],Mo);class Bo extends As{get result(){return this._result}run(){return new Is(.1).get()}constructor(e){super(),this._result=!1,this._choices=[{choice:!0},{choice:!1}],this.shouldUseCoreExperimentsConfig=!1,this.key="RemoveLargeSize",this.abgroup="smhd100";const t=window.adthriveCLS,i=t&&t.experiments;this._result=i&&this.abgroup in i?i[this.abgroup]:this.run(),e.set(this.abgroup,this._result?"on":"off")}}Bo=B([hs("RemoveLargeSizeExperiment"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Qs?Object:Qs])],Bo);class Fo extends As{get result(){return this._result}run(){return new Is(1).get()}constructor(e){super(),this._result=!1,this._choices=[{choice:!0},{choice:!1}],this.shouldUseCoreExperimentsConfig=!1,this.key="mrsf",this.abgroup="mrsf";const t=window.adthriveCLS,i=t&&t.experiments;i&&this.abgroup in i?(this._result=i[this.abgroup],e.set(this.abgroup,this._result?"on":"off")):Wt()&&(this._result=this.run(),e.set(this.abgroup,this._result?"on":"off"))}}Fo=B([hs("MobileRecipeSizeFilterExperiment"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Qs?Object:Qs])],Fo);class jo{setupStickyOutstreamSettings(e){const t=e.siteAds.video&&e.siteAds.video.partners&&e.siteAds.video.partners.stickyOutstream,i=this._adthriveSiteAds.videoPlayers&&this._adthriveSiteAds.videoPlayers.partners&&this._adthriveSiteAds.videoPlayers.partners.stickyOutstream,s=t||i,r=(e=>{const{tablet:t,desktop:i}=e.siteAds.breakpoints,s=Et(t,i),r=e.siteAds,n=r.video&&r.video.partners&&r.video.partners.stickyOutstream,a=r.videoPlayers&&r.videoPlayers.partners&&r.videoPlayers.partners.stickyOutstream,o=n||a,l=e.siteAds.adOptions,d=o||l&&l.stickyOutstream;return!(!d||!("phone"===s?d.mobile.enabled:d.desktop.enabled))})(e);if(this._stickyOutstreamSiteExperiment.enabled?this._stickyOutstreamSiteExperiment.result:r){this._stickyOutstreamEnabled=!0;const e={...this._adUnitSettingTemplate};e.sticky=!0,e.location=ge.Video_StickyOutstream,e.position="beforeend",e.pageSelector=bt(s&&s.blockedPageSelectors,""),e.sizes="phone"===this._device?[[300,50]]:[[300,250]],this._stickyOutstreamSettingTemplate=e}}setupInterstitialSettings(){const e={...this._adUnitSettingTemplate},t=this._adthriveOptions;e.location=ge.Interstitial,e.sizes=this.interstitalSupportedSizes(),e.pageSelector=bt(t.interstitialBlockedPageSelectors,""),this._interstitialSettingTemplate=e}get(){this._adUnits.sort(((e,t)=>{const i=e.location===ge.Sidebar&&e.sticky?`${e.location}_sticky`:e.location,s=t.location===ge.Sidebar&&t.sticky?`${t.location}_sticky`:t.location;return this._adUnitAuctionPriorityMap.get(i)-this._adUnitAuctionPriorityMap.get(s)}));const e=this._parallaxAdsExperiment.result,t=this._adUnits.filter((e=>void 0!==e.dynamic&&e.dynamic.enabled)).map((t=>{const i=t.location.replace(/\s+/g,"_"),s="Sidebar"===i?0:2;return{auctionPriority:this._adUnitAuctionPriorityMap.get(i)||8,location:i,sequence:bt(t.sequence,1),sizes:this.onlySupportedAdSizes(t.adSizes).filter((e=>this.includeCertainTallSizes(t,e))).concat(e&&t.location===ge.Content?this._tallMobileContentAdsizes:[]),devices:t.devices,pageSelector:bt(t.dynamic.pageSelector,"").trim(),elementSelector:bt(t.dynamic.elementSelector,"").trim(),position:bt(t.dynamic.position,"beforebegin"),max:Math.floor(bt(t.dynamic.max,0)),spacing:bt(t.dynamic.spacing,0),skip:Math.floor(bt(t.dynamic.skip,0)),every:Math.max(Math.floor(bt(t.dynamic.every,1)),1),classNames:t.dynamic.classNames||[],sticky:this.isStickyUnit(t,this._adthriveSiteAds.adOptions.stickyContainerConfig),stickyOverlapSelector:bt(t.stickyOverlapSelector,"").trim(),autosize:t.autosize,special:bt(t.targeting,[]).filter((e=>"special"===e.key)).reduce(((e,t)=>e.concat(...t.value)),[]),lazy:bt(t.dynamic.lazy,!1),lazyMax:bt(t.dynamic.lazyMax,s),lazyMaxDefaulted:0!==t.dynamic.lazyMax&&!t.dynamic.lazyMax,name:t.name}}));return this._stickyOutstreamEnabled&&this._stickyOutstreamSettingTemplate&&t.push(this._stickyOutstreamSettingTemplate),this._adOptions.interstitial.gam&&this._interstitialSettingTemplate&&t.push(this._interstitialSettingTemplate),t}onlySupportedAdSizes(e){return this._supportedSizes.filter((([t,i])=>e.some((([e,s])=>t===e&&i===s))))}interstitalSupportedSizes(){return this._interstitialSupportedSizes.filter((([e,t])=>"phone"===this._device||"320,50"!=`${e},${t}`))}includeCertainTallSizes(e,[t,i]){const{location:s,sequence:r}=e;if(s===ge.Footer)return!("phone"===this._device&&320===t&&100===i);if(s===ge.Header)return!(i>100&&this._removeLargeSizeExperiment.result);if(s===ge.Recipe)return!(this._mobileRecipeSizeFilterExperiment.result&&"phone"===this._device&&(300===t&&390===i||320===t&&300===i));if(s===ge.Sidebar){const t=e.adSizes.some((([,e])=>e<=300)),s=i>300;return!(!s||t)||(9===r||(!!r&&r<=5?!s||e.sticky:!s))}return!0}constructor(e,t,i,s,r,n){this._adOptions=t,this._removeLargeSizeExperiment=i,this._stickyOutstreamSiteExperiment=s,this._parallaxAdsExperiment=r,this._mobileRecipeSizeFilterExperiment=n,this._stickyOutstreamEnabled=!1,this._supportedSizes=[[728,90],[300,250],[300,600],[320,50],[970,250],[160,600],[300,1050],[336,280],[970,90],[300,50],[320,100],[468,60],[250,250],[120,240],[1,1],[300,300],[552,334],[300,420],[728,250],[320,300],[300,390]],this._tallMobileContentAdsizes=[[300,600],[160,600]],this._interstitialSupportedSizes=[[320,50],[300,250],[300,600],[336,280],[320,480],[1,1]],this._adUnitAuctionPriorityMap=new Map([[ge.Footer,1],[ge.Header,2],[ge.Sidebar,3],[ge.Content,4],[ge.Recipe,5],["Sidebar_sticky",6],["Below Post",7]]),this._adUnitSettingTemplate={auctionPriority:8,autosize:!0,classNames:[],devices:["tablet","phone","desktop"],elementSelector:"body",every:1,lazy:!1,lazyMax:0,lazyMaxDefaulted:!1,location:"",max:1,pageSelector:"",position:"beforebegin",sequence:1,sizes:[],skip:0,spacing:0,special:[],sticky:!1,stickyOverlapSelector:"",name:""},this.isStickyUnit=(e,t)=>{const{location:i,sticky:s}=e;if(i===ge.Recipe&&t){const{recipeMobile:e,recipeDesktop:i}=t;if(Wt()&&(null==e?void 0:e.enabled))return!0;if(!Wt()&&(null==i?void 0:i.enabled))return!0}return i===ge.Footer||s};const{tablet:a,desktop:o}=e.siteAds.breakpoints;this._device=Et(a,o),this._adthriveSiteAds=e.siteAds,this._adthriveOptions=this._adthriveSiteAds.adOptions,this._adUnits=e.siteAds.adUnits,this.setupStickyOutstreamSettings(e),this.setupInterstitialSettings()}}jo=B([L(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===Qr?Object:Qr,void 0===Bo?Object:Bo,void 0===ko?Object:ko,void 0===$a?Object:$a,void 0===Fo?Object:Fo])],jo);class No extends nr{init(){this._key="FledgeGPT",this._default=!1}}No=B([hs("FledgeGPTExperiment"),M()],No);class Uo{get supported(){return!1}get enabled(){return!1}get cookieDeprecationLabel(){return this._cookieDeprecationLabel}_isFledgeEnabled(){if(!this._supported)return!1;var e;const t=(e=>{const t=Object.keys(_t).find((t=>e===t||e.startsWith(t)));return _t[null!=t?t:"none"]})((null!=(e=this._cookieDeprecationLabel)?e:"").replace("fake_",""));return"enabled"===t||"disabled"!==t&&R.resolve(No).result}constructor(e){var t;this._cookieDeprecationLabel=null!=(t=e.cookieDeprecationLabel)?t:null,this._supported=((e=window.document,t=window.navigator)=>!!t.joinAdInterestGroup&&!!e.featurePolicy&&e.featurePolicy.allowsFeature("join-ad-interest-group")&&e.featurePolicy.allowsFeature("run-ad-auction"))(),this._enabled=this._isFledgeEnabled()}}Uo=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],Uo);class Vo{constructor(){this.elements=[],this.footerSelectorsForHeightCheck=["div[data-gg-moat]",".kargo-ad-content",".adthrive-footer",".sprkflw_main.sprkflw_default",".ogy-footer-ad",".raptive-sales-footer"]}}Vo=B([M()],Vo);class zo{get enabled(){return this._isRequired}constructor(e){this.cafeMediaVendorId=996,this.nonCompliantBidders=[ae.Colossus,ae.Concert,ae.ResetDigital,ae.ThirtyThreeAcross],this.consentCaptured=!1,this.revokedPurposeConsent=!1,this.cmpUserActionCompleteFired=!1,this._isRequired="true"===e.gdpr}}zo=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],zo);class $o extends tr{init(){this._key="HBHO",this._default=["none"]}get choices(){return this._choices}}$o=B([hs("HBHOExperiment"),M()],$o);const Ho=["none"];class qo{_getFilteredBidders(e){return e.filter((e=>this._fullyDisabledBiddersMapping.includes(e)))}constructor(e,t,i){var s,r,n,a,o;(this.hbhoExperiment=e,this.optdExperiment=t,this.optimalBidder=i,this.choicesList=[],this._fullyDisabledBiddersMapping=[],this.useMlBidders=this.optdExperiment.result,this.useMlBidders&&this.optimalBidder.optimalBidderDataExists())?this.bidders=null!=(n=null==(r=this.optimalBidder.optimalBidderModelGroup)||null==(s=r.values[0])?void 0:s.hbho)?n:Ho:(this.bidders=null!=(o=this.hbhoExperiment.result)?o:Ho,this.choicesList=(null==(a=this.hbhoExperiment.choices)?void 0:a.map((({choice:e})=>e)))||[]);this.filteredBidders=this._getFilteredBidders(this.bidders)}}qo=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===$o?Object:$o,void 0===wa?Object:wa,void 0===Oa?Object:Oa])],qo);class Go{get enabled(){return this._liveRampATS}constructor(e){this.apiReady=new Q,this.optIn=new Q,this._liveRampATS=bt(e.siteAds.adOptions.liveRampATS,!1)}}Go=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],Go);class Ko extends tr{init(){this._key="IDHO",this._default=["none"]}setABGroup(e,t){const i=this._coreExperimentConfig.getCoreExperiment(this.key);if(i&&Array.isArray(e)){const s=e.map((e=>`${e}`));this.abgroupClass.set(t||i.abgroup,s)}}}Ko=B([hs("IDHOExperiment"),M()],Ko);class Wo{constructor(e){this.subModule=e.result;const t=e._choices;this.percentages=null==t?void 0:t.map((e=>`${e.choice}:${"number"==typeof e.weight?e.weight:0}`))}}Wo=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ko?Object:Ko])],Wo);class Yo{constructor(){this.refreshSlots=new Set(["Footer"]),this.ajaxType=!1}}Yo=B([M()],Yo);class Qo{constructor(){this.googleLazyLoadSettings={disabled:{fetchMarginPercent:-1,renderMarginPercent:-1,mobileScaling:-1},gam:{fetchMarginPercent:600,renderMarginPercent:100,mobileScaling:1.5},hbMarginPercent:700}}}Qo=B([M(),j("design:type",Function),j("design:paramtypes",[])],Qo);class Xo{constructor(e){this._id="69e75073-3763-483e-a64c-0d281bfd9225",this.url=`https://launchpad-wrapper.privacymanager.io/${this._id}/launchpad-liveramp.js`,this.enabled=bt(e.siteAds.adOptions.liveRampATS,!0)}}Xo=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],Xo);class Jo{get targetingValue(){return this.isNewZealand()?"nz":this.isUnitedStates()?"us":this.isUnitedKingdom()?"uk":this.isCanada()?"ca":this.isGDPR()?"gdpr":"o"}isNewZealand(){return"NZ"===this.country}isUnitedStates(){return"US"===this.country}isUnitedKingdom(){if(!this.country)return!1;return["UK","GB","IM","GG","JE","GI","FK"].includes(this.country)}isCanada(){return"CA"===this.country}isGDPR(){return!!this.country&&"true"===this.gdpr}constructor(e){var t,i,s,r;this.country=null==e||null==(i=e.core)||null==(t=i.country)?void 0:t.toUpperCase(),this.region=null==e||null==(r=e.core)||null==(s=r.region)?void 0:s.toUpperCase(),this.tz=Intl.DateTimeFormat().resolvedOptions().timeZone,this.gdpr=null==e?void 0:e.gdpr}}Jo=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],Jo);const Zo={AS:{location:"Sponsor_Tile",selectors:["h1.entry-title","h1.post-title","h1.posttitle","h1.story-title","h1.heading",".post > .post-title","h1.tdb-title-text","h1.post_title"],size:[[300,55],[234,60]],position:"afterend",classNames:["adthrive-sponsor-tile"],find:e=>document.querySelector(e),requireSelectorMatch:!0,lazy:!1},NR:{location:"Native_Recipe",sequence:1,nativeRecipeSiteSpecificSelectors:{"5531445f4f3ba0833a7842a4":['[class*="recipe"] [class*="ingredient"] ul li:last-child']},selectors:['[itemscope][itemtype$="//schema.org/Recipe"] [itemprop="recipeIngredient"]:last-child','[itemscope][itemtype$="//schema.org/Recipe"] [itemprop="ingredients"]:last-child','[itemscope][itemtype$="//schema.org/Recipe"] .ingredient:last-child',".wprm-recipe-ingredient:last-child","#recipe .ingredients",".wprm-recipe-ingredients-container",".tasty-recipe-ingredients",'[class*="recipe"] [class*="ingredient"] ul li:last-child','[class*="create-ingredient"] ul li:last-child','[class*="tasty-recipe"] [class*="ingredient"] p:last-child',"[class*=recipe] [class*=recipe] ~ p + ul li:last-child"],size:[[225,65],[234,60],[300,100]],position:"afterend",classNames:["adthrive-native-recipe"],find:e=>{const t=document.querySelectorAll(e);return t.length>0?t[t.length-1]:null},requireSelectorMatch:!1,lazy:!0}},el=["MINO_2021","FMLO_2021","FMOOI_2022","LGBTQ_2021","LGBTQOI_2021","HISPO_2022","HISP_2023","AAOSL_21","AFAM_2020","APIO_2022","ASOI_2022","CMINO_2022","AFOI_2020","MRLOI_22","MOMS_2020","GENZ_2023","PKDSU12_2021","NWPR_2021","RMOI_24","TGNAF_21","STKCONT_24","BIPOC_2024"],tl=["MINO_2021","FMLO_2021","FMOOI_2022","LGBTQ_2021","LGBTQOI_2021","HISPO_2022","HISP_2023","AAOSL_21","AFAM_2020","APIO_2022","ASOI_2022","CMINO_2022","AFOI_2020","MRLOI_22","MOMS_2020","GENZ_2023","PKDSU12_2021","NWPR_2021","RMOI_24","TGNAF_21"];class il{_setMarmaladeData(e,t){var i,s;this.loaded=!0;const{host:r,page:n,adViewability:a,dcsllSiteSpecific:o,amazonASR:l}=e;if(r&&r.length&&(this.siteCodes=(r[0].site_codes||[]).filter(Mt),this.filteredSiteCodes=this.siteCodes.filter((e=>this._bidderSiteCodeList.includes(e))),this.filteredRoadblockSiteCodes=this.siteCodes.filter((e=>this._appnexusRoadblockSiteCodeList.includes(e)))),n&&n.length){const e=n[0].campaigns||[];this.campaigns=e.filter(this._activeCampaign)}a&&a.length&&(this.adViewability=a),o&&(this.dcsllSiteSpecific=o),(null==l||null==(i=l.values)?void 0:i.length)&&(this.amazonASR={...l,values:l.values.filter((e=>"AdThrive_Content"!==e.adUnit))});const d=null==(s=window.location.hostname)?void 0:s.replace("www.","");this._targetCampaignSites.has(d)&&(this.adUnits.NR.lazy=!1),this._targetCampaignSites.has(d)&&document.body.classList.contains("single-post")&&!this.campaigns.some((e=>"NR_TNFLK23"===e.dfp_id))&&this.campaigns.push({casale_id:"NR_TNFLK23",dfp_id:"NR_TNFLK23",expiration_date:"2026-12-31",ingredient_line:"",internal_id:"NR_TNFLK23",lead_ingredient:"",start_date:"2023-08-15"});const c=this._getMcmpFlpIds();this.mcmp=c.mcmp||[],this.flpProdIds=c.flpProdIds||[],this.ortbSegments=this._getOrtbSegments(),t.recencyFrequencyDataSet.on(this._handleRecencyFrequencyDataSet.bind(this),{handleEventsAlreadyEmitted:!0})}_getOrtbSegments(){return this.campaigns.reduce(((e,t)=>{const i=new RegExp(/(^iab(a|c))_(\d*)/),[,s,,r]=i.exec(t.dfp_id)||[];if(r){const t=e.get(s)||[];t.push({id:r}),s&&t.length&&e.set(s,t)}return e}),new Map)}_handleRecencyFrequencyDataSet(e){e.forEach((e=>{const t=e[0],i=e[1];if("_A"===t.substring(t.length-2))this.rfMcmpCodes.push([t,i]);else{const e=t.substring(t.indexOf("_")+1);this.ortbSegments.set("iaba",[{id:e}]),this.rfIabCodes.push([t,i])}})),this.rfDataProcessed.emit()}_isValidMarmaladeCampaign(e){const t=e.dfp_id.substring(0,2),i=this.adUnits[t],s=window.adthrive.siteAds.siteId;if(i){const e=i.find(((e,t)=>{var i;return(null==(i=e.nativeRecipeSiteSpecificSelectors)?void 0:i.hasOwnProperty(t))?e.nativeRecipeSiteSpecificSelectors[t]:e.selectors})(i,s).join(","));return e&&this.selectorMatches.push({adUnit:i,match:e}),!i.requireSelectorMatch||!!e}return!0}_getMcmpFlpIds(){return this.campaigns.filter((e=>this._isValidMarmaladeCampaign(e))).reduce(((e,t)=>(e.mcmp.push(t.dfp_id),t.flp_prod_id&&e.flpProdIds.push(...JSON.parse(t.flp_prod_id)),e)),{mcmp:[],flpProdIds:[]})}_parseDate(e){const t=e.split("-");return new Date(Number(t[0]),Number(t[1])-1,Number(t[2]))}constructor(e,t){this.loaded=!1,this.campaigns=[],this.filteredRoadblockSiteCodes=[],this.filteredSiteCodes=[],this.siteCodes=[],this.adViewability=[],this.speed=navigator.connection&&"4g"===navigator.connection.effectiveType?"1":"0",this.adUnits=Zo,this.selectorMatches=[],this.ortbSegments=new Map,this.rfMcmpCodes=[],this.rfIabCodes=[],this.rfDataProcessed=new Q,this.hvThreshold=.6,this.mcmp=[],this.mcmpTargeting=[],this.flpProdIds=[],this.amazonASR={},this._targetCampaignSites=new Set(["divascancook.com","hungryhappens.net","whatsgabycooking.com","pinchofyum.com","isabeleats.com"]),this._bidderSiteCodeList=el,this._appnexusRoadblockSiteCodeList=tl,this._activeCampaign=e=>{const t=Date.now();return t>=this._parseDate(e.start_date).getTime()&&t<=this._parseDate(e.expiration_date).getTime()},e&&Object.keys(e).length>0?this._setMarmaladeData(e,t):t.marmaladeResponseLoaded.once((e=>{this._setMarmaladeData(e,t),t.resetMarmaladeData.emit()}))}}il=B([M(),F(0,D("RecencyFrequencyMarmaladeResponse")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof RecencyFrequencyMarmaladeResponse?Object:RecencyFrequencyMarmaladeResponse,void 0===js?Object:js])],il);const sl=e=>{const t=e.substring(13).split(".").map((e=>parseInt(e)));return{major:t[0],minor:t[1],patch:t[2]}};class rl{isEnabled(){const e=window,t=e.adthrive&&e.adthrive.plugin,i=e.adthriveCLS,s=i&&i.experiments,r=!(!s||!("clsins_ss"in s))||!(!t||!((e,t)=>{const i=sl(e),s=sl(t);return!(i.major>s.major)&&(i.major<s.major||!(i.minor>s.minor)&&(i.minor<s.minor||!(i.patch>s.patch)&&(i.patch<=s.patch||void 0)))})("adthrive-ads-1.1.0",t));return!!(this.settings&&this._adDensityEnabled&&r)}constructor(e){this.settings=e.siteAds.adDensityLayout,this._adDensityEnabled=bt(e.siteAds.adDensityEnabled,!0),this.enabled=this.isEnabled()}}rl=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],rl);class nl extends sr{init(){const e=R.resolve(Pr);this._key=(e=>{const t=(e=>{const t=e.downlink;return void 0===t?"unknown":t<10?"slow":"fast"})(e);if("desktop"===e.device)switch(t){case"fast":return"InitialTimeoutDesktopFastExperiment";case"slow":return"InitialTimeoutDesktopSlowExperiment";case"unknown":return"InitialTimeoutDesktopUnknownExperiment"}else switch(t){case"fast":return"InitialTimeoutMobileFastExperiment";case"slow":return"InitialTimeoutMobileSlowExperiment";case"unknown":return"InitialTimeoutMobileUnknownExperiment"}})(e)}}nl=B([hs("InitialTimeoutExperiment"),M()],nl);class al{constructor(e){var t;this.initialBidsRequest=null!=(t=e.result)?t:2400,this.refreshBidsRequest=5e3}}al=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===nl?Object:nl])],al);class ol{set(e){this._data={...this._data,...e}}get(){return 0!==Object.keys(this._data).length?this._data:void 0}getByKey(e){return this._data[e]}clear(){this.set({})}constructor(){this._data={}}}ol=B([hs("UserPageDataLoggingStore"),M()],ol);class ll{_executeCallback(e){e(),this._callbacks.delete(e),0===this._callbacks.size&&this.logUserPageData()}setUserPageData(e){e&&this._userPageDataLoggingStore.set(e)}logUserPageData(){this._requestSent||(te.fetchEvent("UserPageDataLoggingComponent","logUserData",this._userPageDataLoggingStore.get()),this._requestSent=!0,this.cleanup())}addCallbackToQueue(e,t){this._callbacks.add(t),e.forEach((e=>{this._listeners.push(e.on((()=>this._executeCallback(t))))}))}cleanup(){this._listeners.forEach((e=>{e()})),this._listeners=[],this._callbacks.clear()}constructor(e){this._userPageDataLoggingStore=e,this.loggingData=new Q,this._maxTimeOnPage=36e5,this._listeners=[],this._callbacks=new Set,this._requestSent=!1,setTimeout((()=>{this._callbacks.forEach((e=>this._executeCallback(e))),this.cleanup()}),this._maxTimeOnPage)}}ll=B([hs("UserPageDataLoggingEvents"),M(),j("design:type",Function),j("design:paramtypes",[void 0===ol?Object:ol])],ll);class dl{setNonBlockingLibraryTimingData(e){const t=e.get(oe.Prebid),i=e.get(oe.Amazon),s=e.get(oe.Optable);this._setPrebidTimingData(t),this._setAmazonTimingData(i),this._setOptableTimingData(s)}_setPrebidTimingData(e){this.prebidStarted=e&&e.started||0,this.prebidFinished=e&&e.finished||0,this.prebidDuration=e&&e.started&&e.finished&&e.finished-e.started||0}_setAmazonTimingData(e){this.amazonStarted=e&&e.started||0,this.amazonFinished=e&&e.finished||0,this.amazonDuration=e&&e.started&&e.finished&&e.finished-e.started||0}_setOptableTimingData(e){this.optableStarted=e&&e.started||0,this.optableFinished=e&&e.finished||0,this.optableDuration=e&&e.started&&e.finished&&e.finished-e.started||0}get timingData(){return{started:this.started,delay:this.delay,loading:this.loading,totalTimeOnPage:this.totalTimeOnPage,bootstrapFinished:this.bootstrapFinished,amazonStarted:this.amazonStarted,amazonFinished:this.amazonFinished,amazonDuration:this.amazonDuration,gamStarted:this.gamStarted,gamFinished:this.gamFinished,gamDuration:this.gamDuration,marmaladeStarted:this.marmaladeStarted,marmaladeFinished:this.marmaladeFinished,marmaladeDuration:this.marmaladeDuration,floorsStarted:this.floorsStarted,floorsFinished:this.floorsFinished,floorsDuration:this.floorsDuration,prebidStarted:this.prebidStarted,prebidFinished:this.prebidFinished,prebidDuration:this.prebidDuration,optableStarted:this.optableStarted,optableFinished:this.optableFinished,optableDuration:this.optableDuration,...this.timeOnPage&&{timeOnPage:this.timeOnPage}}}documentVisibilityChanged(){"visible"===document.visibilityState?this.timeOnPage=ls():"hidden"===document.visibilityState&&(this.totalTimeOnPage+=ls()-this.timeOnPage,this.timeOnPage=void 0)}constructor(e,t){this._pageManager=t,this.started=0,this.delay=0,this.loading=0,this.totalTimeOnPage=0,this.bootstrapFinished=0,this.amazonStarted=0,this.amazonFinished=0,this.amazonDuration=0,this.gamStarted=0,this.gamFinished=0,this.gamDuration=0,this.marmaladeStarted=0,this.marmaladeFinished=0,this.marmaladeDuration=0,this.floorsStarted=0,this.floorsFinished=0,this.floorsDuration=0,this.prebidStarted=0,this.prebidFinished=0,this.prebidDuration=0,this.optableStarted=0,this.optableFinished=0,this.optableDuration=0,this.started=ls(),"visible"===document.visibilityState&&(this.timeOnPage=this.started),this._pageManager.visibilityChange.on((()=>this.documentVisibilityChanged())),e.loggingData.on((()=>{"visible"===document.visibilityState&&(this.totalTimeOnPage+=ls()-this.timeOnPage)}))}}dl=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===ll?Object:ll,void 0===wr?Object:wr])],dl);class cl extends tr{init(){this._key="TKHO",this._default=["none"]}}cl=B([hs("TKHOExperiment"),M()],cl);class hl{constructor(e){var t;this.tracker=null!=(t=e.result)?t:["none"]}}hl=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===cl?Object:cl])],hl);class ul extends tr{init(){this._key="VBHO",this._default=["none"]}get choices(){return this._choices}}ul=B([hs("VBHOExperiment"),M()],ul);const pl=["none"];class gl{_getFilteredBidders(e){return e.filter((e=>this._fullyDisabledBiddersMapping.includes(e)))}constructor(e,t,i){var s,r,n,a,o;(this.vbhoExperiment=e,this.optvExperiment=t,this.optimalBidder=i,this.choicesList=[],this._fullyDisabledBiddersMapping=[],this.useMlBidders=this.optvExperiment.result,this.useMlBidders&&this.optimalBidder.optimalBidderDataExists())?this.bidders=null!=(n=null==(r=this.optimalBidder.optimalBidderModelGroup)||null==(s=r.values[0])?void 0:s.vbho)?n:pl:(this.bidders=null!=(o=this.vbhoExperiment.result)?o:pl,this.choicesList=(null==(a=this.vbhoExperiment.choices)?void 0:a.map((({choice:e})=>e)))||[]);this.filteredBidders=this._getFilteredBidders(this.bidders)}}gl=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===ul?Object:ul,void 0===Aa?Object:Aa,void 0===Oa?Object:Oa])],gl);class ml{static getScrollTop(){return(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)}static getScrollBottom(){return this.getScrollTop()+(document.documentElement.clientHeight||0)}static shufflePlaylist(e){let t,i,s=e.length;for(;0!==s;)i=Math.floor(Math.random()*e.length),s-=1,t=e[s],e[s]=e[i],e[i]=t;return e}static isMobileLandscape(){return window.matchMedia("(orientation: landscape) and (max-height: 480px)").matches}static playerViewable(e){const t=e.getBoundingClientRect();return this.isMobileLandscape()?window.innerHeight>t.top+t.height/2&&t.top+t.height/2>0:window.innerHeight>t.top+t.height/2}static createQueryString(e){return Object.keys(e).map((t=>`${t}=${e[t]}`)).join("&")}static createEncodedQueryString(e){return Object.keys(e).map((t=>`${t}=${encodeURIComponent(e[t])}`)).join("&")}static setMobileLocation(e){return"top-left"===(e=e||"bottom-right")?e="adthrive-collapse-top-left":"top-right"===e?e="adthrive-collapse-top-right":"bottom-left"===e?e="adthrive-collapse-bottom-left":"bottom-right"===e?e="adthrive-collapse-bottom-right":"top-center"===e&&(e=Wt()?"adthrive-collapse-top-center":"adthrive-collapse-bottom-right"),e}static addMaxResolutionQueryParam(e){const t=`max_resolution=${Wt()?"320":"1280"}`,[i,s]=String(e).split("?");return`${i}?${s?s+`&${t}`:t}`}}const _l=e=>{const t=[],i=[],s=(()=>{const e=ss(".adthrive-content-specific-playlist");return e.valid&&e.elements&&e.elements.length?{playlistId:e.elements[0].getAttribute("data-playlist-id"),shuffle:Boolean(e.elements[0].getAttribute("data-playlist-shuffle"))}:null})();if(s&&s.playlistId)return s;e.forEach((e=>{if(e.isDraft)return;e.categories.some((e=>{const t=ss(`.adthrive-cat-${e}`);return t.valid&&t.elements&&t.elements.length}))?t.push({playlistId:e.playlistId,shuffle:e.shuffle||!1}):0===e.categories.length&&i.push({playlistId:e.playlistId,shuffle:e.shuffle||!1})}));const r=t.length>0?t:i;return r[Math.floor(Math.random()*r.length)]},fl=e=>{if(R.resolve(Ka).result&&e.length){return _l(e)}};class vl extends sr{init(){this._key="RaptivePlayerLoadVideoTimeout"}}vl=B([hs("LoadVideoTimeoutExperiment"),M()],vl);class yl{setupAdvanceRelatedExperiment(e){const t=R.resolve(xo),i=R.resolve(Ha),s=this.advancePlaylist.relatedPlayer,r=t.enabled;s.shouldRun=this.jwPlaylistObj.playlist.then((n=>{const a=s.sticky?s.sticky.enabled:s.enabled,o=s.static?s.static.enabled:s.enabled,l=a&&e,d=!e||o;return"object"==typeof n&&(r&&t.result||!r&&(l||d)&&i.result)})).catch((()=>!1)),s.applyToFirst=r?t.result:e&&s.sticky?s.sticky.applyToFirst:s.applyToFirst}_getPlaylistPlayerVideos(e){const t=e.siteAds.videoPlayers,i=(t&&t.players||[]).filter((e=>"stickyPlaylist"===e.type)),s=e.siteAds.videoPlayers&&e.siteAds.videoPlayers.contentSpecificPlaylists,r=s&&fl(s),n=r&&r.playlistId,a=n||i.length&&i[0].playlistId;var o;return{playlistId:a,hasContentSpecificPlaylist:Boolean(r),shuffle:null!=(o=r&&r.shuffle)&&o,playlist:a?ti(ml.addMaxResolutionQueryParam(`https://cdn.jwplayer.com/v2/playlists/${a}`)):Promise.reject().catch((()=>!1))}}_getAdvancePlaylistConfig(e){const t=e.siteAds.adOptions.advancePlaylistOptions||{},i=t.relatedPlayer||{};return{playlistPlayer:{enabled:bt(t.playlistPlayer.enabled,!0)},relatedPlayer:{applyToFirst:bt(i.applyToFirst,!0),enabled:bt(i.enabled,!0),shouldRun:Promise.reject().catch((()=>!1)),static:i.static,sticky:i.sticky}}}_getStickyOutstreamSettings(e){const{video:t,videoPlayers:i}=e.siteAds,s=i&&i.partners&&i.partners.stickyOutstream,r=t&&t.partners.stickyOutstream;return bt(s||r,{blockedPageSelectors:"",mobile:{enabled:!1},desktop:{enabled:!1},allowForPageWithStickyPlayer:{enabled:!1},allowOnHomepage:!1,mobileHeaderSelector:"",mobileLocation:"bottom-right",saveVideoCloseState:!1})}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u,p,g,m,_,f,v,y,b,S){this.players=[],this.instreamAdUnits=new Set([_e.Video_Collapse_Autoplay_SoundOff,_e.Video_Individual_Autoplay_SOff,_e.Video_Coll_SOff_Smartphone,_e.Video_In_Post_ClicktoPlay_SoundOn]);const E=e.siteAds.videoPlayers;this.advancePlaylist=this._getAdvancePlaylistConfig(e),this.apiValue=[2,7],this.stickyOutstreamCloseButtonTimeout=bt(t.result,4e3),this.contentSpecificPlaylists=E&&E.contentSpecificPlaylists,this.footerSelector=bt(E&&E.footerSelector,""),this.jwPlaylistObj=this._getPlaylistPlayerVideos(e),this.jwRequestTimeout=bt(l.result,15e3),this.logAdDuration=a.result,this.logAdLifeCycle=o.result,this.maxRedirect=8,this.mimeType=navigator.userAgent&&-1===navigator.userAgent.search(/Chrom|firefox/i)?["video/mp4","application/javascript"]:["video/mp4","application/javascript","video/webm"],this.mobileStickyPlayerOnPage=!1,this.outstreamPlacement=d.result||0,this.playbackmethod=n.playbackmethod,this.players=bt(E&&E.players.map((e=>(e.mobileLocation=ml.setMobileLocation(e.mobileLocation),e))),[]),this.position={id:1,name:"above"},this.relatedSettings=E&&E.contextual,this.removeVideoTitleWrapper=bt(e.siteAds.adOptions.removeVideoTitleWrapper,!1),this.setStandardOutstreamBackupRenderer=h.result,this.stickyOutstreamSettings=this._getStickyOutstreamSettings(e),this.vastTimeoutISV=bt(i.result,1e4),this.vastTimeoutOSV=bt(s.result,5e3),this.videoProtocols=r.result,this.videoWasClosed=bt(K.getLocalStorageValue("video_closed",!0,!0,18e5),!1),this.maxBitrate=u.result||-1,this.backBufferLength=p.result&&"off"!==p.result?p.result:1/0,this.maxBufferLength=g.result||30,this.maxBufferSize=m.result||60,this.maxMaxBufferLength=_.result||600,this.frontBufferThreshold=f.result&&"off"!==f.result?f.result:1/0,this.staleLoadThreshold=c.result||20,this.maxMaxBufferReset=v.result,this.enablePreloading=y.result,this.loadVideoTimeout=b.result||8e3,this.creativeFailureThreshold=S.result||5}}yl=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===wo?Object:wo,void 0===Po?Object:Po,void 0===Oo?Object:Oo,void 0===mo?Object:mo,void 0===po?Object:po,void 0===to?Object:to,void 0===io?Object:io,void 0===Za?Object:Za,void 0===uo?Object:uo,void 0===So?Object:So,void 0===To?Object:To,void 0===so?Object:so,void 0===Ga?Object:Ga,void 0===ro?Object:ro,void 0===no?Object:no,void 0===ao?Object:ao,void 0===Wa?Object:Wa,void 0===oo?Object:oo,void 0===Mo?Object:Mo,void 0===vl?Object:vl,void 0===Ya?Object:Ya])],yl);class bl{constructor(e,t,i,s){this._videoAdOptions=e,this.apiValue=[2,7],this.relatedPlayerAdded=!1,this.footerSelector="",this.gamDiscount=.16,this.hasJwPlayer=!1,this.hasStickyOutstream=!1,this.instreamAdUnits=new Set([_e.Video_Collapse_Autoplay_SoundOff,_e.Video_Individual_Autoplay_SOff,_e.Video_Coll_SOff_Smartphone,_e.Video_In_Post_ClicktoPlay_SoundOn]),this.jwpVersion=null,this.minFloor=.1753,this.mobileStickyPlayerOnPage=!1,this.playlistPlayerAdded=!1,this.plcmtUnits=new Map([[_e.Video_Collapse_Autoplay_SoundOff,2],[_e.Video_Individual_Autoplay_SOff,2],[_e.Video_Coll_SOff_Smartphone,2],[_e.Video_In_Post_ClicktoPlay_SoundOn,1]]),this.preventStickyOutstream=!1,this.removeVideoTitleWrapper=!1,this.vidDiscount=.1753;const r=this._videoAdOptions;this.position={id:1,name:"above"},this.maxRedirect=8,this.playbackmethod=r.playbackmethod,this.advancePlaylist=r.advancePlaylist,this.jwPlaylistObj=r.jwPlaylistObj,this.setupAdvanceRelatedExperiment=r.setupAdvanceRelatedExperiment,this.relatedSettings=r.relatedSettings,this.mimeType=r.mimeType,this.outstreamPlacement=r.outstreamPlacement,this.videoProtocols=r.videoProtocols,this.jwRequestTimeout=r.jwRequestTimeout,this.logAdDuration=r.logAdDuration,this.logAdLifeCycle=r.logAdLifeCycle,this.vastTimeoutISV=r.vastTimeoutISV,this.vastTimeoutOSV=r.vastTimeoutOSV,this.videoWasClosed=r.videoWasClosed,this.removeVideoTitleWrapper=i.enabled?i.result:r.removeVideoTitleWrapper,this.players=r.players,this.footerSelector=r.footerSelector,this.stickyOutstreamSettings=r.stickyOutstreamSettings,this.maxDuration=s.result||30,this.contentSpecificPlaylists=r.contentSpecificPlaylists,this.jwpVersion=t.result&&"none"!==t.result?t.result:null,this.staleLoadThreshold=r.staleLoadThreshold,this.setStandardOutstreamBackupRenderer=r.setStandardOutstreamBackupRenderer,this.stickyOutstreamCloseButtonTimeout=r.stickyOutstreamCloseButtonTimeout,this.maxBitrate=r.maxBitrate,this.backBufferLength=r.backBufferLength,this.maxBufferLength=r.maxBufferLength,this.maxBufferSize=r.maxBufferSize,this.maxMaxBufferLength=r.maxMaxBufferLength,this.frontBufferThreshold=r.frontBufferThreshold,this.maxMaxBufferReset=r.maxMaxBufferReset,this.enablePreloading=r.enablePreloading,this.loadVideoTimeout=r.loadVideoTimeout,this.creativeFailureThreshold=r.creativeFailureThreshold}}bl=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===yl?Object:yl,void 0===eo?Object:eo,void 0===Eo?Object:Eo,void 0===Lo?Object:Lo])],bl);class Sl extends tr{init(){this._setAbGroup=!1,this._key="VideoOpenBidderExperiment",this._default=["none"]}}Sl=B([hs("VideoOpenBidderExperiment"),M()],Sl);class El{constructor(e){this.bidders=e.result||["none"]}}El=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Sl?Object:Sl])],El);class Cl{constructor(){this.active=!1}}Cl=B([M()],Cl);class Tl extends tr{init(){this._key="AllBidderHO",this.abgroup="allbho",this._default=["off"]}}Tl=B([hs("AllBidderHOExperiment"),M()],Tl);class wl{constructor(e){this.bidders=e.result||["off"],this.useMlBidders=!1}}wl=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Tl?Object:Tl])],wl);class Al extends sr{init(){this._key="TrackScrollExperiment"}get choices(){return this._choices}get result(){var e;return null!=(e=this._result)?e:"off"}}Al=B([hs("TrackScrollExperiment"),M()],Al);function kl(e,t,i){var s=!0,r=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return ln(i)&&(s="leading"in i?!!i.leading:s,r="trailing"in i?!!i.trailing:r),Fn(e,t,{leading:s,maxWait:t,trailing:r})}class Il{getTargetingValue(){if(this._timeForTracking&&this._shouldUpdateTargeting())return`engage${this._timeForTracking}`}_parseResult(e){const[,t]=e.split("on");if(t)return Number(t)}_setupScrollListener(){const e=kl((()=>{this._lastScrollTimestamp=Date.now()}),500);window.addEventListener("scroll",e,{passive:!0})}_shouldUpdateTargeting(){if(this._lastScrollTimestamp&&this._timeForTracking){if((Date.now()-this._lastScrollTimestamp)/1e3<=this._timeForTracking)return!0}return!1}constructor(e){this.trackScrollExperiment=e;const t=this.trackScrollExperiment.result;"off"!==t?(this.trackScrollEnabled=!0,this._timeForTracking=this._parseResult(t),this._setupScrollListener()):this.trackScrollEnabled=!1}}Il=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Al?Object:Al])],Il);class Pl{get os(){return this._os}get browser(){return this._browser}get device(){return this._device}get deviceByBreakpoint(){return this._deviceByBreakpoint}constructor(e){const{tablet:t,desktop:i}=e.siteAds.breakpoints;this._os=di(),this._browser=ut(),this._device=Wt()?"phone":Yt()?"tablet":Bt()?"desktop":"other",this._deviceByBreakpoint=Et(t,i)}}Pl=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],Pl);class Ol{resetDynamicAds(){this.dynamicAds=this._dynamicAdsMapper.get()}shouldHalveIOSDensity(){return Ft()&&this.featureRolloutService.isRolloutEnabled("iOS-Resolution")}getTargetDensity(e){return this.shouldHalveIOSDensity()?e/2:e}get isStickyOutstreamTopCenterColorsDisabled(){return this.featureRolloutService.isRolloutEnabled("disable-sticky-outstream-top-center-colors")}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u,p,g,m,_,f,v,y,b,S,E,C,T,w,A,k,I,P,O,x,D,L,M,B,F,j,N,U,V,z,$,H){this.abGroup=e,this.act25=t,this.adOptions=i,this.adTypes=s,this.amazon=r,this.allBidderHO=n,this.ccpa=a,this.gpc=o,this.clsOptimizedAds=l,this.comscore=d,this.disableAds=c,this.displayOpenBidding=h,this.fledge=u,this.floors=p,this.footer=g,this.gam=m,this.gdpr=_,this.hbho=f,this.identityApi=v,this.idho=y,this.infiniteScroll=b,this.lazyLoad=S,this.liveRampAts=E,this.locale=C,this.marmalade=T,this.optable=w,this.partners=A,this.pubAbGroup=k,this.prebid=I,this.site=P,this.targetDensity=O,this.timeouts=x,this.timing=D,this.tkho=L,this.user=M,this.vbho=B,this.video=F,this.videoOpenBidding=j,this.uid2TokenCleanup=N,this._dynamicAdsMapper=U,this.trackScroll=V,this.userAgent=z,this.prebidClientSide=$,this.optimalBidder=H,n.bidders.forEach((e=>{f.choicesList.includes(e)&&!f.bidders.includes(e)&&f.bidders.push(e),B.choicesList.includes(e)&&!B.bidders.includes(e)&&B.bidders.push(e)})),this.dynamicAds=U.get();const q=R.resolve(Ba);q.enabled&&(this.clsOptions=q),this.featureRolloutService=R.resolve(Cr)}}Ol=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Qs?Object:Qs,void 0===qr?Object:qr,void 0===Qr?Object:Qr,void 0===Jr?Object:Jr,void 0===La?Object:La,void 0===wl?Object:wl,void 0===nn?Object:nn,void 0===an?Object:an,void 0===ja?Object:ja,void 0===Na?Object:Na,void 0===Ua?Object:Ua,void 0===za?Object:za,void 0===Uo?Object:Uo,void 0===ba?Object:ba,void 0===Vo?Object:Vo,void 0===Ts?Object:Ts,void 0===zo?Object:zo,void 0===qo?Object:qo,void 0===Go?Object:Go,void 0===Wo?Object:Wo,void 0===Yo?Object:Yo,void 0===Qo?Object:Qo,void 0===Xo?Object:Xo,void 0===Jo?Object:Jo,void 0===il?Object:il,void 0===Zn?Object:Zn,void 0===fr?Object:fr,void 0===Xs?Object:Xs,void 0===Nr?Object:Nr,void 0===Ys?Object:Ys,void 0===rl?Object:rl,void 0===al?Object:al,void 0===dl?Object:dl,void 0===hl?Object:hl,void 0===da?Object:da,void 0===gl?Object:gl,void 0===bl?Object:bl,void 0===El?Object:El,void 0===Cl?Object:Cl,void 0===jo?Object:jo,void 0===Il?Object:Il,void 0===Pl?Object:Pl,void 0===Or?Object:Or,void 0===Oa?Object:Oa])],Ol);const xl={phone:"mobile",desktop:"desktop",tablet:"tablet"},Rl=(e,t)=>{var i;const s=t.device,r=null==(i=e.marmalade)?void 0:i.dcsllSiteSpecific,n=r?r[xl[s]]:void 0,a=null==n?void 0:n.variants.map((({value:e,weight:t})=>({choice:`${e}`,weight:t})));return(e=>{if(!e||0===e.length)return!0;if(100!==e.reduce(((e,{weight:t})=>e+t),0))return te.error("DCSLLSiteSpecificMarmaladeExperiment","validation","Sum of weights is not 100"),!1;const t=e.map((({choice:e})=>e)),i=[...new Set(t)];return t.length!==i.length?(te.error("DCSLLSiteSpecificMarmaladeExperiment","validation","Duplicate choices found in DCSLLM site specific experiment"),!1):!!t.filter((e=>"off"!==e)).every((e=>!isNaN(Number(e))))||(te.error("DCSLLSiteSpecificMarmaladeExperiment","validation","Non-numeric choices found in DCSLLM site specific experiment"),!1)})(a)?a:null};class Dl{get result(){return this._result}run(){return new Ps(this._choices).get()}constructor(e,t,i){this.abgroup="dcsllm_ss",this._result=void 0,this._choices=void 0;const s=Rl(t,i);this._choices=null!=s?s:void 0,this._result=this.run(),e.set(this.abgroup,this._result)}}Dl=B([hs("DCSLLSiteSpecificMarmaladeExperiment"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Qs?Object:Qs,void 0===Ol?Object:Ol,void 0===Pr?Object:Pr])],Dl);class Ll extends Cs{isContentSlot(e){return"Content"===e.location}isBelowPostSlot(e){return"Below_Post"===e.location}isRecipeSlot(e){return"Recipe"===e.location}isValidLocation(e){return this.isContentSlot(e)||this.isBelowPostSlot(e)||this.isRecipeSlot(e)}isValidSequence(e){return this.isBelowPostSlot(e)?e.sequence&&e.sequence<=1:!!this.isRecipeSlot(e)||e.sequence&&e.sequence<=9}isCPMSlot(e){return e.sequence&&e.sequence<=2&&this.isContentSlot(e)}isTargetSlot(e){return e.lazy&&!this.isCPMSlot(e)&&this.isValidSequence(e)&&this.isValidLocation(e)}_sortByCpm(e,t){return e.cpm===t.cpm?0:e.cpm<t.cpm?1:-1}getSlotCPM(e,t){if(e.prebidAdUnit&&e.prebidAdUnit.length&&e.prebidAdUnit[0].code){const i=t.getBidResponsesForAdUnitCode(e.prebidAdUnit[0].code).bids.sort(this._sortByCpm);if(i.length>0)return i[0].cpm}return 0}checkThresholdMet(e,t){return this.cpmThresholdMet||this.isCPMSlot(e)&&this._dcsllSiteSpecificExperimentResult&&(this.cpmThresholdMet=this.getSlotCPM(e,t)>=parseFloat(this._dcsllSiteSpecificExperimentResult),this.cpmThresholdMet&&this.loadRemainingSlots()),this.cpmThresholdMet}loadRemainingSlots(){this._intersectionObserverManager.unobservedSlotIntersectionObservers.forEach(((e,t)=>{this.isTargetSlot(t)&&(this._intersectionObserverManager.unobserve(t),this._slotEventBus.displaySlot.emit(t))}))}lazyLoadingEnabledForSlot(e,t){if(e&&e.googleTagSlot){if("off"!==this._dcsllSiteSpecificExperimentResult&&this.checkThresholdMet(e,t)&&this.isTargetSlot(e))return e.setSlotTargetingFlag("dcsll",["true"]),e.lazyDisabled=!0,!1}else te.error("DynamicContentSlotLazyLoadingComponent","lazyLoadingEnabledForSlot","Slot not configured");return e.lazy}constructor(e,t,i,s,r){super(),this._slotEventBus=e,this._intersectionObserverManager=t,this._config=i,this.cpmThresholdMet=!1,this._dcsllSiteSpecificExperimentResult=this._config.adOptions.dynamicContentSlotLazyLoading?r.result||s.result:"off"}}Ll=B([hs("DynamicContentSlotLazyLoadingComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Es?Object:Es,void 0===$r?Object:$r,void 0===Ol?Object:Ol,void 0===Hr?Object:Hr,void 0===Dl?Object:Dl])],Ll);class Ml extends nr{init(){this._key="InterstitialConfig",this._default=!1}}Ml=B([hs("InterstitialConfigExperiment"),M()],Ml);class Bl extends Cs{get enabled(){return this._interstitialConfigExperiment.result&&(this._adOptions.desktopInterstitial||this._adOptions.mobileInterstitial)}start(){this._addAttributeToInternalLinks()}_isInternalLink(e){const t=new URL(window.location.href).hostname;return e.startsWith("/")||e.startsWith("#")||e.includes(t)||e.startsWith(`//${t}`)}_addAttributeToInternalLinks(){document.querySelectorAll("a").forEach((e=>{this._isInternalLink(e.href)&&e.setAttribute("data-google-interstitial","false")}))}_setInterstitialConfig(e){e.googleTagSlot&&e.googleTagSlot.setConfig({interstitial:{triggers:{unhideWindow:!0}}})}constructor(e,t){super(),this._interstitialConfigExperiment=e,this._adOptions=t}}Bl=B([L(),hs("InterstitialConfigComponent"),j("design:type",Function),j("design:paramtypes",[void 0===Ml?Object:Ml,void 0===Qr?Object:Qr])],Bl);class Fl extends nr{init(){this._key="AdExpansion",this._default=!1}isEnabled(){const e=!R.resolve(Cr).isRolloutEnabled("disable-expandable-ads");return super.isEnabled()&&!Wt()&&e}}Fl=B([hs("AdExpansionExperiment"),M()],Fl);class jl{constructor(){this.impressionViewable=new Q,this.slotOnload=new Q,this.slotRenderEnded=new Q,this.slotVisibilityChanged=new Q,this.slotRequested=new Q,this.slotResponseReceived=new Q,this.started=new Q}}jl=B([M()],jl);class Nl{markEndTask(){const e=this._markEnd();this._isDevelopmentTraffic||this._logData(e)}_markEnd(){const e=Date.now();return this._isDevelopmentTraffic&&(performance.mark(`${this._id}-end`),performance.measure(`${this._id}`,`${this._id}-start`,`${this._id}-end`)),{startTime:this._startTime,duration:e-this._startTime,name:this._id}}_logData(e){const t=this._createLogURL(e),i=new XMLHttpRequest;i.open("get",t,!0),i.send()}setTaskData(e){const{duration:t,startTime:i}=e;this._taskData={name:this._name,type:this._type,startTime:i,duration:t,sequence:this._sequence,metadata:this._metadata}}_createLogURL(e){this.setTaskData(e);const t=[null===this._taskData?{}:this._taskData,this._adsloggerData];return`https://logger.adthrive.com/event?${[`siteId=${encodeURIComponent(window.adthrive.siteAds.siteId||"")}`,`siteName=${encodeURIComponent(window.adthrive.siteAds.siteName||"")}`,`bucket=${encodeURIComponent(window.adthrive.bucket||"")}`,`branch=${encodeURIComponent(window.adthrive.branch||"")}`,`deployment=${encodeURIComponent(window.adthrive.deployment||"")}`,`message=${encodeURIComponent("TaskMonitor::_logData")}`,`pageurl=${encodeURIComponent(window.location.origin+window.location.pathname)}`,`body=${encodeURIComponent(JSON.stringify(t))}`].join("&")}`}addMetadata(e){Object.keys(e).forEach((t=>{this._metadata[t]=e[t]}))}constructor(e,t,i,s,r){this._id=e,this._startTime=t,this._sequence=i,this._type=s,this._isDevelopmentTraffic=r,this._pvk="",this._adsloggerData={abgroup:"taskmonitor-log",pubab:"taskmonitor-log",sess:"taskmonitor-log",pvk:this._pvk,hbho:["taskmonitor-log"],vbho:["taskmonitor-log"],spa:!1},this._taskData=null,this._metadata={};const n=window.adthrive;"object"==typeof n&&null!==n&&"context"in n&&"object"==typeof n.context&&null!==n.context&&"pageviewKey"in n.context&&"string"==typeof n.context.pageviewKey&&(this._pvk=n.context.pageviewKey,this._adsloggerData.pvk=this._pvk),this._name=this._id.split("_")[0]}}const Ul=new class{markStartTask(e,t,i=!1){if(i||this.enabled){const i=`adt-${t.join("-")}`,s=this._taskIdCounters.get(i),r=void 0!==s?s+1:0,n=`${i}_${r}`,a=this._markStart(n);return this._taskIdCounters.set(i,r),new Nl(n,a,r,e,this._isDevelopmentTraffic)}return{markEndTask:()=>{},addMetadata:()=>{}}}_markStart(e){return this._isDevelopmentTraffic&&performance.mark(`${e}-start`),Date.now()}get enabled(){return this._enabled}constructor(){this._taskIdCounters=new Map,this._enabled=!1,this._desiredTraffic=.02,this._isDevelopmentTraffic=!1;const e=!!window.performance&&!!window.performance.mark&&!!window.performance.measure,t=new Is(this._desiredTraffic).get();this._enabled=t,window.adthrive&&(this._isDevelopmentTraffic=window.adthrive.bucket.includes("ovrd"),this._isDevelopmentTraffic&&e&&(this._enabled=!0))}};class Vl{init(){Vl.pushToQueue((()=>{const e=window.googletag.pubads();e.setSafeFrameConfig({sandbox:!0,allowOverlayExpansion:!0,allowPushExpansion:!0}),e.set("page_url",this._context.pageUrl),e.enableSingleRequest(),e.disableInitialLoad(),e.setPrivacySettings({childDirectedTreatment:Gi()}),this._addGamEventListeners(),this._bootstrapEventBus.libraryLoadFailed.on((({bootstrapType:e})=>{e===oe.Prebid&&this.setTargetingFlag("pbjs",["failed"])}),{handleEventsAlreadyEmitted:!0}),this._config.act25.required&&this._consentEventBus.act25consentCaptured.on((e=>{this.setNonPersonalizedAds(!e)}),{handleEventsAlreadyEmitted:!0}),this._identityEventBus.optableResolved.on((e=>this._setOptableGamTargeting(e)),{handleEventsAlreadyEmitted:!0})})),this.setTargetingFlag("tpme",[Ul.enabled.toString()])}start(){Vl.pushToQueue((()=>{window.googletag.enableServices();try{this._eventBus.started.emit()}catch(e){te.error("GoogleAdManager","start","started",e)}}))}static pushToQueue(e){window.googletag.cmd.push(e)}waitForQueue(){return new Promise((e=>{window.googletag.cmd.push((()=>{e(!0)}))}))}setTargeting(e){const t=(Array.isArray(e)?e:[e]).filter((e=>!(!e.value||!e.value.length)));for(const e of t)e&&Vl.pushToQueue((()=>{window.googletag.pubads().setTargeting(e.key,e.value)}))}setSlotTargeting(e,t){const i=Array.isArray(e)?e:[e];for(const e of i)e&&Vl.pushToQueue((()=>{t.setTargeting(e.key,Array.isArray(e.value)?e.value.join(","):e.value)}))}setTargetingFlag(e,t,i=!1){const s=()=>{const s=window.googletag.pubads().getTargeting("flag").filter((t=>{const[s]=t.split(":");return!i||s!==e}));this.setTargeting({key:"flag",value:[...s,...t.map((t=>`${e}:${t}`))]})};t&&t.length>0&&Vl.pushToQueue((()=>s()))}getTargeting(){return window.googletag.pubads().getTargetingKeys().map((e=>({key:e,value:window.googletag.pubads().getTargeting(e)})))}getTargetingValuesForKey(e){return window.googletag.pubads().getTargeting(e)}getTargetingValuesForFlag(e){let t=[];const i=this.getTargetingValuesForKey("flag").filter((t=>{const[i]=t.split(":");return i===e}));return i.length>0&&(t=i.map((e=>e.split(":")[1]))),t}getTargetingMap(){const e=window.googletag.pubads();return e.getTargetingKeys().reduce(((t,i)=>(t[i]=e.getTargeting(i),t)),{})}clearTargetingForKey(e){Vl.pushToQueue((()=>{window.googletag.pubads().clearTargeting(e)}))}_getPathname(e){return e.location===ge.Content&&e.sequence&&e.sequence>9||e.location===ge.Below_Post&&e.sequence&&e.sequence>1?e.location:e.location===ge.Sidebar&&e.sequence&&e.sequence>9?e.name.replace(/\d+/,"9"):e.location===ge.Recipe&&e.sequence&&e.sequence>5?e.name.replace(/\d+/,"2"):e.name}defineSlots(e){const{id:t}=this._config.site,{account:i,prefix:s}=this._config.gam;return e.map((e=>{const r=this._getPathname(e),n=`/${i}/${s}_${r}/${t}`,a=e.location===ge.Video_StickyOutstream?[...e.sizes]:[...e.sizes,"fluid"];return this._setupSlot(e,n,a),e})).filter(Ji)}displaySlots(e){Vl.pushToQueue((async()=>{const t=window.googletag.pubads();window.googletag&&!window.googletag.pubadsReady&&te.error("index","load",new Error(`Unexpected googletag.pubadsReady: ${window.googletag.pubadsReady}`));let i=[];await this._prebidMethods.waitForQueue().then((e=>{!0===e&&(i=this._prebidMethods.getAllPrebidWinningBids())}));for(const s of e){const r=s.location===ge.Video_StickyOutstream,n=this._demandChain.getBidWithBsidForSlot(i,s);let a;n&&(a=this._demandChain.getLastBsid(n.meta),a&&s.googleTagSlot.setTargeting("hb_bsid",a)),t.enableLazyLoad(this._dynamicContentSlotLazyLoadingComponent.lazyLoadingEnabledForSlot(s,this._prebidMethods)?this._config.lazyLoad.googleLazyLoadSettings.gam:this._config.lazyLoad.googleLazyLoadSettings.disabled),await this._emitBeforeRefreshSlots(e);!r||this._hasBids(s,{hb_bsid:a})?t.refresh([s.googleTagSlot]):(s.unfilled=!0,this._emitNoBidResponses(s))}}))}refreshSlots(e){Vl.pushToQueue((async()=>{await this._emitBeforeRefreshSlots(e);const t=[],i=[];e.forEach((e=>{e.location!==ge.Video_StickyOutstream||this._hasBids(e)?t.push(e):(e.unfilled=!0,i.push(e))})),t.length&&(t.forEach((e=>e.addRequestTypeSlotFlag())),window.googletag.pubads().refresh(t.map((e=>e.googleTagSlot)))),i.forEach((e=>this._emitNoBidResponses(e)))}))}_emitNoBidResponses(e){return this._slotEventBus.noBidResponses.legacyEmit(e)}_hasBids(e,t){const i=e.googleTagSlot;if(!i)return;const s=i.getTargeting("amz_pb").length||i.getTargeting("amz_pb_sp").length,r=i.getTargeting("hb_adid").length||s;return r||te.event("GoogleAdManager","_hasBids",{name:e.name,nref:e.refreshCount,...t}),!!r}_emitBeforeRefreshSlots(e){return this._slotEventBus.beforeGoogleAdManagerRefreshSlots.legacyEmit(e)}clearSlots(e){Vl.pushToQueue((()=>{const t=e.map((e=>e.googleTagSlot));window.googletag.pubads().clear(t)}))}destroySlots(e){Vl.pushToQueue((()=>{const t=e.map((e=>e.googleTagSlot));window.googletag.destroySlots(t)}))}setSharedIdAsPPID(e){const t=e.replace(/[\W_]/g,"");t.length>=32&&t.length<=150&&Vl.pushToQueue((()=>{window.googletag.pubads().setPublisherProvidedId(t)}))}setGPIDasPPID(e){Vl.pushToQueue((()=>{window.googletag.pubads().setPublisherProvidedId(e)}))}setNonPersonalizedAds(e){Vl.pushToQueue((()=>{window.googletag.pubads().setPrivacySettings({nonPersonalizedAds:e})}))}_addGamEventListeners(){this._addEventListener(this._eventBus.impressionViewable,"impressionViewable"),this._addEventListener(this._eventBus.slotOnload,"slotOnload"),this._addEventListener(this._eventBus.slotRenderEnded,"slotRenderEnded"),this._addEventListener(this._eventBus.slotVisibilityChanged,"slotVisibilityChanged"),this._addEventListener(this._eventBus.slotRequested,"slotRequested"),this._addEventListener(this._eventBus.slotResponseReceived,"slotResponseReceived")}_addEventListener(e,t){Vl.pushToQueue((()=>{window.googletag.pubads().addEventListener(t,(i=>{const s=Ul.markStartTask("microtask",["GoogleAdManager",t]),r=this._slots.get(i.slot.getSlotElementId());if(r)try{e.emit({slot:r,event:i})}catch(e){te.error("GoogleAdManager","addEventListener","emit",e)}s.markEndTask()}))}))}_setOptableGamTargeting(e){const{clusterCount:t,hemCount:i,accuracyResult:s,traits:r,recencyGroup:n}=e;this.setTargetingFlag("n_clust",[`${t}`]),this.setTargetingFlag("n_hem",[`${i}`]),this.setTargetingFlag("g_rec",[n]),"hem-found"===s.status?this.setTargetingFlag("rog_ha",[s.matchingClusterIndex.toString()]):"hem-not-found"===s.status&&this.setTargetingFlag("rog_ha",["-1"]),this._setOptableGamTargetingForTraits(r)}_setOptableGamTargetingForTraits(e){[{key:"lastSeen",targetingName:"td_rec"},{key:"percentile",targetingName:"td_perc"},{key:"hemSources",targetingName:"oemsrc"}].forEach((t=>{const{key:i,targetingName:s}=t,r=e[i];if(r)switch(r){case"true":this.setTargetingFlag(s,["t"]);break;case"false":this.setTargetingFlag(s,["f"]);break;default:this.setTargetingFlag(s,Array.isArray(r)?r.map((e=>e.toString())):[r.toString()])}}))}_setupSlot(e,t,i){if(this._bootstrapConfig.gptLibFailedToLoad)return;const s=window.googletag.pubads();e.googleTagSlot=e.location===ge.Interstitial?window.googletag.defineOutOfPageSlot(t,window.googletag.enums.OutOfPageFormat.INTERSTITIAL):window.googletag.defineSlot(t,i,e.element.id),e.googleTagSlot?(e.googleTagSlot.addService(s).setTargeting("location",e.location).setTargeting("sequence",String(e.sequence)).setTargeting("id",e.id),e.googleTagSlotReady=!0,e.googleTagSlotReadyEmitter.emit(),e.location!==ge.Content&&e.location!==ge.Below_Post||!this._adExpansionExperiment.result||e.googleTagSlot.setConfig({adExpansion:{enabled:!0}}),!this._interstitialConfigComponent.enabled||e.location!==ge.Interstitial&&e.location!==ge.Interstitial_1||this._interstitialConfigComponent._setInterstitialConfig(e),(1===e.sequence&&e.isAboveTheFold||e.location===ge.Footer)&&e.googleTagSlot.setTargeting("ATF","true"),e.isSticky&&e.location!==ge.Video_StickyOutstream&&e.googleTagSlot.setTargeting("sticky","true"),e.special&&e.special.length>0&&e.googleTagSlot.setTargeting("special",e.special),"Sponsor_Tile"===e.location&&e.googleTagSlot.setCollapseEmptyDiv(!0,!0),e.location.includes("Native")&&e.googleTagSlot.setCollapseEmptyDiv(!0),s.isInitialLoadDisabled()&&window.googletag.display(e.googleTagSlot)):te.error("GoogleAdManager","defineSlots","Duplicate",t)}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u,p,g){this._config=e,this._context=t,this._bootstrapEventBus=i,this._consentEventBus=s,this._slots=r,this._prebidMethods=n,this._demandChain=a,this._dynamicContentSlotLazyLoadingComponent=o,this._interstitialConfigComponent=l,this._adExpansionExperiment=d,this._identityEventBus=c,this._userIdEventBus=h,this._slotEventBus=u,this._eventBus=p,this._bootstrapConfig=g}}Vl=B([hs("GoogleAdManager"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Os?Object:Os,void 0===Rs?Object:Rs,void 0===zr?Object:zr,void 0===Ss?Object:Ss,void 0===bs?Object:bs,void 0===Ll?Object:Ll,void 0===Bl?Object:Bl,void 0===Fl?Object:Fl,void 0===Ls?Object:Ls,void 0===Fs?Object:Fs,void 0===Es?Object:Es,void 0===jl?Object:jl,void 0===tn?Object:tn])],Vl);class zl{setValues(e,t,i){e.values[`${this._host}|${t}`]=i>0?i:0}getDefaultFloorConfig(){return{currency:"USD",schema:{fields:["domain","adUnitCode"],delimiter:"|"},values:{}}}setPrebidFloors(e,t){e.modelGroups.length>0&&this._setPrebidFloors(e,t)}setRaptiveFloors(e,t){var i;const s=(null==e||null==(i=e.modelGroups)?void 0:i[0])||{},r=(null==s?void 0:s.values)||{};this._raptiveFloors=e,t&&this._setPrebidFloors(e,de.raptive,!0),this._setAmazonFloors({values:r,currency:e.currency},!0)}auctionCaptured(e){return!!this._auctionFloors.get(e)}setAuctionFloors(e,t=0,i,s){this._auctionFloors.set(e,{price:t,floorData:i,bidder:s})}getAuctionFloors(e){const{price:t,floorData:i,bidder:s}=e&&this._auctionFloors.get(e)||{},r=i||{};return{floorPrice:!(null==i?void 0:i.skipped)&&t&&t.toFixed(4).toString()||"none",floorData:r,bidder:s}}saveBids(e,t){this._prebidMethods.getBidResponsesForAdUnitCode(e.id).bids.forEach((e=>{t.push(e.cpm)}))}prioritizeFloorsConfig(e,t,i){if(!Object.keys(t.values).length)return;const s=Object.keys(t.values),r=this._config.floors,n=this._prioritizedFloorsByUnit.get(e);for(const o of s)if(o.includes(e)){var a;const s=(null==n||null==(a=n[i])?void 0:a.values)||{},l=t.values[o],d={[o]:l};t.values={...s,...d},this._prioritizedFloorsByUnit.set(e,{...n,[i]:t}),r.savePriorityFloorData(e,t,i)}return t}_getCombinedLegacyData(e){const t=this.getDefaultFloorConfig();for(const e of this._prioritizedFloorsByUnit.values())for(const i of this._floorPriority){const s=e[i];if(s){t.values={...t.values||{},...s.values};break}}return t.values={...t.values,...e.values},t}setLegacyFloorsConfig(e){const t=this._getCombinedLegacyData(e);this._setAmazonFloors(t);const i=this._config.floors,s=!i.floorsExperiment.fbrap&&i.floorsData||{floorProvider:"legacy",floorsSchemaVersion:2,currency:"USD",modelGroups:[{...t,skipRate:0,modelWeight:100,modelVersion:"legacy"}]};return this.setPrebidFloors(s),s}updateBidTTL(e,t,i=""){(i?this._prebidMethods.getBidResponsesForBidPoolId(i):this._prebidMethods.getBidResponsesForAdUnitCode(e)).bids.filter((e=>"rendered"!==e.status&&e.ttl&&!e.expired&&!e.sharedBidInUse)).forEach((i=>{const s=i.responseTimestamp,r=i.ttl,n=(e.includes(ge.Video_StickyOutstream)?this._config.prebid.multistageStickyOutstreamActive:this._config.prebid.multistageActive)?2:1,a=r-this._expirationThreshold*n;Number(s)+1e3*Number(a)<t&&(i.ttl=0,i.expired=!0)}))}setOGRefreshValue(e,t){this._refreshFloors.set(e,t)}get prioritizedFloorData(){return this._prioritizedFloorsByUnit}createFloorValue(e=[],t=0){return 0===e.length?0:e.length>1?Bi(e,t):e[0]*t}getAmazonFloors(e,t){const i=this.getAmazonFloorsById(e);if(!i&&this._config.floors.floorsExperiment.raptive){const i=this._getAmazonRaptiveFloorKeys([e,`${t||0}`]);for(const e of i){const t=this.getAmazonFloorsById(e);if(t)return t}}return i}clearVideoFlagSlot(e){if(e)return delete this._videoFlagSlot[e],!0}getVideoFlagSlot(e){return e&&e in this._videoFlagSlot?this._videoFlagSlot[e]:{}}setVideoFlagSlot(e,t={}){return e&&(this._videoFlagSlot[e]={...this._videoFlagSlot[e],...t})}_setupEventListeners(){const{fbrap:e,legacy:t}=this._config.floors.floorsExperiment,i=t||e;i&&(this._slotEventBus.preRequestBids.on(this._setBannerAuctionFloor.bind(this)),this._videoEventBus.preRequestVideoBids.on(this._setVideoAuctionFloor.bind(this))),this._prebidEventBus.auctionEnd.on((e=>{i&&e.adUnitCodes.forEach((e=>this._clearRefreshFloorValue(`${this._host}|${e}`)))})),this._slotEventBus.auctionsCompleted.on((e=>{e.forEach((e=>{this._clearRefreshFloorValue(`${this._host}|${e.id}`)})),this.setSlotFloorTargeting(e)})),this._videoEventBus.auctionsCompleted.on((e=>{e.forEach((e=>{this._clearRefreshFloorValue(`${this._host}|${e.name}`)})),this.setVideoFloorTargeting(e)}))}_setVidDiscountRules(){Object.keys(_e).forEach((e=>{const t=`${this._host}|${_e[e]}`;this._vidDiscountRules[t]=1e-5}))}_clearRefreshFloorValue(e){this._floorResetTypes.forEach((t=>{const i=this._prioritizedFloorsByUnit.get(e),s=null==i?void 0:i[t],r=null==s?void 0:s.values[e];s&&r&&(delete i[t],this._config.floors.savePriorityFloorData(e,s,t))}))}_setBannerAuctionFloor(e){e.forEach((e=>{const t=e.prebidAdUnit&&e.prebidAdUnit.length&&e.prebidAdUnit[0].code;t&&(this._usedFloorMap.delete(t),this._setAuctionFloor(t))}))}_setVideoAuctionFloor(e){e.videos.forEach((e=>{const t=e.name;this._usedFloorMap.delete(t),this._setAuctionFloor(t)}))}_setAuctionFloor(e){const t=this._raptiveFloors,i=this._floorPriority;let s=!1;if(e){for(let t=0;t<=i.length;t++){var r,n;const a=null==(r=this._prioritizedFloorsByUnit.get(e))?void 0:r[i[t]];if(null==a||null==(n=a.values)?void 0:n[`${this._host}|${e}`]){s=!0,this.setLegacyFloorsConfig(a),this._usedFloorMap.set(e,i[t]);break}}!s&&t&&this._setPrebidFloors(t,de.raptive,!!t)}}_excludeSettingFloors(e){if(!e||e&&!this._config.floors.floorsTypeExcludes.has(e))return!1;const{ccpa:t,gdpr:i}=this._config,s=t.enabled&&t.ccpaOptOut===t.privacyString,r=i.enabled&&i.revokedPurposeConsent;return e&&(s||r)}_setPrebidFloors(e,t,i){const s=this._excludeSettingFloors(t),r=(null==e?void 0:e.modelGroups)||[];s||1!==r.length||"legacy"!==r[0].modelVersion||(e.modelGroups[0].values={...this._vidDiscountRules,...e.modelGroups[0].values});const n=s?{}:{floors:{enforcement:{enforceJS:!1},data:e,...i&&{additionalSchemaFields:this._config.floors.customSchemaFields}}};this._prebidMethods.setConfig(n)}_getAmazonRaptiveFloorKeys(e){const t=e.join("-");let i=this._amazonRaptiveFloorKeys.get(t)||[];if(t&&!i.length){i=((e,t)=>e.reduce(((e,i)=>{const s=[];return e.forEach((e=>{i.forEach((i=>{s.push(e+t+i)}))})),s})).sort(((e,t)=>e.split("*").length-t.split("*").length)))(e.map((e=>[e,"*"])),"-"),this._amazonRaptiveFloorKeys.set(t,i)}return i}_setAmazonFloors({values:e,currency:t},i=!1){Object.keys(e).forEach((s=>{const r=s.split("|");var n;const a=r.length&&r[i&&null!=(n=this._config.floors.getSchemaFieldOrder("adUnitCode"))?n:1]||s;let o=a;if(i){o=`${a}-${r[this._config.floors.getSchemaFieldOrder("hvp")||1]}`}this._amazonFloors.set(o.toLowerCase(),{value:e[s],currency:t||"USD"})}))}getAmazonFloorsById(e){return this._amazonFloors.get(e.toLowerCase())||null}_getTargetingValue(e,t){const i=this._usedFloorMap.get(e),s=t&&"legacy"===t.floorProvider&&(i&&this._floorAbbrv[i]||"L");let r=!1;(null==t?void 0:t.skipped)&&(t.skippedReason===this.SKIP_REASON_RANDOM?r="sr":t.skippedReason===this.SKIP_REASON_NOT_FOUND?(r="se",te.event("Floors","_getTargetingValue","fv:se")):r="s");const n=null==t?void 0:t.modelVersion;return{modelVersion:r||s||n||"none",modelTimestamp:s?-1:n&&(null==t?void 0:t.modelTimestamp)||0,isLegacy:s}}_clearRefreshValue(e){return e&&this._refreshFloors.get(e)&&this._refreshFloors.set(e,0)}getFCVForAdUnit(e,t){const i=t?":":"%3A",s=[];return this._config.floors.activeFloorsTypes.forEach((t=>{let r=0;if(t===de.refresh)r=this._refreshFloors.get(e)||0,this._clearRefreshValue(e);else{var n,a;const i=null==(n=this._prioritizedFloorsByUnit.get(e))?void 0:n[t];r=(null==i||null==(a=i.values)?void 0:a[`${this._host}|${e}`])||0}r&&s.push(`${ce[t]}${i}${r}`)})),s.length,s}setSlotFloorTargeting(e){e.forEach((e=>{var t,i;const s=e.id,r=this.getFCVForAdUnit(s,!0),{floorPrice:n,floorData:a,bidder:o}=this.getAuctionFloors(null==(i=e.prebidAdUnit)||null==(t=i[0])?void 0:t.lastAuctionId),{modelVersion:l,modelTimestamp:d,isLegacy:c}=this._getTargetingValue(s,a);null==a||a.skipped;const h=!c&&Number(d)>=0;e.setSlotTargetingFlag("fv",[l],!0),e.setSlotTargetingFlag("hbf",[n],!0),e.setSlotTargetingFlag("hbb",[o||"none"],!0),h&&e.setSlotTargetingFlag("flrti",[`${d}`],!0),r.length&&e.setTargeting({key:"fcv",value:r})}))}setVideoFloorTargeting(e){e.forEach((e=>{const t=e.name,i=(this._prebidMethods.isPrebidLoaded()&&this._prebidMethods.getPrebidAdUnits()||[]).filter((t=>t.code===e.name))[0],s=this.getFCVForAdUnit(t,!1),{floorPrice:r,floorData:n}=this.getAuctionFloors(null==i?void 0:i.lastAuctionId),{modelVersion:a,modelTimestamp:o,isLegacy:l}=this._getTargetingValue(t,n);null==n||n.skipped;const d=!l&&Number(o)>=0,c={fv:a,hbf:r,...s.length&&{fcv:s},...d&&{flrti:`${o}`}};this.setVideoFlagSlot(t,c)}))}getFloorPrice(e,t){var i;return t?"none":e?(null==e||null==(i=e.floorData)?void 0:i.floorValue.toFixed(2))||"none":"0.00"}constructor(e,t,i,s,r,n){this._config=e,this._prebidMethods=t,this._slots=i,this._prebidEventBus=s,this._slotEventBus=r,this._videoEventBus=n,this._videoFlagSlot={},this._amazonFloors=new Map,this._amazonRaptiveFloorKeys=new Map,this._floorPriority=this._config.floors.cmPriority,this._floorResetTypes=[de.refresh,de.lazyBidPool,de.lazy],this._prioritizedFloorsByUnit=new Map,this._vidDiscountRules={},this._host=window.location.hostname,this._expirationThreshold=5,this._usedFloorMap=new Map,this._floorAbbrv={[de.refresh]:"lr",[de.lazyBidPool]:"lbp",[de.lazy]:"ll",[de.session]:"ls"},this._refreshFloors=new Map,this._auctionFloors=new Map,this.SKIP_REASON_RANDOM="random",this.SKIP_REASON_NOT_FOUND="not_found",this._setupEventListeners(),this._setVidDiscountRules()}}zl=B([hs("Floors"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Ss?Object:Ss,void 0===zr?Object:zr,void 0===Ms?Object:Ms,void 0===Es?Object:Es,void 0===zs?Object:zs])],zl);class $l{get videoEnabled(){return!0}get enabled(){return!0}}class Hl{getSupplyChainConfig(e){return{ver:"1.0",complete:1,nodes:[{asi:"cafemedia.com",sid:e,hp:1}]}}}const ql=new Map([["10thu68",`a_${ae.AppNexus}`],["16d9pts",`a_${ae.GumGum}`],["1axt6o",`a_${ae.OpenX}`],["1bkk3r4",`a_${ae.AmazonTAM}`],["1dfpj4",`a_${ae.AmazonTAM}`],["1e4ycjk",`a_${ae.Triplelift}`],["1lcnshs",`a_${ae.Sharethrough}`],["1skd8g0",`a_${ae.Yieldmo}`],["1y4543k",`a_${ae.Pubmatic}`],["3bcv7k",`a_${ae.AmazonTAM}`],["j27tog",`a_${ae.Rubicon}`],["me2y9s",`a_${ae.IndexExchange}`],["qtwge8",`a_${ae.Verizon}`],["upqrr4",`a_${ae.MediaGrid}`],["emebk0",`a_${ae.Unruly}`],["f6dibk",`a_${ae.Ogury}`],["rdvn5s",`a_${ae.Seedtag}`]]),Gl={"138wa9s":.01,lhm9s0:.02,"1l06ark":.03,clz9j4:.04,"1c4jaio":.05,ud9a0w:.06,"1tvtb0g":.07,"865reo":.08,"17opse8":.09,pxfrwg:.1,"1pfzsw0":.11,h1srnk:.12,"1gkcsn4":.13,yt2s5c:.14,"1ybmt4w":.15,"1ifi80":.16,"110zj7k":.17,j9pips:.18,"1is9jpc":.19,ae2igw:.2,"19wmjgg":.21,s5ciyo:.22,"1rnwjy8":.23,"5y90cg":.24,"15gt1c0":.25,npj0u8:.26,"1n831ts":.27,etw0lc:.28,"1ecg1kw":.29,wl6134:.3,"1w3q22o":.31,"2mdvr4":.32,"124xwqo":.33,kdnw8w:.34,"1jw7x8g":.35,bi0w00:.36,"1b0kwzk":.37,t9awhs:.38,"1sruxhc":.39,"727dvk":.4,"16krev4":.41,othedc:.42,"1oc1fcw":.43,fxue4g:.44,"1fgef40":.45,xp4em8:.46,"1x7ofls":.47,eh4ow:.48,zx15og:.49,i5r56o:.5,"1hob668":.51,"9a44xs":.52,"18so5xc":.53,r1e5fk:.54,"1qjy6f4":.55,"4uamtc":.56,"14cunsw":.57,mlknb4:.58,"1m44oao":.59,dpxn28:.6,"1d8ho1s":.61,vh7nk0:.62,"1uzrojk":.63,"4abg1s":.64,"13svh1c":.65,m1lgjk:.66,"1lk5hj4":.67,d5ygao:.68,"1coiha8":.69,ux8gsg:.7,"1ufshs0":.71,"8q4y68":.72,"188oz5s":.73,qheyo0:.74,"1pzyznk":.75,hlryf4:.76,"1h4bzeo":.77,zd1yww:.78,"1yvlzwg":.79,"22eozk":.8,"11kypz4":.81,jtophc:.82,"1jc8qgw":.83,ay1p8g:.84,"1aglq80":.85,spbpq8:.86,"1s7vqps":.87,"6i8740":.88,"160s83k":.89,o9i7ls:.9,"1ns28lc":.91,fdv7cw:.92,"1ewf8cg":.93,x557uo:.94,"1wnp8u8":.95,"36d2io":.96,"12ox3i8":.97,kxn30g:.98,"1kg7400":.99,c202rk:1,"1bkk3r4":1.01,tta39c:1.02,"1tbu48w":1.03,"7m6kn4":1.04,"174qlmo":1.05,pdgl4w:1.06,"1ow0m4g":1.07,ghtkw0:1.08,"1g0dlvk":1.09,y93lds:1.1,"1xrnmdc":1.11,ygbgg:1.12,"10h0cg0":1.13,ipqby8:1.14,"1i8acxs":1.15,"9u3bpc":1.16,"19cncow":1.17,rldc74:1.18,"1r3xd6o":1.19,"5e9tkw":1.2,"14wtukg":1.21,n5ju2o:1.22,"1mo3v28":1.23,e9wtts:1.24,"1dsgutc":1.25,w16ubk:1.26,"1vjqvb4":1.27,"3gcnwg":1.28,"12ywow0":1.29,l7moe8:1.3,"1kq6pds":1.31,cbzo5c:1.32,"1bujp4w":1.33,u39on4:1.34,"1tltpmo":1.35,"7w660w":1.36,"17eq70g":1.37,png6io:1.38,"1p607i8":1.39,grt69s:1.4,"1gad79c":1.41,yj36rk:1.42,"1y1n7r4":1.43,"18fwu8":1.44,"10qzxts":1.45,izpxc0:1.46,"1ii9ybk":1.47,a42x34:1.48,"19mmy2o":1.49,rvcxkw:1.5,"1rdwykg":1.51,"5o9eyo":1.52,"156tfy8":1.53,nfjfgg:1.54,"1my3gg0":1.55,ejwf7k:1.56,"1e2gg74":1.57,wb6fpc:1.58,"1vtqgow":1.59,"2ceadc":1.6,"11uybcw":1.61,k3oav4:1.62,"1jm8buo":1.63,b81am8:1.64,"1aqlbls":1.65,szbb40:1.66,"1shvc3k":1.67,"6s7shs":1.68,"16arthc":1.69,ojhszk:1.7,"1o21tz4":1.71,fnusqo:1.72,"1f6etq8":1.73,xf4t8g:1.74,"1wxou80":1.75,"4hjb4":1.76,zn1kao:1.77,hvrjsw:1.78,"1hebksg":1.79,"904jk0":1.8,"18iokjk":1.81,qrek1s:1.82,"1q9yl1c":1.83,"4kb1fk":1.84,"142v2f4":1.85,mbl1xc:1.86,"1lu52ww":1.87,dfy1og:1.88,"1cyi2o0":1.89,v78268:1.9,"1ups35s":1.91,"40buo0":1.92,"13ivvnk":1.93,lrlv5s:1.94,"1la5w5c":1.95,cvyuww:1.96,"1ceivwg":1.97,un8veo:1.98,"1u5swe8":1.99,"8g5csg":2,"17ypds0":2.01,q7fda8:2.02,"1ppze9s":2.03,hbsd1c:2.04,"1guce0w":2.05,z32dj4:2.06,"1ylmeio":2.07,"1sf3ls":2.08,"11az4lc":2.09,jjp43k:2.1,"1j29534":2.11,ao23uo:2.12,"1a6m4u8":2.13,sfc4cg:2.14,"1rxw5c0":2.15,"688lq8":2.16,"15qsmps":2.17,nzim80:2.18,"1ni2n7k":2.19,f3vlz4:2.2,"1emfmyo":2.21,wv5mgw:2.22,"1wdpngg":2.23,"2wdh4w":2.24,"12exi4g":2.25,knnhmo:2.26,"1k67im8":2.27,bs0hds:2.28,"1bakidc":2.29,tjahvk:2.3,"1t1uiv4":2.31,"7c6z9c":2.32,"16ur08w":2.33,p3gzr4:2.34,"1om10qo":2.35,g7tzi8:2.36,"1fqe0hs":2.37,xz4000:2.38,"1xho0zk":2.39,ogq2o:2.4,"1070r28":2.41,ifqqkg:2.42,"1hyark0":2.43,"9k3qbk":2.44,"192nrb4":2.45,rbdqtc:2.46,"1qtxrsw":2.47,"54a874":2.48,"14mu96o":2.49,mvk8ow:2.5,"1me49og":2.51,dzx8g0:2.52,"1dih9fk":2.53,vr78xs:2.54,"1v9r9xc":2.55,"3vc1z4":2.56,"13dw2yo":2.57,lmm2gw:2.58,"1l563gg":2.59,cqz280:2.6,"1c9j37k":2.61,ui92ps:2.62,"1u0t3pc":2.63,"8b5k3k":2.64,"17tpl34":2.65,q2fklc:2.66,"1pkzlkw":2.67,h6skcg:2.68,"1gpclc0":2.69,yy2ku8:2.7,"1ygmlts":2.71,"1nfaww":2.72,"115zbwg":2.73,jepbeo:2.74,"1ix9ce8":2.75,aj2b5s:2.76,"1a1mc5c":2.77,sacbnk:2.78,"1rswcn4":2.79,"638t1c":2.8,"15lsu0w":2.81,nuitj4:2.82,"1nd2uio":2.83,eyvta8:2.84,"1ehfu9s":2.85,wq5ts0:2.86,"1w8purk":2.87,"2rdog0":2.88,"129xpfk":2.89,kinoxs:2.9,"1k17pxc":2.91,bn0oow:2.92,"1b5kpog":2.93,teap6o:2.94,"1swuq68":2.95,"7776kg":2.96,"16pr7k0":2.97,oyh728:2.98,"1oh181s":2.99,g2u6tc:3,"1020ydc":3.05,r6dy4g:3.1,"1m94gzk":3.15,"4fb8qo":3.2,"1cti9z4":3.25,qmercw:3.3,"1z0lslc":3.35,b31hxc:3.4,"165s0sg":3.45,xa50jk:3.5,"1kl6wow":3.55,"7r6dc0":3.6,"1g5dekg":3.65,iuq4n4:3.7,"1r8x5vk":3.75,eewmio:3.8,"133whkw":3.85,u89hc0:3.9,"1pb0074":3.95,"1dfpj4":4,"19rmqrk":4.05,nkj85c:4.1,"1vyq9ds":4.15,bd13b4:4.2,"16frm68":4.25,xk4lxc:4.3,"1hjbdhc":4.35,"4pau4g":4.4,"1d3hvcw":4.45,lwlnuo:4.5,"1uasp34":4.55,hgs5q8:4.6,"11fyxa8":4.65,skbx1c:4.7,"1nn2fwg":4.75,"31d9ts":4.8,"1bfkb28":4.85,p8gsg0:4.9,"1xmntog":4.95,"9p3j0g":5,"14ru1vk":5.05,vw71mo:5.1,"1kxoef4":5.15,"83nv28":5.2,"1ghuwao":5.25,j77mdc:5.3,"1rlenls":5.35,ere48w:5.4,"122g0e8":5.45,t6t05c:5.5,"1o9jj0g":5.55,bz8cg:5.6,"18q69kw":5.65,mj2qyo:5.7,"1ux9s74":5.75,d3gjy8:5.8,"18672tc":5.85,zak2kg:5.9,"1j9qu4g":5.95,"6fqark":6,"1etxc00":6.05,kv56o0:6.1,"1t9c7wg":6.15,gfbojk:6.2,"10eig3k":6.25,rivfuo:6.3,"1mllyps":6.35,"3durk0":6.4,"1bs1ssg":6.45,pkya68:6.5,"1xz5beo":6.55,a1l0qo:6.6,"154bjls":6.65,w8ojcw:6.7,"1jjqfi8":6.75,"6ppw5c":6.8,"1f3wxds":6.85,ht9ngg:6.9,"1q7goow":6.95,ddg5c0:7,"13gdzb4":7.05,ukqz28:7.1,"1pnhhxc":7.15,"1px79c":7.2,"1a448hs":7.25,nx0pvk:7.3,"1wb7r40":7.35,bpil1c:7.4,"16s93wg":7.45,xwm3nk:7.5,"1hvsv7k":7.55,"51sbuo":7.6,"1dfzd34":7.65,lk464g:7.7,"1tyb7cw":7.75,h4ao00:7.8,"113hfk0":7.85,s7ufb4:7.9,"1naky68":7.95,"2ovs3k":8,ovzaps:8.1,"9cm1a8":8.2,"14fck5c":8.25,vjpjwg:8.3,"8smuio":8.4,jw6lts:8.5,fgd3pc:8.6,tvrzls:8.7,"1oyiigw":8.75,"10y7sw":8.8,n81qf4:8.9,cehkhs:9,yll340:9.1,"5qrbb4":9.2,"1e4ycjk":9.25,k6677k:9.3,fqcp34:9.4,qtwge8:9.5,"42tr0g":9.6,q9x9mo:9.7,"1yo4av4":9.75,aqk074:9.8,wxnitc:9.9,"7eovls":10,ii8mww:10.1,e2f4sg:10.2,"137nc3k":10.25,uc0buo:10.3,"1h6k1s":10.4,noa2o0:10.5,bgrxts:10.6,xnvgg0:10.7,"1hn2800":10.75,"4t1on4":10.8,m0cidc:10.9,hkj08w:11,so2rk0:11.1,"3544cg":11.2,"1bjb5kw":11.25,pc7myo:11.3,"9sudj4":11.4,vzxw5c:11.5,"7ux7uo":11.6,iygz5s:11.7,"1rco0e8":11.75,einh1c:11.8,sy2cxs:11.9,"38l4w":12,mac3r4:12.1,cupwqo:12.2,"17xgfls":12.25,z1tfcw:12.3,"66znk0":12.4,kmejgg:12.5,g6l1c0:12.6,"1mcvbi8":12.7,ra4sn4:12.75,"3u33sw":12.8,q16mf4:12.9,ahtczk:13,wowvls:13.1,"75y8e8":13.2,"1fk59mo":13.25,i9hzpc:13.3,dtohkw:13.4,v0zbb4:13.5,"265ji8":13.6,od924g:13.7,"1wrg3cw":13.75,c5qxa8:13.8,ycufwg:13.9,"5i0o3k":14,lbdiww:14.1,gvk0sg:14.2,"10uqscg":14.25,rz3s3k:14.3,"2g54w0":14.4,on8ni8:14.5,"93ve2o":14.6,vaywow:14.7,"1ldwqo0":14.75,"8jw7b4":14.8,jnfym8:14.9,f7mghs:15,tn1ce8:15.1,s7klc:15.2,"196elts":15.25,mzb37k:15.3,ci8f0g:15.4,ypbxmo:15.5,"5ui5ts":15.6,k9x1q8:15.7,"1so42yo":15.75,fu3jls:15.8,qxnaww:15.9,"46klj4":16,qdo45c:16.1,auaups:16.2,"15x1dkw":16.25,x1edc0:16.3,"7ifq4g":16.4,ilzhfk:16.5,e65zb4:16.6,tziu4g:16.7,"1p29czk":16.75,"14p2bk":16.8,nbskxs:16.9,b4ag3k:17,xbdyps:17.1,"4gk6ww":17.2,"1cur85c":17.25,lnv0n4:17.3,h81iio:17.4,sbl9ts:17.5,"2smmm8":17.6,ozq58g:17.7,"1xdx6gw":17.75,"9gcvsw":17.8,vngef4:17.9,"87epkw":18,jaygw0:18.1,ev4yrk:18.2,"1266uww":18.25,tajuo0:18.3,fq2v4:18.4,mmtlhc:18.5,d77egw:18.6,zeax34:18.7,"1jdhon4":18.75,"6jh5a8":18.8,kyw16o:18.9,gj2j28:19,rmmadc:19.1,"3hlm2o":19.2,"1bvsnb4":19.25,pop4ow:19.3,a5bv9c:19.4,wcfdvk:19.5,"6tgqo0":19.6,hx0hz4:19.7,"1qb7j7k":19.75,dh6zuo:19.8,uohtkw:19.9,"1to1s0":20,lgzsow:20.5,"99hnuo":21,tsnm68:21.5,"5nmxvk":22,q6sw74:22.5,dzarcw:23,xthq80:23.5,"3aqe4g":24,j438xs:24.5,d0c6io:25,rfr2f4:25.5,"6z30g0":26,o6du68:26.5,goosu8:27,v43oqo:27.5,lccn4:28,kfjbi8:28.5,azx4hs:29,u553wg:29.5,"4m6gow":30,p5cf0g:30.5,es0lc0:31,zb6jnk:31.5,"3eh8n4":32,htw4jk:32.5,bq524g:33,s8gwe8:33.5,"8t9bls":34,n8o7i8:34.5,fqz668:35,wy9zwg:35.5,"1e26m8":36,lx84xs:36.5,"9pq03k":37,suxzi8:37.5,"63va4g":38,py28zk:38.5,dqk45c:39,y9q2gw:39.5,"2d0rgg":40,jkbl6o:40.5,cmai2o:41,r1pdz4:41.5,"7mht6o":42,nfuo00:42.5,hc3lkw:43,vrihhc:43.5,js5xc:44,l2y48w:44.5,a9dybk:45,usjwn4:45.5,"59l9fk":46,oraqkg:46.5,fbojk0:47,ygwiyo:47.5,"3y56v4":48,idk2rk:48.5,bku0w0:49,ss4um8:49.5,"7yzaww":50,mee6tc:50.5,gan4e8:51,wk8bgg:51.5,"21gzcw":52,l6oyrk:52.5,"8z6txc":53,tics8w:53.5,"62b3eo":54,qlh1q8:54.5,edyww0:55,xj6wao:55.5,"30fk74":56,j69wqo:56.5,d2iubk:57,rhxq80:57.5,"6os6io":58,nw308w:58.5,h3cydc:59,viru9s:59.5,"100i68":60,k58hkw:60.5,apmakg:61,ucy1hc:61.5,"4tze9s":62,pd5clc:62.5,ejl6o0:63,z2r4zk:63.5,"3v0tfk":64,iafpc0:64.5,c6omww:65,s01hq8:65.5,"8ktwxs":66,n08su8:66.5,fv198g:67,x2c2yo:67.5,"15mry8":68,losq9s:68.5,"9halfk":69,tbhkao:69.5,"6keuww":70,ppmubk:70.5,di4phc:71,y1answ:71.5,"2ktp1c":72,js4irk:72.5,cafhfk:73,qpudc0:73.5,"7amsjk":74,nsymtc:74.5,hp7ke8:75,w4mgao:75.5,"7x5a8":76,kr33ls:76.5,aa0feo:77,ut6dq8:77.5,"5a7qio":78,offpxc:78.5,eztiww:79,yu0hs0:79.5,"4b95og":80,iqo1kw:80.5,b8z08w:81,sg9tz4:81.5,"86bdog":82,mlq9kw:82.5,ghz75s:83,wbc1z4:83.5,"1skpvk":84,lmroqo:84.5,"9f9jwg":85,tyfi80:85.5,"5tetxc":86,qcks8w:86.5,e52neo:87,xms4jk:87.5,"340sg0":88,ixdn9c:88.5,ctmku8:89,r91gqo:89.5,"74uwhs":90,oc5q80:90.5,gugow0:91,v9vksg:91.5,r48ow:92,kckkcg:92.5,awydc0:93,u26cqo:93.5,"4j7pj4":94,p2dnuo:94.5,exshds:95,zgyfpc:95.5,"3k94ow":96,hzo0lc:96.5,bvwy68:97,s1raps:97.5,"8mjpxc":98,n1ylts:98.5,fk9khs:99,wrke80:99.5,"1ju2o0":100},Kl=e=>Gl[(e=>{const t=e.indexOf("_");return-1===t?e:e.substring(t+1)})(e)];class Wl extends nr{init(){this._key="AmazonHoldDisplay",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Wl.prototype,"run",null),Wl=B([hs("AmazonLibraryExperiment"),M()],Wl);class Yl{isAmazonLoaded(){return!!window.apstag}init(e){this.isAmazonLoaded()&&window.apstag.init(e)}customPlacements(){return this.isAmazonLoaded()&&window.apstag.customPlacements&&window.apstag.customPlacements()}fetchBids(e,t){this.isAmazonLoaded()&&window.apstag.fetchBids(e,t)}setDisplayBids(){this.isAmazonLoaded()&&window.apstag.setDisplayBids()}targetingKeys(){return this.isAmazonLoaded()?window.apstag.targetingKeys():[]}rpa(e){this.isAmazonLoaded()&&window.apstag.rpa(e,this.tokenCallback,!1)}upa(e){this.isAmazonLoaded()&&window.apstag.upa(e,this.tokenCallback,!1)}tokenCallback(e){e&&(document.cookie=`AMZN-Token=${e.AIPToken}; expires=${e.cookieExpiry}; path=/;`)}dpa(e){this.isAmazonLoaded()&&window.apstag.dpa(e)}renderImp(e,t){this.isAmazonLoaded()&&window.apstag.renderImp&&window.apstag.renderImp(e,t)}}class Ql extends sr{init(){this._key="AdInViewExperiment_2"}}Ql=B([hs("AdInViewExperiment"),M()],Ql);class Xl extends As{get result(){return this._result}run(){return new Is(this.weight).get()}constructor(e){super(),this._result=!1,this.abgroup="scre",this.key="StickyContainerRecipe",this._choices=[{choice:!0},{choice:!1}],this.weight=.99,this.shouldUseCoreOverride=!1;const t=window,i=t&&t.adthriveCLS,s=i&&i.experiments,r=s&&this.abgroup in s;this._result=r?s[this.abgroup]:this.run(),e.set(this.abgroup,this._result?"on":"off")}}Xl=B([hs("StickyContainerRecipeExperiment"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Qs?Object:Qs])],Xl);const Jl=()=>new Promise((e=>setTimeout(e,0)));class Zl extends sr{init(){this._key="ASRInViewRefreshExperiment"}get result(){const e=this._result;return"noref"===e?864e5:"number"==typeof e?1e3*e:void 0}}Zl=B([hs("ASRInViewRefreshExperiment"),M()],Zl);class ed extends sr{init(){this._key="SizeOrder"}}ed=B([hs("SizeOrderExperiment"),M()],ed);const td=new Map([["300x250",1],["320x50",2],["728x90",3],["300x600",4],["300x50",5],["336x280",6],["1x1",7],["160x600",8],["320x300",9],["300x300",10],["320x100",11],["552x334",12],["970x90",13],["300x420",14],["300x390",15],["970x950",16],["250x250",17],["468x60",18],["1x2",19],["320x480",20],["120x240",21],["728x4100",22],["*",23]]);class id{async add(e){const t=Ul.markStartTask("microtask",["SlotManager","add","1"]);this._bootstrapConfig.gptLibFailedToLoad?t.markEndTask():(t.markEndTask(),await this._googleAdManager.waitForQueue());const i=Ul.markStartTask("microtask",["SlotManager","add","2"]),s=kr.readSessionStorage("adthrive_footer_closed"),r=this._googleAdManager.defineSlots(this.castArray(e).filter((e=>e.location!==ge.Footer||e.location===ge.Footer&&!s))),n=this._config.marmalade;n.adViewability.length||this._marmaladeEventBus.resetMarmaladeData.once((()=>{r.forEach((e=>e.setViewability(n)))})),r.forEach((e=>{this._slotSorter&&(e.sizes=e.sizes.sort(this._slotSorter)),e.setViewability(n),e.setHighlyViewable(n),e.setBidPoolId(this._config.prebid.bidPoolSlots),e.setPassiveBidPoolId();e.location===ge.Recipe&&e.sticky&&this._stickyContainerRecipeExperiment.result||this._config.clsOptimizedAds.setStyle(e.element,e.location)})),this._slotEventBus.addSlots.emit(r),this._slots.add(r),i.markEndTask(),await Jl();const a=Ul.markStartTask("microtask",["SlotManager","add","3"]),o=this.eventBus.added.legacyEmit(r);return a.markEndTask(),await o,r}async clear(e){const t=this.castArray(e);return t.forEach((e=>{e.displayed=!1,this.setMinDimensions(e.element)})),this._googleAdManager.clearSlots(t),await this.eventBus.cleared.legacyEmit(t),t}destroy(e){const t=this.castArray(e);return this.pauseRefresh(t),this._slots.remove(t),this._googleAdManager.destroySlots(t),t}destroyAll(){const e=this._slots.get();return this.destroy(e)}rebuild(e){const t=this.castArray(e),i=this._googleAdManager;for(const e of t)Vl.pushToQueue((()=>{const t=["refresh","inf_scroll","decref","nref","hvp","lazy"].reduce(((t,i)=>{const s=e.getTargeting(i);return s.length&&t.push({key:i,value:s}),t}),[]);i.destroySlots(this.castArray(e)),e.googleTagSlotReady=!1,i.defineSlots(this.castArray(e)),e.setTargeting(t)}));return t}rebuildAll(){const e=this._slots.get();return this.rebuild(e)}removeElement(e){const t=this.castArray(e),i=[];for(const e of t)e.element.remove(),i.push(e.element);return i}removeAllElements(){const e=this._slots.get();return this.removeElement(e)}async refresh(e,t=!0,i=0){const s=this.castArray(e),{renderSlots:r,auctionSlots:n}=this._getSortedSlots(s);return r.length&&await this._renderSlots(r,t,i,0),n.length&&await this._auctionAndRenderSlots(n,t,i),s}async display(e){const t=this.castArray(e);await this.eventBus.displaying.legacyEmit(t);const i=Ul.markStartTask("microtask",["SlotManager","display","1"]),s=this.requestBids(t).then((async()=>{const e=Ul.markStartTask("microtask",["SlotManager","display","auctionComplete"]),i=this._slotEventBus.auctionsCompleted.legacyEmit(t);e.markEndTask(),await i;const s=Ul.markStartTask("microtask",["SlotManager","display","gamDisplaySlots"]);this._googleAdManager.displaySlots(t),s.markEndTask()}));i.markEndTask(),await s;const r=Ul.markStartTask("microtask",["SlotManager","display","2"]);t.forEach((e=>{e.displayed=!0}));const n=this.eventBus.displayed.legacyEmit(t);return r.markEndTask(),await n,t}inView(e){const t=this.castArray(e);return t.forEach((e=>this.setRefreshTimeout(e))),t}outOfView(e){const t=this.castArray(e);return t.filter((e=>!e.alwaysInView)).filter((e=>"IntersectionObserver"in window?e.outOfViewGPT&&e.outOfViewIO:e.outOfViewGPT)).forEach((e=>{const t=e.element.querySelector("div > iframe"),i=null==t?void 0:t.nextElementSibling;Ri(e.element)&&t&&(Ri(t)||i&&Ri(i))&&this.clearRefreshTimeout(e)})),t}pauseRefresh(e){const t=this.castArray(e);return t.filter((e=>e.refreshTimeout)).forEach((e=>{e.refreshPaused=!0,this.clearRefreshTimeout(e)})),t}resumeRefresh(e){const t=this.castArray(e);return t.filter((e=>e.refreshPaused)).forEach((e=>{e.refreshPaused=!1,this.setRefreshTimeout(e)})),t}updateRefreshTimeout(e,t){const i=this.castArray(e);return i.forEach((e=>{e.refreshInterval=t;const i=e.element.querySelector("div > iframe"),s=Ri(e.element)&&i&&Ri(i)&&!document.hidden;e.location===ge.Video_StickyOutstream&&e.unfilled?(this.setRefreshTimeout(e),e.unfilled=!1):e.refreshTimeout&&(e.location!==ge.Video_StickyOutstream||s)?(this.clearRefreshTimeout(e),this.setRefreshTimeout(e)):e.refreshTimeout&&!s&&(this.setRefreshTimeout(e),this.clearRefreshTimeout(e))})),i}clearRefreshTimeout(e,t=!1){this.castArray(e).filter((e=>e.refreshTimeout)).forEach((e=>{window.clearTimeout(e.refreshTimeout),e.refreshTimeout=void 0,t?(e.viewableDuration=0,e.slotFullyRenderedDuration=0):(e.viewableSince&&(e.viewableDuration+=Yi()-e.viewableSince.getTime()),e.slotFullyRenderedSince&&(e.slotFullyRenderedDuration=Yi()-e.slotFullyRenderedSince))}))}getSlot(e){return this._slots.get(e)}getAllSlots(){return this._slots.get()}get amazonBidResponseReceived(){return this._slotEventBus.amazonBidResponseReceived}triggerAuction(e,t=!1){if((e.hasRefreshStarted||e.isRefreshing)&&!t)return;const i=async t=>{e.refreshCount++,e.servedPrebidBidResponse=void 0,e.hasRefreshStarted=!0,await this.eventBus.refreshing.legacyEmit([e]),await this.eventBus.refreshAuctionStart.legacyEmit([e]);const i=this._getAuctionCount([e],e.location===ge.Video_StickyOutstream),s=1!==i,r=this._getInjectedAuctions(s,i);for(let t=0;t<r.length;t++){const i=t+1;await this.refreshBids([e],i,!1),await this.eventBus.refreshAuctionStart.legacyEmit([e])}await this.refreshBids([e],i,!0),t()};e.auctionPromise=new Promise((e=>{i(e)}))}_getAuctionCount(e,t){const i=t&&e[0].stickyOutstreamShortVideo,s=t&&e[0].noAdRefreshCount,r=t&&e[0].stickyOutstreamLastAdErrored,n=this._config.prebid.multiStageLimit,a=n&&e[0].refreshCount>=n?1:this._config.prebid.refreshAuctionCount,o=i||s||r?1:this._config.prebid.refreshStickyOutstreamAuctionCount;return t?o:a}_getAuctionDelay(e,t,i){var s;const r=this._config.timeouts.refreshBidsRequest,n=e.some((e=>e.location===ge.Video_StickyOutstream)),a=n&&e[0].stickyOutstreamShortVideo?1:this._config.prebid.refreshStickyOutstreamAuctionCount,o=n?a:this._config.prebid.refreshAuctionCount,l=null==(s=e[0])?void 0:s.stickyOutstreamRefreshTimeout,d=(i>3e4-r*o?3e4-i:r*o)-t,c=Math.max(d,0);return n&&l?l:c}_getInjectedAuctions(e,t){const i=[];if(e)for(let e=0;e<(t||1)-1;e++)i.push(e);return i}_getSortedSlots(e){return e.reduce(((e,t)=>(t.auctionPromise?e.renderSlots.push(t):e.auctionSlots.push(t),e)),{renderSlots:[],auctionSlots:[]})}_auctionAndRenderSlots(e,t,i){const s=Date.now();for(const t of e)this.triggerAuction(t,!0);const r=Date.now();return this._renderSlots(e,t,i,r-s)}async _renderSlots(e,t=!0,i=0,s=0){const r=this._getAuctionDelay(e,s,i);for(const i of e)i.isRefreshing=!0,await Promise.all([!t||St(r),i.auctionPromise]).then((async()=>{await this._slotEventBus.auctionsCompleted.legacyEmit(e),this._googleAdManager.refreshSlots(e),i.isRefreshing=!1,i.hasRefreshStarted=!1,await this.eventBus.refreshed.legacyEmit(e)}))}setRefreshTimeout(e){this.castArray(e).filter((e=>!(e.refreshTimeout||e.isRefreshing&&e.location!==ge.Video_StickyOutstream))).forEach((e=>{const t=e.location===ge.Video_StickyOutstream?this.stickyOutstreamRefreshInterval:this.displayRefreshInterval,i=this.calculateRemainingRefreshDuration(e,e.auctionPromise?25e3:t);e.viewableSince=new Date,e.slotFullyRenderedSince||(e.slotFullyRenderedSince=Date.now()),0!==e.refreshInterval&&(e.refreshTimeout=window.setTimeout((()=>{const t=Yi()-(e.slotFullyRenderedSince||Date.now());e.viewableDuration=0,e.slotFullyRenderedDuration=0,e.refreshInterval=void 0,e.refreshTimeout=void 0,e.slotFullyRenderedSince=void 0,this.refresh(e,!0,t).catch((e=>{}))}),Math.max(i,0)))}))}getAmazonBidderCode(e){var t,i;return 4526447244===this.slotAdvertiserID.get(e.element.id)&&(null==(i=e.getTargeting("amz_bidder"))||null==(t=i[0])?void 0:t.substring(2))||""}getBidderAdInViewDurationOverride(e){var t;const i=new Set(["kargo","krgo_ss","tripl_ss","triplelift","ogury","nativo"]),s=(null==(t=e.servedPrebidBidResponse)?void 0:t.bidderCode)||"",r=this.getAmazonBidderCode(e);if(e.getTargetingMap().amznasr){const e=this._asrInViewRefreshExperiment.result;return null!=e?e:5e3}return i.has(s)||i.has(r)?5e3:void 0}calculateRemainingRefreshDuration(e,t=25e3){const i=this._adInViewExperiment.result?this.getBidderAdInViewDurationOverride(e):void 0,s=bt(i||this._adInViewExperiment.result,t),r=bt(e.refreshInterval,s);e.slotFullyRenderedSince&&(e.slotFullyRenderedDuration=Yi()-e.slotFullyRenderedSince);const n=t-e.slotFullyRenderedDuration,a=r-e.viewableDuration,o=Math.max(n,a,0);if(e.location===ge.Video_StickyOutstream){return bt(e.refreshInterval,this.stickyOutstreamRefreshInterval)-e.viewableDuration}return o}async requestBids(e){const t=this.castArray(e).filter((e=>e.enabledForAuction));if(0===t.length)return t;await this.eventBus.requestingBids.legacyEmit(t);const i=Ul.markStartTask("microtask",["SlotManger","requestBids","1"]),s=this._slotEventBus.preRequestBids.legacyEmit(t);i.markEndTask(),await s;const r=Ul.markStartTask("microtask",["SlotManger","requestBids","2"]),n=this._slotEventBus.requestingBids.legacyEmit(t);r.markEndTask(),await n;const a=Ul.markStartTask("microtask",["SlotManger","requestBids","3"]),o=this.eventBus.requestedBids.legacyEmit(t);return a.markEndTask(),await o,t}async refreshBids(e,t=0,i=!0){const s=this.castArray(e).filter((e=>e.enabledForAuction));return s.length>0&&(this._clearTargetingKeysOnRefresh(s),await this.eventBus.refreshingBids.legacyEmit(s),await this._slotEventBus.preRequestBids.legacyEmit(s),await this._slotEventBus.refreshingBids.legacyEmit({managedSlots:s,auctionCount:t,setTargeting:i}),await this.eventBus.refreshedBids.legacyEmit(s)),s}castArray(e){if("string"==typeof e){const t=this._slots.get(e);return void 0!==t?[t]:[]}return Array.isArray(e)?e:[e]}setMinDimensions(e){const t=getComputedStyle(e,null);e.style.minHeight=t.getPropertyValue("height"),e.style.minWidth=t.getPropertyValue("width")}setupSlotRenderedListener(){this._gamEventBus.slotRenderEnded.on((e=>{const t=this._slots.get(e.slot.id);this.slotAdvertiserID.set(e.slot.id,e.event.advertiserId),t&&(t.slotFullyRenderedSince=(new Date).getTime())}))}_clearTargetingKeysOnRefresh(e){e.forEach((e=>{e.clearSlotTargetingFlag(this._refreshTargetingKeys)}))}_setRubiconBidFailedTargeting(e){const t=e.errorCode,i=Ae.includes(t),s=this.getSlot(e.adUnitCode);if(i){const e=this._googleAdManager.getTargetingValuesForFlag("bot");e.push(ke),this._googleAdManager.setTargetingFlag("bot",e.filter(Mt),!0)}s&&s.setSlotTargetingFlag(ke,[t],!0)}_getSizeSorter(e){let t;return t="bg"===e?this._largeSizeSorter:"sm"===e?this._smallSizeSorter:this._valueSizeSorter,t}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u){this._config=e,this._googleAdManager=t,this._slots=i,this._slotEventBus=s,this._marmaladeEventBus=r,this._adInViewExperiment=n,this._stickyContainerRecipeExperiment=a,this._gamEventBus=o,this._bootstrapConfig=l,this.eventBus=d,this._prebidEventBus=c,this._asrInViewRefreshExperiment=h,this.stickyOutstreamRefreshInterval=4e4,this.slotAdvertiserID=new Map,this._refreshTargetingKeys=["aop","apd","aopp","appd",ke,"pbop","pbpd","reqtype"],this._largeSizeSorter=(e,t)=>{const i=e[0]*e[1];return t[0]*t[1]-i},this._smallSizeSorter=(e,t)=>e[0]*e[1]-t[0]*t[1],this._valueSizeSorter=(e,t)=>(td.get(e.join("x"))||td.get("*")||td.size)-(td.get(t.join("x"))||td.get("*")||td.size),this._slotEventBus.displaySlot.on((e=>this.display(e))),this.setupSlotRenderedListener(),this.displayRefreshInterval=3e4-5e3*this._config.prebid.refreshAuctionCount,this._prebidEventBus.rubiconBidError.on(this._setRubiconBidFailedTargeting.bind(this)),(null==u?void 0:u.result)&&"off"!==u.result&&(this._slotSorter=this._getSizeSorter(u.result))}}id=B([hs("SlotManager"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Vl?Object:Vl,void 0===zr?Object:zr,void 0===Es?Object:Es,void 0===js?Object:js,void 0===Ql?Object:Ql,void 0===Xl?Object:Xl,void 0===jl?Object:jl,void 0===tn?Object:tn,void 0===Vs?Object:Vs,void 0===Ms?Object:Ms,void 0===Zl?Object:Zl,void 0===ed?Object:ed])],id);class sd{addVideoSlots(e){this._videoEventBus.videoPlayerAdded.emit(e)}async requestVideoBids(e,t){await this.requestingVideoBids.legacyEmit(e).catch(),await this._determineIsRefreshing(e).catch(),await this._videoEventBus.preRequestVideoBids.legacyEmit({videos:e,timeout:t}),await this._videoEventBus.requestingVideoBids.legacyEmit({videos:e,timeout:t})}get amazonVideoBidResponseReceived(){return this._videoEventBus.amazonVideoBidResponseReceived}async _determineIsRefreshing(e){const t=e.filter((e=>e.prerollNum>0));t.length&&await this.refreshingVideoBids.legacyEmit(t)}constructor(e){this._videoEventBus=e,this.refreshingVideoBids=new Q,this.requestingVideoBids=new Q}}sd=B([hs("VideoRequestManager"),M(),j("design:type",Function),j("design:paramtypes",[void 0===zs?Object:zs])],sd);class rd{async setContextualData(e){return this.fetchIrisResponse(e).then((e=>{if(e&&"boolean"!=typeof e){const t=e.video_info,i=t&&t.context;i&&i.length&&(this._contextualData=i,this._irisId=t.iris_id)}return!0})).catch((()=>!1))}get irisContextualData(){return this._contextualData}get irisId(){return this._irisId}fetchIrisResponse(e){return ti(`${this._irisEndpoint}?access_token=${this._token}&client_token=${this._clientToken}&platform_id=${e}`)}_resetIrisData(){this._contextualData=void 0,this._irisId=void 0}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}constructor(e,t){this._config=e,this._spaEventBus=t,this._name="iris",this.segmentName="www.iris.tv",this.segtax=501,this._irisEndpoint="https://context.iris.tv/video_info",this._token="5d8f38ad6d7de4253cfa501b84c30b1014868d9884be5d68dc64bd50a6edb54c",this._clientToken="EXJQESR8SMWMZCJ",this._spaEventBus.routeChanged.on((()=>{this._resetIrisData()}))}}rd=B([hs("IrisTvTrackerComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Ns?Object:Ns])],rd);class nd extends Cs{getAllMcmps(){return[...this._config.marmalade.mcmp.filter((e=>!e.startsWith("SR_"))),...this._config.marmalade.rfMcmpCodes.map((e=>e[0])),...this._config.marmalade.rfIabCodes.map((e=>e[0]))].filter(Mt)}constructor(e,t){super(),this._config=e,this._eventBus=t,this.setMcmpWithRFCodes=()=>new Promise((e=>{this._eventBus.recencyFrequencyDataSet.on((()=>{this.getAllMcmps(),e(!0)}),{handleEventsAlreadyEmitted:!0})}))}}nd=B([hs("RecencyAndFrequencyCodesComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===js?Object:js])],nd);class ad extends sr{init(){this._key="ttddealflr"}}ad=B([hs("TTDDealFloorExperiment"),M()],ad);const od=["IAB25","IAB26"],ld=new Map([["alc",["IAB8-5","IAB8-18"]],["ast",["IAB15-1"]],["dat",["IAB14-1"]],["gamc",["IAB9-5"]],["gamv",["IAB9-30"]],["pol",["IAB11-4"]],["rel",["IAB23"]],["ssr",["IAB7-39"]],["srh",["IAB7-30","IAB6-7","IAB7-45"]],["ske",["IAB7-19"]],["tob",["IAB7-41"]],["wtl",["IAB7-44"]]]);class dd extends sr{init(){this._key="PubmaticBCats"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],dd.prototype,"run",null),dd=B([hs("PubMaticBcatExperiment"),M()],dd);class cd extends Cs{get staticFirstPartyData(){return this._staticFirstPartyData}get staticIXFirstPartyData(){return this._staticIXFirstPartyData}init(){this._onAddedEvent(),this._onRequestingEvent(),this._onRefreshingEvent(),this._onVideoRequestingEvent(),this._onVideoRefreshingEvent(),this._setGlobalFirstPartyData(),this._spaEventBus.routeChanged.on((()=>{this._onAddedEvent()}))}_resetMCMPData(){this._staticFirstPartyData.mcmp=this._rfcodes.getAllMcmps()}_getTheTradeDeskPMPData(){let e=this._ttdDealFloorExperiment.result||"1";e="off"===e?"1":e;const t=+e.replace("_",".");return{deals:[{id:"opath-192-1-xpscexs57t",at:1,bidfloor:10*t,bidfloorcur:"USD",isVideo:!0},{id:"opath-192-1-47pf1rhzaq",at:1,bidfloor:2.5*t,bidfloorcur:"USD",isVideo:!1}],private_auction:0}}_getSiteExtData(e,t=!1){const i=this._updateMcmpWithScrollTargeting(e.mcmp);return t&&i&&(e.mcmp=i),{ext:{data:e}}}_onAddedEvent(){this._slotManagerEventBus.added.once((e=>{const t=this._getBlockedCategories(),i=this._getTheTradeDeskPMPData();this._setPrebidBidderSpecificFirstPartyData([ae.TTD],{pmp:i,site:this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes})});const s=this._context.bucket,r=Jt(e[0]).toString(),n=this._getIXFirstPartyData({refresh:"0",vp:"0"});this._setPrebidBidderSpecificFirstPartyData([ae.IndexExchange],{site:this._getSiteExtData(n,!0)});const a=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,refresh:["false"],vp:"0",bucket:s},!0);this._setPrebidBidderSpecificFirstPartyData([ae.Rubicon,ae.RubiconServer],{site:a});const o=this._getSiteExtData({refresh:"0",vp:"0",hvp:r,site_code:this._config.marmalade.filteredSiteCodes});this._setPrebidBidderSpecificFirstPartyData([ae.OpenX,ae.OpenXServer],{site:o}),this._setPrebidBidderSpecificFirstPartyData([ae.TTD],{bcat:t}),this._setPrebidBidderSpecificFirstPartyData([ae.Kargo,ae.KargoServer],{bcat:t}),this._setPrebidBidderSpecificFirstPartyData([ae.OpenX,ae.OpenXServer],{bcat:t}),"nobc"!==this._pubMaticBcatExperiment.result&&this._setPrebidBidderSpecificFirstPartyData([ae.Pubmatic,ae.PubmaticServer],{bcat:t})}))}_getBlockedCategories(){return[...[...ld.keys()].filter((e=>!this._config.site.filteredSensitiveCategories.includes(e))).reduce(((e,t)=>e.concat(ld.get(t)||[])),[]),...od]}_onRequestingEvent(){this._slotManagerEventBus.requestingBids.on((e=>{const t=this._context.bucket;e.forEach((i=>{if(this.setIXHVPParam(i,this._prebidMethods),i.lazy){const i="0",s=Jt(e[0]).toString(),r=this._getIXFirstPartyData({refresh:"0",vp:i});this._setPrebidBidderSpecificFirstPartyData([ae.IndexExchange],{site:this._getSiteExtData(r,!0)});const n=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,refresh:["false"],vp:i,bucket:t},!0);this._setPrebidBidderSpecificFirstPartyData([ae.Rubicon,ae.RubiconServer],{site:n});const a=this._getSiteExtData({refresh:"0",vp:i,hvp:s,site_code:this._config.marmalade.filteredSiteCodes});this._setPrebidBidderSpecificFirstPartyData([ae.OpenX,ae.OpenXServer],{site:a})}}))}))}_onRefreshingEvent(){this._slotManagerEventBus.refreshingBids.on((e=>{e.forEach((e=>{this.setIXHVPParam(e,this._prebidMethods)}));const t=e[0]&&e[0].refreshCount,i=Jt(e[0]).toString(),s=this._context.bucket,r=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,refresh:["true"],vp:"0",bucket:s},!0);this._setPrebidBidderSpecificFirstPartyData([ae.Rubicon,ae.RubiconServer],{site:r});const n=this._getIXFirstPartyData({refresh:`${t}`,vp:"0"});this._setPrebidBidderSpecificFirstPartyData([ae.IndexExchange],{site:this._getSiteExtData(n,!0)});const a=this._getSiteExtData({refresh:`${t}`,vp:"0",hvp:i,site_code:this._config.marmalade.filteredSiteCodes});this._setPrebidBidderSpecificFirstPartyData([ae.OpenX,ae.OpenXServer],{site:a})}))}_onVideoRequestingEvent(){this._videoRequestManager.requestingVideoBids.on((e=>{e.forEach((()=>{const e=this._irisTvTracker,t=this._irisTvTracker.enabled?e.irisContextualData:void 0;if(t&&t.length){const t={content:{id:e.irisId}};this._setPrebidBidderSpecificFirstPartyData([ae.Pubmatic,ae.PubmaticServer],{site:t})}}))}))}_onVideoRefreshingEvent(){this._videoRequestManager.refreshingVideoBids.on((e=>{const t=this._context.bucket;e.forEach((e=>{if(e.vp>0&&e.prerollNum<=10){const i=e.vp.toString(),s=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,refresh:["true"],vp:i,bucket:t},!0);this._setPrebidBidderSpecificFirstPartyData([ae.Rubicon,ae.RubiconServer],{site:s});const r=this._getIXFirstPartyData({refresh:`${e.prerollNum}`,vp:i});this._setPrebidBidderSpecificFirstPartyData([ae.IndexExchange],{site:this._getSiteExtData(r,!0)});const n=this._getSiteExtData({refresh:`${e.prerollNum}`,vp:i,site_code:this._config.marmalade.filteredSiteCodes});this._setPrebidBidderSpecificFirstPartyData([ae.OpenX,ae.OpenXServer],{site:n}),this._prebidMethods.addToQueue((()=>{this.setIXVPParam(e.vp)}))}}))}))}_getIXFirstPartyData(e){return this._setupIXFirstPartyData(e)}setIXHVPParam(e,t){Vl.pushToQueue((()=>{t.addToQueue((()=>{const i=t.getConfig(ae.IndexExchange);if(i&&i.firstPartyData){const s=i.firstPartyData.HVP||{},r=Jt(e),n=Zt(r||0);s[e.id]=n,e.refreshCount>0?Si({HVP:s,Refresh:"True"},t):Si({HVP:s},t,!0)}}))}))}setIXVPParam(e){const t=this._prebidMethods.getConfig(ae.IndexExchange);t&&t.firstPartyData&&e>0&&Si({vp:e.toString()},this._prebidMethods)}_setupIXFirstPartyData(e){return{...e,...this.staticIXFirstPartyData}}_setGlobalFirstPartyData(){this._config.marmalade.rfDataProcessed.emitted||this._rfcodes.setMcmpWithRFCodes().then((()=>{this._resetMCMPData(),this._setPrebidGlobalFirstPartyData()})).catch((()=>{})),this._setPrebidGlobalFirstPartyData()}_setPrebidGlobalFirstPartyData(){this._prebidMethods.addToQueue((()=>{const e=this._prebidMethods.getConfig("ortb2"),t={...e,ext:{...e.ext,rpbs:{experiments:this._config.prebid.pbsExperimentsResults}},site:{...e.site,ext:{data:this.staticFirstPartyData}}};this._prebidMethods.setConfig({ortb2:t})}))}_setPrebidBidderSpecificFirstPartyData(e,t){this._prebidMethods.setBidderConfig({bidders:e,config:{ortb2:t}})}_updateMcmpWithScrollTargeting(e){const t=this._config.trackScroll.getTargetingValue();return t?e?[...e,t]:[t]:e}constructor(e,t,i,s,r,n,a,o,l,d,c){super(),this._slotManager=e,this._config=t,this._context=i,this._prebidMethods=s,this._videoRequestManager=r,this._irisTvTracker=n,this._rfcodes=a,this._spaEventBus=o,this._ttdDealFloorExperiment=l,this._slotManagerEventBus=d,this._pubMaticBcatExperiment=c,this._staticFirstPartyData={mcmp:this._rfcodes.getAllMcmps(),site_id:[this._config.site.id],verticals:this._config.site.verticals,pmp_elig:[this._config.adOptions.pmp],sens:this._config.site.filteredSensitiveCategories},this._staticIXFirstPartyData={site_code:this._config.marmalade.filteredSiteCodes,sens:this._config.site.filteredSensitiveCategories,topic:this._config.site.verticals,pd:`${this._config.adOptions.pmp?"":"no"}${this._context.device}`,pmp_elig:this._config.adOptions.pmp?"TRUE":"FALSE",source:""};const h=ri(this._context.savedReferrer);this._staticIXFirstPartyData.source=Ei(h)}}function hd(e,t){return e===t||e!=e&&t!=t}function ud(e,t){for(var i=e.length;i--;)if(hd(e[i][0],t))return i;return-1}cd=B([hs("FirstPartyDataComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===id?Object:id,void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Ss?Object:Ss,void 0===sd?Object:sd,void 0===rd?Object:rd,void 0===nd?Object:nd,void 0===Ns?Object:Ns,void 0===ad?Object:ad,void 0===Vs?Object:Vs,void 0===dd?Object:dd])],cd);var pd=Array.prototype.splice;function gd(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}gd.prototype.clear=function(){this.__data__=[],this.size=0},gd.prototype.delete=function(e){var t=this.__data__,i=ud(t,e);return!(i<0)&&(i==t.length-1?t.pop():pd.call(t,i,1),--this.size,!0)},gd.prototype.get=function(e){var t=this.__data__,i=ud(t,e);return i<0?void 0:t[i][1]},gd.prototype.has=function(e){return ud(this.__data__,e)>-1},gd.prototype.set=function(e,t){var i=this.__data__,s=ud(i,e);return s<0?(++this.size,i.push([e,t])):i[s][1]=t,this};var md="[object AsyncFunction]",_d="[object Function]",fd="[object GeneratorFunction]",vd="[object Proxy]";function yd(e){if(!ln(e))return!1;var t=wn(e);return t==_d||t==fd||t==md||t==vd}var bd,Sd=hn["__core-js_shared__"],Ed=(bd=/[^.]+$/.exec(Sd&&Sd.keys&&Sd.keys.IE_PROTO||""))?"Symbol(src)_1."+bd:"";var Cd=Function.prototype.toString;var Td=/^\[object .+?Constructor\]$/,wd=Function.prototype,Ad=Object.prototype,kd=wd.toString,Id=Ad.hasOwnProperty,Pd=RegExp("^"+kd.call(Id).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Od(e){return!(!ln(e)||(t=e,Ed&&Ed in t))&&(yd(e)?Pd:Td).test(function(e){if(null!=e){try{return Cd.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function xd(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return Od(i)?i:void 0}var Rd=xd(hn,"Map"),Dd=xd(Object,"create");var Ld=Object.prototype.hasOwnProperty;var Md=Object.prototype.hasOwnProperty;function Bd(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}function Fd(e,t){var i,s,r=e.__data__;return("string"==(s=typeof(i=t))||"number"==s||"symbol"==s||"boolean"==s?"__proto__"!==i:null===i)?r["string"==typeof t?"string":"hash"]:r.map}function jd(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}Bd.prototype.clear=function(){this.__data__=Dd?Dd(null):{},this.size=0},Bd.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Bd.prototype.get=function(e){var t=this.__data__;if(Dd){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return Ld.call(t,e)?t[e]:void 0},Bd.prototype.has=function(e){var t=this.__data__;return Dd?void 0!==t[e]:Md.call(t,e)},Bd.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Dd&&void 0===t?"__lodash_hash_undefined__":t,this},jd.prototype.clear=function(){this.size=0,this.__data__={hash:new Bd,map:new(Rd||gd),string:new Bd}},jd.prototype.delete=function(e){var t=Fd(this,e).delete(e);return this.size-=t?1:0,t},jd.prototype.get=function(e){return Fd(this,e).get(e)},jd.prototype.has=function(e){return Fd(this,e).has(e)},jd.prototype.set=function(e,t){var i=Fd(this,e),s=i.size;return i.set(e,t),this.size+=i.size==s?0:1,this};function Nd(e){var t=this.__data__=new gd(e);this.size=t.size}Nd.prototype.clear=function(){this.__data__=new gd,this.size=0},Nd.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},Nd.prototype.get=function(e){return this.__data__.get(e)},Nd.prototype.has=function(e){return this.__data__.has(e)},Nd.prototype.set=function(e,t){var i=this.__data__;if(i instanceof gd){var s=i.__data__;if(!Rd||s.length<199)return s.push([e,t]),this.size=++i.size,this;i=this.__data__=new jd(s)}return i.set(e,t),this.size=i.size,this};var Ud=function(){try{var e=xd(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();function Vd(e,t,i){"__proto__"==t&&Ud?Ud(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function zd(e,t,i){(void 0!==i&&!hd(e[t],i)||void 0===i&&!(t in e))&&Vd(e,t,i)}var $d=function(e,t,i){for(var s=-1,r=Object(e),n=i(e),a=n.length;a--;){var o=n[++s];if(!1===t(r[o],o,r))break}return e},Hd="object"==typeof exports&&exports&&!exports.nodeType&&exports,qd=Hd&&"object"==typeof module&&module&&!module.nodeType&&module,Gd=qd&&qd.exports===Hd?hn.Buffer:void 0;Gd&&Gd.allocUnsafe;var Kd=hn.Uint8Array;function Wd(e,t){var i,s,r=(i=e.buffer,s=new i.constructor(i.byteLength),new Kd(s).set(new Kd(i)),s);return new e.constructor(r,e.byteOffset,e.length)}var Yd=Object.create,Qd=function(){function e(){}return function(t){if(!ln(t))return{};if(Yd)return Yd(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}();var Xd,Jd,Zd=(Xd=Object.getPrototypeOf,Jd=Object,function(e){return Xd(Jd(e))}),ec=Object.prototype;function tc(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ec)}function ic(e){return An(e)&&"[object Arguments]"==wn(e)}var sc=Object.prototype,rc=sc.hasOwnProperty,nc=sc.propertyIsEnumerable,ac=ic(function(){return arguments}())?ic:function(e){return An(e)&&rc.call(e,"callee")&&!nc.call(e,"callee")},oc=Array.isArray,lc=9007199254740991;function dc(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=lc}function cc(e){return null!=e&&dc(e.length)&&!yd(e)}var hc="object"==typeof exports&&exports&&!exports.nodeType&&exports,uc=hc&&"object"==typeof module&&module&&!module.nodeType&&module,pc=uc&&uc.exports===hc?hn.Buffer:void 0,gc=(pc?pc.isBuffer:void 0)||function(){return!1},mc="[object Object]",_c=Function.prototype,fc=Object.prototype,vc=_c.toString,yc=fc.hasOwnProperty,bc=vc.call(Object);var Sc={};Sc["[object Float32Array]"]=Sc["[object Float64Array]"]=Sc["[object Int8Array]"]=Sc["[object Int16Array]"]=Sc["[object Int32Array]"]=Sc["[object Uint8Array]"]=Sc["[object Uint8ClampedArray]"]=Sc["[object Uint16Array]"]=Sc["[object Uint32Array]"]=!0,Sc["[object Arguments]"]=Sc["[object Array]"]=Sc["[object ArrayBuffer]"]=Sc["[object Boolean]"]=Sc["[object DataView]"]=Sc["[object Date]"]=Sc["[object Error]"]=Sc["[object Function]"]=Sc["[object Map]"]=Sc["[object Number]"]=Sc["[object Object]"]=Sc["[object RegExp]"]=Sc["[object Set]"]=Sc["[object String]"]=Sc["[object WeakMap]"]=!1;var Ec="object"==typeof exports&&exports&&!exports.nodeType&&exports,Cc=Ec&&"object"==typeof module&&module&&!module.nodeType&&module,Tc=Cc&&Cc.exports===Ec&&dn.process,wc=function(){try{var e=Cc&&Cc.require&&Cc.require("util").types;return e||Tc&&Tc.binding&&Tc.binding("util")}catch(e){}}(),Ac=wc&&wc.isTypedArray,kc=Ac?function(e){return function(t){return e(t)}}(Ac):function(e){return An(e)&&dc(e.length)&&!!Sc[wn(e)]};function Ic(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Pc=Object.prototype.hasOwnProperty;function Oc(e,t,i){var s=e[t];Pc.call(e,t)&&hd(s,i)&&(void 0!==i||t in e)||Vd(e,t,i)}var xc=9007199254740991,Rc=/^(?:0|[1-9]\d*)$/;function Dc(e,t){var i=typeof e;return!!(t=null==t?xc:t)&&("number"==i||"symbol"!=i&&Rc.test(e))&&e>-1&&e%1==0&&e<t}function Lc(e,t){var i=oc(e),s=!i&&ac(e),r=!i&&!s&&gc(e),n=!i&&!s&&!r&&kc(e),a=i||s||r||n,o=a?function(e,t){for(var i=-1,s=Array(e);++i<e;)s[i]=t(i);return s}(e.length,String):[],l=o.length;for(var d in e)a&&("length"==d||r&&("offset"==d||"parent"==d)||n&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||Dc(d,l))||o.push(d);return o}var Mc=Object.prototype.hasOwnProperty;function Bc(e){if(!ln(e))return function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t}(e);var t=tc(e),i=[];for(var s in e)("constructor"!=s||!t&&Mc.call(e,s))&&i.push(s);return i}function Fc(e){return cc(e)?Lc(e):Bc(e)}function jc(e){return function(e,t,i){var s=!i;i||(i={});for(var r=-1,n=t.length;++r<n;){var a=t[r],o=void 0;void 0===o&&(o=e[a]),s?Vd(i,a,o):Oc(i,a,o)}return i}(e,Fc(e))}function Nc(e,t,i,s,r,n,a){var o=Ic(e,i),l=Ic(t,i),d=a.get(l);if(d)zd(e,i,d);else{var c,h=n?n(o,l,i+"",e,t,a):void 0,u=void 0===h;if(u){var p=oc(l),g=!p&&gc(l),m=!p&&!g&&kc(l);h=l,p||g||m?oc(o)?h=o:An(c=o)&&cc(c)?h=function(e,t){var i=-1,s=e.length;for(t||(t=Array(s));++i<s;)t[i]=e[i];return t}(o):g?(u=!1,h=l.slice()):m?(u=!1,h=Wd(l)):h=[]:function(e){if(!An(e)||wn(e)!=mc)return!1;var t=Zd(e);if(null===t)return!0;var i=yc.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&vc.call(i)==bc}(l)||ac(l)?(h=o,ac(o)?h=jc(o):ln(o)&&!yd(o)||(h=function(e){return"function"!=typeof e.constructor||tc(e)?{}:Qd(Zd(e))}(l))):u=!1}u&&(a.set(l,h),r(h,l,s,n,a),a.delete(l)),zd(e,i,h)}}function Uc(e,t,i,s,r){e!==t&&$d(t,(function(n,a){if(r||(r=new Nd),ln(n))Nc(e,t,a,i,Uc,s,r);else{var o=s?s(Ic(e,a),n,a+"",e,t,r):void 0;void 0===o&&(o=n),zd(e,a,o)}}),Fc)}function Vc(e){return e}var zc=Math.max;var $c=Ud?function(e,t){return Ud(e,"toString",{configurable:!0,enumerable:!1,value:(i=t,function(){return i}),writable:!0});var i}:Vc,Hc=Date.now;var qc=function(e){var t=0,i=0;return function(){var s=Hc(),r=16-(s-i);if(i=s,r>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}($c);function Gc(e,t){return qc(function(e,t,i){return t=zc(void 0===t?e.length-1:t,0),function(){for(var s=arguments,r=-1,n=zc(s.length-t,0),a=Array(n);++r<n;)a[r]=s[t+r];r=-1;for(var o=Array(t+1);++r<t;)o[r]=s[r];return o[t]=i(a),function(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}(e,this,o)}}(e,t,Vc),e+"")}var Kc,Wc=(Kc=function(e,t,i){Uc(e,t,i)},Gc((function(e,t){var i=-1,s=t.length,r=s>1?t[s-1]:void 0,n=s>2?t[2]:void 0;for(r=Kc.length>3&&"function"==typeof r?(s--,r):void 0,n&&function(e,t,i){if(!ln(i))return!1;var s=typeof t;return!!("number"==s?cc(i)&&Dc(t,i.length):"string"==s&&t in i)&&hd(i[t],e)}(t[0],t[1],n)&&(r=s<3?void 0:r,s=1),e=Object(e);++i<s;){var a=t[i];a&&Kc(e,a,i,r)}return e})));const Yc={Crafts:{id:"540522cb5c0eb47de4152801",iabCode:"IAB9-2",iabCat:"Arts & Crafts"},Family_and_Parenting:{id:"540522cb5c0eb47de4152802",iabCode:"IAB9-2",iabCat:"Family & Parenting"},Personal_Finance:{id:"540522cb5c0eb47de4152803",iabCode:"IAB13",iabCat:"Personal Finance"},Food:{id:"540522cb5c0eb47de4152804",iabCode:"IAB8",iabCat:"Food & Drink"},Home_Decor_and_Design:{id:"540522cb5c0eb47de4152807",iabCode:"IAB10",iabCat:"Home & Garden"},Sports:{id:"540522cb5c0eb47de4152809",iabCode:"IAB17",iabCat:"Sports"},Entertainment:{id:"55d374253d3884315c3d0bca",iabCode:"IAB1",iabCat:"Arts & Entertainment"},Gardening:{id:"5a4fab0ce6ec1959fd678d46",iabCode:"IAB10-4",iabCat:"Gardening"},Mens_Style_and_Grooming:{id:"5a4fab1de6ec1959fd678d47",iabCode:"IAB18",iabCat:"Style & Fashion"},Pets:{id:"5a4fab2ee6ec1959fd678d49",iabCode:"IAB16",iabCat:"Pets"},Tech:{id:"5a4fab38e6ec1959fd678d4a",iabCode:"IAB19",iabCat:"Technology & Computing"},Wedding:{id:"5a4fab42e6ec1959fd678d4b",iabCode:"IAB14-7",iabCat:"Weddings"},Professional_Finance:{id:"5aa2f3a7fdf4d60603ab3a65",iabCode:"IAB13",iabCat:"Personal Finance"},Deals:{id:"5c05a3d19e385c167333449c",iabCode:"IAB13",iabCat:"Personal Finance"},Vegetarian:{id:"5c113968b4fc765c1cbd3a54",iabCode:"IAB8-17",iabCat:"Vegetarian"},Auto:{id:"5c11399bb4fc765c1cbd3a91",iabCode:"IAB2",iabCat:"Automotive"},Fitness:{id:"5e5571361237cb073f4c414a",iabCode:"IAB7-1",iabCat:"Exercise"},Gaming:{id:"615cb84741a24b73b7c34703",iabCode:"IAB9-30",iabCat:"Video & Computer Games"},Beauty:{id:"540522cb5c0eb47de4152800",iabCode:"IAB18-1",iabCat:"Beauty"},Health_and_Wellness:{id:"540522cb5c0eb47de4152806",iabCode:"IAB7",iabCat:"Health & Fitness"},Clean_Eating:{id:"58ebb95fb628206640771353",iabCode:"IAB8-12",iabCat:"Health/Lowfat Cooking"},Natural_Parenting:{id:"58ebba85b628206640771355",iabCode:"IAB6",iabCat:"Family & Parenting"},Baby:{id:"58ebba8bb628206640771356",iabCode:"IAB6-2",iabCat:"Babies & Toddlers"},Pregnancy:{id:"58ebba92b628206640771357",iabCode:"IAB6-7",iabCat:"Pregnancy"},Toddler:{id:"58ebba9ab628206640771358",iabCode:"IAB6-2",iabCat:"Babies & Toddlers"},Womens_Style:{id:"58ebbaccb628206640771359",iabCode:"IAB18",iabCat:"Style & Fashion"},Travel:{id:"58ebbafbb62820664077135a",iabCode:"IAB20",iabCat:"Travel"},"History_&_Culture":{iabCode:"IAB14",iabCat:"Society"},"Arts_&_Creativity":{iabCode:"IAB1",iabCat:"Arts & Entertainment"},Education:{iabCode:"IAB5",iabCat:"Education"},Business:{iabCode:"IAB3",iabCat:"Business"},"Hobbies_&_Interests":{iabCode:"IAB9",iabCat:"Hobbies & Interests"},Science:{iabCode:"IAB15",iabCat:"Science"},"Religion_&_Spirituality":{iabCode:"IAB23",iabCat:"Religion & Spirituality"},Shopping:{iabCode:"IAB22",iabCat:"Shopping"},"Law,_Gov't_&_Politics":{iabCode:"IAB11",iabCat:"Law, Gov't & Politics"},Careers:{iabCode:"IAB4",iabCat:"Careers"},Real_Estate:{iabCode:"IAB21",iabCat:"Real Estate"}},Qc=e=>/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)?"IPv4":/^((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){1,7}:)|(([0-9A-Fa-f]{1,4}:){1,6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,5}(:[0-9A-Fa-f]{1,4}){1,2})|(([0-9A-Fa-f]{1,4}:){1,4}(:[0-9A-Fa-f]{1,4}){1,3})|(([0-9A-Fa-f]{1,4}:){1,3}(:[0-9A-Fa-f]{1,4}){1,4})|(([0-9A-Fa-f]{1,4}:){1,2}(:[0-9A-Fa-f]{1,4}){1,5})|([0-9A-Fa-f]{1,4}:((:[0-9A-Fa-f]{1,4}){1,6}))|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4}))$/.test(e)||"::"===e?"IPv6":"Invalid";class Xc extends nr{init(){this._key="RaptiveConnectedId",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Xc.prototype,"run",null),Xc=B([hs("RaptiveConnectedIdExperiment"),M()],Xc);const Jc=e=>"JwPlayer"===e.type;class Zc{_setORTB2Data(){this._prebidMethods.addToQueue((()=>{const e=this._prebidMethods.getConfig("ortb2")||{};this.createOrtbDataObj();const t=Wc(e,this._data);this._prebidMethods.setConfig({ortb2:t})})),this._spaEventBus.routeChanged.on((()=>{this._prebidMethods.addToQueue((()=>{this.createOrtbDataObj(),this._prebidMethods.setConfig({ortb2:{...this._data}})}))}))}createOrtbDataObj(){var e;this._userSegments=this._getUserSegments(),this._siteSegments=this._getSiteSegments();const t={...this._userSegments.length&&{data:this._userSegments}},i=document.documentElement.lang,s=this._raptiveConnectedIdExperiment.result&&(null==(e=this._config.user.rcid)?void 0:e.metadata.clientIp),r=s?Qc(s):null,n="IPv6"===r?"ipv6":"IPv4"===r?"ip":null,a=this._config.site.verticals,o=a.length?a[0].replace(/ /g,"_"):"",l={cur:this._getOrtb2Currency(),site:{content:{...this._siteSegments.length&&{data:this._siteSegments}}},user:t,...s&&n&&{device:{[n]:s}}},d={cur:this._getOrtb2Currency(),at:1,device:{language:navigator.language.slice(0,2),js:1,...s&&n&&{[n]:s}},site:{content:{...this._siteSegments.length&&{data:this._siteSegments},...i&&{language:i.slice(0,2)}},...a.length&&Yc[o]&&{cat:[Yc[o].iabCode],pagecat:[Yc[o].iabCode]},privacypolicy:1,mobile:1},user:t,source:{fd:0}};this._data=this._config.prebid.ortbEnrich?{...d}:{...l}}get data(){return this._data}_onConsentEvent(){const e=this._config.ccpa;e.consentChange.on((t=>{this._prebidMethods.addToQueue((()=>{if(t===e.ccpaOptOut){const e=this._prebidMethods.getConfig("ortb2")||{};e.user&&(delete e.user,this._prebidMethods.setConfig({ortb2:e}))}}))}))}_getSiteSegments(){return this.buildSegmentData(this._config.marmalade.ortbSegments.get("iabc")||[],6)}_getUserSegments(){if(this._config.ccpa.userOptedOut)return[];const e=this.buildSegmentData(this._config.marmalade.ortbSegments.get("iaba")||[],4),t=this._convertTopicData(this._context.browsingTopics);return e.concat(t)}_convertTopicData(e){const t=e.some((e=>"2"===e.taxonomy_version))?601:600;return this.buildSegmentData(e.reduce(((e,t)=>[...e,{id:String(t.id)}]),[]),t,"adthrive.com")}_setDelayedTopicsData(e){this._prebidMethods.addToQueue((()=>{const t=this._prebidMethods.getConfig("ortb2")||{};t.user=t.user||{},t.user.data=t.user.data||[],t.user.data=t.user.data.concat(e),this._prebidMethods.setConfig({ortb2:t})}))}buildSegmentData(e,t,i="cafemedia.com"){return e.length?[{name:i,segment:e,ext:{segtax:t}}]:[]}buildSegmentDataFromArray(e,t,i){return this.buildSegmentData(e.map((e=>({id:e}))),t,i)}setOrtb2Imp(e,t){if(t)for(const i of Object.keys(e))t[i]=e[i]}setOrtb2ImpExt(e,t){t&&(t.ext={...t.ext,...e})}setOrtb2ImpExtData(e,t){var i;t&&(t.ext=null!=(i=t.ext)?i:{},t.ext.data={...t.ext.data,...e})}_setVideoOrtb2ImpData(e,t){this.setOrtb2ImpExtData({adserver:{name:"gam",adslot:`/${this._config.gam.account}/${this._config.gam.prefix}_${t.name}/${this._config.site.id}`}},e),Jc(t)&&!this._config.ccpa.userOptedOut&&this._jwBoostExperiment.result&&this.setOrtb2ImpExtData({jwTargeting:t.getJwBoostTargeting()},e)}addOrtb2Imp(e,t=!1,i){const{slot:s,video:r}=e,n=i||{ext:{data:{}}};if(this._config.fledge.enabled&&(this.setOrtb2ImpExt({ae:1},n),s&&this.setOrtb2ImpExtData({banner:{sizes:s.sizes}},n),r&&this.setOrtb2ImpExtData({video:{sizes:r.size}},n)),r)this._setVideoOrtb2ImpData(n,r);else if(s){const e=Jt(s),t=Zt(e||0);this.setOrtb2ImpExtData({hvp:`${t}`},n)}return s&&t&&this.setOrtb2Imp({instl:1},n),s&&s.isHighlyViewable()&&this.setOrtb2ImpExtData({pos:"atf"},n),n}addOrtb2Reg(e,t){this._prebidMethods.addToQueue((()=>{const i=this._prebidMethods.getConfig("ortb2")||{};i.regs={gpp:e,gpp_sid:t},this._prebidMethods.setConfig({ortb2:i})}))}addEidsToOrtb2(e){this._prebidMethods.addToQueue((()=>{const t=this._data||this._prebidMethods.getConfig("ortb2")||{};t.user=t.user||{},t.user.ext=t.user.ext||{},t.user.ext.eids=t.user.ext.eids||[],t.user.ext.eids=t.user.ext.eids.concat(e),this._prebidMethods.setConfig({ortb2:t})}))}updateOrtb2WithIris(e){var t,i;if(!1===e.enabled)return;const s=this._prebidMethods.getConfig("ortb2")||{},{irisId:r,segmentName:n,irisContextualData:a}=e;var o;const l={ext:{segtax:e.segtax,...r&&{cids:[r]}},name:n,segment:null!=(o=null==a?void 0:a.map((e=>({id:e}))))?o:[]};(null==(i=s.site)||null==(t=i.content)?void 0:t.data)?s.site.content.data.push(l):s.site.content.data=[l],this._prebidMethods.setConfig({ortb2:s})}_getOrtb2Currency(){const e=this._config.prebid.currencyConversionEnabled,t=this._context.country,i=["USD"],s={GB:"GBP",CA:"CAD",AU:"AUD"};return e&&t&&s[t]&&i.unshift(s[t]),i}constructor(e,t,i,s,r,n,a,o){this._config=e,this._context=t,this._jwBoostExperiment=i,this._prebidMethods=s,this._spaEventBus=r,this._marmaladeEventBus=n,this._browsingTopicsApiEventBus=a,this._raptiveConnectedIdExperiment=o,this._data={},this.createOrtbDataObj(),this._onConsentEvent(),this._marmaladeEventBus.resetMarmaladeData.once((()=>{this._setORTB2Data()})),this._config.marmalade.rfDataProcessed.on((()=>{this._setORTB2Data()})),this._config.gdpr.enabled||this._config.ccpa.userOptedOut||!this._context.browsingTopicsSupported||0!==this._context.browsingTopics.length||this._browsingTopicsApiEventBus.topicsReceived.on((e=>{this._setDelayedTopicsData(this._convertTopicData(e))}))}}Zc=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Ja?Object:Ja,void 0===Ss?Object:Ss,void 0===Ns?Object:Ns,void 0===js?Object:js,void 0===xs?Object:xs,void 0===Xc?Object:Xc])],Zc);class eh extends Cs{init(){Gi()||this.addPrivacyPreferencesFooter()}addPrivacyPreferencesFooter(){const e=document.createElement("div");e.className="adthrive-privacy-preferences";const t=document.createElement("a");t.href="javascript:adthrive.cmd.push(adthrive.showPrivacyPreferences);",t.innerText="Update Privacy Preferences",e.appendChild(t),this._config.footer.elements.push({order:1,element:e})}constructor(e){super(),this._config=e}}eh=B([hs("GDPRComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],eh);class th{constructor(){this.consentCaptured=new Q}}th=B([M()],th);class ih extends Cs{init(){this.checkConsentOnLoad().then((e=>{const t=e&&e.tcString;t?(this._config.gdpr.consentCaptured=!0,this._config.gdpr.revokedPurposeConsent=this._checkForRevokedPurpose(e.purpose),this._events.consentCaptured.emit(t),this._clearGdprQueues()):this.listenForConsentSubmit().catch((e=>{te.error("GDPREnforcementComponent","init","listenForConsentSubmit",e)}))})).catch((e=>{te.error("GDPREnforcementComponent","init","checkConsentOnLoad",e)}))}checkConsentOnLoad(){return new Promise((e=>{window.__tcfapi("addEventListener",2,((t,i)=>i&&t&&"tcloaded"===t.eventStatus&&t.tcString&&!Gi()?e(t):e({})))}))}checkConsentForVendor(e,t){const i=window.__cmp("getCMPData"),s=!0===i.vendorConsents[e],r=!!(null==t?void 0:t.every((e=>!0===i.purposeConsents[e])));return Promise.resolve(s&&r)}_clearGdprQueues(){this._queues.forEach((e=>{this.checkConsentForVendor(this._config.gdpr.cafeMediaVendorId,e.gdprPurposes).then((t=>{t?e.clearQueue(!0):(e.disable=!0,e.clearQueue(!1))})).catch((e=>{te.error("listenForConsentSubmit","clearGdprQueues",e)}))}))}listenForConsentSubmit(){return new Promise((e=>{window.__tcfapi("addEventListener",2,((t,i)=>{i&&(t&&"useractioncomplete"===t.eventStatus&&(this._config.gdpr.consentCaptured=!0,this._config.gdpr.cmpUserActionCompleteFired=!0,this._config.gdpr.revokedPurposeConsent=this._checkForRevokedPurpose(t.purpose),this._events.consentCaptured.emit(t.tcString),this._clearGdprQueues(),window.__tcfapi("removeEventListener",2,(e=>{}),t.listenerId)),e(!0)),e(!1)}))}))}_checkForRevokedPurpose(e){const t=e&&e.consents||{};return!t[1]||!t[4]}get enabled(){return"function"==typeof window.__tcfapi}constructor(e,t){super(),this._events=e,this._config=t,this._queues=[kr,K,te]}}ih=B([hs("GDPREnforcementComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===th?Object:th,void 0===Ol?Object:Ol])],ih);const sh="AmazonAuctionManager";class rh extends $l{init(){this._checkLibLoaded("init").then((()=>{this._setupFpdForCCPA(),this._setupFpdForGDPR(),this._config.ccpa.required||this._config.gdpr.enabled||this._toggleFPDToAmzConfig(!0),this._listenForSlotRefreshEvents(),this._listenForOutsideGAMRender(),this._amazonMethods.init(this._amazonConfig)})).catch((e=>{te.error(sh,"init","Failed to initialize apstag",e)})),this.videoSlotNames=this._initVideoSlotMap()}_listenForSlotRefreshEvents(){this._slotEventBus.beforeGoogleAdManagerRefreshSlots.on((e=>{this._setDecryptedBidsBasedOnSlotTargetingForSlots(e),this._removeAmazonEncryptedSlotTargetingForSlots(e)}))}_listenForOutsideGAMRender(){this._slotEventBus.adRenderingOutsideGAM.on((({slot:e})=>{this._config.amazon._availableBids.delete(e.id)}))}_setupFpdForGDPR(){this._config.gdpr.enabled&&this._gdprEvents.consentCaptured.on((()=>{this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.cafeMediaVendorId,[1]).then((e=>{this._toggleFPDToAmzConfig(!!e),this._amazonMethods.init(this._amazonConfig)})).catch((()=>{}))}))}_setupFpdForCCPA(){this._config.ccpa.required&&(this._config.ccpa.userOptedOut||this._toggleFPDToAmzConfig(!0),this._config.ccpa.consentChange.on((e=>{this._amazonConfig.params&&e&&(this._amazonConfig.params.us_privacy=e),this._toggleFPDToAmzConfig(e!==this._config.ccpa.ccpaOptOut),this._amazonMethods.init(this._amazonConfig)})))}_toggleFPDToAmzConfig(e=!0){if(e){const e={site:{...this._ortb2.data.site,cattax:1},user:{...this._ortb2.data.user}},t={ext:{data:{mcmp:[...this._config.marmalade.mcmp,...this._config.marmalade.rfMcmpCodes.map((e=>e[0]))],...this._firstPartyDataComponent.staticFirstPartyData}}};e.site={...e.site,...t},this._amazonConfig={...this._amazonConfig,signals:{ortb2:{...e}}}}else delete this._amazonConfig.signals}async requestBids(e,t=this._config.timeouts.initialBidsRequest-200,i=!1){try{if(!await this._checkLibLoaded("requestBids"))return;const s=e.map((e=>e.name)),r=Ul.markStartTask("microtask",["AmazonAuctionManager","requestBids"]);r.addMetadata({slotNames:s});const n=this.filterExcludedSlots(e,this._config.amazon.adUnitExclusions);if(!n.length)return void r.markEndTask();this._mapGptSlotsFromManagedSlots(n);const a=this._requestBidsFromAmazon(n,t,i);return r.markEndTask(),await a}catch(e){return void te.error(sh,"requestBids",e)}}filterExcludedSlots(e,t){return e.filter((e=>void 0!==e.googleTagSlot&&!t.has(e.location)&&e.location!==ge.Native_Recipe))}getAmazonSlots(e){const{id:t}=this._config.site,{networkCode:i,prefix:s}=this._config.gam;return e.map((e=>{const r=e.element.id,n=this._getAmazonFloors(r,e.hvp);return{slotID:r,slotName:`/${i}/${s}_${e.name}/${t}`,sizes:e.sizes,...e.location===ge.Video_StickyOutstream&&{mediaType:"video"},...n&&n.value>0&&n.currency&&{floor:{value:Math.ceil(100*n.value),currency:n.currency}}}}))}_getAmazonFloors(e,t){return this._floors.getAmazonFloors(e,t)}_mapGptSlotsFromManagedSlots(e,t=this._gptSlot){e.forEach((e=>t.set(e.element.id,e.googleTagSlot)))}get amazonHoldDisplayExperimentResult(){return this._amazonHoldDisplayExperiment.result}_requestBidsFromAmazon(e,t,i){return new Promise((s=>{const r=setTimeout((()=>{this._amazonMethods.setDisplayBids(),e.forEach((e=>{this._resetAmazonSlotCpm(e)})),s()}),t+this._config.amazon.failsafeTimeout),n=()=>{s(),clearTimeout(r)},a={slots:this.getAmazonSlots(e),timeout:t,params:{adRefresh:i?"1":"0"}};this._amazonMethods.fetchBids(a,(()=>{Vl.pushToQueue((()=>{try{this._amazonMethods.setDisplayBids()}catch(e){te.error(sh,"_requestBidsFromAmazon",e)}e.forEach((e=>{this._resetAmazonSlotCpm(e)})),n()}))})),this.amazonHoldDisplayExperimentResult||n()}))}_resetAmazonSlotCpm(e){const t="id"in e?e.id:e.name;this.amazonSlotCpm.get(t)&&this.amazonSlotCpm.set(t,0)}_setDecryptedBidsBasedOnSlotTargetingForSlots(e){e.forEach((e=>this._setDecryptedBidsBasedOnSlotTargeting(e)))}_removeAmazonEncryptedSlotTargetingForSlots(e){e.forEach((e=>this._removeAmazonEncryptedSlotTargeting(e)))}_removeAmazonEncryptedSlotTargeting(e){const t=e.googleTagSlot.getTargetingKeys();this._amazonEncryptedTargetingKeysToRemove.forEach((i=>{t.includes(i)&&e.googleTagSlot.clearTargeting(i)}))}_setDecryptedBidsBasedOnSlotTargeting(e,t=this._gptSlot){this._decryptAmazonDisplayBidAndSetTargeting(this._getReconstructedAmazonBidBasedOnSlotTargeting(e),t,e)}_getReconstructedAmazonBidBasedOnSlotTargeting(e){const t={};var i;return this._config.amazon.getEncryptedTargetingKeys().forEach((i=>{var s;const r=null==(s=e.googleTagSlot)?void 0:s.getTargeting(i);(null==r?void 0:r.length)&&(t[i]=r[0])})),{slotID:e.element.id,size:null!=(i=t.amznsz)?i:"",targeting:t}}_decryptAmazonDisplayBidAndSetTargeting(e,t=this._gptSlot,i){const s=t.get(e.slotID),r=this._decryptAmazonBid(e),{bidder:n,cpm:a,mediaType:o,pmpCpm:l,pmpBidder:d,pmpMediaType:c}=r,h=!!n&&this._partnerEnabled(n),u=!!d&&this._partnerEnabled(d),p={standard:{originalCpm:0,discount:0},pmp:{originalCpm:0,discount:0}};if(s){if(a&&n&&h){const t=et(this._config,r,n,a,o),i=Ze(t),l=a-t;p.standard.originalCpm=a,p.standard.discount=l,this._setDisplayTargeting(e,n,i,s,o,this._decrypted_cpm_key,this._decrypted_bidder_key)}else this._clearAmazonKeys([i],this._config.amazon.getEncryptedTargetingKeys({nonDealKeys:!0}));if(l&&d&&u){const t=et(this._config,r,d,l,c),i=Ze(t),n=l-t;p.pmp.originalCpm=l,p.pmp.discount=n,this._setDisplayTargeting(e,d,i,s,c,this._decrypted_deal_cpm_key,this._decrypted_deal_bidder_key)}else this._clearAmazonKeys([i],this._config.amazon.getEncryptedTargetingKeys({dealKeys:!0}));(h||u)&&(this._config.amazon._availableBids.set(e.slotID,r),this._setAmazonSlotCpm(i,p.standard.originalCpm,p.pmp.originalCpm),this._setAmazonDiscountTargeting(p,i))}}_partnerEnabled(e){return this._config.partners.getBidderConfig(e,!1).enabled}_setAmazonSlotCpm(e,t,i){const s=t>i?t:i;"id"in e?(this._config.floors.amazonSlotCpm.set(e.id,s),this._slotEventBus.amazonBidResponseReceived.emit([{slot:e,cpm:t},{slot:e,cpm:i}])):(this._config.floors.amazonSlotCpm.set(e.name,s),this._videoEventBus.amazonVideoBidResponseReceived.emit([{video:e,cpm:t},{video:e,cpm:i}]))}_setAmazonDiscountTargeting(e,t){const{standard:i,pmp:s}=e,r=(e,i)=>{t.setSlotTargetingFlag(e,[i.toFixed(6).toString()])};i.originalCpm&&r("aop",i.originalCpm),i.discount&&r("apd",i.discount),s.originalCpm&&r("aopp",s.originalCpm),s.discount&&r("appd",s.discount)}_setDisplayTargeting(e,t,i,s,r,n,a){s.setTargeting(n,i),s.setTargeting(a,t)}refreshBids(e){return this._clearAmazonKeys(e),this.requestBids(e,this._config.timeouts.refreshBidsRequest-200,!0)}_clearAmazonKeys(e,t){const i=t||this._config.amazon.amznTargetingKeys;e.forEach((e=>{if(e.googleTagSlot){const t=e.googleTagSlot.getTargetingKeys();i.forEach((i=>t.includes(i)&&e.googleTagSlot.clearTargeting(i)))}}))}requestVideoBids(e,t=this._config.timeouts.initialBidsRequest-200){const i=this._amazonMethods;return e.forEach((e=>{this._resetAmazonSlotCpm(e)})),Promise.all(e.map((e=>{const s=this._floors.getAmazonFloors(e.name)||{value:0,currency:"USD"},r=s&&s.value||0,n=Math.ceil(100*(Number(r)+this._config.video.minFloor)),a={slotID:this.videoSlotNames.get(e.name),mediaType:"video",floor:{value:n,currency:s.currency||"USD"}};return new Promise((s=>{const r=setTimeout((()=>{s()}),t+this._config.amazon.failsafeTimeout),n=e=>{e?s(e):s(),clearTimeout(r)};this._checkLibLoaded("requestVideoBids").then((s=>{if(!s)return n();a?i.fetchBids({slots:[a],timeout:t},(t=>{t.length&&t.forEach((t=>{const{cpm:i,amznBid:s,discounts:r}=this._setDecryptedAmazonVideoKVs(t);i-r.standard.discount>0&&(this._setAmazonSlotCpm(e,r.standard.originalCpm,r.pmp.originalCpm),this._videoEventBus.addAPStagSlotBidResponse.legacyEmit({playlistId:e._playlistId,bid:s,discounts:r}),n(i))})),n()})):n()})).catch((e=>{te.error(sh,"requestVideoBids",e)}))}))}))).then((()=>Promise.resolve())).catch()}get videoEnabled(){return this._config.partners.video.get("AmazonUAM")}get enabled(){return this._amazonMethods.isAmazonLoaded()&&this._config.amazon.enabled}get amazonSlotCpm(){return this._config.floors.amazonSlotCpm}_decryptAmazonBid(e){const t={...e,...e.targeting};var i;const s=null!=(i=t[ne.amznbid])?i:"",r=Kl(s);var n;const a=null!=(n=t[ne.amznp])?n:"";var o;const l=null!=(o=ql.get(a))?o:"";var d;const c=null!=(d=t.amznbid_sp)?d:"",h=this._getMediaTypeFromEncryptedBidCpm(c),u=Kl(c);var p;const g=null!=(p=t[`${ne.amznp}_sp`])?p:"";var m;const _=null!=(m=ql.get(g))?m:"";var f;const v=null!=(f=t[`${ne.amzniid}_sp`])?f:"",y=t[`${ne.amznsz}_sp`];var b;const S=null!=(b=t.amznbid_sp)?b:"";var E;const C=null!=(E=t.amzndeal_sp)?E:"",T="slotID"in t?t.slotID:"",w=this._getMediaTypeFromEncryptedBidCpm(s),A=t[ne.amznsz];return{...t,amznbid:s,amzniid:t.amzniid,bidder:l,cpm:r,mediaType:w,slotID:T,...c.length&&{pmpAmznBid:S,pmpAmazoniid:v,pmpBidder:_,pmpCpm:u,pmpDeal:C,pmpMediaType:h,mediaType_sp:h,pmpSize:y},size:A}}_getMediaTypeFromEncryptedBidCpm(e){return e.includes("o_")?"stickyOutstream":e.includes("v_")?"instream":"default"}async _checkLibLoaded(e){try{return await this._bootstrapConfig.bootstrapLoaders[oe.Amazon],!0}catch(t){return te.error(sh,"checkLibLoaded",e,t),!1}}_initVideoSlotMap(){return Bt()?new Map([[_e.Video_Collapse_Autoplay_SoundOff,"Sticky_Playlist_Desktop"],[_e.Video_Individual_Autoplay_SOff,"Sticky_Related_Desktop"],[_e.Video_In_Post_ClicktoPlay_SoundOn,"CTP_Desktop"]]):new Map([[_e.Video_Coll_SOff_Smartphone,"Sticky_Playlist_Mobile"],[_e.Video_Individual_Autoplay_SOff,"Sticky_Related_Mobile"],[_e.Video_In_Post_ClicktoPlay_SoundOn,"CTP_Mobile"]])}_setDecryptedAmazonVideoKVs(e){const t={standard:{originalCpm:0,discount:0},pmp:{originalCpm:0,discount:0}},i=this._decryptAmazonBid(e),{bidder:s,cpm:r,mediaType:n,pmpCpm:a,pmpBidder:o,pmpMediaType:l}=i;if(s&&r){const e=et(this._config,i,s,r,n),a=Ze(e),o=r-e;t.standard.originalCpm=r,t.standard.discount=o,i[this._decrypted_cpm_key]=`${a}`,i[this._decrypted_bidder_key]=s}if(a&&o){const e=et(this._config,i,o,a,l),s=Ze(e),r=a-e;t.pmp.originalCpm=a,t.pmp.discount=r,i.targeting?(i.targeting[this._decrypted_deal_cpm_key]=`${s}`,i.targeting[this._decrypted_deal_bidder_key]=`${o}`):(i[this._decrypted_deal_cpm_key]=`${s}`,i[this._decrypted_deal_bidder_key]=`${o}`)}return{amznBid:i,cpm:r,discounts:t}}constructor(e,t,i,s,r,n,a,o,l,d,c){super(),this._config=e,this._amazonMethods=t,this._amazonHoldDisplayExperiment=i,this._floors=s,this._videoEventBus=r,this._bootstrapConfig=n,this._firstPartyDataComponent=a,this._ortb2=o,this._gdprEnforcement=l,this._gdprEvents=d,this._slotEventBus=c,this.videoSlotNames=new Map,this._gptSlot=new Map,this._encrypted_cpm_key="amznbid",this._encrypted_bidder_key="amznp",this._encrypted_deal_cpm_key="amznbid_sp",this._encrypted_deal_bidder_key="amznp_sp",this._decrypted_cpm_key="amz_pb",this._decrypted_bidder_key="amz_bidder",this._decrypted_deal_cpm_key="amz_pb_sp",this._decrypted_deal_bidder_key="amz_bidder_sp",this._amazon_size_key="amznsz",this._amazonEncryptedTargetingKeysToRemove=["amznp","amznp_sp"],this._amazonConfig={pubID:this._config.amazon.pubId,deals:this._config.adOptions.pmp,adServer:"googletag",videoAdServer:"DFP",...this._config.ccpa.required&&this._config.ccpa.privacyString&&{params:{us_privacy:this._config.ccpa.privacyString}},schain:(new Hl).getSupplyChainConfig(this._config.site.id)}}}rh=B([hs(sh),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Yl?Object:Yl,void 0===Wl?Object:Wl,void 0===zl?Object:zl,void 0===zs?Object:zs,void 0===tn?Object:tn,void 0===cd?Object:cd,void 0===Zc?Object:Zc,void 0===ih?Object:ih,void 0===th?Object:th,void 0===Es?Object:Es])],rh);class nh{get _config(){return this.config}get enabled(){return!0}}class ah extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"connectId")&&this._liveRampAts.enabled}constructor(e,t,i,s,r,n){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._liveRampAts=s,this._user=r,this._shareHemWithUserIdModule=n,this._name="connectId",this.targetingKey="cid",this.eidSource="yahoo.com",this.config={name:this._name,params:{pixelId:58404,...ha()&&{puid:ha()},...this._shareHemWithUserIdModule.share({blockGraphHem:!0})&&{he:this._user.hash}},storage:{name:"connectid",type:"html5",expires:15}}}}ah=B([hs("ConnectIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo,void 0===Xo?Object:Xo,void 0===da?Object:da,void 0===ca?Object:ca])],ah);class oh extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"unifiedId")}constructor(e,t,i){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._name="unifiedId",this.targetingKey="uid1",this.eidSource="adserver.org",this.config={name:this._name,params:{url:"https://match.adsrvr.org/track/rid?ttd_pid=iowij76&fmt=json"},storage:{type:"html5",name:"pbjs-unifiedid",expires:60}}}}oh=B([hs("UnifiedIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo])],oh);class lh extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"id5Id")}getPdString(e){var t;const i=null==(t=this._user.rcid)?void 0:t.metadata.clientIp,s=Qc(i||""),r=[{key:1,value:this._shareHemWithUserIdModule.share({blockGraphHem:!0})?null:null!=e?e:this._user.hash},{key:5,value:ha()},{key:12,value:st}];this._raptiveConnectedIdExperiment.result&&r.push({key:10,value:"IPv4"===s?i:null},{key:11,value:"IPv6"===s?i:null});const n=r.filter((e=>e.value)).map((e=>`${e.key}=${encodeURIComponent(e.value)}`)).join("&");return btoa(n)}constructor(e,t,i,s,r,n){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._user=s,this._shareHemWithUserIdModule=r,this._raptiveConnectedIdExperiment=n,this._name="id5Id",this.targetingKey="id5-d",this.eidSource="id5-sync.com",this.config={name:this._name,params:{partner:367,...this._shareHemWithUserIdModule.share({blockGraphHem:!0})&&{pd:this.getPdString()}},storage:{type:"html5",name:"pbjs-id5id",expires:60,refreshInSeconds:28800}}}}lh=B([hs("Id5IdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo,void 0===da?Object:da,void 0===ca?Object:ca,void 0===Xc?Object:Xc])],lh);class dh extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"merkuryId")&&!this._gdpr.enabled}constructor(e,t,i,s){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._gdpr=s,this._name="merkleId",this.targetingKey="mrk",this.eidSource="merkleinc.com",this.config={name:this._name,params:{sv_pubid:"9262",ssp_ids:["534404531"]},storage:{type:"html5",name:"pbjs-merkleId",expires:30}}}}dh=B([hs("MerkuryIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo,void 0===zo?Object:zo])],dh);class ch extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"identityLink")}constructor(e,t,i){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._name="identityLink",this.targetingKey="idl",this.eidSource="liveramp.com",this.config={name:this._name,params:{pid:"111"},storage:{type:"html5",name:"pbjs-identitylink",expires:60}}}}ch=B([hs("IdentityLinkIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo])],ch);class hh extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"lotamePanoramaId")}constructor(e,t,i){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._name="lotamePanoramaId",this.targetingKey="lpid",this.storageKey="panoramaId",this.eidSource="crwdcntrl.net",this.config={name:this._name,params:{clientId:"17297"}}}}hh=B([hs("LotamePanoramaIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo])],hh);class uh extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"FTrack")&&!this._gdpr.enabled}constructor(e,t,i,s){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._gdpr=s,this._name="FTrack",this.targetingKey="ftr",this.eidSource="flashtalking.com",this.config={name:this._name,params:{url:"https://d9.flashtalking.com/d9core",ids:{"device id":!0,"single device id":!0,"household id":!0}},storage:{type:"html5",name:"FTrackId",expires:60,refreshInSeconds:28800}}}}uh=B([hs("FTrackIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo,void 0===zo?Object:zo])],uh);class ph extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"lmpId")&&this._optableConfig.loblawEnabled}constructor(e,t,i,s){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._optableConfig=s,this._name="lmpId",this.targetingKey="lmpId",this.storageKey=mi.KEY,this.eidSource="loblawmedia.ca",this.config={name:this._name,params:{clientId:"17297"}}}}ph=B([hs("LoblawIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo,void 0===Zn?Object:Zn])],ph);class gh extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"33acrossId")&&!this._gdpr.enabled}constructor(e,t,i,s){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._gdpr=s,this._name="33acrossId",this.targetingKey="33a",this.eidSource="33across.com",this.config={name:this._name,params:{pid:"0013300001i0fyfAAA"},storage:{name:"33acrossId",type:"html5",expires:90,refreshInSeconds:28800}}}}gh=B([hs("ThirtyThreeAcrossIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo,void 0===zo?Object:zo])],gh);class mh extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"fabrickId")&&!this._gdpr.enabled}constructor(e,t,i,s,r,n){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._user=s,this._gdpr=r,this._shareHemWithUserIdModule=n,this._name="fabrickId",this.targetingKey="fab",this.eidSource="neustar.biz",this.config={name:this._name,params:{apiKey:"2215608639",...this._shareHemWithUserIdModule.share({blockGraphHem:!0})&&{e:this._user.hash}},storage:{type:"html5",name:"pbjs_fabrickId",expires:60}}}}mh=B([hs("FabrickIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo,void 0===da?Object:da,void 0===zo?Object:zo,void 0===ca?Object:ca])],mh);class _h extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"criteo")}constructor(e,t,i){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._name="criteo",this.targetingKey="cri",this.eidSource="criteo.com",this.config={name:this._name,storage:{type:"html5",name:"pbjs-criteo",expires:60}}}}_h=B([hs("CriteoIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo])],_h);class fh extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"pairId")&&this._liveRampAts.enabled}constructor(e,t,i,s){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._liveRampAts=s,this._name="pairId",this.targetingKey="pair",this.eidSource="google.com",this.config={name:this._name,params:{liveramp:{}},storage:{type:"html5",name:"pbjs-pairId",expires:30,refreshInSeconds:1800}}}}fh=B([hs("PairIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo,void 0===Xo?Object:Xo])],fh);class vh extends nr{init(){this._key="TripleLiftLiveIntent",this._default=!1}}vh=B([hs("TripleLiftLiveIntentExperiment"),M()],vh);class yh extends sr{init(){this._key="LiveIntentTimeOutExperiment"}}yh=B([hs("LiveIntentTimeOutExperiment"),M()],yh);class bh extends sr{init(){this._key="LiveIntentFpiExpiration"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],bh.prototype,"run",null),bh=B([hs("LiveIntentTimeOutExperiment"),M()],bh);class Sh extends nr{init(){this._key="OpenXLiveIntent",this._default=!1}}Sh=B([hs("OpenXLiveIntentExperiment"),M()],Sh);class Eh extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"liveIntentId")}constructor(e,t,i,s,r,n,a,o,l){var d;super(),this._ccpa=e,this._gpc=t,this._idho=i,this._user=s,this._shareHemWithUserIdModule=r,this._openXLiveIntentExperiment=n,this._tripleLiftLiveIntentExperiment=a,this._liveIntentTimeoutExperiment=o,this._liveIntentFpiExpirationExperiment=l,this._name="liveIntentId",this.targetingKey="liid",this.config={name:this._name,params:{distributorId:"did-001w",requestedAttributesOverrides:{uid2:!0,medianet:!0,bidswitch:!0,magnite:!0,index:!0,pubmatic:!0,sovrn:!0,openx:this._openXLiveIntentExperiment.result,triplelift:this._tripleLiftLiveIntentExperiment.result,thetradedesk:!0},..."d"!==this._liveIntentFpiExpirationExperiment.result&&this._liveIntentFpiExpirationExperiment.result&&{liCollectConfig:{fpiExpirationDays:parseInt(this._liveIntentFpiExpirationExperiment.result)}},...this._shareHemWithUserIdModule.share({blockGraphHem:!0})&&{emailHash:this._user.hash},ajaxTimeout:null!=(d=this._liveIntentTimeoutExperiment.result)?d:5e3},storage:{name:"__tamLIResolveResult",type:"html5",expires:1,refreshInSeconds:28800}}}}Eh=B([hs("LiveIntentIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo,void 0===da?Object:da,void 0===ca?Object:ca,void 0===Sh?Object:Sh,void 0===vh?Object:vh,void 0===yh?Object:yh,void 0===bh?Object:bh])],Eh);class Ch extends nr{init(){this._key="IdGraphUid2",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ch.prototype,"run",null),Ch=B([hs("IdGraphUid2Experiment"),M()],Ch);class Th extends nr{init(){this._key="DeclareBridgedUid2",this._default=!1}}Th=B([hs("DeclareBridgedUid2Experiment"),M()],Th);class wh extends nr{init(){this._key="DeclareBridgedGPID",this._default=!1}}wh=B([hs("DeclareBridgedGPIDExperiment"),M()],wh);class Ah{shouldDeclareBridgedId(e){const t=fi({source:e,identifierType:"truedata"})&&this._declareBridgedUid2Experiment.result,i=(e=>{const{source:t,identifierType:i}=e;return"gpid"===i?t.includes(`${pi.PREFIXES.RAPTIVE_AUTH}${pi.VALUES.GPID}`):t.includes(pi.PREFIXES.RAPTIVE_AUTH)})({source:e,identifierType:"gpid"})&&this._declareBridgedGpidExperiment.result;return t||i}constructor(e,t){this._declareBridgedUid2Experiment=e,this._declareBridgedGpidExperiment=t}}Ah=B([M(),hs("UserIdBridgeManager"),j("design:type",Function),j("design:paramtypes",[void 0===Th?Object:Th,void 0===wh?Object:wh])],Ah);class kh extends nh{get enabled(){var e;const t=!fi({source:null!=(e=this._user.source)?e:""}),i=this._idGraphUid2Experiment.result;return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"unifiedId2")&&!this._gdpr.enabled&&(t||i)}getToken(){return this._uid2AdvertisingToken?this._uid2AdvertisingToken.latestToken?this._uid2AdvertisingToken.latestToken:this._uid2AdvertisingToken.originalToken:this._uid2ServerToken}get _config(){return this.config}_declareBridgedToken(e){if(!(null==e?void 0:e.advertising_token))return;this._ortb2.addEidsToOrtb2({source:"uidapi.com",matcher:"cafemedia.com",inserter:"cafemedia.com",mm:5,uids:[{id:e.advertising_token,atype:3}]}),this._googleAdManager.setTargetingFlag("idmm",["5"])}constructor(e,t,i,s,r,n,a,o,l){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._gdpr=s,this._user=r,this._ortb2=n,this._idGraphUid2Experiment=a,this._userIdBridgeManager=o,this._googleAdManager=l,this._name="uid2",this.targetingKey="uid2",this.eidSource="uidapi.com",this.storageKey="__uid2_advertising_token",this._uid2ServerToken=kr.readExternalLocalStorage("__uid2_server_token"),this._uid2AdvertisingToken=kr.readExternalLocalStorage("__uid2_advertising_token");const d=this.getToken(),c=!(!this._user.source||!d)&&this._userIdBridgeManager.shouldDeclareBridgedId(this._user.source);this.config={name:this._name,params:{storage:"localStorage",...d?{uid2Token:d,declareBridged:c}:{}}},setTimeout((()=>{c&&d&&this._declareBridgedToken(d)}),0)}}kh=B([hs("UnifiedId2IdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo,void 0===zo?Object:zo,void 0===da?Object:da,void 0===Zc?Object:Zc,void 0===Ch?Object:Ch,void 0===Ah?Object:Ah,void 0===Vl?Object:Vl])],kh);class Ih extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"sharedId")}constructor(e,t,i){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._name="sharedId",this.targetingKey="shl",this.eidSource="pubcid.org",this.config={name:this._name,storage:{type:"html5",name:"_pubcid",expires:60}}}}Ih=B([hs("SharedIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo])],Ih);class Ph extends nh{get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&ua(this._idho,"linkedInAdsId")}constructor(e,t,i){super(),this._ccpa=e,this._gpc=t,this._idho=i,this._name="linkedInAdsId",this.targetingKey="liaid",this.config={name:this._name,storage:{type:"html5",name:"linkedin_ads_id",expires:30}}}}Ph=B([hs("LinkedInAdsIdModule"),M(),j("design:type",Function),j("design:paramtypes",[void 0===nn?Object:nn,void 0===an?Object:an,void 0===Wo?Object:Wo])],Ph);class Oh{_removeIdsOnWordpressPage(){this._context.isWordPressLogin&&(this.ids=new Map)}get(e){return"FTrack"===e?this.ids.get("ftrack"):"merkleId"===e?this.ids.get("merkuryId"):this.ids.get(e)}forEach(e){return this.ids.forEach(e)}values(){return this.ids.values()}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u,p,g,m,_){this._context=e,this._connectIdModule=t,this._unifiedIdModule=i,this._id5IdModule=s,this._merkuryIdModule=r,this._identityLinkIdModule=n,this._lotamePanoramaIdModule=a,this._thirtyThreeAcrossIdModule=o,this._fTrackIdModule=l,this._loblawIdModule=d,this._fabrickIdModule=c,this._criteoIdModule=h,this._liveIntentIdModule=u,this._pairIdModule=p,this._unifiedId2IdModule=g,this._sharedIdModule=m,this._linkedInAdsIdModule=_,this._connectIdConfig=["connectId",{id:this._connectIdModule._config,targetingKey:this._connectIdModule.targetingKey,enabled:this._connectIdModule.enabled,eidSource:this._connectIdModule.eidSource}],this._unifiedIdConfig=["unifiedId",{id:this._unifiedIdModule._config,targetingKey:this._unifiedIdModule.targetingKey,enabled:this._unifiedIdModule.enabled,eidSource:this._unifiedIdModule.eidSource,storageParser:e=>JSON.parse(decodeURIComponent(e)).TDID}],this._unifiedId2Config=["uid2",{id:this._unifiedId2IdModule._config,enabled:this._unifiedId2IdModule.enabled,eidSource:this._unifiedId2IdModule.eidSource,targetingKey:this._unifiedId2IdModule.targetingKey,storageKey:this._unifiedId2IdModule.storageKey}],this._id5IdConfig=["id5Id",{id:this._id5IdModule._config,enabled:this._id5IdModule.enabled,targetingKey:this._id5IdModule.targetingKey,eidSource:this._id5IdModule.eidSource,storageParser:e=>JSON.parse(decodeURIComponent(e)).gp}],this._merkuryIdConfig=["merkuryId",{id:this._merkuryIdModule._config,enabled:this._merkuryIdModule.enabled,eidSource:this._merkuryIdModule.eidSource,targetingKey:this._merkuryIdModule.targetingKey}],this._identityLinkConfig=["identityLink",{id:this._identityLinkIdModule._config,enabled:this._identityLinkIdModule.enabled,eidSource:this._identityLinkIdModule.eidSource,targetingKey:this._identityLinkIdModule.targetingKey}],this._pairIdConfig=["pairId",{id:this._pairIdModule._config,enabled:this._pairIdModule.enabled,eidSource:this._pairIdModule.eidSource,targetingKey:this._pairIdModule.targetingKey}],this._criteoIdConfig=["criteo",{id:this._criteoIdModule._config,enabled:this._criteoIdModule.enabled,eidSource:this._criteoIdModule.eidSource,targetingKey:this._criteoIdModule.targetingKey}],this._sharedIdConfig=["sharedId",{id:this._sharedIdModule._config,enabled:this._sharedIdModule.enabled,eidSource:this._sharedIdModule.eidSource,targetingKey:this._sharedIdModule.targetingKey}],this._fabrickIdConfig=["fabrickId",{id:this._fabrickIdModule._config,enabled:this._fabrickIdModule.enabled,eidSource:this._fabrickIdModule.eidSource,targetingKey:this._fabrickIdModule.targetingKey}],this._fTrackIdConfig=["ftrack",{id:this._fTrackIdModule._config,enabled:this._fTrackIdModule.enabled,eidSource:this._fTrackIdModule.eidSource,targetingKey:this._fTrackIdModule.targetingKey}],this._33AcrossIdConfig=["33acrossId",{id:this._thirtyThreeAcrossIdModule._config,enabled:this._thirtyThreeAcrossIdModule.enabled,eidSource:this._thirtyThreeAcrossIdModule.eidSource,targetingKey:this._thirtyThreeAcrossIdModule.targetingKey}],this._liveIntentIdConfig=["liveIntentId",{id:this._liveIntentIdModule._config,enabled:this._liveIntentIdModule.enabled,targetingKey:this._liveIntentIdModule.targetingKey}],this._lotamePanoramaIdConfig=["lotamePanoramaId",{id:this._lotamePanoramaIdModule._config,enabled:this._lotamePanoramaIdModule.enabled,targetingKey:this._lotamePanoramaIdModule.targetingKey,eidSource:this._lotamePanoramaIdModule.eidSource,storageKey:this._lotamePanoramaIdModule.storageKey}],this._lmpIdConfig=["lmpId",{id:this._loblawIdModule._config,enabled:this._loblawIdModule.enabled,targetingKey:this._loblawIdModule.targetingKey,eidSource:this._loblawIdModule.eidSource,storageKey:this._loblawIdModule.storageKey}],this._linkedInAdsIdConfig=["linkedInAdsId",{id:this._linkedInAdsIdModule._config,enabled:this._linkedInAdsIdModule.enabled,targetingKey:this._linkedInAdsIdModule.targetingKey}],this.ids=new Map([this._sharedIdConfig,this._connectIdConfig,this._unifiedIdConfig,this._unifiedId2Config,this._id5IdConfig,this._identityLinkConfig,this._merkuryIdConfig,this._pairIdConfig,this._criteoIdConfig,this._fabrickIdConfig,this._fTrackIdConfig,this._33AcrossIdConfig,this._liveIntentIdConfig,this._lotamePanoramaIdConfig,this._lmpIdConfig,this._linkedInAdsIdConfig]),this._removeIdsOnWordpressPage()}}Oh=B([hs("UserIds"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Pr?Object:Pr,void 0===ah?Object:ah,void 0===oh?Object:oh,void 0===lh?Object:lh,void 0===dh?Object:dh,void 0===ch?Object:ch,void 0===hh?Object:hh,void 0===gh?Object:gh,void 0===uh?Object:uh,void 0===ph?Object:ph,void 0===mh?Object:mh,void 0===_h?Object:_h,void 0===Eh?Object:Eh,void 0===fh?Object:fh,void 0===kh?Object:kh,void 0===Ih?Object:Ih,void 0===Ph?Object:Ph])],Oh);class xh{get enabled(){return!0}}class Rh extends nr{init(){this._key="IdGraphLiveRamp",this._default=!1}run(){return super.run()}constructor(...e){super(...e),this.source=""}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Rh.prototype,"run",null),Rh=B([hs("IdGraphLiveRampExperiment"),M()],Rh);class Dh extends xh{get enabled(){return this._enabled}_runLiveRamp(e){if(fi({source:e.source,identifierType:"truedata"})){if(!R.resolve(Rh).result)return}let t,i="";var s;if(this._config.gdpr.enabled)t="gdpr",i=null!=(s=e.consent)?s:"";else if(this._config.ccpa.required){var r;t="ccpa",i=null!=(r=this._config.ccpa.privacyString)?r:this._config.ccpa.ccpaOptIn}try{const s=[e.sha256Hash,e.sha1Hash].filter((e=>e&&e.length));window.atsenvelopemodule.setAdditionalData({consentString:i,...void 0!==t?{consentType:t}:{},id:s.length?s:e.email,type:e.sha256Hash||e.sha1Hash?"emailHashes":"email"})}catch(e){te.error("LiveRampPiiPartner","processPii","Error setting ATS additional data",e)}}processPii(e){this._isEnvelopeModuleReady?this._runLiveRamp(e):window.addEventListener("envelopeModuleReady",(()=>{this._runLiveRamp(e)}))}get _shouldSetTargeting(){return this._enabled&&!!K.getLocalStorageValue(this._localKey,!1)}constructor(e){var t;super(),this._config=e,this._localKey="_lr_env",this._isEnvelopeModuleReady=!1,this._enabled=!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut&&(null==(t=this._config.liveRampAts)?void 0:t.enabled)&&"localStorage"in window,window.addEventListener("envelopeModuleReady",(()=>{this._isEnvelopeModuleReady=!0}))}}Dh=B([hs("LiveRampPiiPartner"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],Dh);class Lh extends nr{init(){this._key="ConfiantRefresh",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Lh.prototype,"run",null),Lh=B([hs("ConfiantPropertyExperiment"),M()],Lh);const Mh=new Map([[1,{type:"manual",description:"Deprecated"}],[2,{type:"creative",description:"Creative-based detection"}],[3,{type:"provider_security",description:"Domain-based detection for unsafe domains"}],[4,{type:"banned_domain",description:"Domain-based detection for bannded domains"}],[5,{type:"provider_ibv",description:"Domain-based detection for in-banner-video"}],[6,{type:"unsafejs",description:"JavaScript-based detection for unsafe ads"}],[7,{type:"hrap",description:"Domain-based detection for high risk ad platform domains"}]]);class Bh extends Cs{init(){const e=`https://cdn.confiant-integrations.net/${this._confiantPropertyExperiment.result?this._expPropertyId:this._prodPropertyId}/gpt_and_prebid/config.js`;return window.confiant=window.confiant||{},window.confiant.callback=(e,t,i,s,r)=>{const n=Mh.get(e);te.event("ConfiantTrackerComponent","adBlocked",{blockingTypeIntegerValue:e,blockingType:n?n.type:"unknown",description:n?n.description:"unknown",tagId:r,wrapperId:s,blockingId:t,isBlocked:i})},vi(e)}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}constructor(e,t){super(),this._config=e,this._confiantPropertyExperiment=t,this._name="conf",this._prodPropertyId="mOinGM9MTu5v-Lto835XLhlrSPY",this._expPropertyId="wyN88rwU6FImxcXgha7IWE-FzsE"}}Bh=B([hs("ConfiantTrackerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Lh?Object:Lh])],Bh);class Fh extends Cs{init(){const e=this._config.ccpa.comscoreParams||"0",t={c1:"2",c2:this._comscoreId,cs_fpid:kr.readExternalCookie("_pubcid")||kr.readExternalLocalStorage("_pubcid"),cs_fpit:"o",cs_fpdm:"*null",cs_fpdt:"*null",options:{enableFirstPartyCookie:!0},...this._gdprEnabled&&{cs_ucfr:"1"},...this._config.ccpa.required&&{cs_ucfr:e}};window._comscore=window._comscore||[],window._comscore.push(t),this._import()}_import(){const e=`https://sb.scorecardresearch.com/cs/${this._comscoreId}/beacon.js`;vi(e).catch((e=>{const t=this._gdprEnabled?"GDPR":"non-GDPR";te.error("ComscoreTrackerComponent","init",`Error during Comscore beacon.js import in ${t} region: `,e)}))}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&this._isValidTraffic&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}constructor(e){super(),this._config=e,this._name="cmscr",this._comscoreId="6035453",this._gdprEnabled=!1,this._isValidTraffic=!1,this._gdprEnabled=this._config.gdpr.enabled,this._isValidTraffic=!window.adthrive.invalidTraffic}}Fh=B([hs("ComscoreTrackerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],Fh);class jh extends Cs{init(){this._gamEventBus.slotOnload.once((()=>{this.import().then((()=>this.syncData())).catch((e=>te.error("HawkeyeTrackerComponent","init","slotOnload",e)))}))}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}async import(){return await vi("https://pghub.io/js/pandg-sdk.js",!0)}async syncData(){const e={ccpa:this._config.ccpa.privacyString?this._config.ccpa.privacyString:null,bp_id:"cafemedia"},t=window.Tapad.init(e,{name:"P&G",pixelUrl:"https://pandg.tapad.com/tag"});await t.sync({}),this._gam.setTargetingFlag("het_sync",["1"])}constructor(e,t,i){super(),this._gam=e,this._config=t,this._gamEventBus=i,this._name="hawk"}}jh=B([hs("HawkeyeTrackerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Vl?Object:Vl,void 0===Ol?Object:Ol,void 0===jl?Object:jl])],jh);class Nh extends Cs{init(){try{this._importATS()}catch(e){te.error("LiveRampAtsTrackerComponent","init",e)}}get enabled(){return this._config.liveRampAts.enabled&&!this._config.disableAds.all&&!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}_setECSTags(){const e={},t=this._config.marmalade.mcmp;for(const i of t)e[i]="mcmp";window.__launchpad("ecst",e,(e=>{}))}_setListener(){window.addEventListener("lrEnvelopePresent",(()=>{this._setECSTags()}))}_importATS(){this._setListener(),vi(this._config.liveRampAts.url).then((()=>{})).catch((e=>{te.error("LiveRampAtsTrackerComponent","error importing liveramp with ATS",e)}))}constructor(e){super(),this._config=e,this._name="ats"}}Nh=B([hs("LiveRampAtsTrackerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],Nh);class Uh extends Cs{init(){K.getLocalStorageValue(`${this.merkleStorageKey}`,!1)?this.spoof():this._gamEventBus.slotOnload.once((()=>{this.load().then((e=>{e instanceof Error||!Object.keys(e).length||(K.setLocalStorageValue(`${this.merkleStorageKey}`,encodeURIComponent(JSON.stringify(e)),!1),this.spoof())})).catch((()=>{}))}))}async load(){const e=`https://mid.rkdms.com/idsv2?ptk=${this.ptk}&pubid=${this.pubid}`;return new Promise(((t,i)=>{const s=new XMLHttpRequest;s.open("get",e),s.withCredentials=!0,s.addEventListener("load",(()=>200!==s.status?i(new Error(`Error status: ${s.status} response: ${s.responseText}`)):t(JSON.parse(s.responseText)))),s.addEventListener("error",(()=>i(new Error("Request failed")))),s.send()}))}spoof(){window.headertag||(window.headertag={getIdentityInfo:()=>{var e;const t=JSON.parse(decodeURIComponent(K.getLocalStorageValue("pbjs-unifiedid",!1)||"{}")),i=JSON.parse(decodeURIComponent(K.getLocalStorageValue(`${this.merkleStorageKey}`,!1)||"{}"));return{AdserverOrgIp:{data:{source:"adserver.org",uids:Object.keys(t).map((e=>({id:t[e],ext:{rtiPartner:e}})))},responsePending:!1},MerkleIp:{data:{source:"merkleinc.com",uids:[{id:null==i||null==(e=i.ppid)?void 0:e.id,ext:{enc:0}}]},responsePending:!1}}}})}get _shouldSetTargeting(){return this.enabled&&null!==K.getLocalStorageValue(`${this.merkleStorageKey}`,!1)}get enabled(){var e;return!(this._config.tkho.tracker.includes(this._name)||this._config.gdpr.enabled||this._config.ccpa.enabled||(null==(e=this._idhoExperiment.result)?void 0:e.includes("merkleId"))||this._config.gpc.gpcEnabled)}constructor(e,t,i){super(),this._config=e,this._idhoExperiment=t,this._gamEventBus=i,this._name="mrk",this.ptk="17c1789b-e660-493b-aa74-3c8fb990dc5f",this.pubid="CAFEMEDIA",this.merkleStorageKey="IXWRAPPERMerkleIp"}}Uh=B([hs("MerkleTrackerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Ko?Object:Ko,void 0===jl?Object:jl])],Uh);class Vh extends Cs{init(){try{this._gamEventBus.slotOnload.once((()=>{this.loadImage()}))}catch(e){te.error("NielsenTrackerComponent","init",e)}}get enabled(){return lt()&&!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}loadImage(){const e=this._context.device;let t="https://secure-gl.imrworldwide.com/cgi-bin/m?am=3&at=view&rt=banner&st=image&cr=adthrive&ce=cafemedia";let i={phone:"nlsn290957",tablet:"nlsn291137",desktop:"nlsn291136"}[e];const s={phone:"nlsn287186",tablet:"nlsn287188",desktop:"nlsn287187"},r=ri(this._context.savedReferrer);r&&(r.toLowerCase().includes("instagram.com")||r.toLowerCase().includes("pinterest.com"))&&(i=s[e]),t+=`&ci=nlsnci542&ca=${i}&pc=${window.location.host}&r=${Date.now()}`,(new Image).src=`${t}`}constructor(e,t,i){super(),this._config=e,this._gamEventBus=t,this._context=i,this._name="nlsn"}}Vh=B([hs("NielsenTrackerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===jl?Object:jl,void 0===Pr?Object:Pr])],Vh);class zh extends Cs{init(){try{const e=setTimeout((()=>{this.rewriteAllTargetLinksOnPage()}),5e3);this._slotManagerEventBus.added.once((()=>{this._gamEventBus.slotOnload.once((()=>{e&&clearTimeout(e),this.rewriteAllTargetLinksOnPage()}))}))}catch(e){te.error("TargetRewriteTrackerComponent","getAllTargetLinksOnPage",e)}}rewriteAllTargetLinksOnPage(){let e=0;Array.prototype.map.call(document.querySelectorAll(`a[href*="${this._targetDomain}"]`),(e=>e)).filter((e=>this.isTargetLink(e))).forEach((t=>{this.fireImpression(t.href),this.replaceTargetLink(t),e++})),e&&te.event("TargetRewriteTrackerComponent","logTargetRewrite",{message:"targetRewrite",countRewrite:e})}fireImpression(e){const t=this.getImpressionPixel(e);return(new Image).src=t}getImpressionPixel(e){let t=`https://${this._affDomain}/i/${this._commonPath}?`;const i=`U1|${this.getUUID()}`;t+=`_ir=${encodeURIComponent(i)}&`+this._commonParams+"&subid3="+encodeURIComponent(e);const s=e.split("?");return s.length>1&&(t+="&"+s[1]),t}getUUID(){return`${Yi().toString()}.${Math.random().toString(36).substring(2,15)}`}replaceTargetLink(e){const t=this.removeHashtagsFromUrl(e.href),i=encodeURIComponent(t);e.classList.add("noskimlinks","norewrite"),e.href=`https://${this._affDomain}/c/${this._commonPath}?${this._commonParams}&subid3=${i}&u=${i}#donotlink`}removeHashtagsFromUrl(e){return e.split("#")[0]}isTargetLink(e){const t=this.extractDomain(e.href);return t&&!t.includes(this._affDomain)}extractDomain(e){const t=/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i.exec(e);return t&&t[1]||""}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&!this._config.ccpa.enabled&&this._config.adOptions.targetAff&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}constructor(e,t,i){var s;super(),this._config=e,this._gamEventBus=t,this._slotManagerEventBus=i,this._name="tgtaff",this._accountId="2773249",this._adId="81938",this._configId="2092",this._affDomain="goto.target.com",this._targetDomain="target.com",this._commonParams="",this._commonPath="",this._commonParams=(s={subid1:this._config.site.id,subid2:location.href,sharedid:this._config.site.name},Object.keys(s).map((e=>`${e}=${encodeURIComponent(s[e])}`)).join("&")),this._commonPath=`${this._accountId}/${this._adId}/${this._configId}`}}zh=B([hs("TargetRewriteTrackerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===jl?Object:jl,void 0===Vs?Object:Vs])],zh);class $h extends Cs{init(){try{this._gamEventBus.slotOnload.once((()=>{this.loadImage()}))}catch(e){te.error("TheTradeDeskTrackerComponent","init",e)}}get enabled(){return!this._tkho.tracker.includes(this._name)&&!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut}loadImage(){(new Image).src="https://insight.adsrvr.org/track/evnt/?adv=z127r4i&ct=0:p21aj7j&fmt=3"}constructor(e,t,i,s){super(),this._gpcConfig=e,this._ccpaConfig=t,this._tkho=i,this._gamEventBus=s,this._name="ttdt"}}$h=B([hs("TheTradeDeskTrackerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===an?Object:an,void 0===nn?Object:nn,void 0===hl?Object:hl,void 0===jl?Object:jl])],$h);class Hh{getSyncedIdModules(e){return[...e].reduce(((e,t)=>{const i=this._userIds.get(t.name);return i&&this.getStoredUserIds(i)?(e.push(i.id.name),e):e}),[])}getSyncedBrowserIdPartners(e){const t=this.getSyncedIdModules(e).map((e=>{var t;return null==(t=this._userIds.get(e))?void 0:t.targetingKey})).filter((e=>Boolean(e)));this._context.gpid&&t.push("gpid");const i=this.getMagniteCarbonId(),s=this.getAmazonPublisherAudienceId(),r=this._getConditionalPiiPartners(),n=this._getRaptiveConnectedId();return[...t,...i,...s,...r,...n]}_getRaptiveConnectedId(){const e=[];return kr.readExternalCookie("_rcid")&&e.push("rcid"),e}_getConditionalPiiPartners(){const e=[];return this.liveRampPiiPartner._shouldSetTargeting&&e.push("ats"),this._merkleTracker._shouldSetTargeting&&e.push("mrk_leg"),e}getSyncedAuctionEidPartners(e){let t=[];const i=this._prebidMethods.getUserIdsAsEids();i&&(t=e.reduce(((e,t)=>(i.find((e=>e.source===(null==t?void 0:t.eidSource)))&&e.push(t.targetingKey),e)),[]));const s=this._getLiveIntentEidPartners(i);return[...t,...s]}_getLiveIntentEidPartners(e){const t=[],i=new Map([["liveintent.com","li_id"],["uidapi.com","li_uid2"],["rubiconproject.com","li_mgn"],["liveintent.indexexchange.com","li_ix"],["liveintent.sovrn.com","li_svrn"],["media.net","li_mnet"],["pubmatic.com","li_pub"],["openx.net","li_ox"],["bidswitch.net","li_bdswt"],["adserver.org","li_uid1"],["liveintent.triplelift.com","li_tl"]]);for(const[r,n]of i){const i=null==e?void 0:e.find((e=>e.source===r));var s;if("adserver.org"===r||"uidapi.com"===r||"pubmatic.com"===r){if(i&&i.uids.length>0)(null==(s=i.uids[0].ext)?void 0:s.hasOwnProperty("provider"))&&t.push(n)}else i&&t.push(n)}return t}getAmazonPublisherAudienceId(){return kr.readExternalCookie("AMZN-Token")?["amzn"]:[]}getMagniteCarbonId(){const e=K.getLocalStorageValue("carbon_ccuid"),t=kr.readExternalCookie("ccuid"),i=kr.readExternalCookie("ccsid");return e||t||i?["mgncrbn"]:[]}getStoredUserIds(e){const{id:{storage:t},storageKey:i}=e;let s;return t&&"cookie"===t.type&&window.navigator.cookieEnabled?s=kr.readExternalCookie(t.name):t&&"html5"===t.type?s=K.getLocalStorageValue(t.name,!1,!1):i&&(s=kr.readExternalLocalStorage(i)),s}getParsedUserIdStoredValue(e){const t=this.getStoredUserIds(e);if(t){if(!e.storageParser)return t;try{return e.storageParser(t)}catch(e){return t}}}getLiveRampAtsEnvelopeId(){const e="_lr_env_src_ats",t=K.getLocalStorageValue(e,!1),i=kr.readExternalCookie(e);var s;return null!=(s=t||i)?s:""}constructor(e,t,i,s,r){this._userIds=e,this._prebidMethods=t,this.liveRampPiiPartner=i,this._merkleTracker=s,this._context=r}}Hh=B([hs("UserIdTargeting"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Oh?Object:Oh,void 0===Ss?Object:Ss,void 0===Dh?Object:Dh,void 0===Uh?Object:Uh,void 0===Pr?Object:Pr])],Hh);class qh extends Cs{_refreshUid2TargetingKey(){this._enabledUserIds=[...this._userIds.values()].filter((e=>e.enabled)).map((e=>{if("uid2"===e.id.name){var t;const i=null==(t=e.id.params)?void 0:t.uid2Token;"optable"===(null==i?void 0:i.provider)&&(e.targetingKey="opt_uid2")}return e.id})),this._enabledUserIdConfigs=[...this._userIds.values()].filter((e=>e.enabled)).map((e=>{if("uid2"===e.id.name){var t;const i=null==(t=e.id.params)?void 0:t.uid2Token;"optable"===(null==i?void 0:i.provider)&&(e.targetingKey="opt_uid2")}return e}))}get enabled(){return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut}getTargetingData(){return this.enabled?this._flattenSyncedIdPartnerData(this._userIdTargeting.getSyncedBrowserIdPartners(this._enabledUserIds),this._userIdTargeting.getSyncedAuctionEidPartners(this._enabledUserIdConfigs)):[]}_flattenSyncedIdPartnerData(e,t){const i=e.filter((e=>!t.includes(e))),s=t.filter((t=>!e.includes(t))),r=e.filter((e=>t.includes(e)));return[...i.map((e=>`i:${e}`)),...s.map((e=>`e:${e}`)),...r]}get enabledUserIds(){return this.enabled?[...this._userIds.values()].map((e=>e.id)):[]}init(){if(!this.enabled)return;const e={userIds:this._enabledUserIds};this._ppid&&(e.ppid="pubcid.org"),this.setTAMLiveIntentFlag(),this.setUserIdsWithPrebid(e),this.setLiveRampAtsEnvelopeId()}setTAMLiveIntentFlag(){const e=this._enabledUserIdConfigs.find((e=>"liveIntentId"===e.id.name));window.liModuleEnabled=void 0!==e}setLiveRampAtsEnvelopeId(){const e=this._userIdTargeting.getLiveRampAtsEnvelopeId();e&&this._gam.setTargetingFlag("ats_src","true"===e?["t"]:["f"])}setUserIdsWithPrebid(e){this._prebidMethods.setConfig({userSync:e})}_setPPID(){((e,t,i)=>{const s=ha(),r=e=>t.setTargetingFlag("ppid",e,!0);if(!ua(e,"id5Id"))return s?(r(["sh_id"]),i.setConfig({ppid:s}),void t.setSharedIdAsPPID(s)):void r(["no_sharedIDAvail_noPPIDSet"]);{const e=kr.readExternalLocalStorage("pbjs-id5id");if(!e&&s)return r(["no_id5StorageAvail_sharedIdSent"]),i.setConfig({ppid:s}),void t.setSharedIdAsPPID(s);if(!e)return void r(["no_id5StorageAvail_noSharedIdAvail_noPPIDset"]);try{const n=JSON.parse(decodeURIComponent(e)).gp;if(n||s){if(!n)return r(["gpid_na_sharedIdSent"]),i.setConfig({ppid:s}),void t.setSharedIdAsPPID(s);if(!s)return r(["no_sharedIdAvail_gpidSent"]),i.setConfig({ppid:n}),void t.setGPIDasPPID(n)}else r(["both_na_noPPIDSet"]);const a=n.split("").map((e=>e.charCodeAt(0).toString(2))).join(" ");if("error during binary conversion"===a)return r(["errorDuringGPIDBinaryConversion_sharedIdSent"]),i.setConfig({ppid:s}),void t.setSharedIdAsPPID(s);if(parseInt(a.charAt(a.length-1))%2==0)return r(["gpid"]),i.setConfig({ppid:n}),void t.setGPIDasPPID(n);r(["sh_id"]),i.setConfig({ppid:s}),t.setSharedIdAsPPID(s)}catch(e){te.error("SetPpid","Error parsing id5 local storage string")}}})(this._idho,this._gam,this._prebidMethods)}constructor(e,t,i,s,r,n,a,o,l){super(),this._gpcConfig=e,this._ccpaConfig=t,this._prebidMethods=i,this._userIdTargeting=s,this._userIds=r,this._gam=n,this._slotEventBus=a,this._idho=o,this._userIdEventBus=l,this._enabledUserIds=[],this._enabledUserIdConfigs=[],this._ppid=null,this.enabled&&(this._enabledUserIds=[...r.values()].filter((e=>e.enabled)).map((e=>{if("sharedId"===e.id.name){const t=e.id.storage&&e.id.storage.name||"";this._ppid=K.getLocalStorageValue(t,!1),this._ppid&&(e.id.value={pubcid:this._ppid})}if("uid2"===e.id.name){var t;const i=null==(t=e.id.params)?void 0:t.uid2Token;"optable"===(null==i?void 0:i.provider)&&(e.targetingKey="opt_uid2")}return e.id})),this._enabledUserIdConfigs=[...r.values()].filter((e=>e.enabled)).map((e=>{if("uid2"===e.id.name){var t;const i=null==(t=e.id.params)?void 0:t.uid2Token;"optable"===(null==i?void 0:i.provider)&&(e.targetingKey="opt_uid2")}return e})),this._slotEventBus.requestingBids.once(this._setPPID.bind(this)),this._slotEventBus.refreshingBids.once(this._setPPID.bind(this)),this._userIdEventBus.uid2Refreshed.on((()=>{this._refreshUid2TargetingKey()})))}}qh=B([hs("UserIdComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===an?Object:an,void 0===nn?Object:nn,void 0===Ss?Object:Ss,void 0===Hh?Object:Hh,void 0===Oh?Object:Oh,void 0===Vl?Object:Vl,void 0===Es?Object:Es,void 0===Wo?Object:Wo,void 0===Fs?Object:Fs])],qh);class Gh{}class Kh extends sr{init(){this._key="Analytics"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Kh.prototype,"run",null),Kh=B([hs("AnalyticsExperiment"),M()],Kh);class Wh extends Gh{init(){if(window.localStorage)try{this._prebidMethods.enableAnalytics({provider:"roxot",options:{publisherIds:["ffcc0e40-07d0-4238-92e4-f711915afb5a"],host:`${this._context.bucket}.com`}})}catch(e){te.error("RoxotAnalytics","init - ignored",e)}else te.error("RoxotAnalytics","init",new Error("Disabled roxot because localStorage is undefined"))}get enabled(){return"roxot"===this._analyticsExperiment.result}constructor(e,t,i){super(),this._context=e,this._prebidMethods=t,this._analyticsExperiment=i,this.name="roxot"}}Wh=B([hs("RoxotAnalytics"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Pr?Object:Pr,void 0===Ss?Object:Ss,void 0===Kh?Object:Kh])],Wh);class Yh extends nr{init(){this._key="GenericAnalyticsAdMarkup",this._default=!1}}Yh=B([hs("GenericAnalyticsAdMarkupExperiment"),M()],Yh);class Qh extends Gh{init(){try{this._prebidMethods.enableAnalytics({provider:this.name,options:{batchSize:10,batchDelay:2e3,gvlid:this._config.gdpr.cafeMediaVendorId,events:{bidResponse:e=>this._setLoggerBidResponseFields(e),bidWon:e=>this._setLoggerBidWonFields(e),noBid:e=>this._setLoggerNoBidFields(e),bidTimeout:e=>this._setLoggerBidTimeoutFields(e),bidRequested:e=>this._setLoggerBidRequestedFields(e),pbsAnalytics:e=>this._setLoggerPbsAnalyticsFields(e)},handler:e=>new Promise(((t,i)=>{fetch(this._loggerEndpoint,{method:"POST",headers:[["Content-Type","application/json"]],body:JSON.stringify({event_type:"generic",message:JSON.stringify(e)})}).then((e=>{t(e)})).catch((e=>{i(e)}))}))}})}catch(e){te.error("GenericAnalytics","init - ignored",e)}}get enabled(){return"generic"===this._analyticsExperiment.result}constructor(e,t,i,s){super(),this._prebidMethods=e,this._analyticsExperiment=t,this._genericAnalyticsAdMarkupExperiment=i,this._config=s,this.name="generic",this._loggerEndpoint="https://api.adthrive.com/logger",this._setLoggerBidResponseFields=e=>{var t;return{event_type:"BIDRESPONSE",...this._genericAnalyticsAdMarkupExperiment.result&&{ad:e.ad},adserverTargeting:e.adserverTargeting,adUnitCode:e.adUnitCode,auctionId:e.auctionId,bidder:e.bidderCode,bidderCode:e.bidderCode,cpm:e.cpm,currency:e.currency,floorData:e.floorData,floorValue:null==(t=e.floorData)?void 0:t.floorValue,height:e.height,mediaType:e.mediaType,meta:e.meta,originalCpm:e.originalCpm,requestId:e.requestId,requestTimestamp:e.requestTimestamp,responseCpm:e.responseCpm,responseTimestamp:e.responseTimestamp,size:e.size,source:e.source,statusMessage:e.statusMessage,timeToRespond:e.timeToRespond,transactionId:e.transactionId,ttl:e.ttl,width:e.width}},this._setLoggerBidWonFields=e=>({event_type:"BIDWON",adserverTargeting:e.adserverTargeting,adUnitCode:e.adUnitCode,auctionId:e.auctionId,bidder:e.bidder,bidderCode:e.bidderCode,cpm:e.cpm,currency:e.currency,floorData:e.floorData,height:e.height,mediaType:e.mediaType,meta:e.meta,requestId:e.requestId,requestTimestamp:e.requestTimestamp,responseCpm:e.responseCpm,size:e.size,source:e.source,status:e.status,statusMessage:e.statusMessage,timeToRespond:e.timeToRespond,transactionId:e.transactionId,ttl:e.ttl,width:e.width}),this._setLoggerNoBidFields=e=>({event_type:"NOBID",auctionId:e.auctionId,bidder:e.bidder,source:e.src,adUnitCode:e.adUnitCode}),this._setLoggerBidTimeoutFields=e=>e.map((e=>({event_type:"BIDTIMEOUT",adUnitCode:e.adUnitCode,auctionId:e.auctionId,bid_id:e.bid_id,bidder:e.bidder,bidderRequestId:e.bidderRequestId,bidderRequestsCount:e.bidRequestsCount,bidderWinsCount:e.bidderWinsCount,bidId:e.bidId,bidRequestsCount:e.bidRequestsCount,floorData:e.floorData,mediaTypes:e.mediaTypes,ortb2:e.ortb2,ortb2Imp:e.ortb2Imp,schain:e.schain,sizes:e.sizes,src:e.src,transactionId:e.transactionId}))),this._setLoggerBidRequestedFields=e=>({event_type:"BIDREQUESTED",bidderCode:e.bidderCode,auctionId:e.auctionId,auctionStart:e.auctionStart,bidderRequestId:e.bidderRequestId,bids:e.bids,ortb2:e.ortb2,start:e.start,timeout:e.timeout}),this._setLoggerPbsAnalyticsFields=e=>({event_type:"PBSANALYTICS",...e})}}Qh=B([hs("GenericAnalytics"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ss?Object:Ss,void 0===Kh?Object:Kh,void 0===Yh?Object:Yh,void 0===Ol?Object:Ol])],Qh);class Xh{updateBidParams(e,t){}setup(){this._integrationConfigured||this._setupBidderIntegrationType()}get bidderDisplayEnabled(){return!0}get bidderInstreamEnabled(){return!0}get bidders(){return this._bidders}get enabled(){var e;return this._bidders.length>0&&(null!=(e=this._config.partners.display.get(this.name))?e:this.adapterName&&this._config.partners.display.get(this.adapterName))}get videoEnabled(){return this._bidders.length>0&&(this._config.partners.video.get(this.name)||this.adapterName&&this._config.partners.video.get(this.adapterName))}get name(){return this.bidderConfig.bidder_name}_addPositionParam(e,t){e.params.position=t}_addPlacementIdParam(e,t){e.params.placementId=t}_applyAuctionLabel(e,t){const i=this._config,s="csdr"!==i.prebid.multistageValue&&"off"!==i.prebid.multistageValue,r=e.location===ge.Video_StickyOutstream,n=i.prebid,a=t.bidder;let o=[];s&&r&&n.refreshStickyOutstreamAuctionCount>1?o=n.getVideoBidderLabel(a):s&&!r&&n.refreshAuctionCount>1&&(o=n.getBidderLabel(a)),o.forEach((e=>{t.labelAll=t.labelAll||[],t.labelAll.includes(e)||t.labelAll.push(e)}))}_addBidLabel(e,t={}){const i=[];if(t.outstreamCapable){const t=`outstreamCapable_${e}`;i.push(t)}if(t.refresh){const e="refresh";i.push(e)}if(t.initial){const e="initial";i.push(e)}return i.length?{labelAll:i}:{}}_isClientNamedServerBidder(){return this._config.prebid.s2s.bidders.includes(this.name)}_setupBidderIntegrationType(){const e=this.alwaysOnBidder;var t;const i=this._config.prebid.requestExp[null!=(t=this.serverBidderName)?t:this.name],s=i&&"client"!==i,r=(!i||"server"!==i)&&(this._isClientNamedServerBidder()||this._config.prebidClientSide.enabled);var n;(e||r)&&this._bidders.push({name:this.name,type:"client"}),(e||s)&&this._bidders.push({name:null!=(n=this.serverBidderName)?n:this.name,type:"server"}),this._integrationConfigured=!0}constructor(e){this._config=e,this._bidders=[],this._integrationConfigured=!1,this.alwaysOnBidder=!1}}class Jh extends Xh{getSlotBidRequests(e){}getBannerSlotBidRequests(e){}getMultiFormatSlotBidRequests(e){te.error("PrebidAuctionManager","getMultiFormatSlotBidRequests","This method should be overridden")}getOutstreamSlotBidRequests(e){}getNativeSlotBidRequests(e){}getVideoSlotBidRequests(e){}getBannerBidRequests(e){return e.filter((e=>!this.multiformatBidder||!e.multiformat)).reduce(((e,t)=>{const i=this.getBannerSlotBidRequests(t);return null==i||i.map((e=>{this._applyAuctionLabel(t,e)})),e.set(t.id,i),e}),new Map)}bannerEligibleReducer(e,t){const i=this.getMultiFormatSlotBidRequests(t);return null==i||i.map((e=>{this._applyAuctionLabel(t,e)})),e.set(t.id,i),e}getMultiFormatBidRequests(e){return e.reduce(this.bannerEligibleReducer.bind(this),new Map)}getOutstreamBidRequests(e){return e.filter((e=>!this.multiformatBidder||!e.multiformat)).reduce(((e,t)=>{const i=this.getOutstreamSlotBidRequests(t);return null==i||i.map((e=>{this._applyAuctionLabel(t,e)})),e.set(t.id,i),e}),new Map)}getNativeBidRequests(e){return e.filter((e=>!this.multiformatBidder||!e.multiformat)).reduce(((e,t)=>{const i=this.getNativeSlotBidRequests(t);return null==i||i.map((e=>{this._applyAuctionLabel(t,e)})),e.set(t.id,i),e}),new Map)}getVideoBidRequests(e){return e.reduce(((e,t)=>(e.set(t.name,this.getVideoSlotBidRequests(t)),e)),new Map)}}class Zh extends Jh{get bidderInstreamEnabled(){return!!this._config.video.playbackmethod}getBannerSlotBidRequests(e){return this._getBidParams(e)}getOutstreamSlotBidRequests(e){return this._getBidParams(e,!0)}_getBidParams(e,t=!1){const i=this._bannerMap,s=i.has(e.placementMapName)&&i.get(e.placementMapName);if(s)return[{bidder:this.name,...this._addBidLabel(e.placementMapName,{outstreamCapable:t}),params:{siteId:s,productId:this._bannerProductId}}]}getVideoSlotBidRequests(e){const t=this._videoMap,i=t.has(e.name)&&t.get(e.name);if(i)return[{bidder:this.name,params:{siteId:i,productId:this._videoProductId}}]}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.ThirtyThreeAcross),this.videoCreativeIds=[["138395447475",ae.ThirtyThreeAcross],["138395937226",ae.ThirtyThreeAcross],["138395937256",ae.ThirtyThreeAcross],["138395937310",ae.ThirtyThreeAcross],["138395937325",ae.ThirtyThreeAcross],["138395447241",ae.ThirtyThreeAcross],["138395937274",ae.ThirtyThreeAcross],["138395937313",ae.ThirtyThreeAcross],["138395937319",ae.ThirtyThreeAcross],["138395937343",ae.ThirtyThreeAcross],["138395937349",ae.ThirtyThreeAcross],["138395937304",ae.ThirtyThreeAcross],["138395937307",ae.ThirtyThreeAcross],["138395937322",ae.ThirtyThreeAcross],["138395937346",ae.ThirtyThreeAcross],["138395445846",ae.ThirtyThreeAcross]],this._bannerProductId="siab",this._videoProductId="instream",this._bannerMap=new Map([[ge.Below_Post,"dqjinO_Lqr6i5uaKkv7mNO"],[ge.Content_1,"dzqsVw_Lqr6iHHaKlId8sQ"],[ge.Content_2,"dGYL36_Lqr6iHHaKlId8sQ"],[ge.Content_3,"dPmBLW_Lqr6ikXaKkGJozW"],[ge.Content_4,"dYmdO4_Lqr6ikXaKkGJozW"],[ge.Content_5,"d73_q4_Lqr6ikfaKlId8sQ"],[ge.Content_6,"aeCNc8_Lur6ikfaKlId8sQ"],[ge.Content_7,"amEJ90_Lur6ikXaKkGJozW"],[ge.Content_8,"avcDUU_Lur6ikXaKkGJozW"],[ge.Content_9,"aE0F5q_Lur6iHHaKlId8sQ"],[ge.Footer_1,"aMbGkS_Lur6ikXaKkGJozW"],[ge.Header_1,"aZCnyg_Lur6ikfaKlId8sQ"],[ge.Header_2,"a7S6ye_Lur6ikXaKkGJozW"],[ge.Recipe_1,"bfXhLW_Lur6ioMaKkGJozW"],[ge.Recipe_2,"bmQVLo_Lur6ikfaKlId8sQ"],[ge.Recipe_3,"d7kcPCUhur6yo-aKkGJozW"],[ge.Recipe_4,"agAjkaUhyr6yo9aKlId8sQ"],[ge.Sidebar_1,"buEy3O_Lur6ikfaKlId8sQ"],[ge.Sidebar_2,"bCOsqy_Lur6ikfaKlId8sQ"],[ge.Sidebar_3,"bOGvrc_Lur6ikXaKkGJozW"],[ge.Sidebar_4,"bW-wb0_Lur6ikfaKlId8sQ"],[ge.Sidebar_5,"b8nVxi_Lur6ikXaKkGJozW"],[ge.Sidebar_9,"cggK7W_Lur6ikfaKlId8sQ"]]),this._videoMap=new Map([[_e.Video_Collapse_Autoplay_SoundOff,"a_lKMg0Iar7k8brkHcnlxd"],[_e.Video_Coll_SOff_Smartphone,"b7sKMM0Iar7ikGrkHcnnVW"],[_e.Video_In_Post_ClicktoPlay_SoundOn,"c98www0Iar7ioerkHcnlKl"],[_e.Video_Individual_Autoplay_SOff,"bhUZlu0Ier7ioerkHcnlKl"]])}}Zh=B([hs("ThirtyThreeAcrossBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],Zh);class eu extends Jh{get bidderDisplayEnabled(){const e=this._context.country;return this._allowedCountries.includes(e)}get bidderInstreamEnabled(){const e=this._context.country;return this._allowedCountries.includes(e)}getBannerSlotBidRequests(e){if(this._bannerMap.has(e.placementMapName))return[{bidder:this.name,params:{...this._params,placementId:e.id}}]}getVideoSlotBidRequests(e){if(this._videoMap.has(e.name))return[{bidder:this.name,params:{...this._params,placementId:`AdThrive_${e.name}`}}]}constructor(e,t){super(e),this._context=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.AidemServer),this.serverBidderName=ae.AidemServer,this.adapterName=ae.Aidem,this._allowedCountries=["GB","US"],this.videoServerCreativeIds=[["138447954856",ae.AidemServer],["138447954853",ae.AidemServer],["138447954850",ae.AidemServer],["138447954859",ae.AidemServer],["138447954568",ae.AidemServer],["138447954574",ae.AidemServer],["138447954514",ae.AidemServer],["138447240867",ae.AidemServer]],this._keywords={keywords:{...this._config.site.filteredSensitiveCategories.length&&{sens:this._config.site.filteredSensitiveCategories},bucket:[this._context.bucket],Chrome:`${lt()}`,Mobile:`${Wt()}`}},this._params={publisherId:"6532804884",siteId:this._config.site.id},this._displaySet=new Set([ge.Below_Post,ge.Content,ge.Content_1,ge.Content_2,ge.Content_3,ge.Content_4,ge.Content_5,ge.Content_6,ge.Content_7,ge.Content_8,ge.Content_9,ge.Footer_1,ge.Header_1,ge.Header_2,ge.Recipe_1,ge.Recipe_2,ge.Recipe_3,ge.Recipe_4,ge.Recipe_5,ge.Sidebar_1,ge.Sidebar_2,ge.Sidebar_3,ge.Sidebar_4,ge.Sidebar_5,ge.Sidebar_9]),this._videoDisplaySet=new Set([_e.Video_Coll_SOff_Smartphone,_e.Video_Collapse_Autoplay_SoundOff,_e.Video_In_Post_ClicktoPlay_SoundOn,_e.Video_Individual_Autoplay_SOff]),this._videoMobileSet=new Set([_e.Video_Coll_SOff_Smartphone,_e.Video_In_Post_ClicktoPlay_SoundOn,_e.Video_Individual_Autoplay_SOff]),this._bannerMobileDesktopMap={desktop:this._displaySet,mobile:this._displaySet},this._videoMobileDesktopMap={desktop:this._videoDisplaySet,mobile:this._videoMobileSet},this._bannerMap=Wt()?this._bannerMobileDesktopMap.mobile:this._bannerMobileDesktopMap.desktop,this._videoMap=Wt()?this._videoMobileDesktopMap.mobile:this._videoMobileDesktopMap.desktop}}eu=B([hs("AidemBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr])],eu);class tu{_setupSpaListeners(){this._spaEventBus.routeChanged.on((()=>{this.spaListeners.forEach((e=>e())),this.spaListeners.length=0})),this._spaEventBus.resetCompleted.on((()=>{this.addEventListeners()}))}addEventListeners(){let e=!1,t=!1;const i=()=>{e||(e=!0,setTimeout((()=>{this.scroll.emit(),e=!1}),100))},s=()=>{t||(t=!0,setTimeout((()=>{this.resize.emit(),t=!1}),100))};this.spaListeners.push(this._pageManager.scroll.on((()=>i()))),this.spaListeners.push(this._pageManager.resize.on((()=>s()))),this.spaListeners.push(this._pageManager.visibilityChange.on((()=>{this.pageVisibility.emit(document.hidden)})))}emitVideoPlayingEvent(e,t){this.videoPlaying.emit({playerId:e,mediaIdCount:t})}emitVideoSlotRenderedEvent(e){this.videoSlotRendered.emit(e)}constructor(e,t,i,s){this._pageManager=e,this._spaEventBus=t,this.gamEventBus=i,this.footerEventBus=s,this.scroll=new Q,this.resize=new Q,this.pageVisibility=new Q,this.videoPlaying=new Q,this.videoSlotRendered=new Q,this.spaListeners=[],this._setupSpaListeners(),this.addEventListeners(),this.gamEventBus.slotResponseReceived.on((({slot:e})=>{e.location===ge.Footer&&this.footerEventBus.footerRefreshed.emit()}))}}tu=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===wr?Object:wr,void 0===Ns?Object:Ns,void 0===jl?Object:jl,void 0===Ds?Object:Ds])],tu);class iu{isDragging(){return this._isDragging}toggle(e){e?this._container.classList.add("active"):this._container.classList.remove("active")}update(){if(!this._isVisible()||this._isDragging)return;const{currentTime:e,duration:t}=this._videoElement,i=e/t;this._setProgressPosition(i)}init(){this._createProgressBar(),this._setupListeners()}_createProgressBar(){this._container.tabIndex=0,this._container.className="adthrive-player-progress-bar-container",this._progressBar.className="adthrive-player-progress-bar",this._progressBarHandle.className="adthrive-player-progress-bar-handle",this._progressBar.appendChild(this._progressBarIndicator),this._container.appendChild(this._progressBar),this._container.appendChild(this._progressBarHandle)}_setupListeners(){this._container.addEventListener("click",this._seekVideoOnClick.bind(this)),this._container.addEventListener("keydown",this._handleKeyboardControl.bind(this)),this._progressBarHandle.addEventListener("pointerdown",this._handleStartDragProgress.bind(this)),this._videoElement.addEventListener("timeupdate",this.update.bind(this))}_setProgressPosition(e){this._progressBarHandle.style.left=100*e+"%",this._progressBarIndicator.style.transform=`scaleX(${e})`}_seekVideoOnClick(e){this._seekVideo(e.clientX)}_seekVideo(e){const t=this._container.getBoundingClientRect(),i=(e-t.left)/t.width*this._videoElement.duration;this._videoElement.currentTime=i}_fastForwardVideo(e=.05){const t=this._videoElement.duration,i=t*e;this._videoElement.currentTime=Math.min(this._videoElement.currentTime+i,t)}_rewindVideo(e=.05){const t=this._videoElement.duration*e;this._videoElement.currentTime=Math.max(this._videoElement.currentTime-t,0)}_handleKeyboardControl(e){["Space","Enter","ArrowLeft","ArrowRight"].includes(e.code)&&e.preventDefault(),this._throttledKeyboardControl(e)}_handleStartDragProgress(e){this._isDragging||(e.preventDefault(),this._isDragging=!0,this._container.setPointerCapture(e.pointerId),document.addEventListener("pointermove",this._startDraggingHandler),document.addEventListener("pointerup",this._stopDraggingHandler))}_handleDragProgress(e){const t=e.clientX;e.preventDefault();const i=this._container.getBoundingClientRect();let s=t-i.left;s=Math.max(0,Math.min(s,i.width));const r=s/i.width;this._setProgressPosition(r)}_handleStopDragProgress(e){const t=e.clientX;this._isDragging=!1,this._container.releasePointerCapture(e.pointerId),document.removeEventListener("pointermove",this._startDraggingHandler),document.removeEventListener("pointerup",this._stopDraggingHandler),this._seekVideo(t)}constructor(e,t){this._container=document.createElement("DIV"),this._progressBar=document.createElement("DIV"),this._progressBarIndicator=document.createElement("DIV"),this._progressBarHandle=document.createElement("DIV"),this._isDragging=!1,this._startDraggingHandler=this._handleDragProgress.bind(this),this._stopDraggingHandler=this._handleStopDragProgress.bind(this),this._throttledKeyboardControl=kl((e=>{switch(e.code){case"ArrowRight":this._fastForwardVideo();break;case"ArrowLeft":this._rewindVideo()}}),100),this._videoElement=e,this._isVisible=t,this.init()}}class su{get muted(){return this._muted}get volumeLevel(){return this._volumeLevel}get preventClick(){return this._preventClick}get isVideoContent(){return this._isVideoContent}set isVideoContent(e){this._isVideoContent=e}get mediaStarted(){return this._mediaStarted}set mediaStarted(e){this._mediaStarted=e}toggleControlsFullWidth(e){const t=this._playerControls.classList;e?t.add("adthrive-full-width"):t.remove("adthrive-full-width")}showControls(){var e;if(!this._mediaStarted)return;const t=this._isVideoContent;this.toggleControlsFullWidth(t),this._controlsVisible=!0,null==(e=this._progressBar)||e.update(),this._playerControls.classList.remove("adthrive-player-ad-controls-hidden"),this._resetAutoHideControlsTimeout()}hideControls(){var e;!this._isDesktop&&!this._isVideoContent||(null==(e=this._progressBar)?void 0:e.isDragging())||(this._playerControls.classList.add("adthrive-player-ad-controls-hidden"),this._controlsVisible=!1,this._clearAutoHideControlsTimeout())}toggleProgressBar(e){this._progressBar&&(e?this._playerControls.classList.add("adthrive-player-progress-bar-visible"):this._playerControls.classList.remove("adthrive-player-progress-bar-visible"),this._progressBar.toggle(e))}setPlayButtonState(e){this._playButtonState!==e&&(this._playButtonState=e,this._setActiveButtonState(this._playButtonState))}_setPreviousVolume(e){return this._previousVolumeLevel=e,this._previousVolumeLevel}setVolume(e){return this._volumeLevel=e,this._videoElement.volume=this.volumeLevel,this._videoElement.volume}muteVolume(){this._setMuteState(!0),this.setVolume(0),this._setMuteIconToMuted(!0)}unmuteVolume(e){this._setMuteState(!1),this.setVolume(e||this._previousVolumeLevel),this._setMuteIconToMuted(!1)}_setMuteState(e){return this._muted=!!e,this._videoElement.muted=this._muted,this._videoElement.muted}enablePlayerControls(e,t,i){const{onPlay:s,onPause:r,onVolumeChange:n}=t;if(e.getElementsByClassName("adthrive-player-ad-controls").length>0)return;const a=this._playerControls;a.classList.add("adthrive-player-ad-controls","adthrive-player-ad-controls-hidden");const o=this._createPlayPauseControls(s,r);var l;(this._createVolumeIconControls(n),a.appendChild(o),a.appendChild(this._playerControlsVolumeContainer),i&&(this._progressBar=new iu(this._videoElement,(()=>this._controlsVisible)),a.appendChild(this._progressBar._container)),this._isInstream)?null==(l=this._videoElement.parentNode)||l.insertBefore(a,this._videoElement):this._adContainer.appendChild(this._playerControls);const d=this._videoElement.parentElement;d&&"embedded-stationary"!==this._playerType&&(d.addEventListener("mouseenter",this.showControls.bind(this)),d.addEventListener("mouseleave",this.hideControls.bind(this)),d.addEventListener("focusin",this.showControls.bind(this)),d.addEventListener("focusout",this.hideControls.bind(this)),d.addEventListener("touchstart",this._handleTouchStart.bind(this)),d.addEventListener("touchend",this._handleTouchEnd.bind(this))),"embedded-stationary"===this._playerType&&(this._createOverlay(),a.style.display="none")}_handleTouchStart(e){var t;if(null==(t=this._progressBar)?void 0:t.isDragging())return;const i=e.target,s=i.parentElement,r=i.querySelectorAll(`${this._adthrivePlayerIcon}-volume`);(null==r?void 0:r.length)&&r.forEach((e=>{Xi(e,this._hiddenIconClassName)})),s&&Xi(s,"active"),this._controlsVisible?this._preventClick=!1:(this._preventClick=!0,this.showControls())}_handleTouchEnd(e){const t=e.target,i=t.parentElement;t.classList.contains("adthrive-player-progress-bar-handle")||(i&&Xi(i,"active"),this._controlsVisible&&e.stopPropagation())}_createOverlay(){var e;this._overlay.className="adthrive-video-overlay";const t=document.createElement("DIV");t.tabIndex=0,t.className="adthrive-player-big-play-button",t.innerHTML="&#9658;",this._overlay.appendChild(t),null==(e=this._videoElement.parentElement)||e.appendChild(this._overlay),t.addEventListener("click",this._handleOverlayClick.bind(this)),t.addEventListener("keydown",kl((e=>{["Space","Enter"].includes(e.code)&&(e.preventDefault(),this._handleOverlayClick(),setTimeout((()=>{var e;return null==(e=this._pauseButton)?void 0:e.focus()}),100))}),100))}_handleOverlayClick(){var e,t;this._overlay.remove(),this._videoElement.play(),this._playerControls.style.display="flex",null==(e=this._videoElement.parentElement)||e.addEventListener("mouseenter",this.showControls.bind(this)),null==(t=this._videoElement.parentElement)||t.addEventListener("mouseleave",this.hideControls.bind(this));const i=this._videoElement.parentElement;i&&(i.addEventListener("mouseenter",this.showControls.bind(this)),i.addEventListener("mouseleave",this.hideControls.bind(this)),i.addEventListener("focusin",this.showControls.bind(this)),i.addEventListener("focusout",this.hideControls.bind(this)))}_createPlayPauseControls(e,t){const i=document.createElement("DIV");return i.className="adthrive-player-ad-controls-play",this._playButton=this._createPlayButton(e),this._pauseButton=this._createPauseButton(t),i.appendChild(this._playButton),i.appendChild(this._pauseButton),this._isDesktop&&(i.addEventListener("mouseenter",this._togglePlayButton.bind(this)),i.addEventListener("mouseleave",this._togglePlayButton.bind(this))),i}_resetAutoHideControlsTimeout(e=5e3){this._clearAutoHideControlsTimeout(),!this._isDesktop&&this._isVideoContent&&(this._autoHideControlsTimeout=window.setTimeout((()=>{this.hideControls()}),e))}_clearAutoHideControlsTimeout(){this._autoHideControlsTimeout&&(clearTimeout(this._autoHideControlsTimeout),this._autoHideControlsTimeout=void 0)}_setActiveButtonState(e){const t=document.getElementById(`${this._adthrivePlayerIcon}-${e}-${this._playerType}`);let i=null;i="pause"===e?t&&t.previousSibling:t&&t.nextSibling,null==t||t.classList.remove(this._hiddenIconClassName),null==i||i.classList.add(this._hiddenIconClassName)}_createPlayButton(e){const t=document.createElement("DIV");t.classList.add(`${this._adthrivePlayerIcon}`,`${this._adthrivePlayerIcon}-play`),"pause"===this._playButtonState&&t.classList.add(this._hiddenIconClassName),t.id=`${this._adthrivePlayerIcon}-play-${this._playerType}`,t.tabIndex=0;const i=this._createSvg("white",!1);return i.appendChild(this._createPolygon("white","2.29,0 2.29,18 15.71,9")),t.appendChild(i),t.addEventListener("click",e),t.addEventListener("keydown",kl((t=>{["Space","Enter"].includes(t.code)&&(t.preventDefault(),e(t),setTimeout((()=>{var e;return null==(e=this._pauseButton)?void 0:e.focus()}),100))}),100)),t}_createPauseButton(e){const t=document.createElement("DIV");t.classList.add(`${this._adthrivePlayerIcon}`,`${this._adthrivePlayerIcon}-pause`),"play"===this._playButtonState&&t.classList.add(this._hiddenIconClassName),t.id=`${this._adthrivePlayerIcon}-pause-${this._playerType}`,t.tabIndex=0;const i=this._createSvg("white",!1);return i.appendChild(this._createRect("white","5","18","2.29")),i.appendChild(this._createRect("white","5","18","10.71")),t.addEventListener("click",e),t.addEventListener("keydown",kl((t=>{["Space","Enter"].includes(t.code)&&(t.preventDefault(),e(t),setTimeout((()=>{var e;return null==(e=this._playButton)?void 0:e.focus()}),100))}),100)),t.appendChild(i),t}_appendVolumeSlider(e){const t=this._createVolumeSlider(e);this._playerControlsVolumeContainer.classList.add("adthrive-player-ad-controls-volume-container-with-slider"),this._playerControlsVolumeIcon.appendChild(t)}_createVolumeIconControls(e){this._playerControlsVolumeContainer.className="adthrive-player-ad-controls-volume-container",this._playerControlsVolumeIcon.className="adthrive-player-ad-controls-volume",this._createVolumeMutedButton(e),this._createVolumeUnMutedButton(e),this._playerControlsVolumeIcon.appendChild(this._muteButton),this._playerControlsVolumeIcon.appendChild(this._unmuteButton),this._playerControlsVolumeContainer.appendChild(this._playerControlsVolumeIcon),this._isDesktop&&this._appendVolumeSlider(e)}_createVolumeMutedButton(e){this._muteButton.tabIndex=0,this._muteButton.classList.add(`${this._adthrivePlayerIcon}`,`${this._adthrivePlayerIcon}-volume`,`${this._adthrivePlayerIcon}-volume-muted`),this.muted||this._muteButton.classList.add(this._hiddenIconClassName);const t=this._createSvg("white",!1);t.appendChild(this._createPath("white","M16.45,9.02c0,1.64-0.57,2.97-1.33,4.03l1.2,1.15C17.29,12.94,18,11.26,18,9.04c0-6.95-6.96-8.7-6.96-8.7v1.32C11.04,1.66,16.45,3.96,16.45,9.02z")),t.appendChild(this._createPath("white","M13.27,14.94c-1.18,0.91-2.23,1.33-2.23,1.33v1.44c0,0,1.68-0.42,3.39-1.67L13.27,14.94z")),t.appendChild(this._createRect("white","1.71","22.61","8.15","-2.28","matrix(0.6917 -0.7222 0.7222 0.6917 -3.7421 9.2833)")),t.appendChild(this._createPath("white","M12.98,11c0.31-0.55,0.52-1.2,0.52-1.98c0-2.95-2.99-4.24-2.99-4.24v3.86L12.98,11z")),t.appendChild(this._createPath("white","M10.52,12.3v0.86c0,0,0.24-0.1,0.58-0.3L10.52,12.3z")),t.appendChild(this._createPolygon("white","9.21,7.4 9.24,0.74 5.82,4.15")),t.appendChild(this._createPolygon("white","3.69,5.77 0.06,5.77 0,12.07 4.14,12.07 9.18,17.11 9.2,11.04")),this._muteButton.addEventListener("click",(()=>this._toggleVolume(e))),this._muteButton.addEventListener("keydown",kl((t=>{["Space","Enter"].includes(t.code)&&(t.preventDefault(),this._toggleVolume(e),setTimeout((()=>{var e;return null==(e=this._unmuteButton)?void 0:e.focus()}),100))}),100)),this._muteButton.appendChild(t)}_createVolumeUnMutedButton(e){this._unmuteButton.tabIndex=0,this._unmuteButton.classList.add(`${this._adthrivePlayerIcon}`,`${this._adthrivePlayerIcon}-volume`,`${this._adthrivePlayerIcon}-volume-unmuted`),this.muted&&this._unmuteButton.classList.add(this._hiddenIconClassName);const t=this._createSvg("white",!1);t.appendChild(this._createPolygon("white","9.18,17.11 4.14,12.07 0,12.07 0.06,5.77 4.2,5.77 9.24,0.74")),t.appendChild(this._createPath("white","M11.04,0.34c0,0,6.96,1.75,6.96,8.7s-6.96,8.67-6.96,8.67v-1.44c0,0,5.42-2.18,5.42-7.25s-5.42-7.37-5.42-7.37V0.34z")),t.appendChild(this._createPath("white","M10.52,4.79c0,0,2.99,1.28,2.99,4.24s-2.99,4.14-2.99,4.14V4.79z")),this._unmuteButton.addEventListener("click",(()=>this._toggleVolume(e))),this._unmuteButton.addEventListener("keydown",kl((t=>{["Space","Enter"].includes(t.code)&&(t.preventDefault(),this._toggleVolume(e),setTimeout((()=>{var e;return null==(e=this._muteButton)?void 0:e.focus()}),100))}),100)),this._unmuteButton.appendChild(t)}_setInitialVolume(e){const t=this._isDesktop?.5:.8,i=e?t:0,s=!e;this._setPreviousVolume(t),this.setVolume(i),this._setSliderRange(),this._setMuteState(s)}_setSliderRange(){this._volumeSlider.value=""+100*this.volumeLevel}_createVolumeSlider(e){const t=document.createElement("DIV");t.tabIndex=0,t.className="adthrive-player-volume-control",t.id=`adthrive-${this._playerType}-volume-control`;const i=this._volumeSlider;return i.setAttribute("type","range"),i.setAttribute("min","0"),i.setAttribute("max","100"),i.setAttribute("step","1"),i.tabIndex=-1,i.addEventListener("mouseup",(t=>this._volumeChange(t,e)),!1),t.appendChild(i),t.addEventListener("keydown",(t=>{["Space","Enter","ArrowLeft","ArrowRight"].includes(t.code)&&t.preventDefault(),kl((()=>{if("ArrowRight"===t.code){var s,r;if(i.value=`${Math.min(Number(i.value)+5,100)}`,this.muted)this._setMuteState(!1),null==(s=this._muteButton)||s.classList.add(this._hiddenIconClassName),null==(r=this._unmuteButton)||r.classList.remove(this._hiddenIconClassName);const t=Number(i.value)/100;this.setVolume(t),this._setSliderRange(),e()}if("ArrowLeft"===t.code){var n,a;if(i.value=`${Math.max(Number(i.value)-5,0)}`,!this.muted&&"0"===i.value)this._setMuteState(!0),null==(n=this._unmuteButton)||n.classList.add(this._hiddenIconClassName),null==(a=this._muteButton)||a.classList.remove(this._hiddenIconClassName);const t=Number(i.value)/100;this.setVolume(t),this._setSliderRange(),e()}}),100)()})),t}_setMuteIconToMuted(e=!0){e?(this._unmuteButton.classList.add(this._hiddenIconClassName),this._muteButton.classList.remove(this._hiddenIconClassName)):(this._muteButton.classList.add(this._hiddenIconClassName),this._unmuteButton.classList.remove(this._hiddenIconClassName))}_volumeChange(e,t){if(this.preventClick)return;const i=e.target,s=this.volumeLevel,r=Number(i.value)/100,n=0===r,a=this.muted&&r>0;n?this.muteVolume():a?this.unmuteVolume(r):this.setVolume(r),this._setPreviousVolume(s),this._setSliderRange(),t()}_toggleVolume(e){this.preventClick||(this.muted?this.unmuteVolume():(this._setPreviousVolume(this.volumeLevel),this.muteVolume()),this._setSliderRange(),e())}_togglePlayButton(e){const t=e.target;t&&Xi(t,"active")}_createPath(e,t){const i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",t),i.setAttribute("fill",e),i}_createPolygon(e,t){const i=document.createElementNS("http://www.w3.org/2000/svg","polygon");return i.setAttribute("points",t),i.setAttribute("fill",e),i}_createRect(e,t,i,s,r,n){const a=document.createElementNS("http://www.w3.org/2000/svg","rect");return a.setAttribute("x",s),a.setAttribute("height",i),a.setAttribute("width",t),a.setAttribute("fill",e),r&&a.setAttribute("y",r),n&&a.setAttribute("transform",n),a}_createSvg(e,t){const i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("focusable",`${t}`),i.setAttribute("width","18"),i.setAttribute("height","18"),i.setAttribute("viewBox","0 0 18 18"),i.setAttribute("fill",e),i}constructor(e,t,i,s,r,n){this._playerControls=document.createElement("DIV"),this._isInstream=!1,this._isDesktop=!1,this._mediaStarted=!1,this._progressBar=null,this._playButtonState="pause",this._muted=!0,this._muteButton=document.createElement("DIV"),this._unmuteButton=document.createElement("DIV"),this._playerControlsVolumeContainer=document.createElement("DIV"),this._playerControlsVolumeIcon=document.createElement("DIV"),this._previousVolumeLevel=.5,this._volumeSlider=document.createElement("INPUT"),this._volumeLevel=0,this._adthrivePlayerIcon="adthrive-player-icon",this._hiddenIconClassName="adthrive-hidden",this._overlay=document.createElement("DIV"),this._preventClick=!1,this._playButton=null,this._pauseButton=null,this._controlsVisible=!0,this._adContainer=t,this._isInstream=s,this._playerType=i,this._videoElement=e,this._isVideoContent=n,this._isDesktop=r;const a="embedded-stationary"===i;this._playButtonState=a?"play":"pause",this._controlsVisible=!a,this._setInitialVolume(a)}}var ru,nu,au,ou,lu;su=B([hs("VideoPlayerControls"),j("design:type",Function),j("design:paramtypes",["undefined"==typeof HTMLVideoElement?Object:HTMLVideoElement,"undefined"==typeof HTMLElement?Object:HTMLElement,String,Boolean,Boolean,Boolean])],su),function(e){e.ABORT="abort",e.CAN_PLAY="canplay",e.CAN_PLAY_THROUGH="canplaythrough",e.DURATION_CHANGE="durationchange",e.EMPTIED="emptied",e.ENDED="ended",e.ERROR="error",e.LOADED_DATA="loadeddata",e.LOADED_METADATA="loadedmetadata",e.LOAD_START="loadstart",e.PAUSE="pause",e.PLAY="play",e.PLAYING="playing",e.PROGRESS="progress",e.RATE_CHANGE="ratechange",e.SEEKED="seeked",e.SEEKING="seeking",e.STALLED="stalled",e.SUSPEND="suspend",e.TIME_UPDATE="timeupdate",e.VOLUME_CHANGE="volumechange",e.WAITING="waiting"}(ru||(ru={})),function(e){e.AD_BREAK_READY="adBreakReady",e.AD_BUFFERING="adBuffering",e.AD_ERROR="adError",e.AD_CAN_PLAY="adCanPlay",e.ADS_MANAGER_LOADED="adsManagerLoaded",e.AD_METADATA="adMetadata",e.AD_PROGRESS="adProgress",e.ALL_ADS_COMPLETED="allAdsCompleted",e.CLICK="click",e.COMPLETE="complete",e.CONTENT_PAUSE_REQUESTED="contentPauseRequested",e.CONTENT_RESUME_REQUESTED="contentResumeRequested",e.DURATION_CHANGE="durationChange",e.EXPANDED_CHANGED="expandedChanged",e.FIRST_QUARTILE="firstQuartile",e.IMPRESSION="impression",e.INTERACTION="interaction",e.LINEAR_CHANGED="linearChanged",e.LOADED="loaded",e.LOG="log",e.MIDPOINT="midpoint",e.PAUSED="pause",e.RESUMED="resume",e.SKIPPABLE_STATE_CHANGED="skippableStateChanged",e.SKIPPED="skip",e.STARTED="start",e.THIRD_QUARTILE="thirdQuartile",e.USER_CLOSE="userClose",e.VIDEO_CLICKED="videoClicked",e.VIDEO_ICON_CLICKED="videoIconClicked",e.VIEWABLE_IMPRESSION="viewable_impression",e.VOLUME_CHANGED="volumeChange",e.VOLUME_MUTED="mute"}(nu||(nu={})),function(e){e.AutoInjected="auto-injected",e.EmbeddedStationary="embedded-stationary",e.Outstream="outstream",e.Playlist="playlist",e.Related="related",e.RelatedSticky="related-sticky",e.StickyOutstream="stickyoutstream"}(au||(au={})),function(e){e.AD_LOAD="adLoadError",e.AD_PLAY="adPlayError"}(ou||(ou={})),function(e){e[e.ADSLOT_NOT_VISIBLE=-1]="ADSLOT_NOT_VISIBLE",e[e.ADS_REQUEST_NETWORK_ERROR=1012]="ADS_REQUEST_NETWORK_ERROR",e[e.ASSET_FALLBACK_FAILED=1021]="ASSET_FALLBACK_FAILED",e[e.AUTOPLAY_DISALLOWED=1205]="AUTOPLAY_DISALLOWED",e[e.COMPANION_AD_LOADING_FAILED=-1]="COMPANION_AD_LOADING_FAILED",e[e.COMPANION_REQUIRED_ERROR=602]="COMPANION_REQUIRED_ERROR",e[e.CONSENT_MANAGEMENT_PROVIDER_NOT_READY=1300]="CONSENT_MANAGEMENT_PROVIDER_NOT_READY",e[e.DEPRECATED_ERROR_CODE=-1]="DEPRECATED_ERROR_CODE",e[e.FAILED_TO_REQUEST_ADS=1005]="FAILED_TO_REQUEST_ADS",e[e.INVALID_AD_TAG=1013]="INVALID_AD_TAG",e[e.INVALID_ARGUMENTS=1101]="INVALID_ARGUMENTS",e[e.NATIVE_MESSAGE_ERROR=1204]="NATIVE_MESSAGE_ERROR",e[e.NONLINEAR_DIMENSIONS_ERROR=501]="NONLINEAR_DIMENSIONS_ERROR",e[e.OVERLAY_AD_LOADING_FAILED=-1]="OVERLAY_AD_LOADING_FAILED",e[e.OVERLAY_AD_PLAYING_FAILED=500]="OVERLAY_AD_PLAYING_FAILED",e[e.Rh=2002]="Rh",e[e.STREAM_INITIALIZATION_FAILED=1020]="STREAM_INITIALIZATION_FAILED",e[e.UNKNOWN_AD_RESPONSE=1010]="UNKNOWN_AD_RESPONSE",e[e.UNKNOWN_ERROR=900]="UNKNOWN_ERROR",e[e.UNSUPPORTED_LOCALE=1011]="UNSUPPORTED_LOCALE",e[e.VAST_ASSET_NOT_FOUND=1007]="VAST_ASSET_NOT_FOUND",e[e.VAST_EMPTY_RESPONSE=1009]="VAST_EMPTY_RESPONSE",e[e.VAST_LINEAR_ASSET_MISMATCH=403]="VAST_LINEAR_ASSET_MISMATCH",e[e.VAST_LOAD_TIMEOUT=301]="VAST_LOAD_TIMEOUT",e[e.VAST_MALFORMED_RESPONSE=-1]="VAST_MALFORMED_RESPONSE",e[e.VAST_MEDIA_ERROR=-1]="VAST_MEDIA_ERROR",e[e.VAST_MEDIA_LOAD_TIMEOUT=402]="VAST_MEDIA_LOAD_TIMEOUT",e[e.VAST_NONLINEAR_ASSET_MISMATCH=503]="VAST_NONLINEAR_ASSET_MISMATCH",e[e.VAST_NO_ADS_AFTER_WRAPPER=303]="VAST_NO_ADS_AFTER_WRAPPER",e[e.VAST_PROBLEM_DISPLAYING_MEDIA_FILE=405]="VAST_PROBLEM_DISPLAYING_MEDIA_FILE",e[e.VAST_SCHEMA_VALIDATION_ERROR=101]="VAST_SCHEMA_VALIDATION_ERROR",e[e.VAST_TOO_MANY_REDIRECTS=302]="VAST_TOO_MANY_REDIRECTS",e[e.VAST_TRAFFICKING_ERROR=200]="VAST_TRAFFICKING_ERROR",e[e.VAST_UNEXPECTED_DURATION_ERROR=202]="VAST_UNEXPECTED_DURATION_ERROR",e[e.VAST_UNEXPECTED_LINEARITY=201]="VAST_UNEXPECTED_LINEARITY",e[e.VAST_UNSUPPORTED_VERSION=102]="VAST_UNSUPPORTED_VERSION",e[e.VAST_WRAPPER_ERROR=300]="VAST_WRAPPER_ERROR",e[e.VIDEO_ELEMENT_REQUIRED=-1]="VIDEO_ELEMENT_REQUIRED",e[e.VIDEO_ELEMENT_USED=-1]="VIDEO_ELEMENT_USED",e[e.VIDEO_PLAY_ERROR=400]="VIDEO_PLAY_ERROR",e[e.VPAID_ERROR=901]="VPAID_ERROR"}(lu||(lu={}));class du extends Cs{_setupVideoPlayerControls(){return this._adReady.on((()=>{this._adPlayReady=!0})),new su(this._videoElement,this._adContainer,this._playerType,this._isInstream,this._isDesktop,this.isVideoContent)}attachEventHandlers(e){for(const t of e)this.addEventHandler(t.target,t.event,t.handler)}addEventHandler(e,t,i){const s=i.bind(this),r=this.getHandlerKey(e,t);this._boundHandlers.set(r,s),e.addEventListener(t,s,!1)}getHandlerKey(e,t){return`${e.constructor.name}_${t}`}removeEventHandler(e,t){const i=this.getHandlerKey(e,t),s=this._boundHandlers.get(i);s&&(e.removeEventListener(t,s,!1),this._boundHandlers.delete(i))}detachEventHandlers(e){for(const t of e)this.removeEventHandler(t.target,t.event)}get imaVersion(){return window.google.ima.VERSION}async init(){await this._importIMAScript();(this._ima=window.google&&window.google.ima)?(this.injectPlayer(),this._addSlickDialogListener()):te.error("VideoPlayer","init",this._playerType,"Failed to initialize player. IMA is not defined.")}injectPlayer(){this._injectPlayer(),this.ready.emit()}_setPlayButtonState(){const e=this._isAdActive&&"playing"===this.state||this.isVideoContent&&"playing"===this.videoContentState,t=this._isAdActive&&"paused"===this.state,i=this.isVideoContent&&"paused"===this.videoContentState,s=t||i;e?this._videoPlayerControls.setPlayButtonState("pause"):s&&this._videoPlayerControls.setPlayButtonState("play")}_play(e){this._isAdActive=!1,this.isVideoContent=!0,this._videoPlayerControls.isVideoContent=!0,this.videoContentState="playing",this._setPlayButtonState(),this.play.emit(e)}_interact(e){e instanceof MouseEvent&&"click"!==e.type||e instanceof KeyboardEvent&&!["Space","Enter","ArrowLeft","ArrowRight"].includes(e.code)||this.interact.emit(e)}_playerClick(e){this.isVideoContent&&!this._videoPlayerControls.preventClick&&("playing"===this.videoContentState?this._pauseVideoPlayer(e):"paused"===this.videoContentState&&this._playVideoPlayer(),this._setPlayButtonState(),this.click.emit(e))}_playerVolumeChange(e){this.playerVolumeChange.emit(e)}_loadedMetaData(e){this.loadedMetaData.emit(e)}_pause(e){this.videoContentState="paused",this._setPlayButtonState(),this.pause.emit(e)}_error(e){this.error.emit(e)}_seeking(e){this.seeking.emit(e)}_seeked(e){this.seeked.emit(e)}_ended(e){this.videoContentState="ended",this.ended.emit(e)}_timeupdate(e){this.timeupdate.emit(e)}playAd(e){const t=this._adsLoader,i=this._adsRequest,s=this.size,{adResponse:r,adTagUrl:n}=e;i.linearAdSlotWidth=s[0],i.linearAdSlotHeight=s[1],i.nonLinearAdSlotWidth=s[0],i.nonLinearAdSlotHeight=s[1],i.vastLoadTimeout=this._config.video.vastTimeoutOSV,r&&(i.adsResponse=r),n&&(i.adTagUrl=n),this.attachEventHandlers([{target:t,event:nu.ADS_MANAGER_LOADED,handler:this._adsManagerLoaded},{target:t,event:nu.AD_ERROR,handler:this._adError}]),t.requestAds(i),this._requestTimer=window.setTimeout((()=>this._adError({error:{data:{errorCode:-1,errorMessage:"Adloader failed to request ads: unknown error",type:"error"}}})),2e4)}playAdInStream(){var e,t;null==(e=this._adsManager)||e.setVolume(this._videoPlayerControls.volumeLevel),null==(t=this._adsManager)||t.start()}requestAd(e){const t=this._adsRequest,i=this.size,{adResponse:s,adTagUrl:r}=e;t.linearAdSlotWidth=i[0],t.linearAdSlotHeight=i[1],t.nonLinearAdSlotWidth=i[0],t.nonLinearAdSlotHeight=i[1],t.vastLoadTimeout=this._config.video.vastTimeoutISV,s&&(t.adsResponse=s),r&&(t.adTagUrl=r),this.attachEventHandlers([{target:this._adsLoader,event:nu.ADS_MANAGER_LOADED,handler:this._adsManagerLoaded},{target:this._adsLoader,event:nu.AD_ERROR,handler:this._adError}]),this._adsLoader.requestAds(t)}_adComplete(e){this._isAdActive=!1;const t=this._getAdRenderDetails(e);this.adCompleted.emit(t)}_adError(e){this._clearLoadTimers();const t=e&&e.error&&e.error.data,i=t?{code:t.errorCode,message:t.errorMessage,type:t.type}:{};this.adError.emit(i)}_adImpression(e){const t=this._getAdRenderDetails(e);this.adImpression.emit(t)}_adLoaded(e){if(this._isInstream){var t;null==(t=this._adsManager)||t.setVolume(this._videoPlayerControls.volumeLevel)}else{var i;null==(i=this._adsManager)||i.setVolume(0),this._videoPlayerControls.muteVolume();const e={onPlay:this._playAd.bind(this),onPause:this._pauseAd.bind(this),onMute:this._onMuteButtonClick.bind(this,"mute","ad"),onUnmute:this._onMuteButtonClick.bind(this,"unmute","ad"),onVolumeChange:this._onVolumeChange.bind(this)};this._videoPlayerControls.enablePlayerControls(this._container,e,!1)}const s=this._getAdRenderDetails(e);this.adLoaded.emit(s),document.hidden&&this._pauseAd()}_adStarted(e){if(this._isInstream&&!this._adPlayReady)return this._prematureAdPlay=!0,void this._pauseAd();const t=this._getAdRenderDetails(e);var i,s;(this.adStarted.emit(t),this.state="playing",this._isAdActive=!0,this.isVideoContent=!1,this._videoPlayerControls.isVideoContent=!1,this._setPlayButtonState(),this._isInstream)?null==(i=this._adsManager)||i.setVolume(this._videoPlayerControls.volumeLevel):(this._container.classList.remove("adthrive-player-idle"),this._container.classList.add("adthrive-player-playing"),null==(s=this._adsManager)||s.setVolume(0))}_adProgress(e){const t=e.getAdData();t&&this.adProgress.emit({duration:t.duration,position:t.currentTime})}_allAdsComplete(e){const t=this._getAdRenderDetails(e);this.allAdsCompleted.emit(t)}_adSkipped(e){const t=this._getAdRenderDetails(e);this.adSkipped.emit(t)}_click(e){const t=this._getAdRenderDetails(e);this.adClick.emit(t)}_contentPauseRequested(e){const t=this._getAdRenderDetails(e);this.contentPauseRequested.emit(t)}_contentResumeRequested(e){const t=this._getAdRenderDetails(e);this.contentResumeRequested.emit(t)}_firstQuartile(e){const t=this._getAdRenderDetails(e);this.adFirstQuartile.emit(t)}handlePageVisibilityChange(e){"playing"===this.state&&e?this._pauseAd():"paused"!==this.state||e||this._userPaused||this._playAd()}_midpoint(e){const t=this._getAdRenderDetails(e);this.adMidpoint.emit(t)}_paused(e){if("paused"===this.state)return;const t=this._getAdRenderDetails(e);this.adPause.emit(t),this.state="paused",this._setPlayButtonState()}_resumed(e){const t=this._getAdRenderDetails(e);this.adPlay.emit(t),this.state="playing",this._userPaused=!1,this._setPlayButtonState()}_thirdQuartile(e){const t=this._getAdRenderDetails(e);this.adThirdQuartile.emit(t)}_pauseAd(e){var t;this._videoPlayerControls.preventClick||(e&&(this._userPaused=!0),"paused"!==this.state&&(null==(t=this._adsManager)||t.pause()),this.userInteraction.emit({action:"pause",context:"ad"}))}_pauseVideoPlayer(e){if(this._videoPlayerControls.preventClick)return;e&&(this._userPaused=!0);let t="";if(this._isInstream&&this.isVideoContent&&"paused"!==this.videoContentState)this._videoElement.pause(),t="content";else if("paused"!==this.state){var i;null==(i=this._adsManager)||i.pause(),t="ad"}this.userInteraction.emit({action:"pause",context:t})}_playAd(){if(!this._videoPlayerControls.preventClick){var e;if("playing"!==this.state)null==(e=this._adsManager)||e.resume();this.userInteraction.emit({action:"play",context:"ad"})}}_playVideoPlayer(){if(this._videoPlayerControls.preventClick)return;const e=this.isFirstPlay&&"embedded-stationary"===this._playerType&&!this._isAdActive;let t="";if(this._isInstream&&"playing"!==this.videoContentState&&(e||this.isVideoContent))this._userPaused=!1,this._videoElement.play(),t="content";else if("playing"!==this.state){var i;this._userPaused=!1,null==(i=this._adsManager)||i.resume(),t="ad"}this.userInteraction.emit({action:"play",context:t})}_onMuteButtonClick(e,t=""){this._videoPlayerControls.preventClick||(this._isInstream&&this.userInteraction.emit({action:e,context:t,details:{vol:this._videoPlayerControls.volumeLevel}}),this._onVolumeChange(!1))}_onVolumeChange(e=!0){const t=this.isVideoContent&&"content",i=this._isAdActive&&"ad",s=t||i||"";var r;this.isVideoContent||(null==(r=this._adsManager)||r.setVolume(this._videoPlayerControls.volumeLevel));this.isVideoContent&&this._videoPlayerControls.setVolume(this._videoPlayerControls.volumeLevel),e&&this._isInstream&&this.userInteraction.emit({action:"volume",context:s,details:{vol:this._videoPlayerControls.volumeLevel}})}_remove(e=!1){var t,i;!this._isInstream||e?(this._removePlayer(),this._removeAdsLoaderEvents(),null==(t=this._adsLoader)||t.destroy(),null==(i=this._adDisplayContainer)||i.destroy(),this._adsLoader=void 0,this._adDisplayContainer=void 0,e&&this._resetPlayerReferences()):this._adsLoader&&this._removeAdsLoaderEvents();this.state="idle",this._adsManager&&(this._adsManager.destroy(),this._adsManager=void 0)}_resetPlayerReferences(){this._adContainer=document.createElement("DIV"),this._container=document.createElement("DIV"),this._playerPosition=document.createElement("DIV"),this._videoElement=document.createElement("VIDEO"),this._videoDescriptionDiv=document.createElement("DIV"),this._videoTitleDiv=document.createElement("DIV"),this._videoTitleOverlayContainer=document.createElement("DIV"),this._videoPlayerControls=this._setupVideoPlayerControls()}_volume(e){const t=this._getAdRenderDetails(e);this.volume.emit(t)}_adsManagerLoaded(e){this._clearLoadTimers();const t=this._ima,i=new t.AdsRenderingSettings;i.bitrate=this._config.video.maxBitrate,i.restoreCustomPlaybackStateOnAdBreakComplete=!0,i.enablePreloading=this._config.video.enablePreloading,i.loadVideoTimeout=this._config.video.loadVideoTimeout;const s=this.size,r=this._adsManager=e.getAdsManager(this._videoElement,i);this._setAdsManagerEvents();try{const e=this._isInstream?this._adContainer.clientWidth:s[0],i=this._isInstream?this._adContainer.clientHeight:s[1];r.init(e,i,t.ViewMode.NORMAL),this._isInstream||r.start(),this.adsManagerLoaded.emit()}catch(e){te.error("VideoPlayer","_adsManagerLoaded",this._playerType,e)}}_importIMAScript(){if(window.google&&window.google.ima)return new Promise((e=>{e(!0)}));const e=this._imaLibraryEnpoint;return vi(e,!1,!1,!0)}_injectPlayer(){this._remove();const e=this._container,t=this._videoElement,i=this._playerPosition,s=this._adContainer,r=this._ima,n=this._playerType,a=this.size,o=n===au.Outstream||n===au.StickyOutstream,l=this._videoContentSource;if(e.id=`adthrive-${n}-container`,s.id=`adthrive-${n}-ad-container`,s.className="adthrive-player-ad-container",o&&(this._pageElement.classList.add("adthrive-video-stickyoutstream-new-player"),e.className=`adthrive-${n}-container adthrive-player-idle`,e.style.width=`${a[0]}px`,e.style.height=`${a[1]}px`,t.style.width=`${a[0]}px`,t.style.height=`${a[1]}px`,s.style.width=`${a[0]}px`,s.style.height=`${a[1]}px`,e.appendChild(t),e.appendChild(s),t.load()),this._isInstream){this._initVideoListeners(),e.className=`adthrive-${n}-player-container`,this._playerType===au.AutoInjected&&e.classList.add("adthrive-collapse-player"),i.classList.add("raptive-player-position"),this._config.video.removeVideoTitleWrapper||this._createTitleOverlayContainer(),s.classList.add("raptive-player-ad","raptive-player-ad-container-idle"),t.classList.add("raptive-player-video"),this._playerContainer.classList.add("raptive-player-container","raptive-player-reset"),this._isMobile&&this._playerContainer.classList.add("raptive-player-container-mobile"),this._playerContainer.appendChild(t),this._playerContainer.appendChild(s),i.appendChild(this._playerContainer),e.appendChild(i),s.style.width="100%",s.style.height="100%";const r={onPlay:this._playVideoPlayer.bind(this),onPause:this._pauseVideoPlayer.bind(this),onMute:this._onMuteButtonClick.bind(this,"mute","content"),onUnmute:this._onMuteButtonClick.bind(this,"unmute","content"),onVolumeChange:this._onVolumeChange.bind(this)};this._videoPlayerControls.enablePlayerControls(this._playerContainer,r,!0),this._visibilityListener=this._eventProxy.pageVisibility.on(this.handlePageVisibilityChange.bind(this))}t.setAttribute("webkit-playsinline","true"),t.setAttribute("playsinline","true"),t.setAttribute("disablePictureInPicture","true"),l&&(t.src=l),this._pageElement.appendChild(e),window.google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0);const d=this._adDisplayContainer=new r.AdDisplayContainer(s,t);d.initialize();const c=(this._adsLoader=new r.AdsLoader(d)).getSettings();c.setNumRedirects(this._config.video.maxRedirect),c.setVpaidMode(r.ImaSdkSettings.VpaidMode.ENABLED),c.setVpaidMode(r.ImaSdkSettings.VpaidMode.INSECURE);const h=this._adsRequest=new r.AdsRequest;this._autoplay&&(this._videoPlayerControls.muteVolume(),h.setAdWillAutoPlay(!0),h.setAdWillPlayMuted(!0))}_createTitleOverlayContainer(){const e=this._playerType===au.AutoInjected;this._videoTitleOverlayContainer.classList.add("adthrive-title-overlay");const t=document.createElement("div");t.classList.add("adthrive-video-title-description-container","adthrive-video-text-cutoff"),this._videoTitleDiv.id="adthrive-video-title-text",this._videoDescriptionDiv.id="adthrive-video-description-text",t.appendChild(this._videoTitleDiv),this._isMobile||t.appendChild(this._videoDescriptionDiv),e?(this._wrapperTitleWrapperElement=document.createElement("a"),this._wrapperTitleWrapperElement.classList.add("adthrive-wrapper-title-wrapper"),this._wrapperTitleWrapperElement.appendChild(t),this._videoTitleOverlayContainer.appendChild(this._wrapperTitleWrapperElement)):this._videoTitleOverlayContainer.appendChild(t),this._playerContainer.appendChild(this._videoTitleOverlayContainer)}_initVideoListeners(){this.attachEventHandlers([{target:this._videoElement,event:"ended",handler:this._ended},{target:this._videoElement,event:"error",handler:this._error},{target:this._videoElement,event:"seeking",handler:this._seeking},{target:this._videoElement,event:"seeked",handler:this._seeked},{target:this._videoElement,event:"loadedmetadata",handler:this._loadedMetaData},{target:this._videoElement,event:"pause",handler:this._pause},{target:this._videoElement,event:"play",handler:this._play},{target:this._videoElement,event:"click",handler:this._playerClick.bind(this)},{target:this._videoElement,event:"volumechange",handler:this._playerVolumeChange},{target:this._videoElement,event:"timeupdate",handler:this._timeupdate},{target:this._container,event:"click",handler:this._interact},{target:this._container,event:"keyup",handler:this._interact}])}reInitIMA(){const e=this._ima,t=this._adsRequest=new e.AdsRequest;this._autoplay&&(t.setAdWillAutoPlay(!0),t.setAdWillPlayMuted(!0))}_getAdRenderDetails(e){const t=this._adsRequest,i=t.adTagUrl,s=t.adsResponse;let r;if(e&&e.getAd){const t=e.getAd(),i=Object.keys(t)||[];r=t&&i.length&&t[i[0]]}const n=e&&Object.keys(e)||[];return r=r||n.reduce(((t,i)=>{if(!e[i]||"object"!=typeof e[i]||Array.isArray(e[i]))return;const s=Object.keys(e[i]);s&&s.length&&e[i][s[0]]}),{}),{ad:r,userRequestContext:{...i&&{adTagUrl:i},...s&&{vastXml:s}}}}_removeAdsLoaderEvents(){this._isInstream&&this.detachEventHandlers([{target:this._adsLoader,event:nu.ADS_MANAGER_LOADED,handler:this._adsManagerLoaded},{target:this._adsLoader,event:nu.AD_ERROR,handler:this._adError}]),this._visibilityListener&&this._visibilityListener()}_removePlayer(){const e=this._container;e&&e.parentElement&&e.parentElement.removeChild(e)}_setAdsManagerEvents(){this.attachEventHandlers([{target:this._adsManager,event:nu.AD_ERROR,handler:this._adError},{target:this._adsManager,event:nu.ALL_ADS_COMPLETED,handler:this._allAdsComplete},{target:this._adsManager,event:nu.CLICK,handler:this._click},{target:this._adsManager,event:nu.COMPLETE,handler:this._adComplete},{target:this._adsManager,event:nu.CONTENT_PAUSE_REQUESTED,handler:this._contentPauseRequested},{target:this._adsManager,event:nu.CONTENT_RESUME_REQUESTED,handler:this._contentResumeRequested},{target:this._adsManager,event:nu.FIRST_QUARTILE,handler:this._firstQuartile},{target:this._adsManager,event:nu.IMPRESSION,handler:this._adImpression},{target:this._adsManager,event:nu.LOADED,handler:this._adLoaded},{target:this._adsManager,event:nu.MIDPOINT,handler:this._midpoint},{target:this._adsManager,event:nu.PAUSED,handler:this._paused},{target:this._adsManager,event:nu.RESUMED,handler:this._resumed},{target:this._adsManager,event:nu.STARTED,handler:this._adStarted},{target:this._adsManager,event:nu.THIRD_QUARTILE,handler:this._thirdQuartile},{target:this._adsManager,event:nu.VOLUME_CHANGED,handler:this._volume},{target:this._adsManager,event:nu.AD_PROGRESS,handler:this._adProgress},{target:this._adsManager,event:nu.SKIPPED,handler:this._adSkipped}])}trimEventData(e){var t,i;const s={...e},r=s.ima&&s.ima.ad;return(null==s?void 0:s.tag)&&delete s.tag,r&&r.traffickingParameters&&delete r.traffickingParameters,(null==s||null==(i=s.ima)||null==(t=i.userRequestContext)?void 0:t.adTagUrl)&&delete s.ima.userRequestContext.adTagUrl,(null==s?void 0:s.mediaFile)&&delete s.mediaFile,s}_addSlickDialogListener(){document.addEventListener("slick-auth-dialog-opened",(()=>{var e;"paused"!==this.state&&(null==(e=this._adsManager)||e.pause())})),document.addEventListener("slick-auth-dialog-closed",(()=>{this._userPaused||this._playAd()}))}_clearLoadTimers(){this._requestTimer&&(clearTimeout(this._requestTimer),this._requestTimer=null)}constructor(e,t,i,s,r,n,a,o){super(),this._playerId=e,this._playlistId=t,this._playerType=i,this._pageElement=s,this.size=r,this._config=n,this._eventProxy=a,this._autoplay=o,this.adClick=new Q,this.adError=new Q,this.adCompleted=new Q,this.adFirstQuartile=new Q,this.adImpression=new Q,this.adLoaded=new Q,this.adMidpoint=new Q,this.adRequest=new Q,this.adPause=new Q,this.adPlay=new Q,this.adSkipped=new Q,this.adStarted=new Q,this.adThirdQuartile=new Q,this.adProgress=new Q,this.adsManagerLoaded=new Q,this.adViewableImpression=new Q,this.allAdsCompleted=new Q,this.contentPauseRequested=new Q,this.contentResumeRequested=new Q,this.error=new Q,this.seeking=new Q,this.seeked=new Q,this.firstFrame=new Q,this.fullscreen=new Q,this.isFirstPlay=!0,this.isVideoContent=!1,this.mute=new Q,this.loaded=new Q,this.pause=new Q,this.play=new Q,this.click=new Q,this.interact=new Q,this.playerVolumeChange=new Q,this.loadedMetaData=new Q,this.ended=new Q,this.timeupdate=new Q,this.playlist=[],this.ready=new Q,this.setupError=new Q,this.state="idle",this.userInteraction=new Q,this.videoContentState="idle",this.time=new Q,this.volume=new Q,this._adReady=new Q,this._adContainer=document.createElement("DIV"),this._videoTitleDiv=document.createElement("DIV"),this._videoDescriptionDiv=document.createElement("DIV"),this._videoTitleOverlayContainer=document.createElement("DIV"),this._container=document.createElement("DIV"),this._playerPosition=document.createElement("DIV"),this._adPlayReady=!1,this._isMobile=Wt(),this._isTablet=Yt(),this._isDesktop=!this._isMobile&&!this._isTablet,this._isAdActive=!1,this._playerContainer=document.createElement("DIV"),this._videoElement=document.createElement("VIDEO"),this._prematureAdPlay=!1,this._imaLibraryEnpoint="https://imasdk.googleapis.com/js/sdkloader/ima3.js",this._userPaused=!1,this._isInstream=!1,this._preventMobileClick=!1,this._instreamTypes=[au.AutoInjected,au.EmbeddedStationary],this._requestTimer=null,this.requestVideoBids=()=>{throw new Error("Request video bids not set")},this.buildVideoUrl=()=>{throw new Error("Build video url not set")},this.waitForConsent=()=>{throw new Error("Wait for consent not set")},this._boundHandlers=new Map,this._isInstream=this._instreamTypes.includes(this._playerType),this._videoPlayerControls=this._setupVideoPlayerControls()}}class cu extends du{_handleReady(){this.adPlaying=!1;const e=document.getElementsByClassName("adthrive-sticky-outstream-idle")[0],t=document.getElementsByClassName("adthrive-sticky-outstream-active")[0];e?e.classList.add("adthrive-new-outstream-player"):t&&this._toggleActive(!0)}_handleAdStart(){this.adPlaying=!0,this._toggleActive(!0)}_handleAdErrorOrComplete(){this.adPlaying=!1,this._toggleActive(!1),this._remove()}_toggleActive(e){const t=document.getElementsByClassName("adthrive-new-outstream-player")[0];t&&(e?(t.classList.add("adthrive-sticky-outstream-active"),t.classList.remove("adthrive-sticky-outstream-idle")):(t.classList.remove("adthrive-sticky-outstream-active"),t.classList.add("adthrive-sticky-outstream-idle")))}constructor(e,t,i,s,r,n,a,o,l){super(e,t,i,s,n,o,r,a),this.adId=l,this.adPlaying=!1,this.ready.on(this._handleReady.bind(this)),this.adStarted.on(this._handleAdStart.bind(this)),this.allAdsCompleted.on(this._handleAdErrorOrComplete.bind(this)),this.adError.on(this._handleAdErrorOrComplete.bind(this))}}class hu{callRendererWithUrl(e,t,i=!1){const s=i?au.StickyOutstream:au.Outstream,r=i?this._stickyOutstreamSize:[300,225];this._callRenderAd({adTagUrl:e},t,s,r)}get standardOutstreamConfig(){const e=this._config.video,t={...this._rendererConfig},i=e.outstreamPlacement;return e.setStandardOutstreamBackupRenderer&&(t.renderer.backupOnly=!0),{playerSize:[640,480],...i&&{placement:i},...this._sharedConfig,...t}}get stickyOutstreamConfig(){return{...this._sharedConfig,...this._rendererConfig,startdelay:0,placement:5,playerSize:this._stickyOutstreamSize}}get _rendererConfig(){return{renderer:{url:this._imaEndpoint,render:e=>{this._renderer(e)}}}}_callRenderer(e,t,i,s=!1){const r=this._slotManager.getSlot(e),n=s?au.StickyOutstream:au.Outstream;r&&s&&(r.stickyOutstreamShortVideo=!1,r.stickyOutstreamLastAdErrored=!1,r.stickyOutstreamRefreshTimeout=5e3,r.stickyOutstreamErrorLogged=!1,r.stickyOutstreamRenderedTimestamp=Date.now()),this._callRenderAd(t,e,n,i)}_callRenderAd(e,t,i,s){const r=document.getElementById(t);if(r){const n=Math.floor(1e8*Math.random()).toString(),a=this._config,o=new cu(n,"",i,r,this._videoEventProxy,s,!0,a,t);this._setPlayerEvents(o,e),o.init()}}_handleComplete(e){this._slotManager.getSlot(e);e.includes("StickyOutstream")}_handleErrorEvent(e,t){this._handleOffEvent();const i=this._slotManager.getSlot(e);e.includes("StickyOutstream")&&i&&(te.error("StickyOutstream","adError",{adId:e,...t}),i.stickyOutstreamRefreshTimeout=2500,i.stickyOutstreamLastAdErrored=!0,this._setSlotForceRefresh(e,!0))}_handleAdTimeChange(e,t){const i=this._slotManager.getSlot(t);let s=!1;if(!t.includes("StickyOutstream")||!i)return;const{duration:r,position:n}=e,a=(r||30)-n,o=r<10,l=1!==this._config.prebid.refreshStickyOutstreamAuctionCount,d=n<100&&n>30&&n<r;if(s=l&&!o?a>0&&a<=10||d:a>0&&a<=5||d,s&&!i.isRefreshing){let e=l&&!o?1e4:5e3;r<5&&(e=1e3*r),i.stickyOutstreamShortVideo=o,i.stickyOutstreamRefreshTimeout=e,this._setSlotForceRefresh(t)}}_handleAdSkip(e){const t=this._slotManager.getSlot(e);e.includes("StickyOutstream")&&t&&(t.stickyOutstreamRefreshTimeout=2500,this._setSlotForceRefresh(e))}_handleOffEvent(){this._offEvents=this._offEvents.filter((e=>(e(),!1)))}_renderer(e){const t=e.ad||e.vastXml,i=-1!==e.adUnitCode.indexOf("StickyOutstream"),s=i?this._stickyOutstreamSize:[300,225],r=t?{adResponse:t}:{adTagUrl:e.vastUrl};this._callRenderer(e.sharedBidInUse||e.adUnitCode,r,s,i)}_setPlayerEvents(e,t){const i=this._offEvents;i.push(e.adError.on((t=>this._handleErrorEvent(e.adId,t)))),i.push(e.adCompleted.on((()=>this._handleComplete(e.adId)))),i.push(e.ready.on((()=>{e.playAd(t)}))),i.push(e.adProgress.on((t=>this._handleAdTimeChange(t,e.adId)))),i.push(e.adSkipped.on((()=>this._handleAdSkip(e.adId))))}_setSlotForceRefresh(e,t=!1,i=!1){const s=this._slotManager,r=s.getSlot(e),n=e.includes("StickyOutstream");let a=!t&&!i;if(!r||!n||r.isRefreshing)return;r.isRefreshing=!0;const o=t&&void 0!==r.stickyOutstreamErrorCount&&r.stickyOutstreamErrorCount<this._forcedRefreshLimit,l=i&&void 0!==r.noAdRefreshCount&&r.noAdRefreshCount<this._forcedRefreshLimit;o?(r.stickyOutstreamErrorCount++,a=!0):l?(r.noAdRefreshCount++,r.setSlotTargetingFlag("fref",[`${r.noAdRefreshCount}`],!0),a=!0):(r.stickyOutstreamErrorCount=0,r.setSlotTargetingFlag("fref",["off"],!0));const d=a?this._viewableImpressionDelay:15e3;s.updateRefreshTimeout(r,d)}_setTargetingForFill({event:e,slot:t}){if(t.location!==ge.Video_StickyOutstream)return;e.isEmpty||(t.noAdRefreshCount=0,t.setSlotTargetingFlag("fref",[`${t.noAdRefreshCount}`],!0))}_noFillForceRefresh(e){if(e.location!==ge.Video_StickyOutstream)return;e.stickyOutstreamRefreshTimeout=2500,this._setSlotForceRefresh(e.id,!1,!0)}constructor(e,t,i,s,r){this._config=e,this._slotManager=t,this._videoEventProxy=i,this._slotEventBus=s,this._gamEventBus=r,this._sharedConfig={context:"outstream",mimes:["video/mp4","application/javascript"],api:[2],skip:0,pos:1,protocols:[2,3,5,6,7,8],linearity:1,minduration:0,maxduration:this._config.video.maxDuration,playbackmethod:[2],plcmt:4},this._forcedRefreshLimit=3,this._imaEndpoint="https://imasdk.googleapis.com/js/sdkloader/ima3.js",this._viewableImpressionDelay=1001,this._offEvents=[];const{desktop:n,tablet:a}=this._config.site.breakpoints;this._stickyOutstreamSize="phone"===Et(a,n)?[178,100]:[227,150],this._gamEventBus.slotRenderEnded.on((e=>this._setTargetingForFill(e))),this._slotEventBus.gamEmptyNoBidResponse.on((e=>this._noFillForceRefresh(e))),this._slotEventBus.noBidResponses.on((e=>{e.isRefreshing=!1,this._setSlotForceRefresh(e.id,!1,!0)}))}}hu=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===id?Object:id,void 0===tu?Object:tu,void 0===Es?Object:Es,void 0===jl?Object:jl])],hu);class uu extends nr{init(){this._key="AdditionalOutstreamUnitsExperiment",this._default=!1}isEnabled(){return super.isEnabled()}}uu=B([hs("AdditionalOutstreamUnitsExperiment"),M()],uu);class pu extends nr{init(){this._key="OneVideoStream",this._default=!1}}pu=B([hs("OneVideoStreamExperiment"),M()],pu);class gu extends sr{init(){this._key="SuppressOutreamSlowConnection"}}gu=B([hs("OutstreamSOCONExperiment"),M()],gu);class mu extends sr{init(){this._key="NativeDescriptionLength"}get result(){return this._result}}mu=B([hs("NativeDescriptionLengthExperiment"),M()],mu);class _u extends nr{init(){this._key="OutstreamWithSOExperiment",this._default=!0}run(){return super.run()}}_u=B([hs("OutstreamWithSOExperiment"),M()],_u);class fu extends nr{init(){this._key="NativeHoldout",this._default=!1}}fu=B([hs("NativeHoldoutExperiment"),M()],fu);class vu{runOneStreamExperiment(){const e=R.resolve(uu);this._gam.setTargeting({key:"abgroup",value:this._config.abGroup.groups.join(",")}),this.additionalOutstreamUnitsExperiment=e.result,this.additionalOutstreamUnitsExperiment&&[ge.Content_3,ge.Content_5,ge.Recipe_1].forEach((e=>{this._standardOutstreamSlots.add(e)}))}isOutstreamAllowed(){return!this._oneVideoStreamExperiment.result||!this._config.video.hasJwPlayer}isSlowConnection(){var e;const t=null!=(e=this._soconExperiment.result)?e:0;if(void 0!==this._context.downlink){return this._context.downlink<=t}return!1}outstreamEnabled(e){const t=e.location===ge.Video_StickyOutstream,i=!t&&this.isSlowConnection();return{outstreamCapable:(this._config.adTypes.outstreamEnabled||t)&&this.outstreamSlots.has(e.placementMapName)&&this.isOutstreamAllowed()&&!i}}nativeEnabled(e){const t=this._nativeHoldoutExperiment.result,i=this._config.adTypes.has(Wt()?`nativeMobile${e.location}`:`nativeDesktop${e.location}`);return!t&&i&&this._nativeEligibleSlots.includes(e.location)}getMediaType(e,t={}){const i={},{slot:s,video:r}=e;if(r&&this._config.video.instreamAdUnits.has(r.name)&&this._config.video.plcmtUnits.has(r.name)){const e=this.getInstreamConfig(r);i.video=e}else if(s){const e={sizes:s.sizes,...s.isHighlyViewable()&&{pos:1}};t.banner&&(i.banner=e),t.outstream&&(i.video=s.location!==ge.Video_StickyOutstream?this._outstream.standardOutstreamConfig:this._outstream.stickyOutstreamConfig),t.native&&(i.native=this._getNativeConfig(s.location,(s.sequence||1)-1))}return i}get outstreamSlots(){return this._outstreamWithSOExperiment.result?this._standardOutstreamSlots:new Set([ge.Video_StickyOutstream_1])}getInstreamConfig(e){var t,i,s;return{context:"instream",playerSize:e.size,mimes:this._config.video.mimeType,protocols:null==(t=this._config.video.videoProtocols)?void 0:t.protocols,...(null==(i=this._config.video.plcmtUnits)?void 0:i.get(e.name))&&{plcmt:this._config.video.plcmtUnits.get(e.name)},maxduration:this._config.video.maxDuration,...(null==(s=this._config.video.playbackmethod)?void 0:s.get(e.name))&&{playbackmethod:this._config.video.playbackmethod.get(e.name)},...e.collapsible&&{playbackend:3},linearity:1,api:this._config.video.apiValue,w:e.size[0],h:e.size[1],pos:this._config.video.position.id,minduration:1,startdelay:0,placement:1,skip:0}}_getNativeSize(e){return"Content"===e?[300,150]:this.native.size}_getAdditionalNativeParams(e){return{context:1,contextsubtype:10,privacy:0,seq:e}}_getNativeConfig(e,t){const i=this.native,s=this._getNativeSize(e);return{ortb:{ver:"1.2",plcmttype:1,eventtrackers:[{event:1,methods:[1,2]}],assets:[{id:1,required:1,title:{len:i.titleLength}},{id:2,required:1,img:{type:3,wmin:s[0],hmin:s[1]}},{id:3,required:1,img:{type:1,wmin:20,hmin:20}},{id:4,required:1,data:{type:1}},{id:5,required:1,data:{type:2,...i.descriptionLength&&{len:i.descriptionLength}}}],...this._config.prebid.sendAdditionalNativeParams&&this._getAdditionalNativeParams(t)}}}constructor(e,t,i,s,r,n,a,o,l){this._config=e,this._context=t,this._gam=i,this._outstream=s,this._outstreamWithSOExperiment=r,this._oneVideoStreamExperiment=n,this._soconExperiment=a,this._nativeHoldoutExperiment=l,this.additionalOutstreamUnitsExperiment=!1,this._standardOutstreamSlots=new Set([ge.Content_1,ge.Below_Post,ge.Video_StickyOutstream_1]),this._nativeEligibleSlots=[ge.Content],this.native={size:[300,300],titleLength:25,descriptionLength:o.result||0}}}vu=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Vl?Object:Vl,void 0===hu?Object:hu,void 0===_u?Object:_u,void 0===pu?Object:pu,void 0===gu?Object:gu,void 0===mu?Object:mu,void 0===fu?Object:fu])],vu);class yu extends Jh{_getRoadblockDisplayTargeting(e){return{site_code:this._config.marmalade.filteredRoadblockSiteCodes,pmp_elig:[String(this._config.adOptions.pmp)],hvp:[this._getHVP(e)]}}_getRoadblockVideoTargeting(e){return{site_code:this._config.marmalade.filteredRoadblockSiteCodes,pmp_elig:[String(this._config.adOptions.pmp)],vprenum:[e.prerollNum.toString()]}}_getHVP(e){const t=Jt(e);return Zt(t).toString()}getBannerSlotBidRequests(e){if(this._map.has(e.placementMapName))return this._map.get(e.placementMapName).filter((({adType:e})=>!e||this._config.adTypes.has(e))).map((({placementId:t})=>({bidder:this.name,params:{...this._getKeywords(e),allowSmallerSizes:this._config.adOptions.allowSmallerAdSizes,placementId:t,...e.isHighlyViewable()&&{position:"above"}}})))}_getKeywords(e){const t={...this._keywords};return"Footer"===e.location&&(t.keywords={...t.keywords,...this._getRoadblockDisplayTargeting(e)}),t}getOutstreamSlotBidRequests(e){if(this._map.has(e.placementMapName))return this._map.get(e.placementMapName).filter((({adType:e})=>!e||this._config.adTypes.has(e))).map((({placementId:t,playback_method:i})=>({bidder:this.name,...this._addBidLabel(e.placementMapName,{outstreamCapable:e.location!==ge.Video_StickyOutstream}),params:{...this._getKeywords(e),allowSmallerSizes:this._config.adOptions.allowSmallerAdSizes,placementId:t,video:{playback_method:i},...e.isHighlyViewable()&&{position:"above"}}})))}getVideoSlotBidRequests(e){var t;if(this._map.has(e.name))return[{bidder:this.name,params:{...this._keywords,placementId:this._map.get(e.name)[0].placementId,position:this._config.video.position.name,video:{mimes:this._config.video.mimeType,...(null==(t=this._config.video.playbackmethod)?void 0:t.get(e.name))&&{playback_method:this._playbackmethodMap.get(this._config.video.playbackmethod.get(e.name)[0])},frameworks:this._config.video.apiValue}}}]}updateBidParams(e){this._addPositionParam(e,"above")}constructor(e,t,i,s){super(e),this._mediaType=t,this._rfcodes=i,this._context=s,this.bidderConfig=this._config.partners.getBidderConfig(ae.AppNexus),this.videoCreativeIds=[["138323232312",ae.AppNexus],["138323908966",ae.AppNexus],["138323900998",ae.AppNexus],["138323900548",ae.AppNexus],["138323457386",ae.AppNexus],["138323908963",ae.AppNexus],["138323908960",ae.AppNexus],["138323901004",ae.AppNexus],["138323901001",ae.AppNexus],["138323521089",ae.AppNexus],["138323457473",ae.AppNexus],["138323908969",ae.AppNexus],["138323908957",ae.AppNexus],["138323908954",ae.AppNexus],["138323900995",ae.AppNexus],["138323521092",ae.AppNexus]],this._keywords={keywords:{...this._config.site.filteredSensitiveCategories.length&&{sens:this._config.site.filteredSensitiveCategories},bucket:[this._context.bucket],Chrome:[`${lt()}`],Mobile:[(!!(navigator.userAgent&&navigator.userAgent.search(/Mobi/i)>-1)).toString()],...this._config.site.verticals.length&&{verticals:this._config.site.verticals},mcmp:this._rfcodes.getAllMcmps()}},this.outstreamType=Wt()?"outstreamMobile":"outstreamDesktop",this._map=new Map([[ge.Below_Post,[{placementId:13036386}]],[ge.Content_1,[{placementId:13036388},{placementId:16808429,adType:this.outstreamType,playback_method:["auto_play_sound_off"]}]],[ge.Content_2,[{placementId:13036389}]],[ge.Content_3,[{placementId:13036391}]],[ge.Content_4,[{placementId:13036393}]],[ge.Content_5,[{placementId:13036394}]],[ge.Content_6,[{placementId:13036396}]],[ge.Content_7,[{placementId:13036398}]],[ge.Content_8,[{placementId:13036399}]],[ge.Content_9,[{placementId:13036400}]],[ge.Footer_1,[{placementId:13036401}]],[ge.Header_1,[{placementId:13036404}]],[ge.Header_2,[{placementId:13036405}]],[ge.Interstitial_1,[{placementId:21240886}]],[ge.Recipe_1,[{placementId:13036406}]],[ge.Recipe_2,[{placementId:13036407}]],[ge.Recipe_3,[{placementId:15014787}]],[ge.Recipe_4,[{placementId:15998791}]],[ge.Sidebar_1,[{placementId:13036408}]],[ge.Sidebar_2,[{placementId:13036409}]],[ge.Sidebar_3,[{placementId:13036410}]],[ge.Sidebar_4,[{placementId:13036411}]],[ge.Sidebar_5,[{placementId:13036412}]],[ge.Sidebar_9,[{placementId:13036416}]],[ge.Video_StickyOutstream_1,[{placementId:22366045}]],[_e.Video_Collapse_Autoplay_SoundOff,[{placementId:15504193,playback_method:["auto_play_sound_off"]}]],[_e.Video_Coll_SOff_Smartphone,[{placementId:15504209,playback_method:["auto_play_sound_off"]}]],[_e.Video_In_Post_ClicktoPlay_SoundOn,[{placementId:15504166,playback_method:["click_to_play"]}]],[_e.Video_Individual_Autoplay_SOff,[{placementId:17947919,playback_method:["auto_play_sound_off"]}]]]),this._playbackmethodMap=new Map([[3,"click_to_play"],[6,"auto_play_sound_off"]])}}yu=B([hs("AppNexusBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===vu?Object:vu,void 0===nd?Object:nd,void 0===Pr?Object:Pr])],yu);class bu extends Jh{getBannerSlotBidRequests(e){const t=this._map.get(e.placementMapName);if(t&&e.hasSize(t.size))return[{bidder:this.name,params:{groupId:t.id}}]}getVideoSlotBidRequests(e){if(this._videoMap.has(e.name))return[{bidder:this.name,params:{groupId:this._videoMap.get(e.name)}}]}constructor(e){super(e),this.adapterName="colossus",this.bidderConfig=this._config.partners.getBidderConfig(ae.ColossusServer),this.videoCreativeIds=[["138399171431",ae.ColossusServer],["138396598194",ae.ColossusServer],["138397072123",ae.ColossusServer],["138397072117",ae.ColossusServer],["138397070791",ae.ColossusServer],["138396598191",ae.ColossusServer],["138397072120",ae.ColossusServer],["138397070788",ae.ColossusServer],["138396598197",ae.ColossusServer],["138396598188",ae.ColossusServer],["138396598158",ae.ColossusServer],["138396598152",ae.ColossusServer],["138397073191",ae.ColossusServer],["138397072102",ae.ColossusServer],["138396598200",ae.ColossusServer],["138396598155",ae.ColossusServer]],this._desktopBannerMap=new Map([[ge.Below_Post,{id:"455",size:[300,250]}],[ge.Content,{id:"456",size:[300,250]}],[ge.Content_1,{id:"457",size:[300,250]}],[ge.Content_2,{id:"458",size:[300,250]}],[ge.Content_3,{id:"459",size:[300,250]}],[ge.Content_4,{id:"460",size:[300,250]}],[ge.Content_5,{id:"461",size:[300,250]}],[ge.Content_6,{id:"462",size:[300,250]}],[ge.Content_7,{id:"463",size:[300,250]}],[ge.Content_8,{id:"464",size:[300,250]}],[ge.Content_9,{id:"465",size:[300,250]}],[ge.Footer_1,{id:"466",size:[728,90]}],[ge.Header_1,{id:"467",size:[728,90]}],[ge.Header_2,{id:"468",size:[728,90]}],[ge.Recipe_1,{id:"469",size:[300,250]}],[ge.Recipe_2,{id:"470",size:[300,250]}],[ge.Recipe_3,{id:"471",size:[300,250]}],[ge.Recipe_4,{id:"472",size:[300,250]}],[ge.Recipe_5,{id:"473",size:[300,250]}],[ge.Sidebar_1,{id:"474",size:[300,250]}],[ge.Sidebar_2,{id:"475",size:[300,250]}],[ge.Sidebar_3,{id:"476",size:[300,250]}],[ge.Sidebar_4,{id:"477",size:[300,250]}],[ge.Sidebar_5,{id:"478",size:[300,250]}],[ge.Sidebar_9,{id:"479",size:[300,250]}]]),this._mobileBannerMap=new Map([[ge.Below_Post,{id:"481",size:[300,250]}],[ge.Content,{id:"482",size:[300,250]}],[ge.Content_1,{id:"483",size:[300,250]}],[ge.Content_2,{id:"484",size:[300,250]}],[ge.Content_3,{id:"485",size:[300,250]}],[ge.Content_4,{id:"486",size:[300,250]}],[ge.Content_5,{id:"487",size:[300,250]}],[ge.Content_6,{id:"488",size:[300,250]}],[ge.Content_7,{id:"489",size:[300,250]}],[ge.Content_8,{id:"490",size:[300,250]}],[ge.Content_9,{id:"491",size:[300,250]}],[ge.Footer_1,{id:"492",size:[320,50]}],[ge.Header_1,{id:"493",size:[320,50]}],[ge.Header_2,{id:"494",size:[320,50]}],[ge.Recipe_1,{id:"495",size:[300,250]}],[ge.Recipe_2,{id:"496",size:[300,250]}],[ge.Recipe_3,{id:"497",size:[300,250]}],[ge.Recipe_4,{id:"498",size:[300,250]}],[ge.Recipe_5,{id:"499",size:[300,250]}],[ge.Sidebar_1,{id:"500",size:[300,250]}],[ge.Sidebar_2,{id:"501",size:[300,250]}],[ge.Sidebar_3,{id:"502",size:[300,250]}],[ge.Sidebar_4,{id:"503",size:[300,250]}],[ge.Sidebar_5,{id:"504",size:[300,250]}],[ge.Sidebar_9,{id:"505",size:[300,250]}]]),this._bannerMap={desktop:this._desktopBannerMap,mobile:this._mobileBannerMap},this._videoMap=new Map([[_e.Video_Collapse_Autoplay_SoundOff,"450"],[_e.Video_Coll_SOff_Smartphone,"451"],[_e.Video_In_Post_ClicktoPlay_SoundOn,"452"],[_e.Video_Individual_Autoplay_SOff,"453"]]);const t=this._bannerMap;this._map=Wt()?t.mobile:t.desktop}}bu=B([hs("ColossusServerBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],bu);class Su extends Jh{getBannerSlotBidRequests(e){if(this._map.has(e.placementMapName))return[{bidder:this.name,params:{tag_id:this._map.get(e.placementMapName).tag_id,site_id:this._siteId}}]}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.Conversant),this._siteId="203587",this._map=new Map([[ge.Below_Post,{tag_id:"8c6e3091"}],[ge.Content,{tag_id:"f4f67b17"}],[ge.Content_1,{tag_id:"9cbc79fd"}],[ge.Content_2,{tag_id:"8fdfa3de"}],[ge.Content_3,{tag_id:"ff6c383c"}],[ge.Content_4,{tag_id:"972f654c"}],[ge.Content_5,{tag_id:"bd1aadb5"}],[ge.Content_6,{tag_id:"ce4f5d6e"}],[ge.Content_7,{tag_id:"d85e90b"}],[ge.Content_8,{tag_id:"f02f4ba"}],[ge.Content_9,{tag_id:"2c01cbc"}],[ge.Footer_1,{tag_id:"1b2dec1"}],[ge.Header_1,{tag_id:"44d21b5"}],[ge.Header_2,{tag_id:"3488dd9"}],[ge.Recipe_1,{tag_id:"f6cf917"}],[ge.Recipe_2,{tag_id:"31d9c43"}],[ge.Recipe_3,{tag_id:"a7b4d19"}],[ge.Recipe_4,{tag_id:"245c673"}],[ge.Recipe_5,{tag_id:"0bf3576"}],[ge.Sidebar_1,{tag_id:"bf73d45"}],[ge.Sidebar_2,{tag_id:"0a57500"}],[ge.Sidebar_3,{tag_id:"cceddcd"}],[ge.Sidebar_4,{tag_id:"872fffd4"}],[ge.Sidebar_5,{tag_id:"a7653e4"}],[ge.Sidebar_9,{tag_id:"517df454"}]])}}Su=B([hs("ConversantBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],Su);class Eu extends Jh{_getBidParams(e,t,i){var s;const r=this._params[e][i];return{params:{...r.networkId&&{networkId:r.networkId},...r.zoneId&&{zoneId:r.zoneId},..."server"===e&&(null==(s=r.uid)?void 0:s[t])&&{uid:r.uid[t]}}}}getBannerSlotBidRequests(e){const t=e.placementMapName;if(!this._map.has(t))return;const i=[];return this._bidders.forEach((e=>{const s=e.type,r="server"===s?this.serverBidderName:this.name;i.push({bidder:r,...this._getBidParams(s,t,"banner")})})),i}getOutstreamSlotBidRequests(e){const t=e.placementMapName;if(!this._map.has(e.placementMapName))return;const i=e.location===ge.Video_StickyOutstream,s=[];return this._bidders.forEach((e=>{const r=e.type,n="server"===r?this.serverBidderName:this.name;s.push({bidder:n,...this._addBidLabel(t,{outstreamCapable:!i}),...this._getBidParams(r,t,i?"stickyOutstream":"outstream")})})),s}getVideoSlotBidRequests(e){if(this._videoMap.has(e.name)){const t=[];return this._bidders.forEach((i=>{var s,r;const n=i.type,a="server"===n?this.serverBidderName:this.name,o=null==(s=this._videoMap.get(e.name))?void 0:s[n];t.push({bidder:a,params:{...o,video:{playbackmethod:(null==(r=this._config.video.playbackmethod)?void 0:r.get(e.name))||[]}}})})),t}}async _setInterestGroupIframe(){const e=document.getElementById("criteo-ig");return e||new Promise(((e,t)=>{try{const i=document.createElement("iframe");i.id="criteo-ig",i.style.display="none",i.onload=()=>{e(i)},i.onerror=()=>{t("Interest Group iframe loading failed")},i.src="https://gpsb-reims.criteo.com/paapi/join_ig?advertiser_id=500002_500329&ig_name=r6NnpiEx",document.body.appendChild(i)}catch(e){t(e)}}))}constructor(e,t){super(e),this._prebidMethods=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.Criteo),this.adapterName=ae.Criteo,this.serverBidderName=ae.CriteoServer,this.gvlid=91,this.videoCreativeIds=[["138381583896",ae.Criteo],["138381548372",ae.Criteo],["138381548387",ae.Criteo],["138381548384",ae.Criteo],["138381548525",ae.Criteo],["138381548522",ae.Criteo],["138381548516",ae.Criteo],["138381548513",ae.Criteo],["138382062244",ae.Criteo],["138382062241",ae.Criteo],["138382062238",ae.Criteo],["138382062235",ae.Criteo],["138382062232",ae.Criteo],["138382062226",ae.Criteo],["138382062223",ae.Criteo],["138381584697",ae.Criteo]],this.videoServerCreativeIds=[["138485671580",ae.CriteoServer],["138486258745",ae.CriteoServer],["138486258748",ae.CriteoServer],["138486258766",ae.CriteoServer],["138486258769",ae.CriteoServer],["138486258772",ae.CriteoServer],["138486258775",ae.CriteoServer],["138486259240",ae.CriteoServer]],this.settings={storageAllowed:["html5"]},this._params={client:{banner:{networkId:3927},outstream:{zoneId:1709027},stickyOutstream:{zoneId:1709026}},server:{banner:{networkId:12180,uid:{[ge.Below_Post]:417066,[ge.Below_Post_1]:417063,[ge.Content]:417061,[ge.Content_1]:417062,[ge.Content_2]:417069,[ge.Content_3]:417068,[ge.Content_4]:417070,[ge.Content_5]:417064,[ge.Content_6]:417065,[ge.Content_7]:417067,[ge.Content_8]:417071,[ge.Content_9]:417072,[ge.Footer_1]:417073,[ge.Header_1]:417074,[ge.Header_2]:417075,[ge.Recipe_1]:417076,[ge.Recipe_2]:417077,[ge.Recipe_3]:417078,[ge.Recipe_4]:417079,[ge.Recipe_5]:417080,[ge.Sidebar_1]:417081,[ge.Sidebar_2]:417082,[ge.Sidebar_3]:417083,[ge.Sidebar_4]:417092,[ge.Sidebar_5]:417090,[ge.Sidebar_9]:417093}},outstream:{networkId:12180,uid:{[ge.Below_Post]:417710,[ge.Below_Post_1]:417711,[ge.Content_1]:417712,[ge.Content_3]:417713,[ge.Content_5]:417714,[ge.Recipe_1]:417715}},stickyOutstream:{networkId:12180,uid:{[ge.Video_StickyOutstream_1]:417106}}}},this._map=new Set([ge.Below_Post,ge.Content_1,ge.Content_2,ge.Content_3,ge.Content_4,ge.Content_5,ge.Content_6,ge.Content_7,ge.Content_8,ge.Content_9,ge.Footer_1,ge.Header_1,ge.Header_2,ge.Recipe_1,ge.Recipe_2,ge.Recipe_3,ge.Recipe_4,ge.Sidebar_1,ge.Sidebar_2,ge.Sidebar_3,ge.Sidebar_4,ge.Sidebar_5,ge.Sidebar_9,ge.Video_StickyOutstream_1]),this._videoMap=new Map([[_e.Video_Collapse_Autoplay_SoundOff,{client:{zoneId:1629631},server:{networkId:12180,uid:417103}}],[_e.Video_Coll_SOff_Smartphone,{client:{zoneId:1629630},server:{networkId:12180,uid:417102}}],[_e.Video_In_Post_ClicktoPlay_SoundOn,{client:{zoneId:1629629},server:{networkId:12180,uid:417104}}],[_e.Video_Individual_Autoplay_SOff,{client:{zoneId:1629401},server:{networkId:12180,uid:417105}}]]),this._prebidMethods.setConfig({criteo:{fastBidVersion:"none"}}),"joinAdInterestGroup"in navigator&&this._setInterestGroupIframe().then((e=>{})).catch((e=>{te.error("CriteoBidder","_setInterestGroupIframe",e)}))}}Eu=B([hs("CriteoBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Ss?Object:Ss])],Eu);class Cu extends Jh{getBannerSlotBidRequests(e){const t=this._map.get(e.placementMapName)||this._map.get(e.location),i=e.location===ge.Footer&&this._animatedFooterEnabled,s=e.location===ge.Content,r=this._interstitialEnabled&&e.location===ge.Interstitial;if(t){const n=[];return i&&n.push({bidder:this.name,params:{...this._defaultContextualAuctionParams}}),(r||s)&&t.filter((({size:t})=>!t||e.hasSize(t))).filter((e=>!e.isHangtime||this._isHangtimeEnabled)).forEach((e=>{const t=this._isHangtimeEnabled&&e.isHangtime?{zone:this._zoneIds.hangtime}:this._defaultContextualAuctionParams;n.push({bidder:this.name,params:{...t,...e.slotId&&!this._config.prebid.s2s.bidders.includes(this.name)&&{slot:e.slotId}}})})),i&&this.isExpandableFooter&&n.push({bidder:this.name,params:{zone:this._config.prebid.s2s.bidders.includes(this.name)?this._zoneIds.expandableFooter.s2s:this._zoneIds.expandableFooter.client}}),n}}getVideoSlotBidRequests(e){if(this._videoMap.has(e.name))return[{bidder:this.name,params:{...this._config.prebid.s2s.bidders.includes(this.name)&&{...this._defaultContextualAuctionParams},video:this._videoMap.get(e.name)}}]}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.GumGum),this.videoCreativeIds=[["138330842944",ae.GumGum],["138330432527",ae.GumGum],["138330466869",ae.GumGum],["138330842389",ae.GumGum],["138330842452",ae.GumGum],["138330432530",ae.GumGum],["138330432548",ae.GumGum],["138330432551",ae.GumGum],["138330466908",ae.GumGum],["138330842464",ae.GumGum],["138330842470",ae.GumGum],["138330466872",ae.GumGum],["138330842458",ae.GumGum],["138330842461",ae.GumGum],["138330842467",ae.GumGum],["138330842455",ae.GumGum]],this._zoneIds={client:"g95nznmj",s2s:{desktop:"0yo5ozig",tablet:"0yo5ozig",phone:"nedjcoh9"},expandableFooter:{client:"klpfgzhj",s2s:"wspaezyl"},hangtime:"yynpv9l1"},this._map=new Map([[ge.Interstitial_1,[{slotId:110743}]],[ge.Content_1,[{slotId:913891},{slotId:1178411,size:[300,250],isHangtime:!0}]],[ge.Content_2,[{slotId:913892}]],[ge.Content_3,[{slotId:913893}]],[ge.Content_4,[{slotId:913894}]],[ge.Content_5,[{slotId:913895}]],[ge.Content_6,[{slotId:913896}]],[ge.Content_7,[{slotId:913897}]],[ge.Content_8,[{slotId:913898}]],[ge.Content_9,[{slotId:913899}]],[ge.Footer_1,[]]]),this._videoMap=new Map([[_e.Video_Collapse_Autoplay_SoundOff,"glpmwixo"],[_e.Video_Coll_SOff_Smartphone,"5zl85htf"],[_e.Video_Individual_Autoplay_SOff,"8jzhuyj5"]]),this.isExpandableFooter=!1,this._animatedFooterEnabled=this._config.adTypes.animatedFooter,this._interstitialEnabled=this._config.adOptions.interstitial.prebid;this._device=Wt()?"phone":Yt()?"tablet":"desktop",this._isHangtimeEnabled=this._config.adTypes.has("interscroller")&&"phone"===this._device,this._defaultContextualAuctionParams={zone:this._config.prebid.s2s.bidders.includes(this.name)?this._zoneIds.s2s[this._device]:this._zoneIds.client},this.isExpandableFooter=this._config.adTypes.has("expandableFooter")}}Cu=B([hs("GumGumBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],Cu);class Tu extends Jh{getBannerSlotBidRequests(e){if(this._displaySet.has(e.placementMapName)){const e=this._displayPlacementId;return[{bidder:this.name,params:{publisherId:this._publisherId,placementId:e}}]}}getOutstreamSlotBidRequests(e){if(this._outstreamSet.has(e.placementMapName)){const e=this._stickyOutstreamPlacementId;return[{bidder:this.name,params:{publisherId:this._publisherId,placementId:e}}]}}getVideoSlotBidRequests(e){if(this._videoSet.has(e.name))return[{bidder:this.name,params:{publisherId:this._publisherId,placementId:22983143}}]}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.ImproveDigitalServer),this.adapterName=ae.ImproveDigital,this.serverBidderName=ae.ImproveDigitalServer,this.gvlid=253,this._publisherId=2250,this._displayPlacementId=22983142,this._stickyOutstreamPlacementId=23006106,this.videoCreativeIds=[["138436972580",ae.ImproveDigitalServer],["138436972724",ae.ImproveDigitalServer],["138436972727",ae.ImproveDigitalServer],["138436972736",ae.ImproveDigitalServer],["138437681002",ae.ImproveDigitalServer],["138437681251",ae.ImproveDigitalServer],["138437681254",ae.ImproveDigitalServer],["138437681257",ae.ImproveDigitalServer]],this._displaySet=new Set([ge.Below_Post,ge.Content_1,ge.Content_2,ge.Content_3,ge.Content_4,ge.Content_5,ge.Content_6,ge.Content_7,ge.Content_8,ge.Content_9,ge.Footer_1,ge.Header_1,ge.Header_2,ge.Recipe_1,ge.Recipe_2,ge.Recipe_3,ge.Recipe_4,ge.Recipe_5,ge.Sidebar_1,ge.Sidebar_2,ge.Sidebar_3,ge.Sidebar_4,ge.Sidebar_5,ge.Sidebar_9]),this._outstreamSet=new Set([ge.Video_StickyOutstream_1]),this._videoSet=new Set([_e.Video_Coll_SOff_Smartphone,_e.Video_Collapse_Autoplay_SoundOff,_e.Video_In_Post_ClicktoPlay_SoundOn,_e.Video_Individual_Autoplay_SOff])}}Tu=B([hs("ImproveDigitalBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],Tu);const wu=new Map([[ge.Content_1,{siteId:"943837"}],[ge.Content_2,{siteId:"943837"}],[ge.Content_3,{siteId:"943837"}],[ge.Content_4,{siteId:"943837"}],[ge.Content_5,{siteId:"943837"}],[ge.Content_6,{siteId:"943837"}],[ge.Content_7,{siteId:"943837"}],[ge.Content_8,{siteId:"943837"}],[ge.Content_9,{siteId:"943837"}]]),Au=new Map([[ge.Below_Post,{initial:{siteId:"185759"}}],[ge.Content_1,{initial:{siteId:"185761",outstreamSiteId:"820298"},refresh:{siteId:"1140188"}}],[ge.Content_2,{initial:{siteId:"185762"},refresh:{siteId:"1140189"}}],[ge.Content_3,{initial:{siteId:"185763"},refresh:{siteId:"1140190"}}],[ge.Content_4,{initial:{siteId:"185764"},refresh:{siteId:"1140191"}}],[ge.Content_5,{initial:{siteId:"185765"},refresh:{siteId:"1140192"}}],[ge.Content_6,{initial:{siteId:"185766"},refresh:{siteId:"1140193"}}],[ge.Content_7,{initial:{siteId:"185767"},refresh:{siteId:"1140194"}}],[ge.Content_8,{initial:{siteId:"185768"},refresh:{siteId:"1140195"}}],[ge.Content_9,{initial:{siteId:"185769"},refresh:{siteId:"1140196"}}],[ge.Footer_1,{initial:{siteId:"185770"}}],[ge.Header_1,{initial:{siteId:"185774"}}],[ge.Interstitial_1,{initial:{siteId:"631834"}}],[ge.Recipe_1,{initial:{siteId:"185776"}}],[ge.Recipe_2,{initial:{siteId:"185777"}}],[ge.Recipe_3,{initial:{siteId:"304909"}}],[ge.Recipe_4,{initial:{siteId:"371523"}}],[ge.Sidebar_1,{initial:{siteId:"185787"}}],[ge.Sidebar_2,{initial:{siteId:"185788"}}],[ge.Sidebar_3,{initial:{siteId:"185789"}}],[ge.Sidebar_4,{initial:{siteId:"185790"}}],[ge.Sidebar_5,{initial:{siteId:"185791"}}],[ge.Sidebar_9,{initial:{siteId:"185795"}}],[ge.Video_StickyOutstream_1,{initial:{siteId:"745167",outstreamSiteId:"745167"}}]]),ku=new Map([[ge.Below_Post,[{size:[728,90],id:"1_1"},{size:[300,250],id:"1_2"}]],[ge.Content_1,[{size:[728,90],id:"3_1"},{size:[300,250],id:"3_2"},{size:[320,480],id:"3_2"},{size:[320,50],id:"3_4"},{size:[320,100],id:"3_5"},{size:[300,50],id:"3_6"},{size:[728,250]}]],[ge.Content_2,[{size:[728,90],id:"4_1"},{size:[300,250],id:"4_2"},{size:[728,410],id:"4_2"},{size:[320,50],id:"4_4"},{size:[320,100],id:"4_5"},{size:[300,50],id:"4_6"},{size:[728,250]}]],[ge.Content_3,[{size:[300,250],id:"5_1"},{size:[320,50],id:"5_2"},{size:[320,100],id:"5_3"},{size:[300,50],id:"5_4"},{size:[728,250]}]],[ge.Content_4,[{size:[300,250],id:"6_1"},{size:[320,50],id:"6_2"},{size:[320,100],id:"6_3"},{size:[300,50],id:"6_4"},{size:[728,250]}]],[ge.Content_5,[{size:[300,250],id:"7_1"},{size:[320,50],id:"7_2"},{size:[320,100],id:"7_3"},{size:[300,50],id:"7_4"},{size:[728,250]}]],[ge.Content_6,[{size:[300,250],id:"8_1"},{size:[320,50],id:"8_2"},{size:[320,100],id:"8_3"},{size:[300,50],id:"8_4"},{size:[728,250]}]],[ge.Content_7,[{size:[300,250],id:"9_1"},{size:[320,50],id:"9_2"},{size:[300,50],id:"9_3"},{size:[728,250]}]],[ge.Content_8,[{size:[300,250],id:"10_1"},{size:[320,50],id:"10_2"},{size:[300,50],id:"10_3"},{size:[728,250]}]],[ge.Content_9,[{size:[300,250],id:"11_1"},{size:[320,50],id:"11_2"},{size:[300,50],id:"11_3"},{size:[728,250]}]],[ge.Footer_1,[{size:[728,90],id:"12_1"},{size:[970,90],id:"12_2"},{size:[320,50],id:"12_3"},{size:[320,100],id:"12_4"},{size:[300,50],id:"12_5"}]],[ge.Header_1,[{size:[728,90],id:"15_1"},{size:[970,90],id:"15_2"},{size:[970,250],id:"15_3"},{size:[320,50],id:"15_4"},{size:[320,100],id:"15_5"},{size:[300,50],id:"15_6"}]],[ge.Interstitial_1,[{size:[300,600],id:"36_1"},{size:[336,280],id:"36_2"},{size:[320,480],id:"36_3"},{size:[300,250],id:"36_4"},{size:[320,50],id:"36_5"}]],[ge.Recipe_1,[{size:[300,250],id:"17_1"},{size:[320,50],id:"17_3"},{size:[320,100],id:"17_4"},{size:[300,50],id:"17_5"}]],[ge.Recipe_2,[{size:[300,250],id:"18_1"},{size:[320,50],id:"18_3"},{size:[320,100],id:"18_4"},{size:[300,50],id:"18_5"}]],[ge.Recipe_3,[{size:[300,250],id:"42_1"},{size:[320,50],id:"42_3"},{size:[320,100],id:"42_4"},{size:[300,50],id:"42_5"}]],[ge.Recipe_4,[{size:[300,250],id:"43_1"},{size:[320,50],id:"43_3"},{size:[320,100],id:"43_4"},{size:[300,50],id:"43_5"}]],[ge.Sidebar_1,[{size:[300,250],id:"27_1"},{size:[300,600],id:"27_2"},{size:[300,1050],id:"27_3"},{size:[160,600],id:"27_4"},{size:[300,50],id:"27_5"}]],[ge.Sidebar_2,[{size:[300,250],id:"28_1"},{size:[300,600],id:"28_2"},{size:[160,600],id:"28_3"},{size:[300,50],id:"28_4"}]],[ge.Sidebar_3,[{size:[300,250],id:"29_1"},{size:[300,600],id:"29_2"},{size:[160,600],id:"29_3"},{size:[300,50],id:"29_4"}]],[ge.Sidebar_4,[{size:[300,250],id:"30_1"},{size:[300,600],id:"30_2"},{size:[160,600],id:"30_3"},{size:[300,50],id:"30_4"}]],[ge.Sidebar_5,[{size:[300,250],id:"31_1"},{size:[300,600],id:"31_2"},{size:[160,600],id:"31_3"},{size:[300,50],id:"31_4"}]],[ge.Sidebar_9,[{size:[300,250],id:"35_1"},{size:[300,600],id:"35_2"},{size:[300,1050],id:"35_3"},{size:[160,600],id:"35_4"},{size:[300,50],id:"35_5"}]],[ge.Video_StickyOutstream_1,[{size:[300,250],id:"48_1",sizeOverride:[227,150]},{size:[320,50],id:"48_2",sizeOverride:[178,100]}]]]),Iu=new Map([[_e.Video_Collapse_Autoplay_SoundOff,[{size:[640,360],siteId:"185255",id:"44_1"}]],[_e.Video_Coll_SOff_Smartphone,[{size:[400,225],siteId:"321341",id:"45_1"}]],[_e.Video_In_Post_ClicktoPlay_SoundOn,[{size:[640,360],siteId:"385287",device:"desktop",id:"46_1"},{size:[400,225],siteId:"385288",device:"mobile",id:"46_2"}]],[_e.Video_Individual_Autoplay_SOff,[{size:[640,360],siteId:"385285",device:"desktop",id:"47_1"},{size:[400,225],siteId:"385286",device:"mobile",id:"47_2"}]]]);class Pu extends sr{init(){this._key="IxNativeExperiment"}run(){return super.run()}}Pu=B([hs("IxNativeExperiment"),M()],Pu);class Ou extends nr{init(){this._key="IXRefresh",this._default=!1}}Ou=B([hs("IXRefreshExperiment"),M()],Ou);class xu extends Jh{init(){const e=ri(this._context.savedReferrer),t=this._config,i=t.site,s=[...i.verticals].filter(Mt),r=i.filteredSensitiveCategories,n={PD:`${t.adOptions.pmp?"":"no"}${this._context.device}`,...s.length&&{Topic:s.join("#Topic:")},...r.length&&{Sens:r.join("#Sens:")},Source:Ei(e),Browser:ut(),vp:"0"};var a,o;Si(n,this._prebidMethods),this._largeFormatSizes.length&&(a=this._largeFormatSizes,(o=this._prebidMethods).addToQueue((()=>{const e=o.getConfig("ix")||{};e.largeFormatSizes=a,o.setConfig({ix:e})})))}getVideoBidRequests(e){return e.reduce(((t,i)=>{const s=this.getVideoSizeSites(e).filter((e=>e.video===i)).map((e=>{const{siteId:t,size:s,id:r}=e.sizeSite,n=this.getPrebidAdUnitBidRequest(t,s,r,"",!1);return n.params.video=this.getVideoParams(i.name),n}));return t.set(i.name,s)}),new Map)}getBannerSlotBidRequests(e){const t=[];if(!Au.get(e.placementMapName))return t;return this._getSlotBids(e)}getOutstreamSlotBidRequests(e){const t=[];if(!Au.get(e.placementMapName))return t;return this._getSlotBids(e,!0)}getNativeSlotBidRequests(e){if(!wu.get(e.placementMapName)||!e.location.includes(ge.Content)||e.location.includes(ge.Content)&&e.sequence&&e.sequence>=3&&"ec3"===this._nativeExperiment.result)return[];const t=wu.get(e.placementMapName).siteId,i=[],s={refresh:"arl"===this._nativeExperiment.result};return i.push(this.getPrebidAdUnitBidRequest(t,void 0,void 0,e.placementMapName,!1,s)),i}getVideoParams(e,t){var i;const s={...this._config.video,...t},r=s.playbackmethod&&s.playbackmethod.get(e),n=new Map([[3,[3]],[6,[2]]]),a=r&&{playbackmethod:n.get(r[0])};if(!s.videoProtocols||!s.videoProtocols.protocols){const e=s.videoProtocols?"protocols is undefined":"videoProtocols is undefined";te.error("IndexExchangeBidder","getVideoParams",e)}return{api:s.apiValue,mimes:s.mimeType,...a,minduration:0,maxduration:30,protocols:null==(i=s.videoProtocols)?void 0:i.protocols,pos:s.position.id}}getPrebidAdUnitBidRequest(e,t,i,s="",r=!1,n={}){return{bidder:this._bidderName,...this._addBidLabel(s,n),params:{...i&&{id:i},siteId:e,...r?{video:{}}:t?{size:t}:{}}}}_getSlotBids(e,t=!1){const i=[],s=[ge.Content],r=ku.get(e.placementMapName),n=Au.get(e.placementMapName),a=!t&&this._ixRefreshExperiment.result&&s.includes(e.location);return r&&r.filter((({size:t})=>e.hasSize(t)||this.largeFormatSizeEnabled(t))).forEach((({size:s,id:r})=>{var o;const l=t&&null!=(o=n.initial.outstreamSiteId)?o:n.initial.siteId,d={outstreamCapable:t&&e.location!==ge.Video_StickyOutstream,initial:a};if(i.push(this.getPrebidAdUnitBidRequest(l,s,r,e.placementMapName,t,d)),a&&n.refresh){const o={outstreamCapable:t,refresh:a},l=n.refresh.siteId;i.push(this.getPrebidAdUnitBidRequest(l,s,r,e.placementMapName,t,o))}})),i}largeFormatSizeEnabled([e,t]){return this._largeFormatSizes.some((([i,s])=>e===i&&t===s))}getVideoSizeSites(e){return e.filter((e=>Iu.has(e.name))).reduce(((e,t)=>[...e,...Iu.get(t.name).filter((({device:e,size:i})=>(!e||e&&e===this._device)&&t.size[0]===i[0]&&t.size[1]===i[1])).map((e=>({video:t,sizeSite:e})))]),[])}constructor(e,t,i,s,r,n){super(e),this._prebidMethods=t,this._mediaType=i,this._nativeExperiment=s,this._context=r,this._ixRefreshExperiment=n,this._bidderName=ae.IndexExchange,this._device=Bt()?"desktop":"mobile",this._hasLargeFormatsEnabled=Bt()?this._config.adTypes.largeFormatsDesktop:this._config.adTypes.largeFormatsMobile,this._largeFormatSizes=this._hasLargeFormatsEnabled?"desktop"===this._device?[[728,410]]:[[320,480]]:[],this.bidderConfig=this._config.partners.getBidderConfig(ae.IndexExchange),this.videoCreativeIds=[["138323461889",ae.IndexExchange],["138365130553",ae.IndexExchange],["138323602520",ae.IndexExchange],["138323911414",ae.IndexExchange],["138365130307",ae.IndexExchange],["138323648223",ae.IndexExchange],["138323911009",ae.IndexExchange],["138364758402",ae.IndexExchange],["138323523396",ae.IndexExchange],["138364703774",ae.IndexExchange],["138323464748",ae.IndexExchange],["138364758405",ae.IndexExchange],["138323911423",ae.IndexExchange],["138365130310",ae.IndexExchange],["138323911420",ae.IndexExchange],["138365130313",ae.IndexExchange],["138323911411",ae.IndexExchange],["138364758408",ae.IndexExchange],["138323911012",ae.IndexExchange],["138364703777",ae.IndexExchange],["138323523390",ae.IndexExchange],["138364758411",ae.IndexExchange],["138323523387",ae.IndexExchange],["138365130316",ae.IndexExchange],["138323911426",ae.IndexExchange],["138364758414",ae.IndexExchange],["138323911408",ae.IndexExchange],["138364703780",ae.IndexExchange],["138323911405",ae.IndexExchange],["138364703783",ae.IndexExchange],["138323523393",ae.IndexExchange],["138364758417",ae.IndexExchange],["138323911417",ae.IndexExchange],["138365130319",ae.IndexExchange]]}}xu=B([hs("IndexExchangeBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Ss?Object:Ss,void 0===vu?Object:vu,void 0===Pu?Object:Pu,void 0===Pr?Object:Pr,void 0===Ou?Object:Ou])],xu);const Ru=new Map([[_e.Video_Collapse_Autoplay_SoundOff,[{siteId:Te.Natashas_Kitchen,client:"_bRbD9p9sZK",server:"_tyXFRsb7b4",size:we.SIZE_640_360},{siteId:Te.Spend_With_Pennies,client:"_x8sgYI55G4",server:"_jg4wlPdEog",size:we.SIZE_640_360},{siteId:Te.AZ_Animals,client:"_d4LW55Tz6Z",server:"_vw404TGZKZ",size:we.SIZE_640_360},{siteId:Te.RecipeTin_Eats,client:"_hhjZvYrxAc",server:"_rsajlrnhno",size:we.SIZE_640_360},{siteId:Te.Sallys_Baking_Recipes,client:"_uEi7eMPnxq",server:"_gPZIDLm8j2",size:we.SIZE_640_360},{siteId:Te.Default,client:"_kWJDXIuROl",server:"_kkLiJTt47x",size:we.SIZE_640_360}]],[_e.Video_In_Post_ClicktoPlay_SoundOn,[{siteId:Te.Natashas_Kitchen,client:"_iSNq3tefXu",server:"_zXaUPeITLG",size:we.SIZE_640_360},{siteId:Te.Spend_With_Pennies,client:"_lCb7dfvNjq",server:"_cHXAF6BKmN",size:we.SIZE_640_360},{siteId:Te.AZ_Animals,client:"_tyYmCc4eCT",server:"_g2LAwxEvEs",size:we.SIZE_640_360},{siteId:Te.RecipeTin_Eats,client:"_bB1dCkFu32",server:"_sBUGeiExbU",size:we.SIZE_640_360},{siteId:Te.Sallys_Baking_Recipes,client:"_g9cki8b6xC",server:"_mBNCdbBCg7",size:we.SIZE_640_360},{siteId:Te.Default,client:"_fR1aawM8Zo",server:"_j08PBtvK4B",size:we.SIZE_640_360}]],[_e.Video_Individual_Autoplay_SOff,[{siteId:Te.Natashas_Kitchen,client:"_cSmQNecEfo",server:"_s5shEWGvJC",size:we.SIZE_640_360},{siteId:Te.Spend_With_Pennies,client:"_atcYOwsv5N",server:"_vx63n2bPCt",size:we.SIZE_640_360},{siteId:Te.AZ_Animals,client:"_qdsWDke6KD",server:"_ySOwZdo8WZ",size:we.SIZE_640_360},{siteId:Te.RecipeTin_Eats,client:"_eZmQSTrIMN",server:"_qxKutqq3kR",size:we.SIZE_640_360},{siteId:Te.Sallys_Baking_Recipes,client:"_gVAQIoM4cp",server:"_i2ILdAGFrc",size:we.SIZE_640_360},{siteId:Te.Default,client:"_nmpcOw19lD",server:"_mX7o0eM1jT",size:we.SIZE_640_360}]]]),Du=new Map([[_e.Video_Coll_SOff_Smartphone,[{siteId:Te.Natashas_Kitchen,client:"_oqaQNDGjZ4",server:"_cjATjOt7M3",size:we.SIZE_400_225},{siteId:Te.Spend_With_Pennies,client:"_g47ukW03bo",server:"_jdef3qyaew",size:we.SIZE_400_225},{siteId:Te.RecipeTin_Eats,client:"_kp8W0sdhdE",server:"_p3pJYWNuxp",size:we.SIZE_400_225},{siteId:Te.Sallys_Baking_Recipes,client:"_rsmG36HH8x",server:"_ngr9SeXdE7",size:we.SIZE_400_225},{siteId:Te.AZ_Animals,client:"_ghA53Kjqrh",server:"_xRJtnJlLcg",size:we.SIZE_400_225},{siteId:Te.Default,client:"_kUg4kKElHf",server:"_wraUX6ObGH",size:we.SIZE_400_225}]],[_e.Video_In_Post_ClicktoPlay_SoundOn,[{siteId:Te.Natashas_Kitchen,client:"_tBeS7Z4US3",server:"_pnaFOGgJHk",size:we.SIZE_400_225},{siteId:Te.Spend_With_Pennies,client:"_lsGboL0uST",server:"_el6JVb9qoD",size:we.SIZE_400_225},{siteId:Te.RecipeTin_Eats,client:"_wqAAlYzlij",server:"_dc6prrDilF",size:we.SIZE_400_225},{siteId:Te.Sallys_Baking_Recipes,client:"_zn7ZLevuPn",server:"_bjw2WhZN1K",size:we.SIZE_400_225},{siteId:Te.AZ_Animals,client:"_qaJQvOMII9",server:"_pCPyKofX1S",size:we.SIZE_400_225},{siteId:Te.Default,client:"_upDLM7q4jV",server:"_iNqGr1ZsCR",size:we.SIZE_400_225}]],[_e.Video_Individual_Autoplay_SOff,[{siteId:Te.Natashas_Kitchen,client:"_vWJq7i6Hsr",server:"_jE3UrcJ5WA",size:we.SIZE_400_225},{siteId:Te.Spend_With_Pennies,client:"_mx5iL6Bejc",server:"_rRtn5dy9zf",size:we.SIZE_400_225},{siteId:Te.RecipeTin_Eats,client:"_oUwmSg3ct7",server:"_bCZv43HA5e",size:we.SIZE_400_225},{siteId:Te.Sallys_Baking_Recipes,client:"_akUrKNgwMu",server:"_dZQibxLKPI",size:we.SIZE_400_225},{siteId:Te.AZ_Animals,client:"_uFi5ptAWHm",server:"_kCaQmZiXGS",size:we.SIZE_400_225},{siteId:Te.Default,client:"_fyab3CymN5",server:"_qeYOrszj4C",size:we.SIZE_400_225}]]]),Lu=new Map([["1000000",[{siteId:Te.Natashas_Kitchen,client:{mobile:"_hAsShWhZrX",desktop:"_hGHupdqGkR"},server:{mobile:"_dBn42PEYpT",desktop:"_bNu9DxaovG"},isOutstream:!1},{siteId:Te.Spend_With_Pennies,client:{mobile:"_ua1Af0iqiz",desktop:"_tHHlCZoftJ"},server:{mobile:"_yiSiyTNTr9",desktop:"_zOvUvvugIj"},isOutstream:!1},{siteId:Te.AZ_Animals,client:{mobile:"_lI4BEQnUxI",desktop:"_nVsVVfpDjN"},server:{mobile:"_d2hBOhJhxF",desktop:"_uo8nEFxOVu"},isOutstream:!1},{siteId:Te.RecipeTin_Eats,client:{mobile:"_wVm3mYeRml",desktop:"_iRqGIvmzUs"},server:{mobile:"_fK6uPhLCLl",desktop:"_yaaHKyz3Zk"},isOutstream:!1},{siteId:Te.Sallys_Baking_Recipes,client:{mobile:"_jvVwL9Fnun",desktop:"_nJqZtOhz0Q"},server:{mobile:"_dzb8opas5y",desktop:"_yC15vgTB1T"},isOutstream:!1},{siteId:Te.Default,client:{mobile:"_htv2gWQDl4",desktop:"_hIMWOFYOkG"},server:{mobile:"_fc3We7MSf8",desktop:"_p9dR36E2p7"},isOutstream:!1}]],["1000001",[{siteId:Te.Natashas_Kitchen,client:{mobile:"_eD6ub757kw",desktop:"_eD6ub757kw"},server:{mobile:"_hXKlqSHoHB",desktop:"_hXKlqSHoHB"},isOutstream:!1},{siteId:Te.Spend_With_Pennies,client:{mobile:"_fTyEwORc0V",desktop:"_fTyEwORc0V"},server:{mobile:"_gvad3bdvqr",desktop:"_gvad3bdvqr"},isOutstream:!1},{siteId:Te.AZ_Animals,client:{mobile:"_d3ReNcjIse",desktop:"_d3ReNcjIse"},server:{mobile:"_r5n7qvMsMJ",desktop:"_r5n7qvMsMJ"},isOutstream:!1},{siteId:Te.RecipeTin_Eats,client:{mobile:"_eWSWxaV6Xx",desktop:"_eWSWxaV6Xx"},server:{mobile:"_kvd1znrrGJ",desktop:"_kvd1znrrGJ"},isOutstream:!1},{siteId:Te.Sallys_Baking_Recipes,client:{mobile:"_k0TLw869op",desktop:"_k0TLw869op"},server:{mobile:"_lrQyIIv5M6",desktop:"_lrQyIIv5M6"},isOutstream:!1},{siteId:Te.Default,client:{mobile:"_zxmQwsW17E",desktop:"_zxmQwsW17E"},server:{mobile:"_npLCsRl0pb",desktop:"_npLCsRl0pb"},isOutstream:!1}]],["0100000",[{siteId:Te.Natashas_Kitchen,client:{mobile:"_eIhMof7yqe",desktop:"_byCkELixPr"},server:{mobile:"_lCC4Vz5HVq",desktop:"_c0YtPZCFAN"},isOutstream:!1},{siteId:Te.Spend_With_Pennies,client:{mobile:"_f1sGSYRKR3",desktop:"_q3eCqZRhdS"},server:{mobile:"_d6K4oqtod2",desktop:"_wwAn0mcH6d"},isOutstream:!1},{siteId:Te.AZ_Animals,client:{mobile:"_qwYKU8Qi3G",desktop:"_ohqIx8jj4D"},server:{mobile:"_ycHhS8LeQg",desktop:"_go3v3cJHBo"},isOutstream:!1},{siteId:Te.RecipeTin_Eats,client:{mobile:"_whqXDci8eJ",desktop:"_c8mUVLDZhB"},server:{mobile:"_a4F7BDxYvO",desktop:"_ry2nukXJCM"},isOutstream:!1},{siteId:Te.Sallys_Baking_Recipes,client:{mobile:"_fp2BsPBxqI",desktop:"_hYVLy7Ua4r"},server:{mobile:"_jHYRZMA3Rv",desktop:"_e1zarT1nQu"},isOutstream:!1},{siteId:Te.Default,client:{mobile:"_bDJEtXJaCQ",desktop:"_vzS4k9rMKu"},server:{mobile:"_mTkU31vSyD",desktop:"_uBJBQkzM4x"},isOutstream:!1}]],["1010000",[{siteId:Te.Natashas_Kitchen,client:{mobile:"_finwQXYsdW",desktop:"_hqpdpEgPND"},server:{mobile:"_aMXALPX3fS",desktop:"_hY1xJfGGVe"},isOutstream:!0},{siteId:Te.Spend_With_Pennies,client:{mobile:"_f8CIFfN0X9",desktop:"_u8FSFfE7br"},server:{mobile:"_ijhi0w8YvT",desktop:"_s5QXHlZsTW"},isOutstream:!0},{siteId:Te.AZ_Animals,client:{mobile:"_agHXJxfEse",desktop:"_eEANDb6t2k"},server:{mobile:"_l2FGd0utDq",desktop:"_zhrJRRWVYf"},isOutstream:!0},{siteId:Te.RecipeTin_Eats,client:{mobile:"_gSKH6aK6R4",desktop:"_jaMt5ZbQgI"},server:{mobile:"_ePFeBkTZqT",desktop:"_nn2s0plngX"},isOutstream:!0},{siteId:Te.Sallys_Baking_Recipes,client:{mobile:"_kIAYcCNe7d",desktop:"_rFrgDRiaQp"},server:{mobile:"_wUz9lluZW9",desktop:"_cKmNoetgxX"},isOutstream:!0},{siteId:Te.Default,client:{mobile:"_rEapvpk6cZ",desktop:"_oCKJ4D9jsI"},server:{mobile:"_d1ofpEpOuE",desktop:"_pJRjrqANDE"},isOutstream:!0}]],["1011000",[{siteId:Te.Natashas_Kitchen,client:{mobile:"_ecQ46kpFH4",desktop:"_hDLFEUkifu"},server:{mobile:"_cRzdV4tRUN",desktop:"_hDLFEUkifu"},isOutstream:!0},{siteId:Te.Spend_With_Pennies,client:{mobile:"_vOhgG6ZGQc",desktop:"_hDLFEUkifu"},server:{mobile:"_oBErk6NgT9",desktop:"_hDLFEUkifu"},isOutstream:!0},{siteId:Te.AZ_Animals,client:{mobile:"_dZU1BlrcQe",desktop:"_hDLFEUkifu"},server:{mobile:"_aGjeC3sjY2",desktop:"_hDLFEUkifu"},isOutstream:!0},{siteId:Te.RecipeTin_Eats,client:{mobile:"_zcdgs90WxP",desktop:"_hDLFEUkifu"},server:{mobile:"_sRHWp1P95W",desktop:"_hDLFEUkifu"},isOutstream:!0},{siteId:Te.Sallys_Baking_Recipes,client:{mobile:"_lLcxnJnUL0",desktop:"_hDLFEUkifu"},server:{mobile:"_mKff6SG1V4",desktop:"_hDLFEUkifu"},isOutstream:!0},{siteId:Te.Default,client:{mobile:"_hDLFEUkifu",desktop:"_hDLFEUkifu"},server:{mobile:"_d4LMbFjRkk",desktop:"_hDLFEUkifu"},isOutstream:!0}]],["1001000",[{siteId:Te.Natashas_Kitchen,client:{mobile:"_qy8FZvprXY",desktop:"_kEvPWSnblw"},server:{mobile:"_aYXzmplV9F",desktop:"_kEvPWSnblw"},isOutstream:!1},{siteId:Te.Spend_With_Pennies,client:{mobile:"_gsOgkDslR3",desktop:"_kEvPWSnblw"},server:{mobile:"_u5EkrC5vYV",desktop:"_kEvPWSnblw"},isOutstream:!1},{siteId:Te.AZ_Animals,client:{mobile:"_lGIFrPovZn",desktop:"_kEvPWSnblw"},server:{mobile:"_f4bL87KId1",desktop:"_kEvPWSnblw"},isOutstream:!1},{siteId:Te.RecipeTin_Eats,client:{mobile:"_gn64RSSM57",desktop:"_kEvPWSnblw"},server:{mobile:"_yDuCGfXmql",desktop:"_kEvPWSnblw"},isOutstream:!1},{siteId:Te.Sallys_Baking_Recipes,client:{mobile:"_gD0lSine9a",desktop:"_kEvPWSnblw"},server:{mobile:"_lx9tkSimU2",desktop:"_kEvPWSnblw"},isOutstream:!1},{siteId:Te.Default,client:{mobile:"_kEvPWSnblw",desktop:"_kEvPWSnblw"},server:{mobile:"_jiqa71nZQy",desktop:"_kEvPWSnblw"},isOutstream:!1}]],["0000110",[{siteId:Te.Natashas_Kitchen,client:{mobile:"_v5SMFEjDrr",desktop:"_fTbDngf8Ub"},server:{mobile:"_jGV537FxMJ",desktop:"_rzRzo7jEiB"},isOutstream:!1},{siteId:Te.Spend_With_Pennies,client:{mobile:"_lX0mmLqXOH",desktop:"_zQGKRsK2OR"},server:{mobile:"_qH1l1kyPi3",desktop:"_pBJnthmHgl"},isOutstream:!1},{siteId:Te.AZ_Animals,client:{mobile:"_lUXeoSZAf0",desktop:"_pXYJ80T5VN"},server:{mobile:"_jxiRracsTG",desktop:"_ndFYWLoiBo"},isOutstream:!1},{siteId:Te.RecipeTin_Eats,client:{mobile:"_qQ8NEcQY1C",desktop:"_gGD1SYrcGe"},server:{mobile:"_dbjFQeqonB",desktop:"_yG4Q6pfCcA"},isOutstream:!1},{siteId:Te.Sallys_Baking_Recipes,client:{mobile:"_kFc3pV1c0n",desktop:"_mzspF6n1E6"},server:{mobile:"_aSfWWLCYIF",desktop:"_oFaxWSuc5h"},isOutstream:!1},{siteId:Te.Default,client:{mobile:"_hRaLC9FgYn",desktop:"_yI7yqradgk"},server:{mobile:"_qkzet6WYFk",desktop:"_cw6zRI7FoH"},isOutstream:!1}]],["0000100",[{siteId:Te.Natashas_Kitchen,client:{mobile:"_r4fIEDQTLY",desktop:"_baT851TDWI"},server:{mobile:"_ecjCX4kPwm",desktop:"_qQwA2mxuBj"},isOutstream:!1},{siteId:Te.Spend_With_Pennies,client:{mobile:"_rAF97HOGTF",desktop:"_l4gY7l7f5a"},server:{mobile:"_jTzFFJiTJD",desktop:"_hBe1suFVbp"},isOutstream:!1},{siteId:Te.AZ_Animals,client:{mobile:"_mqFteTH9Rj",desktop:"_d7BTJmSlpc"},server:{mobile:"_vuHz64bKFd",desktop:"_r9dNt9173p"},isOutstream:!1},{siteId:Te.RecipeTin_Eats,client:{mobile:"_qs6lmj0Pbf",desktop:"_p950SHR2Xv"},server:{mobile:"_lx5UxDlx0g",desktop:"_lLRgz2kTfw"},isOutstream:!1},{siteId:Te.Sallys_Baking_Recipes,client:{mobile:"_maZsbF5qjH",desktop:"_lZNyxSw6Ss"},server:{mobile:"_vTQcRjZrSS",desktop:"_gund5mIKg5"},isOutstream:!1},{siteId:Te.Default,client:{mobile:"_iyznbek6ki",desktop:"_fPM3feDxUE"},server:{mobile:"_xgNGHBHpEp",desktop:"_uqR67yraqv"},isOutstream:!1}]],["0000010",[{siteId:Te.Natashas_Kitchen,client:{mobile:"_cxVgq7bff1",desktop:"_paxUDMm9of"},server:{mobile:"_oMCKtxsq0T",desktop:"_uXClSLcqiX"},isOutstream:!1},{siteId:Te.Spend_With_Pennies,client:{mobile:"_nhQCrEk0GT",desktop:"_iGYXTwKJkq"},server:{mobile:"_vg5Tj9cQlS",desktop:"_ix2Vu5yio6"},isOutstream:!1},{siteId:Te.AZ_Animals,client:{mobile:"_yc0KcUV2Sb",desktop:"_gaEp6ub3Uz"},server:{mobile:"_lhuIK8d0HO",desktop:"_s1YBpsN41s"},isOutstream:!1},{siteId:Te.RecipeTin_Eats,client:{mobile:"_vwzo4mlIdf",desktop:"_p3pvAJLdvb"},server:{mobile:"_ol6ZhRXMRV",desktop:"_k5zqurOzN9"},isOutstream:!1},{siteId:Te.Sallys_Baking_Recipes,client:{mobile:"_vKGlgbERMK",desktop:"_x7OEkwJGD9"},server:{mobile:"_vaUAWXhKWM",desktop:"_wzZeDPhHwx"},isOutstream:!1},{siteId:Te.Default,client:{mobile:"_g1dEyYpnCU",desktop:"_wtAZ5wepHr"},server:{mobile:"_p2WCSP0fm1",desktop:"_bSkTYI5gwN"},isOutstream:!1}]]]),Mu=[ge.Below_Post,ge.Content_1,ge.Content_2,ge.Content_3,ge.Content_4,ge.Content_5,ge.Content_5,ge.Content_6,ge.Content_7,ge.Content_8,ge.Content_9,ge.Recipe_1,ge.Recipe_2,ge.Recipe_3,ge.Recipe_4,ge.Recipe_5,ge.Sidebar_1,ge.Sidebar_2,ge.Sidebar_3,ge.Sidebar_4,ge.Sidebar_5,ge.Sidebar_9],Bu=[ge.Below_Post,ge.Content_1],Fu=[ge.Below_Post,ge.Content],ju={desktop:Ru,mobile:Du},Nu=[ge.Below_Post,ge.Content_1,ge.Content_3,ge.Content_5,ge.Recipe_1];class Uu extends Jh{addLazySlotsToTypes(e){"mobile"===this._device&&Fu.includes(e.location)&&e.lazy&&Bu.push(e.name)}createBitStringAdOptions(e,t=!1){const i=e.hasSize([300,250]),s=e.hasSize([320,50]),r=e.hasSize([728,90]),n=e.hasSize([300,600]),a=e.hasSize([160,600]);this.addLazySlotsToTypes(e);return[+this.isBanner(e,i,s,n),+this.isHeader(e,r,s),+this.isOutstream(e,i,t),+this.isInterscroller(e),+this.isAnimatedFooter(e,s),+this.isExpandableFooter(e,s),+this.isSiderail(e,i||a||n)].join("")}isBanner(e,t,i,s){const r=e.location===ge.Sidebar;return(t||i||s&&r)&&Mu.includes(e.placementMapName)}isHeader(e,t,i){const s=[ge.Header_1,ge.Header_2];return(t||i)&&s.includes(e.placementMapName)}isOutstream(e,t,i=!1){const s=[ge.Content,ge.Header,ge.Below_Post,ge.Recipe];return t&&("desktop"===this._device&&s.includes(e.location)||"mobile"===this._device&&i&&Nu.includes(e.placementMapName)&&this._mediaType.outstreamEnabled(e).outstreamCapable)}isInterscroller(e){return"mobile"===this._device&&this._config.adTypes.has("interscroller")&&Bu.includes(e.placementMapName)}isAnimatedFooter(e,t){return("desktop"===this._device||this._config.adTypes.has("animatedFooter"))&&t&&e.placementMapName===ge.Footer_1}isExpandableFooter(e,t){return"mobile"===this._device&&t&&this._config.adTypes.has("expandableFooter")&&e.placementMapName===ge.Footer_1}isSiderail(e,t){return"desktop"===this._device&&t&&e.location===ge.Sidebar}getBannerSlotBidRequests(e){return this._getBidParams(e)}getOutstreamSlotBidRequests(e){if("desktop"!==this._device)return this._getBidParams(e,!0)}getVideoSlotBidRequests(e){const t=this._videoMap.get(e.name),i=[];return t?(this._bidders.forEach((t=>{const s="server"===t.type?"adSlotID":"placementId",r=this._videoMap.get(e.name).filter((e=>e.siteId===this._videoSiteID))[0][t.type];i.push({bidder:t.name,params:{[s]:r}})})),i):i}_getBidParams(e,t=!1){const i=this.createBitStringAdOptions(e,t);if(Lu.has(i))return this._bidders.map((s=>{const r="server"===s.type?"adSlotID":"placementId",n=Lu.get(i).filter((e=>e.siteId===this._siteID))[0];return{bidder:s.name,...this._addBidLabel(e.placementMapName,{outstreamCapable:n.isOutstream&&t}),params:{[r]:n[s.type][this._device]}}}))}constructor(e,t){super(e),this._mediaType=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.Kargo),this.adapterName=ae.Kargo,this.serverBidderName=ae.KargoServer,this.gvlid=972,this._device=Wt()?"mobile":"desktop",this._videoMap=ju[this._device],this._displaySiteMappings=[Te.AZ_Animals,Te.RecipeTin_Eats,Te.Sallys_Baking_Recipes,Te.Natashas_Kitchen,Te.Spend_With_Pennies],this._videoSiteMappings=[Te.RecipeTin_Eats,Te.Sallys_Baking_Recipes,Te.AZ_Animals,Te.Natashas_Kitchen,Te.Spend_With_Pennies],this._siteID=this._displaySiteMappings.includes(this._config.site.id)?this._config.site.id:"default",this._videoSiteID=this._videoSiteMappings.includes(this._config.site.id)?this._config.site.id:"default",this.videoCreativeIds=[["138381592896",ae.Kargo],["138381553202",ae.Kargo],["138381553217",ae.Kargo],["138381553238",ae.Kargo],["138381553328",ae.Kargo],["138381553214",ae.Kargo],["138381553235",ae.Kargo],["138381553244",ae.Kargo],["138381553331",ae.Kargo],["138381553334",ae.Kargo],["138382066465",ae.Kargo],["138381553241",ae.Kargo],["138381553325",ae.Kargo],["138381553337",ae.Kargo],["138381553340",ae.Kargo],["138382066468",ae.Kargo]],this.videoServerCreativeIds=[["138412278583",ae.KargoServer],["138411680693",ae.KargoServer],["138411680690",ae.KargoServer],["138411680687",ae.KargoServer],["138411680684",ae.KargoServer],["138411680681",ae.KargoServer],["138411680678",ae.KargoServer],["138411680264",ae.KargoServer]],this.settings={storageAllowed:["html5"]}}}Uu=B([hs("KargoBidder"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===vu?Object:vu])],Uu);class Vu extends Jh{getBannerSlotBidRequests(e){if(this._displayMap.has(e.placementMapName))return[{bidder:this.name,params:{uid:this._displayMap.get(e.placementMapName)}}]}getOutstreamSlotBidRequests(e){if(this._outstreamMap.has(e.placementMapName))return[{bidder:this.name,...this._addBidLabel(e.placementMapName,{outstreamCapable:e.location!==ge.Video_StickyOutstream}),params:{uid:this._outstreamMap.get(e.placementMapName)}}]}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.MediaGrid),this.settings={bidCpmAdjustment:(e,t)=>this._getCPMAdjustment(e,t),adserverTargeting:[{key:"hb_attr",val:e=>{var t,i;let s="trustx"===(null==e||null==(t=e.meta)?void 0:t.demandSource)?`trustx_${e.mediaType}`:e.mediaType;return(null==e||null==(i=e.meta)?void 0:i.isInBannerVideo)&&(s="ibv"),s}}]},this._getCPMAdjustment=(e,t)=>{const i=t.dealId,s=("vastUrl"in t||"vastXml"in t)&&i&&i.toString().includes("G-TRUSTX");return Qe(this._config,e,ae.MediaGrid,{...t,...s&&{dealId:void 0}})},this._displayMap=new Map([[ge.Below_Post,357],[ge.Content_1,358],[ge.Content_2,359],[ge.Content_3,360],[ge.Content_4,361],[ge.Content_5,362],[ge.Content_6,363],[ge.Content_7,364],[ge.Content_8,365],[ge.Content_9,366],[ge.Footer_1,367],[ge.Header_1,368],[ge.Header_2,369],[ge.Interstitial_1,48428],[ge.Recipe_1,370],[ge.Recipe_2,371],[ge.Recipe_3,372],[ge.Recipe_4,373],[ge.Sidebar_1,375],[ge.Sidebar_2,376],[ge.Sidebar_3,377],[ge.Sidebar_4,378],[ge.Sidebar_5,379],[ge.Sidebar_9,380]]),this._outstreamMap=new Map([[ge.Below_Post,415475],[ge.Content_1,415482],[ge.Content_3,415479],[ge.Content_5,415481],[ge.Recipe_1,420057],[ge.Video_StickyOutstream_1,133519]])}}Vu=B([hs("MediaGridBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],Vu);class zu extends Jh{getVideoSlotBidRequests(e){const t=Bt()?"desktop":"mobile";if(this._map.has(e.name))return this._map.get(e.name).filter((({device:e})=>!e||e===t)).map((({uid:e})=>({bidder:this.name,params:{uid:e}})))}constructor(e){super(e),this.gvlid=686,this.bidderConfig=this._config.partners.getBidderConfig(ae.MediaGridVideo),this.adapterName="grid",this.videoCreativeIds=[["138323922262",ae.MediaGridVideo],["138323922901",ae.MediaGridVideo],["138323922886",ae.MediaGridVideo],["138323922898",ae.MediaGridVideo],["138323922904",ae.MediaGridVideo],["138323923042",ae.MediaGridVideo],["138323922889",ae.MediaGridVideo],["138323923018",ae.MediaGridVideo],["138323922907",ae.MediaGridVideo],["138323922859",ae.MediaGridVideo],["138323923048",ae.MediaGridVideo],["138323923045",ae.MediaGridVideo],["138323923051",ae.MediaGridVideo],["138323923021",ae.MediaGridVideo],["138323922895",ae.MediaGridVideo],["138323922892",ae.MediaGridVideo]],this._map=new Map([[_e.Video_Collapse_Autoplay_SoundOff,[{uid:2163}]],[_e.Video_Coll_SOff_Smartphone,[{uid:2165}]],[_e.Video_In_Post_ClicktoPlay_SoundOn,[{device:"desktop",uid:2164},{device:"mobile",uid:6056}]],[_e.Video_Individual_Autoplay_SOff,[{device:"desktop",uid:2166},{device:"mobile",uid:6057}]]])}}zu=B([hs("MediaGridVideoBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],zu);class $u extends Jh{_addRecipePlacements(){const e=this._config.adTypes;(this._mobile?e.nativeMobileRecipe:e.nativeDesktopRecipe)&&this._eligibleUnits.push(ge.Recipe_1,ge.Recipe_2,ge.Recipe_3)}_addHeaderPlacements(){const e=this._config.adTypes;(this._mobile?e.nativeMobileHeader:e.nativeDesktopHeader)&&this._eligibleUnits.push(ge.Header_1)}_addSidebarPlacements(){const e=this._config.adTypes;!this._mobile&&e.nativeDesktopSidebar&&this._eligibleUnits.push(ge.Sidebar_1,ge.Sidebar_2)}_addContentPlacements(){const e=this._config.adTypes;(this._mobile?e.nativeMobileContent:e.nativeDesktopContent)&&this._eligibleUnits.push(ge.Content_1,ge.Content_2,ge.Content_3,ge.Content_4,ge.Content_5,ge.Content_6,ge.Content_7,ge.Content_8,ge.Content_9)}getBannerSlotBidRequests(e){if(this._map.has(e.placementMapName))return[{bidder:this.name,params:{}}]}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.Nativo),this.adapterName=ae.Nativo,this._mobile=Wt(),this._eligibleUnits=[ge.Footer_1],this._addContentPlacements(),this._addRecipePlacements(),this._addSidebarPlacements(),this._addHeaderPlacements(),this._map=new Set(this._eligibleUnits)}}$u=B([hs("NativoBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],$u);class Hu extends Jh{_lazyActiveTypes(e){return e.lazy&&this._lazyImpactParamsMap.has(e.location)&&this._lazyImpactParamsMap.get(e.location).filter((e=>this._config.adTypes[e]))}activeAdTypes(e){return this._highImpactParamsMap.has(e.placementMapName)&&this._highImpactParamsMap.get(e.placementMapName).filter((e=>this._config.adTypes[e]))}getBannerSlotBidRequests(e){if(this._map.has(e.placementMapName))return this._getBidParams(e)}getOutstreamSlotBidRequests(e){if(this._map.has(e.placementMapName))return this._getBidParams(e,!0)}getVideoSlotBidRequests(e){if(this._map.has(e.name)){var t;const i="all"===(null==(t=this._config.video.videoProtocols)?void 0:t.scope)?{protocols:this._config.video.videoProtocols.protocols}:"",s=this._map.get(e.name);return this._bidders.map((t=>{var r;return{bidder:t.name,params:{...this._params,unit:s[t.type].unit,video:{mimes:this._config.video.mimeType,api:this._config.video.apiValue,...i,pos:this._config.video.position.id,...(null==(r=this._config.video.playbackmethod)?void 0:r.get(e.name))&&{playbackmethod:this._config.video.playbackmethod.get(e.name)}}}}}))}}_getBidParams(e,t=!1){const i=this.activeAdTypes(e)||this._lazyActiveTypes(e)||[],s=this._map.get(e.placementMapName);return this._bidders.map((r=>({bidder:r.name,...this._addBidLabel(e.placementMapName,{outstreamCapable:t&&e.location!==ge.Video_StickyOutstream}),params:{...this._params,unit:s[r.type].unit,customParams:{...this._custParams,...i.length&&{hi_au:i.filter((e=>this._config.adTypes[e]))}}}})))}constructor(e,t){super(e),this._context=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.OpenX),this.adapterName=ae.OpenX,this.serverBidderName=ae.OpenXServer,this.gvlid=69,this.videoCreativeIds=[["138323525262",ae.OpenX],["138323914702",ae.OpenX],["138323526741",ae.OpenX],["138323526186",ae.OpenX],["138323526738",ae.OpenX],["138323526744",ae.OpenX],["138323526747",ae.OpenX],["138323526189",ae.OpenX],["138323914588",ae.OpenX],["138323526192",ae.OpenX],["138323526750",ae.OpenX],["138323466806",ae.OpenX],["138323468969",ae.OpenX],["138323914705",ae.OpenX],["138323526183",ae.OpenX],["138323526753",ae.OpenX]],this.videoServerCreativeIds=[["138411286398",ae.OpenXServer],["138411786451",ae.OpenXServer],["138411286395",ae.OpenXServer],["138411286392",ae.OpenXServer],["138411286401",ae.OpenXServer],["138411286389",ae.OpenXServer],["13841117744",ae.OpenXServer],["138411178055",ae.OpenXServer]],this._params={delDomain:"cafemedia-d.openx.net"},this._highImpactParamsMap=new Map([[ge.Content_1,["interscroller","miniscroller"]]]),this._lazyImpactParamsMap=new Map([[ge.Content,["interscroller","miniscroller"]],[ge.Recipe,["miniscroller"]],[ge.Below_Post,["interscroller","miniscroller"]]]),this._map=new Map([[ge.Below_Post,{client:{unit:"538699862"},server:{unit:"558245996"}}],[ge.Content_1,{client:{unit:"538699864"},server:{unit:"558245997"}}],[ge.Content_2,{client:{unit:"538699865"},server:{unit:"558245998"}}],[ge.Content_3,{client:{unit:"538699866"},server:{unit:"558245999"}}],[ge.Content_4,{client:{unit:"538699867"},server:{unit:"558246000"}}],[ge.Content_5,{client:{unit:"538699868"},server:{unit:"558246001"}}],[ge.Content_6,{client:{unit:"538699869"},server:{unit:"558246002"}}],[ge.Content_7,{client:{unit:"538699870"},server:{unit:"558246003"}}],[ge.Content_8,{client:{unit:"538699871"},server:{unit:"558246004"}}],[ge.Content_9,{client:{unit:"538699872"},server:{unit:"558246005"}}],[ge.Footer_1,{client:{unit:"538699840"},server:{unit:"558246006"}}],[ge.Header_1,{client:{unit:"538699873"},server:{unit:"558246007"}}],[ge.Header_2,{client:{unit:"538699874"},server:{unit:"558246008"}}],[ge.Interstitial_1,{client:{unit:"543876568"},server:{unit:"543876568"}}],[ge.Recipe_1,{client:{unit:"538699843"},server:{unit:"558246009"}}],[ge.Recipe_2,{client:{unit:"538699844"},server:{unit:"558246010"}}],[ge.Recipe_3,{client:{unit:"540594416"},server:{unit:"558246011"}}],[ge.Recipe_4,{client:{unit:"540751624"},server:{unit:"558246012"}}],[ge.Sidebar_1,{client:{unit:"538699853"},server:{unit:"558246014"}}],[ge.Sidebar_2,{client:{unit:"538699854"},server:{unit:"558246015"}}],[ge.Sidebar_3,{client:{unit:"538699855"},server:{unit:"558246016"}}],[ge.Sidebar_4,{client:{unit:"538699856"},server:{unit:"558246017"}}],[ge.Sidebar_5,{client:{unit:"538699857"},server:{unit:"558246018"}}],[ge.Sidebar_9,{client:{unit:"538699861"},server:{unit:"558246019"}}],[ge.Video_StickyOutstream_1,{client:{unit:"545721971"},server:{unit:"558246697"}}],[_e.Video_Collapse_Autoplay_SoundOff,{client:{unit:"540679731"},server:{unit:"558246727"}}],[_e.Video_Coll_SOff_Smartphone,{client:{unit:"540679733"},server:{unit:"558246726"}}],[_e.Video_In_Post_ClicktoPlay_SoundOn,{client:{unit:"540679727"},server:{unit:"558246662"}}],[_e.Video_Individual_Autoplay_SOff,{client:{unit:"540925853"},server:{unit:"558246728"}}]]),this._custParams={...this._config.site.filteredSensitiveCategories.length&&{sens:this._config.site.filteredSensitiveCategories},bucket:[this._context.bucket]}}}Hu=B([hs("OpenXBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr])],Hu);class qu extends Jh{get bidderDisplayEnabled(){return this._isCountryValid()}_isCountryValid(){const e=this._config;switch(this._context.country){case"GB":return e.gdpr.enabled;case"CA":return!0;default:return!1}}getBannerSlotBidRequests(e){var t;if(this._map.has(e.placementMapName))return[{bidder:this.name,params:{placementId:null==(t=this._map.get(e.placementMapName))?void 0:t.placementId,...this._params}}]}constructor(e,t){super(e),this._context=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.Ozone),this.adapterName=ae.Ozone,this._params={publisherId:"OZONERAP0001",siteId:"1500000160"},this._map=new Map([[ge.Content,{placementId:"3500013089"}],[ge.Content_1,{placementId:"3500013090"}],[ge.Content_2,{placementId:"3500013091"}],[ge.Content_3,{placementId:"3500013092"}],[ge.Content_4,{placementId:"3500013093"}],[ge.Content_5,{placementId:"3500013094"}],[ge.Content_6,{placementId:"3500013095"}],[ge.Content_7,{placementId:"3500013096"}],[ge.Content_8,{placementId:"3500013097"}],[ge.Content_9,{placementId:"3500013098"}],[ge.Header_1,{placementId:"3500013099"}],[ge.Header_2,{placementId:"3500013100"}],[ge.Sidebar_1,{placementId:"3500013101"}],[ge.Sidebar_2,{placementId:"3500013102"}],[ge.Sidebar_3,{placementId:"3500013103"}],[ge.Sidebar_4,{placementId:"3500013104"}],[ge.Sidebar_5,{placementId:"3500013105"}],[ge.Sidebar_9,{placementId:"3500013106"}],[ge.Below_Post,{placementId:"3500013107"}],[ge.Below_Post_1,{placementId:"3500013108"}],[ge.Footer_1,{placementId:"3500013109"}],[ge.Recipe_1,{placementId:"3500013110"}],[ge.Recipe_2,{placementId:"3500013111"}],[ge.Recipe_3,{placementId:"3500013112"}],[ge.Recipe_4,{placementId:"3500013113"}],[ge.Recipe_5,{placementId:"3500013114"}]])}}qu=B([hs("OzoneBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr])],qu);class Gu extends Jh{getBannerSlotBidRequests(e){return this._getDisplayBidRequests(e)}getMultiFormatSlotBidRequests(e){return this._getDisplayBidRequests(e)}_getDisplayBidRequests(e){const t=[],i={banner:this._map,native:this._nativeMap};return Object.keys(i).forEach((s=>{const r="native"===s,n=i[s].get(e.placementMapName);if(!n||r&&!e.nativeEnabled)return;if(this.prebidClientSide.enabled){const i=this._getBidParams(this.name,n.client,e,!1,r);t.push(i)}const a=this._getBidParams(this.serverBidderName,n.server,e,!1,r);t.push(a)})),t}getOutstreamSlotBidRequests(e){const t=[];return this._map.has(e.placementMapName)&&(t.push(this._getBidParams(this.name,this._map.get(e.placementMapName).client,e,!1)),t.push(this._getBidParams(this.serverBidderName,this._map.get(e.placementMapName).server,e,!1))),t}_getBidParams(e,t,i,s=!1,r=!1){return{bidder:e,...this._addBidLabel(i.placementMapName,{outstreamCapable:s}),params:{publisherId:this.pubId,adSlot:r?t:`${t}@${i.sizes[0][0]}x${i.sizes[0][1]}`,...this._config.site.filteredSensitiveCategories.length>0&&this._shouldSendPMZoneId()&&{pmzoneid:this._config.site.filteredSensitiveCategories.join(",")}}}}getVideoSlotBidRequests(e){const t=[];return this._map.has(e.name)&&(t.push(this.getVideoBidParams(this.name,this._map.get(e.name).client,e)),t.push(this.getVideoBidParams(this.serverBidderName,this._map.get(e.name).server,e))),t}getDCTRParam(){const e=[],t=this._irisTvTracker.enabled?this._irisTvTracker.irisContextualData:void 0;return t&&t.length&&e.push(`iris_context=${t.toString()}`),e.join("|")}getVideoBidParams(e,t,i){var s,r;const n=this.getDCTRParam();return{bidder:e,params:{publisherId:this.pubId,...n&&{dctr:n},video:{mimes:this._config.video.mimeType,api:this._config.video.apiValue,..."all"===(null==(s=this._config.video.videoProtocols)?void 0:s.scope)&&{protocols:this._config.video.videoProtocols.protocols},...(null==(r=this._config.video.playbackmethod)?void 0:r.get(i.name))&&{playbackmethod:this._config.video.playbackmethod.get(i.name)}},adSlot:`${t}@${i.size[0]}x${i.size[1]}`,...this._config.site.filteredSensitiveCategories.length>0&&this._shouldSendPMZoneId()&&{pmzoneid:this._config.site.filteredSensitiveCategories.join(",")}}}}_shouldSendPMZoneId(){return"bc"!==this._pubMaticBcatExperiment.result}constructor(e,t,i,s){super(e),this._irisTvTracker=t,this.prebidClientSide=i,this._pubMaticBcatExperiment=s,this.multiformatBidder=!0,this.bidderConfig=this._config.partners.getBidderConfig(ae.Pubmatic),this.adapterName=ae.Pubmatic,this.serverBidderName=ae.PubmaticServer,this.gvlid=76,this.videoCreativeIds=[["138323526825",ae.Pubmatic],["138323915419",ae.Pubmatic],["138323915299",ae.Pubmatic],["138323527095",ae.Pubmatic],["138323469392",ae.Pubmatic],["138323915422",ae.Pubmatic],["138323469395",ae.Pubmatic],["138323469389",ae.Pubmatic],["138323469383",ae.Pubmatic],["138323469320",ae.Pubmatic],["138323469317",ae.Pubmatic],["138323527092",ae.Pubmatic],["138323469401",ae.Pubmatic],["138323469398",ae.Pubmatic],["138323469386",ae.Pubmatic],["138323469404",ae.Pubmatic]],this.videoServerCreativeIds=[["138337271609",ae.PubmaticServer],["138337343196",ae.PubmaticServer],["138337343229",ae.PubmaticServer],["138337720879",ae.PubmaticServer],["138337720885",ae.PubmaticServer],["138337343202",ae.PubmaticServer],["138337343211",ae.PubmaticServer],["138337343217",ae.PubmaticServer],["138337343232",ae.PubmaticServer],["138337720597",ae.PubmaticServer],["138337720888",ae.PubmaticServer],["138337343199",ae.PubmaticServer],["138337343214",ae.PubmaticServer],["138337343223",ae.PubmaticServer],["138337343226",ae.PubmaticServer],["138337343220",ae.PubmaticServer]],this.pubId="157347",this._map=new Map([[ge.Below_Post,{client:"BelowPost1",server:"BelowPost1_XandrS2S"}],[ge.Content_1,{client:"Content1",server:"Content1_XandrS2S"}],[ge.Content_2,{client:"Content2",server:"Content2_XandrS2S"}],[ge.Content_3,{client:"Content3",server:"Content3_XandrS2S"}],[ge.Content_4,{client:"Content4",server:"Content4_XandrS2S"}],[ge.Content_5,{client:"Content5",server:"Content5_XandrS2S"}],[ge.Content_6,{client:"Content6",server:"Content6_XandrS2S"}],[ge.Content_7,{client:"Content7",server:"Content7_XandrS2S"}],[ge.Content_8,{client:"Content8",server:"Content8_XandrS2S"}],[ge.Content_9,{client:"Content9",server:"Content9_XandrS2S"}],[ge.Footer_1,{client:"Footer1",server:"Footer1_XandrS2S"}],[ge.Header_1,{client:"Header1",server:"Header1_XandrS2S"}],[ge.Header_2,{client:"Header2",server:"Header2_XandrS2S"}],[ge.Interstitial_1,{client:"interstitial",server:"interstitial_XandrS2S"}],[ge.Recipe_1,{client:"Recipe1",server:"Recipe1_XandrS2S"}],[ge.Recipe_2,{client:"Recipe2",server:"Recipe2_XandrS2S"}],[ge.Recipe_3,{client:"Recipe3",server:"Recipe3_XandrS2S"}],[ge.Recipe_4,{client:"Recipe4",server:"Recipe4_XandrS2S"}],[ge.Sidebar_1,{client:"Sidebar1",server:"Sidebar1_XandrS2S"}],[ge.Sidebar_2,{client:"Sidebar2",server:"Sidebar2_XandrS2S"}],[ge.Sidebar_3,{client:"Sidebar3",server:"Sidebar3_XandrS2S"}],[ge.Sidebar_4,{client:"Sidebar4",server:"Sidebar4_XandrS2S"}],[ge.Sidebar_5,{client:"Sidebar5",server:"Sidebar5_XandrS2S"}],[ge.Sidebar_9,{client:"Sidebar9",server:"Sidebar9_XandrS2S"}],[ge.Video_StickyOutstream_1,{client:"2267845",server:"4018943"}],[_e.Video_Collapse_Autoplay_SoundOff,{client:"1961309",server:"3437231"}],[_e.Video_Coll_SOff_Smartphone,{client:"1961310",server:"3437234"}],[_e.Video_In_Post_ClicktoPlay_SoundOn,{client:"1961308",server:"3437232"}],[_e.Video_Individual_Autoplay_SOff,{client:"2503033",server:"3443766"}]]),this._nativeMap=new Map([[ge.Content_1,{client:"Content1_Native",server:"Content1_Native_S2S"}],[ge.Content_2,{client:"Content2_Native",server:"Content2_Native_S2S"}],[ge.Content_3,{client:"Content3_Native",server:"Content3_Native_S2S"}],[ge.Content_4,{client:"Content4_Native",server:"Content4_Native_S2S"}],[ge.Content_5,{client:"Content5_Native",server:"Content5_Native_S2S"}],[ge.Content_6,{client:"Content6_Native",server:"Content6_Native_S2S"}],[ge.Content_7,{client:"Content7_Native",server:"Content7_Native_S2S"}],[ge.Content_8,{client:"Content8_Native",server:"Content8_Native_S2S"}],[ge.Content_9,{client:"Content9_Native",server:"Content9_Native_S2S"}]])}}Gu=B([hs("PubMaticBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===rd?Object:rd,void 0===Or?Object:Or,void 0===dd?Object:dd])],Gu);class Ku extends Jh{getBannerSlotBidRequests(e){return this._getBidParams(e)}getOutstreamSlotBidRequests(e){return this._getBidParams(e,!0)}getVideoSlotBidRequests(e){if(this._videoSet.has(e.name)){const t=`Adthrive${e.name}`.split("_").join("");return[{bidder:this.name,params:{pubId:this._pubId,zoneId:t}}]}}_getBidParams(e,t=!1){if(this._displaySet.has(e.placementMapName)){const i=e.id.split("_").slice(0,-1).join("");return[{bidder:this.name,...this._addBidLabel(e.placementMapName,{outstreamCapable:t&&e.location!==ge.Video_StickyOutstream}),params:{pubId:this._pubId,zoneId:i}}]}}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.ResetDigital),this.videoCreativeIds=[["138413962354",ae.ResetDigital],["138413962351",ae.ResetDigital],["138413962348",ae.ResetDigital],["138413454348",ae.ResetDigital],["138413351039",ae.ResetDigital],["138413346701",ae.ResetDigital],["138413346611",ae.ResetDigital],["138413169413",ae.ResetDigital]],this._pubId="118",this._displaySet=new Set([ge.Below_Post,ge.Content,ge.Content_1,ge.Content_2,ge.Content_3,ge.Content_4,ge.Content_5,ge.Content_6,ge.Content_7,ge.Content_8,ge.Content_9,ge.Footer_1,ge.Header_1,ge.Header_2,ge.Recipe_1,ge.Recipe_2,ge.Recipe_3,ge.Recipe_4,ge.Recipe_5,ge.Sidebar_1,ge.Sidebar_2,ge.Sidebar_3,ge.Sidebar_4,ge.Sidebar_5,ge.Sidebar_9,ge.Video_StickyOutstream_1]),this._videoSet=new Set([_e.Video_Coll_SOff_Smartphone,_e.Video_Collapse_Autoplay_SoundOff,_e.Video_In_Post_ClicktoPlay_SoundOn,_e.Video_Individual_Autoplay_SOff])}}Ku=B([hs("ResetDigitalBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],Ku);class Wu extends nr{init(){this._key="RtbHouseExperiment",this._default=!1}}Wu=B([hs("RtbHouseExperiment"),M()],Wu);class Yu extends Jh{get bidderDisplayEnabled(){const e=this._config;return this._rtbHouseExperiment.result&&e.fledge.enabled}getBannerSlotBidRequests(e){if(this._map.has(e.placementMapName))return[{bidder:this.name,params:{publisherId:"puHY4pgB9FOPeQBYYZEM",region:"prebid-us"}}]}constructor(e,t){super(e),this._rtbHouseExperiment=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.Rtbhouse),this.gvlid=16,this._map=new Set([ge.Below_Post,ge.Content_1,ge.Content_2,ge.Content_3,ge.Content_4,ge.Content_5,ge.Content_6,ge.Content_7,ge.Content_8,ge.Content_9,ge.Footer_1,ge.Header_1,ge.Header_2,ge.Recipe_1,ge.Recipe_2,ge.Recipe_3,ge.Recipe_4,ge.Recipe_5,ge.Sidebar_1,ge.Sidebar_2,ge.Sidebar_3,ge.Sidebar_4,ge.Sidebar_5,ge.Sidebar_9])}}Yu=B([hs("RtbHouseBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Wu?Object:Wu])],Yu);class Qu extends nr{init(){this._key="MagniteRefresh",this._default=!1}}Qu=B([hs("MagniteRefreshExperiment"),M()],Qu);class Xu extends Jh{getDisplayParams(e,t){return{accountId:9262,siteId:t===ge.Video_StickyOutstream?{server:420534,client:386004}[e]:{server:363698,client:180726}[e],...t===ge.Video_StickyOutstream&&{video:{language:"en"}}}}getVideoParams(e){return{accountId:9262,siteId:{server:375144,client:253996}[e],video:{language:"en"}}}getBannerSlotBidRequests(e){return this._getBidParams(e)}getMultiFormatSlotBidRequests(e){return this._getMultiformatBidParams(e)}getOutstreamSlotBidRequests(e){return this._getBidParams(e,!0)}getVideoSlotBidRequests(e){if(this._map.has(e.name))return this._bidders.map((t=>({bidder:t.name,params:{...this.getVideoParams(t.type),zoneId:this._map.get(e.name).initial[t.type]}})))}updateBidParams(e){this._addPositionParam(e,"atf")}_getMultiformatBidParams(e){const t=this._getBidParams(e,!1);return t&&t.forEach((e=>{e.params&&(e.params.bidonmultiformat=!0)})),t}_getBidParams(e,t=!1){const i=[ge.Content],s=this._magniteRefreshExperiment.result&&i.includes(e.location),r=t&&e.location!==ge.Video_StickyOutstream;if(this._map.has(e.placementMapName))return this._bidders.reduce(((t,i)=>{const n=(t=!1,s=!1)=>{const n=t&&!s,a=s?"refresh":"initial";return{bidder:i.name,...this._addBidLabel(e.placementMapName,{...n&&{initial:n},...s&&{refresh:s},outstreamCapable:r}),params:{...this.getDisplayParams(i.type,e.location),zoneId:this._map.get(e.placementMapName)[a][i.type],...e.isHighlyViewable()&&{position:"atf"}}}};return"client"===i.type&&r||(t.push(n(s)),s&&t.push(n(s,!0))),t}),[])}constructor(e,t){super(e),this._magniteRefreshExperiment=t,this.multiformatBidder=!0,this.bidderConfig=this._config.partners.getBidderConfig(ae.Rubicon),this.adapterName=ae.Rubicon,this.serverBidderName=ae.RubiconServer,this.alwaysOnBidder=!0,this.gvlid=52,this.videoCreativeIds=[["138323536473",ae.Rubicon],["138323540955",ae.Rubicon],["138323540961",ae.Rubicon],["138323540964",ae.Rubicon],["138323929606",ae.Rubicon],["138323480624",ae.Rubicon],["138323536455",ae.Rubicon],["138323540856",ae.Rubicon],["138323929612",ae.Rubicon],["138323480642",ae.Rubicon],["138323929516",ae.Rubicon],["138323480600",ae.Rubicon],["138323480636",ae.Rubicon],["138323536467",ae.Rubicon],["138323926693",ae.Rubicon],["138323536476",ae.Rubicon]],this.videoServerCreativeIds=[["138323542002",ae.RubiconServer],["138323932663",ae.RubiconServer],["138323544525",ae.RubiconServer],["138323932642",ae.RubiconServer],["138323544531",ae.RubiconServer],["138323544528",ae.RubiconServer],["138323932765",ae.RubiconServer],["138323932768",ae.RubiconServer],["138323932852",ae.RubiconServer],["138323932855",ae.RubiconServer],["138323544354",ae.RubiconServer],["138323932858",ae.RubiconServer],["138323544357",ae.RubiconServer],["138323544339",ae.RubiconServer],["138323932672",ae.RubiconServer],["138323932669",ae.RubiconServer]],this._map=new Map([[ge.Below_Post,{initial:{client:881394,server:1974272}}],[ge.Content_1,{initial:{client:881398,server:1974276},refresh:{client:3571264,server:3571284}}],[ge.Content_2,{initial:{client:881400,server:1974280},refresh:{client:3571268,server:3571286}}],[ge.Content_3,{initial:{client:881402,server:1974282},refresh:{client:3571270,server:3571288}}],[ge.Content_4,{initial:{client:881404,server:1974284},refresh:{client:3571272,server:3571290}}],[ge.Content_5,{initial:{client:881406,server:1974286},refresh:{client:3571274,server:3571292}}],[ge.Content_6,{initial:{client:881408,server:1974288},refresh:{client:3571276,server:3571294}}],[ge.Content_7,{initial:{client:881410,server:1974290},refresh:{client:3571278,server:3571296}}],[ge.Content_8,{initial:{client:881412,server:1974292},refresh:{client:3571280,server:3571298}}],[ge.Content_9,{initial:{client:881414,server:1974294},refresh:{client:3571282,server:3571300}}],[ge.Footer_1,{initial:{client:881416,server:1974296}}],[ge.Header_1,{initial:{client:881422,server:1974304}}],[ge.Header_2,{initial:{client:881426,server:1974306}}],[ge.Interstitial_1,{initial:{client:1979348,server:1979354}}],[ge.Recipe_1,{initial:{client:881428,server:1974308}}],[ge.Recipe_2,{initial:{client:881430,server:1974310}}],[ge.Recipe_3,{initial:{client:1187188,server:1974312}}],[ge.Recipe_4,{initial:{client:1279328,server:1974314}}],[ge.Sidebar_1,{initial:{client:881440,server:1974316}}],[ge.Sidebar_2,{initial:{client:881454,server:1974318}}],[ge.Sidebar_3,{initial:{client:881460,server:1974320}}],[ge.Sidebar_4,{initial:{client:881462,server:1974322}}],[ge.Sidebar_5,{initial:{client:881466,server:1974324}}],[ge.Sidebar_9,{initial:{client:881478,server:1974332}}],[ge.Video_StickyOutstream_1,{initial:{client:2150398,server:2384630}}],[_e.Video_Collapse_Autoplay_SoundOff,{initial:{client:1259006,server:2055644}}],[_e.Video_Coll_SOff_Smartphone,{initial:{client:1259010,server:2055648}}],[_e.Video_In_Post_ClicktoPlay_SoundOn,{initial:{client:1259008,server:2055642}}],[_e.Video_Individual_Autoplay_SOff,{initial:{client:1506800,server:2055646}}]])}}Xu=B([hs("RubiconBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Qu?Object:Qu])],Xu);const Ju=new Map([[ge.Below_Post,[{pkey:"WoVFJAUvQg9oowjifOQLhHfb"}]],[ge.Content_1,[{pkey:"9kDU40A4BJXchR7ikuWND5Ui"}]],[ge.Content_2,[{pkey:"ocdg6DMXhAfaTk7KgImuPCPi"}]],[ge.Content_3,[{pkey:"JQXmRwXj1jOjHCQF8ufXkKIJ"}]],[ge.Content_4,[{pkey:"7DEh5436UHnmeKGzVXQVsvRk"}]],[ge.Content_5,[{pkey:"ZWVmSVe4txKlxxCQoqMcGIus"}]],[ge.Content_6,[{pkey:"T3CRI7sep8LYNDkOrvgSZUPQ"}]],[ge.Content_7,[{pkey:"T4LKxfIKZJCqFzBemjae6MGu"}]],[ge.Content_8,[{pkey:"TIHmP6MqapPY4RpbkOm3pYpV"}]],[ge.Content_9,[{pkey:"mBGMr6mqftj8c2qcQky6UjEB"}]],[ge.Footer_1,[{pkey:"B1C8tQAkMN7kpCuxh1hW6CY8"}]],[ge.Header_1,[{pkey:"jStKXZxN8Ccuf6XS4dKqhKr9"}]],[ge.Header_2,[{pkey:"TJx2N6gevlYeFawnBbRy4gRl"}]],[ge.Recipe_1,[{pkey:"lklI3sAvIozfaIGNQGORtPOR"}]],[ge.Recipe_2,[{pkey:"nWhVYiRycgz0snwL4hTcS3vA"}]],[ge.Recipe_3,[{pkey:"XTsNJ5wTa3CksG40rnRNHiib"}]],[ge.Recipe_4,[{pkey:"BpO7D8zDzdyGmFUOGNcRhUUm"}]],[ge.Sidebar_1,[{pkey:"1BptSVedVseFELcEHmSjZmDr"}]],[ge.Sidebar_2,[{pkey:"TAk15aJmBw3jMFoV9vSYYWLl"}]],[ge.Sidebar_3,[{pkey:"oSwBRQCb6174NZ0wDEyxZW9E"}]],[ge.Sidebar_4,[{pkey:"UMKQPvhCYMOH1sOPVdYEDEQt"}]],[ge.Sidebar_5,[{pkey:"WdPWJ92IfPqKgO5vRXvlsDO4"}]],[ge.Sidebar_9,[{pkey:"k8W1t71k8qmkYsiK4v3pop6j"}]],[ge.Video_StickyOutstream_1,[{pkey:"qKjlCz8NOStHzB15G18scbgS"}]]]),Zu=new Map([[_e.Video_Collapse_Autoplay_SoundOff,[{pkey:"I5VjN89qESPMegBdpCt92W8S"}]],[_e.Video_Coll_SOff_Smartphone,[{pkey:"iZXbFkwkNrOgpI7ue8o3mJda"}]],[_e.Video_In_Post_ClicktoPlay_SoundOn,[{pkey:"sMLWZBQNa6GaKC2khQiIg5Tj"},{pkey:"yHkEhAMj24ubV101Fklbp6fA"}]],[_e.Video_Individual_Autoplay_SOff,[{pkey:"GCV9Do84nDBEFaVjb507H4iE"},{pkey:"6lY8mDlZX6W7ijhbh6OuDCfj"}]]]);class ep extends Jh{getBannerSlotBidRequests(e){const t=Ju.get(e.placementMapName);if(t&&e.location!==ge.Video_StickyOutstream)return this._getBidParams(e,t)}getOutstreamSlotBidRequests(e){const t=Ju.get(e.placementMapName);if(t&&e.location===ge.Video_StickyOutstream)return this._getBidParams(e,t)}getVideoSlotBidRequests(e){return Zu.get(e.name).map((({pkey:e})=>({bidder:this.name,params:{pkey:e}})))}_getBidParams(e,t){return t.map((({pkey:e})=>({bidder:this.name,params:{pkey:e}})))}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.Sharethrough),this.videoCreativeIds=[["138377683089",ae.Sharethrough],["138377670131",ae.Sharethrough],["138377670158",ae.Sharethrough],["138377670173",ae.Sharethrough],["138378141751",ae.Sharethrough],["138377670161",ae.Sharethrough],["138377670167",ae.Sharethrough],["138377670170",ae.Sharethrough],["138377670209",ae.Sharethrough],["138377670212",ae.Sharethrough],["138377670224",ae.Sharethrough],["138377669645",ae.Sharethrough],["138377670218",ae.Sharethrough],["138377670221",ae.Sharethrough],["138378141754",ae.Sharethrough],["138377670215",ae.Sharethrough]]}}ep=B([hs("SharethroughBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],ep);class tp extends Jh{lazyActiveTypes(e,t){if(!e.lazy)return!1;return[ge.Content,ge.Recipe,ge.Below_Post].includes(e.location)&&["interscroller","miniscroller"].includes(t)}createBitArrayAdOptions(e,t=!1){const i=Wt()?this._deviceAdTypes.mobile:this._deviceAdTypes.desktop,s=["1","0","0","0"],r=this._adUnitsMap.get(e.placementMapName);return this._adTypeBitIndexMap.forEach(((n,a)=>{const o=n.adType;i.includes(o)&&this._config.adTypes.has(o)&&(r.includes(o)||this.lazyActiveTypes(e,o))&&(s[n.index]="outstream"===a?t&&this._mediaType.outstreamEnabled(e).outstreamCapable?"1":"0":"1")})),s}getBannerSlotBidRequests(e){if(this._adUnitsMap.has(e.placementMapName)){const t=this.createBitArrayAdOptions(e),i=this._placementIdMap.get(t.join(""));return[{bidder:this.name,params:{placementId:i.id,pageId:this._pageId}}]}}getOutstreamSlotBidRequests(e){if(this._adUnitsMap.has(e.placementMapName)){const t=this.createBitArrayAdOptions(e,!0),i=this._placementIdMap.get(t.join(""));return[{bidder:this.name,...this._addBidLabel(e.placementMapName,{outstreamCapable:e.location!==ge.Video_StickyOutstream}),params:{placementId:i.id,pageId:this._pageId}}]}}constructor(e,t){super(e),this._mediaType=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.Teads),this._pageId=112062,this._adTypeBitIndexMap=new Map([["outstream",{adType:Wt()?"outstreamMobile":"outstreamDesktop",index:1}],["miniscroller",{adType:"miniscroller",index:2}],["interscroller",{adType:"interscroller",index:3}]]),this._adUnitsMap=new Map([[ge.Below_Post,[]],[ge.Content_1,["outstreamDesktop","outstreamMobile","miniscroller","interscroller"]],[ge.Content_2,["miniscroller","interscroller"]],[ge.Content_3,["outstreamDesktop","outstreamMobile","miniscroller","interscroller"]],[ge.Content_4,["miniscroller","interscroller"]],[ge.Content_5,["outstreamDesktop","outstreamMobile","miniscroller","interscroller"]],[ge.Content_6,["miniscroller","interscroller"]],[ge.Content_7,["miniscroller","interscroller"]],[ge.Content_8,["miniscroller","interscroller"]],[ge.Content_9,["miniscroller","interscroller"]],[ge.Footer_1,[]],[ge.Header_1,[]],[ge.Header_2,[]],[ge.Recipe_1,["outstreamDesktop","outstreamMobile","miniscroller"]],[ge.Recipe_2,["miniscroller"]],[ge.Recipe_3,["miniscroller"]],[ge.Recipe_4,["miniscroller"]],[ge.Sidebar_1,[]],[ge.Sidebar_2,[]],[ge.Sidebar_3,[]],[ge.Sidebar_4,[]],[ge.Sidebar_5,[]],[ge.Sidebar_9,[]]]),this._deviceAdTypes={mobile:["outstreamMobile","interscroller","miniscroller"],desktop:["outstreamDesktop"]},this._placementIdMap=new Map([["1000",{id:121842}],["1001",{id:121836}],["1010",{id:121835}],["1011",{id:121840}],["1100",{id:121834}],["1101",{id:121838}],["1110",{id:121837}],["1111",{id:121895}]])}}tp=B([hs("TeadsBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===vu?Object:vu])],tp);const ip=new Map([[ge.Interstitial_1,{desktop:{adTypes:[]},mobile:{adTypes:[]}}],[ge.Below_Post,{desktop:{adTypes:["nativeDesktopBelowPost"],sizes:[[728,250],[728,90]]},mobile:{adTypes:["nativeMobileBelowPost"],sizes:[[300,250],[320,100]]}}],[ge.Content_1,{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],[ge.Content_2,{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],[ge.Content_3,{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],[ge.Content_4,{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],[ge.Content_5,{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],[ge.Content_6,{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],[ge.Content_7,{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],[ge.Content_8,{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],[ge.Content_9,{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],[ge.Footer_1,{desktop:{adTypes:[]},mobile:{adTypes:[]}}],[ge.Header_1,{desktop:{adTypes:["nativeDesktopHeader"],sizes:[[970,250],[728,90]]},mobile:{adTypes:["nativeMobileHeader"],sizes:[[320,100]]}}],[ge.Header_2,{desktop:{adTypes:["nativeDesktopHeader"],sizes:[[970,250],[728,90]]},mobile:{adTypes:["nativeMobileHeader"],sizes:[[320,100]]}}],[ge.Recipe_1,{desktop:{adTypes:["nativeDesktopRecipe"]},mobile:{adTypes:["nativeMobileRecipe"]}}],[ge.Recipe_2,{desktop:{adTypes:["nativeDesktopRecipe"]},mobile:{adTypes:["nativeMobileRecipe"]}}],[ge.Recipe_3,{desktop:{adTypes:["nativeDesktopRecipe"]},mobile:{adTypes:["nativeMobileRecipe"]}}],[ge.Recipe_4,{desktop:{adTypes:["nativeDesktopRecipe"]},mobile:{adTypes:["nativeMobileRecipe"]}}],[ge.Recipe_5,{desktop:{adTypes:["nativeDesktopRecipe"]},mobile:{adTypes:["nativeMobileRecipe"]}}],[ge.Sidebar_1,{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],[ge.Sidebar_2,{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],[ge.Sidebar_3,{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],[ge.Sidebar_4,{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],[ge.Sidebar_5,{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],[ge.Sidebar_9,{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],[ge.Video_StickyOutstream_1,{desktop:{adTypes:[]},mobile:{adTypes:[]}}]]),sp=new Map([[_e.Video_Collapse_Autoplay_SoundOff,{client:"AdThriveRON_instream_desktopcollapse_prebid_c2s",server:"AdThriveRON_instream_desktopcollapse_prebid"}],[_e.Video_Coll_SOff_Smartphone,{client:"AdThriveRON_instream_mwebsticky_prebid_c2s",server:"AdThriveRON_instream_mwebsticky_prebid"}],[_e.Video_In_Post_ClicktoPlay_SoundOn,{client:"AdThriveRON_instream_CTP_prebid_c2s",server:"AdThriveRON_instream_CTP_prebid"}],[_e.Video_Individual_Autoplay_SOff,{client:"AdThriveRON_instream_contextcollapse_prebid_c2s",server:"AdThriveRON_instream_contextcollapse_prebid"}]]);class rp extends Jh{_getSharedSlotBidRequests(e){const t=this._mediaType.outstreamEnabled(e).outstreamCapable&&e.location!==ge.Video_StickyOutstream,i=Wt()?"mobile":"desktop",s=this._deviceAdTypes[i].filter((e=>this._config.adTypes.has(e))),r=[];if(ip.has(e.placementMapName)){let n=e.location===ge.Interstitial?ge.Interstitial.toLowerCase():"standard";const a=ip.get(e.placementMapName)[i];a.adTypes.forEach((e=>{s.includes(e)&&(n=e)}));this._getInventoryCode(n,e,a.sizes).forEach((i=>{this._bidders.forEach((s=>{const n=this._addBidLabel(e.placementMapName,{outstreamCapable:t&&i.indexOf("hive")>-1});r.push({bidder:s.name,...n,params:{inventoryCode:`${i}${"server"===s.type?"_pbs2s":""}`}})}))}))}return r}getBannerSlotBidRequests(e){return this._getSharedSlotBidRequests(e)}getOutstreamSlotBidRequests(e){return this._getSharedSlotBidRequests(e)}getMultiFormatSlotBidRequests(e){return this._getSharedSlotBidRequests(e)}_isOutstreamAndContentCapable(e){return"Content"===e.location&&this._mediaType.outstreamEnabled(e).outstreamCapable}_getLargeFormatPlacements(e,t){let i="";const s="mobile"===t,r=e.location===ge.Content&&s,n=s?this._config.adTypes.largeFormatsMobile:this._config.adTypes.largeFormatsDesktop;return r&&n&&(i=`adthriveron_${e.location.toLowerCase()}_${t}_largeformat_opt_in`),i}_stripSlotString(e){return e.replace(/_(?!.*_)/,"")}_getInventoryCode(e,t,i){const s=Wt()?"mobile":"desktop",r=[],n="standard"===e||this._standardInclusionAdTypes.includes(e),a=t.location.toLowerCase(),o=t.placementMapName===ge.Content_1||t.placementMapName===ge.Sidebar_9?a:this._stripSlotString(t.placementMapName.toLowerCase()),l=this._getLargeFormatPlacements(t,s);if(n){const e=t.placementMapName===ge.Below_Post?ge.Below_Post_1:t.placementMapName,i=t.placementMapName===ge.Video_StickyOutstream_1?`_${s}`:"";r.push(`adthrive_${e.toLowerCase()}${i}_hdx`)}else"interstitial"===e?r.push("adthriveron_interstitial_multisize"):r.push(`adthrive${this._category}_${o}_fixed_${s}`);if(i){const e=this._stripSlotString(a);i.filter((e=>t.sizes.some((([t,i])=>t===e[0]&&i===e[1])))).forEach((t=>{r.push(`adthriveron_${e}_${s}_${t[0]}x${t[1]}`)}),[])}return l&&r.push(l),this._isOutstreamAndContentCapable(t)&&r.push(`adthriveron_${a}_${s}_hive`),r}_getVideoBidParams(e,t,i){var s,r,n;return{bidder:e,params:{inventoryCode:i,video:{...Bt()?{w:640,h:360}:{w:400,h:225},api:this._config.video.apiValue,mimes:this._config.video.mimeType,..."all"===(null==(s=this._config.video.videoProtocols)?void 0:s.scope)&&{protocols:this._config.video.videoProtocols.protocols},playbackmethod:null==(n=this._config.video.playbackmethod)||null==(r=n.get(t.name))?void 0:r[0],pos:this._config.video.position.id}}}}getVideoSlotBidRequests(e){const t=[];return sp.has(e.name)&&this._bidders.forEach((i=>{t.push(this._getVideoBidParams(i.name,e,sp.get(e.name)[i.type]))})),t}_getCategory(){const e=this._config.site.verticals.filter((e=>this._verticalCategoryMap.has(e))).map((e=>this._verticalCategoryMap.get(e)));for(const t of this._categoryPriorityList)if(e.includes(t))return t}constructor(e,t){super(e),this._mediaType=t,this.multiformatBidder=!0,this.bidderConfig=this._config.partners.getBidderConfig(ae.Triplelift),this.adapterName=ae.Triplelift,this.serverBidderName=ae.TripleliftServer,this.gvlid=28,this.videoCreativeIds=[["138323510289",ae.Triplelift],["138323472959",ae.Triplelift],["138323472731",ae.Triplelift],["138323472671",ae.Triplelift],["138323472641",ae.Triplelift],["138323473061",ae.Triplelift],["138323473058",ae.Triplelift],["138323473019",ae.Triplelift],["138323473016",ae.Triplelift],["138323472986",ae.Triplelift],["138323472734",ae.Triplelift],["138323473064",ae.Triplelift],["138323473055",ae.Triplelift],["138323472728",ae.Triplelift],["138323472674",ae.Triplelift],["138323472737",ae.Triplelift],["138326649881",ae.Triplelift],["138326691825",ae.Triplelift],["138326691828",ae.Triplelift],["138326691831",ae.Triplelift],["138326691834",ae.Triplelift],["138326691837",ae.Triplelift],["138326691840",ae.Triplelift],["138326691843",ae.Triplelift],["138326691846",ae.Triplelift],["138326691783",ae.Triplelift],["138326691786",ae.Triplelift],["138326691789",ae.Triplelift],["138326691792",ae.Triplelift],["138326691753",ae.Triplelift],["138326691756",ae.Triplelift],["138326691570",ae.Triplelift]],this.videoServerCreativeIds=[["138348653814",ae.TripleliftServer],["138348654438",ae.TripleliftServer],["138349054156",ae.TripleliftServer],["138349054168",ae.TripleliftServer],["138349054201",ae.TripleliftServer],["138348654432",ae.TripleliftServer],["138348654444",ae.TripleliftServer],["138349054186",ae.TripleliftServer],["138349054204",ae.TripleliftServer],["138349054210",ae.TripleliftServer],["138349054435",ae.TripleliftServer],["138349054189",ae.TripleliftServer],["138349054207",ae.TripleliftServer],["138349054426",ae.TripleliftServer],["138349054429",ae.TripleliftServer],["138349054432",ae.TripleliftServer]],this._standardInclusionAdTypes=["nativeMobileHeader","nativeMobileBelowPost","nativeDesktopHeader","nativeDesktopBelowPost"],this.settings={adserverTargeting:[{key:"hb_attr",val:({mediaType:e,meta:t,tl_source:i})=>{let s=t&&t.mediaType||this.tlSourceMap.get(i||"")||e;return(null==t?void 0:t.isInBannerVideo)&&(s="ibv"),s}}]},this.tlSourceMap=new Map([["hdx","banner"],["tlx","native"]]),this._verticalCategoryMap=new Map([["Baby","family"],["Family and Parenting","family"],["Natural Parenting","family"],["Pregnancy","family"],["Toddler","family"],["Personal Finance","finance"],["Professional Finance","finance"],["Deals","finance"],["Clean Eating","food"],["Food","food"],["Crafts","home"],["Gardening","home"],["Green Living","home"],["Home Decor and Design","home"],["Pets","home"],["Travel","travel"],["News","news"],["Lifestyle","lifestyle"],["Beauty","lifestyle"],["Other","lifestyle"],["Health and Fitness","health"],["Entertainment","entertainment"],["Sports","sports"],["Womens Style","womensstyle"],["Mens Style and Grooming","mensstyle"],["Tech","tech"],["Wedding","wedding"],["Auto","auto"]]),this._categoryPriorityList=new Set(["food","home","family","finance","travel","news","health","entertainment","sports","womensstyle","mensstyle","tech","wedding","auto","lifestyle"]),this._category=bt(this._getCategory(),"lifestyle"),this._deviceAdTypes={mobile:["nativeMobileContent","nativeMobileRecipe","nativeMobileHeader","nativeMobileBelowPost"],desktop:["nativeDesktopContent","nativeDesktopRecipe","nativeDesktopSidebar","nativeDesktopHeader","nativeDesktopBelowPost"]}}}rp=B([hs("TripleLiftBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===vu?Object:vu])],rp);class np extends Jh{getBannerSlotBidRequests(e){if(this._set.has(e.placementMapName)&&e.location!==ge.Video_StickyOutstream)return this._getBidParams(e)}getOutstreamSlotBidRequests(e){if(this._set.has(e.placementMapName))return this._getBidParams(e,e.location!==ge.Video_StickyOutstream)}getVideoSlotBidRequests(e){if(this._set.has(e.name)){const t=`${e.name}`;return[{bidder:this.name,params:{publisherId:this._config.site.id,siteId:this._config.site.id,placementId:t,supplySourceId:"cafemedia"}}]}}_getBidParams(e,t=!1){const i=e.id,s=new RegExp(`_${this._device}`);return[{bidder:this.name,...this._addBidLabel(e.placementMapName,{outstreamCapable:t}),params:{publisherId:this._config.site.id,siteId:this._config.site.id,placementId:i.replace(s,""),supplySourceId:"cafemedia"}}]}constructor(e,t){super(e),this._context=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.TTD),this.videoCreativeIds=[["138323472896",ae.TTD],["138323532681",ae.TTD],["138323532645",ae.TTD],["138323532675",ae.TTD],["138323532678",ae.TTD],["138323922211",ae.TTD],["138323530488",ae.TTD],["138323532606",ae.TTD],["138323532648",ae.TTD],["138323922202",ae.TTD],["138323532672",ae.TTD],["138323922205",ae.TTD],["138323922010",ae.TTD],["138323922208",ae.TTD],["138323532642",ae.TTD],["138323921998",ae.TTD]],this._device=this._context.device,this._set=new Set([ge.Below_Post,ge.Content_1,ge.Content_2,ge.Content_3,ge.Content_4,ge.Content_5,ge.Content_6,ge.Content_7,ge.Content_8,ge.Content_9,ge.Footer_1,ge.Header_1,ge.Recipe_1,ge.Recipe_2,ge.Recipe_3,ge.Recipe_4,ge.Sidebar_1,ge.Sidebar_2,ge.Sidebar_3,ge.Sidebar_4,ge.Sidebar_5,ge.Sidebar_9,ge.Video_StickyOutstream_1,_e.Video_Collapse_Autoplay_SoundOff,_e.Video_Coll_SOff_Smartphone,_e.Video_In_Post_ClicktoPlay_SoundOn,_e.Video_Individual_Autoplay_SOff])}}np=B([hs("TTDBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr])],np);class ap extends Jh{getBannerSlotBidRequests(e){const t=(Wt()?this._deviceAdTypes.mobile:this._deviceAdTypes.desktop).filter((e=>this._config.adTypes.has(e)));if(this._map.has(e.placementMapName))return this._map.get(e.placementMapName).filter((({adType:i,mobileCollapsePlayer:s,size:r})=>(!i&&r.some((t=>e.hasSize(t)))||i&&t.includes(i))&&(!s||!this._config.video.mobileStickyPlayerOnPage))).map((({placementId:i,size:s,highViewability:r,adType:n})=>({bidder:this.name,...this._addBidLabel(e.placementMapName,{refresh:r&&e.viewability<this._config.marmalade.hvThreshold}),params:{...this._params,placementId:i,size:s.filter((i=>e.hasSize(i)||n&&t.includes(n)))}})))}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.Undertone),this._params={publisherId:2002},this._deviceAdTypes={mobile:["animatedFooter","expandableFooter","interscroller","miniscroller"],desktop:[]},this._map=new Map([[ge.Below_Post,[{placementId:"2002034",size:[[1,2]],adType:"interscroller",highViewability:!0}]],[ge.Content_1,[{placementId:"2002001",size:[[1,2]],adType:"interscroller"},{placementId:"2002002",size:[[1,2],[300,250],[728,90]]}]],[ge.Content_2,[{placementId:"2002003",size:[[1,2],[300,250],[728,90]]}]],[ge.Content_3,[{placementId:"2002004",size:[[1,2],[300,250],[728,90]]}]],[ge.Content_4,[{placementId:"2002005",size:[[1,2],[300,250],[728,90]]}]],[ge.Footer_1,[{placementId:"2002033",size:[[320,50]],adType:"expandableFooter"},{placementId:"2002038",size:[[1,1]],adType:"expandableFooter",mobileCollapsePlayer:!0},{placementId:"2002039",size:[[1,1]],adType:"animatedFooter"}]],[ge.Interstitial_1,[{placementId:"2002040",size:[[1,1]]}]],[ge.Sidebar_9,[{placementId:"2002032",size:[[300,250],[160,600],[300,600]]}]]])}}ap=B([hs("UndertoneBidder"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],ap);class op extends Jh{getVideoSlotBidRequests(e){if(this._videoMap.has(e.name))return[{bidder:this.name,params:{publisherId:this._params.publisherId,placementId:this._videoMap.get(e.name).placementId}}]}constructor(e){super(e),this.gvlid=677,this.bidderConfig=this._config.partners.getBidderConfig(ae.UndertoneServer),this.adapterName=ae.Undertone,this.videoCreativeIds=[["138422425195",ae.UndertoneServer],["138421771020",ae.UndertoneServer],["138421771017",ae.UndertoneServer],["138421771014",ae.UndertoneServer],["138421761770",ae.UndertoneServer],["138421761767",ae.UndertoneServer],["138421761764",ae.UndertoneServer],["138421761761",ae.UndertoneServer]],this._params={publisherId:2002},this._videoMap=new Map([[_e.Video_Collapse_Autoplay_SoundOff,{placementId:2002044}],[_e.Video_Coll_SOff_Smartphone,{placementId:2002045}]])}}op=B([hs("UndertoneServerBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],op);class lp extends Jh{_getBids(){return[{bidder:this.name,params:{...this._params}}]}getBannerSlotBidRequests(){return this._getBids()}getVideoSlotBidRequests(){return this._getBids()}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.Unruly),this.videoCreativeIds=[["138398568419",ae.Unruly],["138398715243",ae.Unruly],["138398716629",ae.Unruly],["138398716632",ae.Unruly],["138398716656",ae.Unruly],["138398716659",ae.Unruly],["138398716662",ae.Unruly],["138398716665",ae.Unruly],["138398716683",ae.Unruly],["138398716686",ae.Unruly],["138398716689",ae.Unruly],["138398716692",ae.Unruly],["138398716695",ae.Unruly],["138398716698",ae.Unruly],["138398716701",ae.Unruly],["138398716704",ae.Unruly]],this._params={siteId:249232}}}lp=B([hs("UnrulyBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],lp);const dp=new Map([[_e.Video_Collapse_Autoplay_SoundOff,{client:"8a96941a017e7e91c49492261bdf000c",server:"8a9695b901888852d78e6cde78c2003e"}],[_e.Video_Coll_SOff_Smartphone,{client:"8a9690ee017e7e91bee0922682f1000b",server:"8a9698af01888852cc626cde79b3002e"}],[_e.Video_In_Post_ClicktoPlay_SoundOn,{client:"8a969951017e7e91ba38923576c20011",server:"8a9695b901888852d78e6cde7a3b003f"}],[_e.Video_Individual_Autoplay_SOff,{client:"8a969951017e7e91ba389236dc470014",server:"8a9691d801888852d23d6cde79390031"}]]),cp={desktop:new Map([[ge.Content_1,[{size:[300,250],id:"8a969d580177771bc13c20458198007e"},{size:[728,90],id:"8a96918c0177771bc65220467ff60092"}]],[ge.Content_2,[{size:[300,250],id:"8a96918c0177771bc652204531fe0091"}]],[ge.Content_3,[{size:[300,250],id:"8a9694d00177771bcae220463a710058"}]],[ge.Footer_1,[{size:[728,90],id:"8a9694d00177771bcae21c6a7d880025"},{size:[970,90],id:"8a969d580177771bc13c2046cd280081"},{size:[320,50],id:"8a9694d00177771bcae2204408520056"}]],[ge.Header_1,[{size:[728,90],id:"8a969d580177771bc13c2045cac4007f"}]],[ge.Interstitial_1,[{size:[300,250],id:"8a969449017c7c9d384d9f8170b10066"},{size:[300,600],id:"8a969449017c7c9d384d9f80b9970064"},{size:[320,480],id:"8a969958017c7c9d2d8a9f812d360081"},{size:[336,280],id:"8a969449017c7c9d384d9f80f2a20065"}]],[ge.Sidebar_1,[{size:[300,250],id:"8a9694d00177771bcae2204449d80057"}]],[ge.Sidebar_9,[{size:[320,50],id:"8a969d580177771bc13c2045ff6b0080"},{size:[300,600],id:"8a96918c0177771bc6522043c8540090"},{size:[160,600],id:"8a969d580177771bc13c2044ea91007d"},{size:[300,250],id:"8a96918c0177771bc6521c6b5f4e003f"}]],[ge.Recipe_1,[{size:[300,250],id:"8a9694d00177771bcae21c6bc7e80027"}]],[ge.Recipe_2,[{size:[300,250],id:"8a969d580177771bc13c2044ac08007c"}]],[ge.Video_StickyOutstream_1,[{size:[300,250],id:"8a969d87017b7be074aae07a22b70005"}]]]),mobile:new Map([[ge.Content_1,[{size:[300,250],id:"8a969d580177771bc13c2048bd0e0085"},{size:[320,50],id:"8a969d580177771bc13c204b68670088"}]],[ge.Content_2,[{size:[300,250],id:"8a96918c0177771bc652204877c50094"},{size:[320,50],id:"8a96918c0177771bc652204b257e0097"}]],[ge.Content_3,[{size:[300,250],id:"8a96918c0177771bc6522048f24e0095"}]],[ge.Content_4,[{size:[300,250],id:"8a9694d00177771bcae220497831005a"}]],[ge.Content_5,[{size:[300,250],id:"8a969d580177771bc13c204a5f240087"}]],[ge.Content_6,[{size:[300,250],id:"8a9694d00177771bcae2204a9092005c"}]],[ge.Footer_1,[{size:[320,100],id:"8a96918c0177771bc652204a27cb0096"},{size:[300,50],id:"8a9694d00177771bcae22049449a0059"},{size:[728,90],id:"8a9694d00177771bcae2204ad481005d"},{size:[320,50],id:"8a969d580177771bc13c20480cf50084"}]],[ge.Interstitial_1,[{size:[300,250],id:"8a969161017c7c9d32879f82491c007d"},{size:[300,600],id:"8a969161017c7c9d32879f8195b3007c"},{size:[320,480],id:"8a969958017c7c9d2d8a9f81f2c50082"},{size:[336,280],id:"8a969449017c7c9d384d9f81c5660067"},{size:[320,50],id:"8a969449017c7c9d384d9f8279950068"}]],[ge.Recipe_1,[{size:[300,250],id:"8a96918c0177771bc6522048483a0093"}]],[ge.Recipe_2,[{size:[300,250],id:"8a9694d00177771bcae22049e596005b"}]],[ge.Recipe_3,[{size:[300,250],id:"8a969d580177771bc13c2049b47f0086"}]],[ge.Video_StickyOutstream_1,[{size:[300,50],id:"8a969d87017b7be074aae07a22b70005"}]]])},hp={desktop:new Map([[ge.Content_1,[{size:[300,250],id:"8a9698af01888852cc626cdc9c8a0024"},{size:[728,90],id:"8a9698af01888852cc626cdca2ac0026"}]],[ge.Content_2,[{size:[300,250],id:"8a9695b901888852d78e6cdc9c0a0036"}]],[ge.Content_3,[{size:[300,250],id:"8a9698af01888852cc626cdc9e100025"}]],[ge.Footer_1,[{size:[728,90],id:"8a9691d801888852d23d6cdc9b7e0027"},{size:[970,90],id:"8a9695b901888852d78e6cdc9fb40039"},{size:[320,50],id:"8a9691d801888852d23d6cdc9f220029"}]],[ge.Header_1,[{size:[728,90],id:"8a9691d801888852d23d6cdca335002a"}]],[ge.Interstitial_1,[{size:[300,250],id:"8a969449017c7c9d384d9f8170b10066"},{size:[300,600],id:"8a969449017c7c9d384d9f80b9970064"},{size:[320,480],id:"8a969958017c7c9d2d8a9f812d360081"},{size:[336,280],id:"8a969449017c7c9d384d9f80f2a20065"}]],[ge.Sidebar_1,[{size:[300,250],id:"8a9695b901888852d78e6cdc9a960035"}]],[ge.Sidebar_9,[{size:[320,50],id:"8a9695b901888852d78e6cdca1b7003a"},{size:[300,600],id:"8a9698af01888852cc626cdc9b0e0023"},{size:[160,600],id:"8a9698af01888852cc626cdca3db0027"},{size:[300,250],id:"8a9691d801888852d23d6cdc9cfd0028"}]],[ge.Recipe_1,[{size:[300,250],id:"8a9695b901888852d78e6cdc9d800037"}]],[ge.Recipe_2,[{size:[300,250],id:"8a9695b901888852d78e6cdc9ea70038"}]],[ge.Video_StickyOutstream_1,[{size:[300,250],id:"8a9695b901888852d78e6ce0245f0040"}]]]),mobile:new Map([[ge.Content_1,[{size:[300,250],id:"8a9698af01888852cc626cdca59d0028"},{size:[320,50],id:"8a9698af01888852cc626cdca7a8002a"}]],[ge.Content_2,[{size:[300,250],id:"8a9695b901888852d78e6cdca71a003c"},{size:[320,50],id:"8a9695b901888852d78e6cdca952003d"}]],[ge.Content_3,[{size:[300,250],id:"8a9698af01888852cc626cdca8b7002b"}]],[ge.Content_4,[{size:[300,250],id:"8a9691d801888852d23d6cdca525002c"}]],[ge.Content_5,[{size:[300,250],id:"8a9698af01888852cc626cdcab10002d"}]],[ge.Content_6,[{size:[300,250],id:"8a9691d801888852d23d6cdca44d002b"}]],[ge.Footer_1,[{size:[320,100],id:"8a9698af01888852cc626cdca68b0029"},{size:[300,50],id:"8a9695b901888852d78e6cdca4b6003b"},{size:[728,90],id:"8a9691d801888852d23d6cdca60e002d"},{size:[320,50],id:"8a9691d801888852d23d6cdcab9a0030"}]],[ge.Interstitial_1,[{size:[300,250],id:"8a969161017c7c9d32879f82491c007d"},{size:[300,600],id:"8a969161017c7c9d32879f8195b3007c"},{size:[320,480],id:"8a969958017c7c9d2d8a9f81f2c50082"},{size:[336,280],id:"8a969449017c7c9d384d9f81c5660067"},{size:[320,50],id:"8a969449017c7c9d384d9f8279950068"}]],[ge.Recipe_1,[{size:[300,250],id:"8a9691d801888852d23d6cdcaa71002f"}]],[ge.Recipe_2,[{size:[300,250],id:"8a9691d801888852d23d6cdca826002e"}]],[ge.Recipe_3,[{size:[300,250],id:"8a9698af01888852cc626cdca9ed002c"}]],[ge.Video_StickyOutstream_1,[{size:[300,50],id:"8a9695b901888852d78e6ce0245f0040"}]]])};class up extends Jh{getBannerSlotBidRequests(e){return this._getBidParams(e)}getOutstreamSlotBidRequests(e){return this._getBidParams(e,!0)}getVideoSlotBidRequests(e){const t=[];return this._bidders.forEach((i=>{dp.has(e.name)&&t.push({bidder:i.name,params:{...this._params.video[i.type],pos:dp.get(e.name)[i.type]}})})),t}_getBidParams(e,t=!1){const i=[];return this._bidders.forEach((s=>{this._map="server"===s.type?hp[this._device]:cp[this._device],!this._map.has(e.placementMapName)||t&&e.location!==ge.Video_StickyOutstream||this._map.get(e.placementMapName).filter((({size:t})=>e.hasSize(t))).forEach((({id:e})=>{i.push({bidder:s.name,params:{...t?this._params.video[s.type]:this._params.display[s.type],pos:e}})}))})),i}_setYahooMediaConfig(){this._prebidMethods.setConfig({yahoossp:{mode:"all"}})}constructor(e,t){super(e),this._prebidMethods=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.YahooSSP),this.adapterName=ae.YahooSSP,this.serverBidderName=ae.YahooSSPServer,this.gvlid=25,this._device=Wt()?"mobile":"desktop",this._map=new Map,this.videoCreativeIds=[["138379204183",ae.YahooSSP],["138378707447",ae.YahooSSP],["138378707558",ae.YahooSSP],["138378717711",ae.YahooSSP],["138378717726",ae.YahooSSP],["138378706907",ae.YahooSSP],["138378706928",ae.YahooSSP],["138378707468",ae.YahooSSP],["138378707561",ae.YahooSSP],["138378717720",ae.YahooSSP],["138378717783",ae.YahooSSP],["138378707552",ae.YahooSSP],["138378717723",ae.YahooSSP],["138378717780",ae.YahooSSP],["138378717786",ae.YahooSSP],["138378707555",ae.YahooSSP]],this.videoServerCreativeIds=[["138437164046",ae.YahooSSPServer],["138437164367",ae.YahooSSPServer],["138437170553",ae.YahooSSPServer],["138437192487",ae.YahooSSPServer],["138437199522",ae.YahooSSPServer],["138437199525",ae.YahooSSPServer],["138437199528",ae.YahooSSPServer],["138437854447",ae.YahooSSPServer]],this._params={display:{client:{dcn:Wt()?"8a969d580177771bc13c2047d6290082":"8a9694d00177771bcae21c6941d30023"},server:{dcn:Wt()?"8a9691d801888852d23d6cda98130025":"8a9698af01888852cc626cda97350021"}},video:{client:{dcn:"8a969469017b7bdf59b2e07862af0281"},server:{dcn:"8a9695b901888852d78e6cda98760033"}}},this._setYahooMediaConfig()}}up=B([hs("YahooSSPBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Ss?Object:Ss])],up);class pp extends Jh{getCreativeFormatId(e){const t=/creative_format_id":([0-9]*)/.exec(e);if(null!==t)return t[1]}isMiniScroller(e){return e.sequence&&this._config.adTypes.has("miniscroller")&&(e.location===ge.Content||e.location===ge.Recipe||e.lazy&&e.location===ge.Below_Post)}isNative(e){const t={mobile:new Map([[ge.Content,"nativeMobileContent"],[ge.Recipe,"nativeMobileRecipe"]]),desktop:new Map([[ge.Content,"nativeDesktopContent"],[ge.Recipe,"nativeDesktopRecipe"],[ge.Sidebar,"nativeDesktopSidebar"]])},i=Wt()?t.mobile:t.desktop;return e.sequence&&i.has(e.location)&&this._config.adTypes.has(i.get(e.location))}isOutstream(e){return this._mediaType.outstreamEnabled(e).outstreamCapable}isStickyOutstream(e){return e.location===ge.Video_StickyOutstream}isMobileOutstreamSingleInstance(e){return Wt()&&e.placementMapName===ge.Content_1&&this._mediaType.outstreamEnabled(e).outstreamCapable&&this._config.adTypes.has("outstreamMobile")&&!this._config.video.mobileStickyPlayerOnPage}createBitStringAdOptions(e,t=!1){let i=this._bannerMap.includes(e.placementMapName)?"1":"0";return i+=t&&this.isOutstream(e)?"1":"0",i+=this.isMiniScroller(e)?"1":"0",i+=this.isNative(e)?"1":"0",i+=t&&this.isMobileOutstreamSingleInstance(e)?"1":"0",i+=t&&this.isStickyOutstream(e)?"1":"0",i}getBannerSlotBidRequests(e){let t;const i=this.createBitStringAdOptions(e);if(this._adOptionsMap.has(i)){t=this._adOptionsMap.get(i).id}return this._config.video.hasStickyOutstream||e.placementMapName!==ge.Footer_1||(t="3457550240226157077"),[{bidder:this.name,params:{placementId:t}}]}getOutstreamSlotBidRequests(e){const t=this.createBitStringAdOptions(e,!0);if(this._adOptionsMap.has(t)){const i=this._adOptionsMap.get(t);return[{bidder:this.name,...this._addBidLabel(e.placementMapName,{outstreamCapable:e.location!==ge.Video_StickyOutstream}),params:{placementId:i.id,...e.location===ge.Video_StickyOutstream&&{video:{placement:2}}}}]}}getVideoSlotBidRequests(e){if(this._videoMap.has(e.name))return[{bidder:this.name,params:{placementId:this._videoMap.get(e.name)}}]}constructor(e,t){super(e),this._mediaType=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.Yieldmo),this.videoCreativeIds=[["138463806447",ae.Yieldmo],["138463975208",ae.Yieldmo],["138463975223",ae.Yieldmo],["138464489752",ae.Yieldmo],["138464489758",ae.Yieldmo],["138464489761",ae.Yieldmo],["138464490757",ae.Yieldmo],["138464490775",ae.Yieldmo]],this.settings={adserverTargeting:[{key:"hb_attr",val:e=>{var t;let i=this._creativeFormatMap.get(this.getCreativeFormatId(e.ad))||e.mediaType;return(null==e||null==(t=e.meta)?void 0:t.isInBannerVideo)&&(i="ibv"),i}}]},this._creativeFormatMap=new Map([["44","banner"],["47","banner"],["49","banner"],["50","banner"],["43","banner"],["17","banner"],["23","banner"],["33","banner"],["40","outstream"],["51","outstream"],["48","outstream"],["34","outstream"],["14","miniscroller"],["16","miniscroller"],["37","miniscroller"],["15","miniscroller"],["18","native"],["36","native"],["46","native"],["10","native"],["6","native"]]),this._adOptionsMap=new Map([["100000",{id:"2626064683911553041",isOutstream:!1}],["110000",{id:"2626064684062547986",isOutstream:!0}],["111000",{id:"2626064684196765715",isOutstream:!0}],["110100",{id:"2626064684339372052",isOutstream:!0}],["110010",{id:"2626064684498755605",isOutstream:!0}],["111100",{id:"2626064684632973334",isOutstream:!0}],["111010",{id:"2626064684775579671",isOutstream:!0}],["111110",{id:"2626064684934963224",isOutstream:!0}],["101000",{id:"2626064685069180953",isOutstream:!1}],["101100",{id:"2626064685203398682",isOutstream:!1}],["101010",{id:"2626064685337616411",isOutstream:!0}],["101110",{id:"2626064685471834140",isOutstream:!0}],["100100",{id:"2626064685606051869",isOutstream:!1}],["100110",{id:"2626064685740269598",isOutstream:!0}],["100010",{id:"2626064685882875935",isOutstream:!0}],["110110",{id:"2626807131797397582",isOutstream:!0}],["110001",{id:"3154492104504189746",isOutstream:!0}]]),this._bannerMap=[ge.Below_Post,ge.Content,ge.Content_1,ge.Content_2,ge.Content_3,ge.Content_4,ge.Content_5,ge.Content_6,ge.Content_7,ge.Content_8,ge.Content_9,ge.Footer_1,ge.Header_1,ge.Header_2,ge.Recipe_1,ge.Recipe_2,ge.Recipe_3,ge.Recipe_4,ge.Recipe_5,ge.Sidebar_1,ge.Sidebar_2,ge.Sidebar_3,ge.Sidebar_4,ge.Sidebar_5,ge.Sidebar_9,ge.Video_StickyOutstream_1],this._videoMap=new Map([[_e.Video_Collapse_Autoplay_SoundOff,"3137192266624344610"],[_e.Video_Coll_SOff_Smartphone,"3137192266808893988"],[_e.Video_Individual_Autoplay_SOff,"3137192266716619299"]])}}pp=B([hs("YieldmoBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===vu?Object:vu])],pp);class gp extends Jh{getPartnerIdFromDomain(){try{const e=ii(window.location.hostname);return e.split(".")[0].toLowerCase().replace("-","")}catch(e){return te.error("ConcertBidder","getPartnerIdFromDomain",e),""}}getBannerSlotBidRequests(e){if(this._map.has(e.placementMapName)&&e.hasSize(this._map.get(e.placementMapName))){const t=this.getPartnerIdFromDomain();if(t.length>0)return[{bidder:this.name,...this._addBidLabel(e.placementMapName,{refresh:!e.isHighlyViewable()}),params:{bidder:this.name,slot:e.id,partnerId:t,sizes:Wt()?this._mobileSizes:this._desktopSizes}}]}}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.Concert),this._map=new Map([[ge.Content_1,[300,250]]]),this._desktopSizes=[[620,366]],this._mobileSizes=[[325,508],[325,204]]}}var mp;gp=B([hs("ConcertBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],gp),function(e){e.display="Raptive_Display_RON",e.video="Raptive_Video_RON",e.outstream="Raptive_StickyOutstream_RON"}(mp||(mp={}));const _p={Raptive_Display_RON:{desktop:1819606,mobile:1819607},Raptive_Video_RON:{default:1819610},Raptive_StickyOutstream_RON:{default:1819614}};class fp extends Jh{getBannerSlotBidRequests(e){if(this._displaySet.has(e.placementMapName))return[{bidder:this.name,params:{mname:"Raptive_Display_RON",mid:Wt()?_p.Raptive_Display_RON.mobile:_p.Raptive_Display_RON.desktop,..."US"===this._context.country&&{adxDomain:this._adxDomain}}}]}getOutstreamSlotBidRequests(e){if(this._outstreamSet.has(e.placementMapName))return[{bidder:this.name,params:{mname:"Raptive_StickyOutstream_RON",mid:_p.Raptive_StickyOutstream_RON.default,adxDomain:this._adxDomain},...this._addBidLabel(e.placementMapName,{outstreamCapable:e.location!==ge.Video_StickyOutstream})}]}getVideoSlotBidRequests(e){if(this._videoSet.has(e.name))return[{bidder:this.name,params:{mname:"Raptive_Video_RON",mid:_p.Raptive_Video_RON.default,adxDomain:this._adxDomain}}]}constructor(e,t){super(e),this._context=t,this.bidderConfig=this._config.partners.getBidderConfig(ae.Adform),this.adapterName=ae.Adform,this.gvlid=50,this._adxDomain="adx2.adform.net",this.videoCreativeIds=[["138446479256",ae.Adform],["138446479406",ae.Adform],["138446479442",ae.Adform],["138446479445",ae.Adform],["138446479505",ae.Adform],["138446479508",ae.Adform],["138447155053",ae.Adform],["138447155056",ae.Adform]],this._displaySet=new Set([ge.Below_Post,ge.Content_1,ge.Content_2,ge.Content_3,ge.Content_4,ge.Content_5,ge.Content_6,ge.Content_7,ge.Content_8,ge.Content_9,ge.Footer_1,ge.Header_1,ge.Header_2,ge.Recipe_1,ge.Recipe_2,ge.Recipe_3,ge.Recipe_4,ge.Recipe_5,ge.Sidebar_1,ge.Sidebar_2,ge.Sidebar_3,ge.Sidebar_4,ge.Sidebar_5,ge.Sidebar_9]),this._videoSet=new Set([_e.Video_Coll_SOff_Smartphone,_e.Video_Collapse_Autoplay_SoundOff,_e.Video_In_Post_ClicktoPlay_SoundOn,_e.Video_Individual_Autoplay_SOff]),this._outstreamSet=new Set([ge.Video_StickyOutstream_1])}}fp=B([hs("AdformBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr])],fp);class vp extends Jh{get bidderDisplayEnabled(){return this._config.site.filteredSensitiveCategories.includes("alc")}getBannerSlotBidRequests(e){if(this._map.has(`${e.placementMapName}_${e.sequence}`)){const t=`${e.placementMapName}_${e.sequence}`;return this._map.get(t).filter((({adType:e})=>!e||this._config.adTypes.has(e))).map((({siteId:e,creativeType:t,publisherNameIdentifier:i,options:s})=>{const r={siteId:e,creativeType:t,publisherNameIdentifier:i};return s&&Object.keys(s).length&&(r.options=s),{bidder:this.name,params:r}}))}}constructor(e){super(e),this.bidderConfig=this._config.partners.getBidderConfig(ae.Flipp),this.adapterName=ae.Flipp,this._expandableCatalogAdType=Wt()?"expandableCatalogAdsMobile":"expandableCatalogAdsDesktop",this._map=new Map([[ge.Below_Post_1,[{siteId:1285424,creativeType:"NativeX",publisherNameIdentifier:"Raptive Prebid Standard",options:{startCompact:!1},adType:this._expandableCatalogAdType},{siteId:1285425,creativeType:"NativeX",publisherNameIdentifier:"Raptive Prebid Compact",options:{startCompact:!0}}]]])}}vp=B([hs("FlippBidder"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],vp);var yp=Object.freeze({__proto__:null,get AdformBidder(){return fp},get AidemBidder(){return eu},get AppNexusBidder(){return yu},Bidder:Jh,BidderBase:Xh,get ColossusServerBidder(){return bu},get ConcertBidder(){return gp},get ConversantBidder(){return Su},get CriteoBidder(){return Eu},get FlippBidder(){return vp},get GumGumBidder(){return Cu},get ImproveDigitalBidder(){return Tu},get IndexExchangeBidder(){return xu},get KargoBidder(){return Uu},get MediaGridBidder(){return Vu},get MediaGridVideoBidder(){return zu},get NativoBidder(){return $u},get OpenXBidder(){return Hu},get OzoneBidder(){return qu},get PubMaticBidder(){return Gu},get ResetDigitalBidder(){return Ku},get RtbHouseBidder(){return Yu},get RubiconBidder(){return Xu},get SharethroughBidder(){return ep},get TTDBidder(){return np},get TeadsBidder(){return tp},get ThirtyThreeAcrossBidder(){return Zh},get TripleLiftBidder(){return rp},get UndertoneBidder(){return ap},get UndertoneServerBidder(){return op},get UnrulyBidder(){return lp},get YahooSSPBidder(){return up},get YieldmoBidder(){return pp}});class bp{get orderedDisplayBidders(){return this._orderedDisplayBidders}get multiFormatBidders(){return this._multiFormatBidders}get orderedVideoBidders(){return this._orderedVideoBidders}get biddersParams(){return this._biddersParams}get videoCreativeIdMapping(){return this._videoCreativeIdMapping}_setVideoCreativeIdMap(){return new Map(this._orderedVideoBidders.reduce(((e,t)=>e.concat(t.videoCreativeIds||[],t.videoServerCreativeIds||[])),[]))}_getBidderEnablement(e){const t=this._config,i=e.name,s={adapterName:e.adapterName,bidderName:i,ccpa:t.ccpa,gdpr:t.gdpr,enablement:{display:{holdout:t.hbho.bidders,enabled:["bidderDisplayEnabled","enabled"]},video:{holdout:t.vbho.bidders,enabled:["bidderInstreamEnabled","videoEnabled"]}}};return this._getEnablement(e,s)}_getEnablement(e,t){const i={display:!1,video:!1},{adapterName:s,bidderName:r,ccpa:n,gdpr:a}=t;return["display","video"].forEach((o=>{const l=t.enablement[o],d=l.holdout,c=l.enabled,h="video"===o||!e.updateBidParams;i[o]=!!(c.every((t=>e[t]))&&this._holdoutValidation(d,r,s)&&this._ccpaValidation(n,r,s)&&this._gdprValidation(a,r,s)&&(h||this._biddersParams.set(r,e)))})),i}_holdoutValidation(e,t,i){return!e.length||!e.includes(i||t)}_ccpaValidation(e,t,i=""){return!e.enabled||!e.nonCompliantBidders.includes(i)&&!e.nonCompliantBidders.includes(t)}_gdprValidation(e,t,i=""){return!e.enabled||!e.nonCompliantBidders.includes(i)&&!e.nonCompliantBidders.includes(t)}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u,p,g,m,_,f,v,y,b,S,E,C,T,w,A,k,I,P,O,x){this._config=e,this._orderedDisplayBidders=[],this._orderedVideoBidders=[],this._biddersParams=new Map;[h,i,c,A,S,g,E,y,_,k,p,a,u,w,f,l,o,v,r,C,b,t,n,m,I,T,d,P,s,O,x].forEach((e=>{e.setup();const{display:t,video:i}=this._getBidderEnablement(e);t&&this._orderedDisplayBidders.push(e),i&&this._orderedVideoBidders.push(e)})),this._multiFormatBidders=this._orderedDisplayBidders.filter((e=>e.multiformatBidder)),this._videoCreativeIdMapping=this._setVideoCreativeIdMap()}}bp=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===yp||void 0===fp?Object:fp,void 0===yp||void 0===yu?Object:yu,void 0===yp||void 0===bu?Object:bu,void 0===yp||void 0===Su?Object:Su,void 0===yp||void 0===gp?Object:gp,void 0===yp||void 0===Eu?Object:Eu,void 0===yp||void 0===zu?Object:zu,void 0===yp||void 0===Cu?Object:Cu,void 0===yp||void 0===Tu?Object:Tu,void 0===yp||void 0===xu?Object:xu,void 0===yp||void 0===Uu?Object:Uu,void 0===yp||void 0===Vu?Object:Vu,void 0===yp||void 0===Hu?Object:Hu,void 0===yp||void 0===Gu?Object:Gu,void 0===yp||void 0===Ku?Object:Ku,void 0===yp||void 0===Xu?Object:Xu,void 0===yp||void 0===$u?Object:$u,void 0===yp||void 0===ep?Object:ep,void 0===yp||void 0===tp?Object:tp,void 0===yp||void 0===Zh?Object:Zh,void 0===yp||void 0===rp?Object:rp,void 0===yp||void 0===np?Object:np,void 0===yp||void 0===ap?Object:ap,void 0===yp||void 0===op?Object:op,void 0===yp||void 0===lp?Object:lp,void 0===yp||void 0===up?Object:up,void 0===yp||void 0===pp?Object:pp,void 0===yp||void 0===Yu?Object:Yu,void 0===yp||void 0===qu?Object:qu,void 0===yp||void 0===eu?Object:eu,void 0===yp||void 0===vp?Object:vp])],bp);class Sp extends nr{init(){this._key="CreativeMonitoring",this._default=!1}}Sp=B([hs("CreativeMonitoringExperiment"),M()],Sp);class Ep{setupCreativeEventListeners(){const e=this._prebidEventBus;e.auctionInit.on(this._storeAuctionData.bind(this)),e.adRenderFailed.on(this._renderFailedHandler.bind(this)),e.adRenderSucceeded.on(this._renderSucceededHandler.bind(this)),e.staleRender.on(this._staleRenderHandler.bind(this)),this._gamEventBus.slotRenderEnded.on(this._slotRenderEnded.bind(this)),this._gamEventBus.slotRequested.on(this._slotRequested.bind(this))}_slotRequested(e){const t=e.slot.id;this._gamRenderedData.has(t)&&this._gamRenderedData.delete(t)}_slotRenderEnded(e){this._gamRenderedData.set(e.slot.id,e),this._creativeMonitoringExperiment.result&&this._checkSlotRender(e)}_storeAuctionData(e){e.adUnitCodes.forEach((t=>this._auctionData.add(`${e.auctionId}-${t}`)))}_deleteStoredAuction(e,t){this._auctionData.delete(`${e}-${t}`)}_getSlotData(e){const t=this._slots.get(e);return{...t&&{slot:t.location,sequence:t.sequence,nref:t.refreshCount}}}_getGAMCreativeData(e){const t=this._gamRenderedData.get(e);return t?{lineItemId:t.event.lineItemId,creativeId:t.event.creativeId,campaignId:t.event.campaignId}:{}}_getBidData(e){return e?{...this._getPrebidBidDataFromBid(e),...this._getSlotData(e.adUnitCode),...this._getGAMCreativeData(e.adUnitCode)}:{}}_renderFailedHandler(e){setTimeout((()=>{const t=e.bid;t&&this._deleteStoredAuction(t.auctionId,t.adUnitCode);const i={message:e.message,reason:e.reason,...this._getBidData(t)};t&&t.meta&&Object.keys(t.meta).length>0?i.buyerInformation=t.meta:i.markup=t&&t.ad,te.error("PrebidAuctionManager","init","adRenderFailed",i)}),2e3)}_staleRenderHandler(e){e&&this._deleteStoredAuction(e.auctionId,e.adUnitCode),setTimeout((()=>{te.error("PrebidAuctionManager","init","staleRender",{...this._getBidData(e)})}),2e3)}_renderSucceededHandler(e){const t=e.bid;t&&this._deleteStoredAuction(t.auctionId,t.adUnitCode)}_isSafeFrame(e){const t=e.element.querySelector("iframe");return!(!t||!t.src)}_checkSlotRender(e){const t=e.event,i=this._config.prebid.advertiserId;this._isSafeFrame(e.slot)||t.advertiserId!==i||setTimeout((()=>{this._logUnknownFailure(e)}),2e3)}_getHeightWidth(e){if(!e)return{};const t=e.split("x").map(Number);return{...Array.isArray(t)&&2===t.length&&{height:t[1],width:t[0]}}}_getPrebidCreativeWindowData(e){return{adId:e.bidderAdId,bidder:e.bidder,size:e.bidderSize,adserverTargeting:e.targeting}}_getPrebidBidDataFromBid(e){return{price:e.adserverTargeting.hb_pb,bidderSize:e.size||e.adserverTargeting.hb_size,advertiserDomains:e.meta&&e.meta.advertiserDomains||e.adserverTargeting.hb_adomain,bidder:e.bidder}}_getPrebidBidderDataFromIframe(e){const t=e.element.querySelector("iframe").contentWindow;if(!t)return{};const{adId:i,adserverTargeting:s,bidder:r,size:n}=this._getPrebidCreativeWindowData(t),{height:a,width:o}=this._getHeightWidth(t&&t.bidderSize);return{adId:i,adserverTargeting:s,adUnitCode:e.id,bidder:r,height:a,size:n,width:o}}_logUnknownFailure(e){const t=this._context,i=e.slot,s=e.event,{adId:r,adserverTargeting:n,auctionId:a,adUnitCode:o,bidder:l,height:d,meta:c,size:h,width:u}=i.servedPrebidBidResponse||this._getPrebidBidderDataFromIframe(i);if(a&&o&&!this._auctionData.has(`${a}-${o}`))return;const p={adId:r,advertiserDomains:c&&c.advertiserDomains||n&&n.hb_adomain,bidderSize:h||n&&n.hb_size,bidder:l,branch:t.branch,bucket:t.bucket,campaignId:s.campaignId,creativeId:s.creativeId||s.sourceAgnosticCreativeId,lineItemId:s.lineItemId||s.sourceAgnosticLineItemId,message:"An unknown error occurred rendering the Prebid creative",nref:i.refreshCount,price:n&&n.hb_pb,sequence:i.sequence,slotSizes:i.sizes,slot:i.location,...u&&d&&{size:[u,d]},...c&&(c.dchain&&{dchain:c.dchain}||c.networkId&&{networkId:c.networkId}),...(!r||r.length<2)&&n&&{hbAdId:n.hb_adid}};te.error("PrebidAuctionManager","init","prebidCreativeFailure",p),a&&o&&this._deleteStoredAuction(a,o)}constructor(e,t,i,s,r,n){this._config=e,this._context=t,this._prebidEventBus=i,this._slots=s,this._creativeMonitoringExperiment=r,this._gamEventBus=n,this._auctionData=new Set,this._gamRenderedData=new Map}}Ep=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Ms?Object:Ms,void 0===zr?Object:zr,void 0===Sp?Object:Sp,void 0===jl?Object:jl])],Ep);class Cp{setOseq(e,t){let i=`${e.sequence}`;const{id:s,bidPoolId:r}=e,{hb_bidder:n,hb_adid:a}=t,{bids:o}=r?this._prebidMethods.getBidResponsesForBidPoolId(r):this._prebidMethods.getBidResponsesForAdUnitCode(s);if(o)for(let e=o.length-1;e>=0;e--)if(o[e].bidderCode===n&&o[e].adId===a){i=this.getSeqFromAdUnitCode(o[e].adUnitCode),o[e];break}e&&e.setSlotTargetingFlag("oseq",[i],!0)}getSeqFromAdUnitCode(e){const t=(e||"").match(/AdThrive_.*?_(\d+)\_\S+$/);return t&&t.length?t[1]:""}constructor(e){this._prebidMethods=e}}Cp=B([hs("OSeq"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ss?Object:Ss])],Cp);class Tp extends sr{init(){this._key="DemandChain"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Tp.prototype,"run",null),Tp=B([hs("DemandChainExperiment"),M()],Tp);const wp={buckets:[{precision:2,max:.1,increment:.01},{precision:2,max:5,increment:.05},{precision:2,max:20,increment:.1},{precision:2,max:100,increment:.5}]};class Ap{get configuration(){return this._configuration}constructor(e){this._config=e,this._configuration={suppressEmptyKeys:!0,adserverTargeting:[{key:"hb_bidder",val:e=>e.bidderCode},{key:"hb_adid",val:e=>e.adId},{key:"hb_pb",val:e=>e.pbCg},{key:"hb_size",val:e=>this._config.video.instreamAdUnits.has(e.adUnitCode)?"":e.size},{key:"hb_deal",val:e=>e.dealId},{key:"hb_format",val:e=>e.mediaType},{key:"hb_adomain",val:e=>e.meta&&e.meta.advertiserDomains?e.meta.advertiserDomains[0]:e.meta&&e.meta.advertiserId},{key:"hb_dsp",val:e=>{var t,i;return null!=(i=null!=(t=e.meta&&e.meta.networkId)?t:e.meta&&e.meta.networkName)?i:e.meta&&e.meta.dchain&&e.meta.dchain.nodes.reverse()[0].bsid}},{key:"hb_crid",val:e=>e.creativeId},{key:"hb_dur",val:e=>e.duration},{key:"hb_source",val:e=>{const t=this._config.prebid;let i;return i=t.s2s.bidders.includes(e.bidderCode)?t.rubiconS2SBidders.includes(e.bidderCode)?"sm":"sr":"c",i}},{key:"hb_attr",val:e=>{var t;return(null==(t=e.meta)?void 0:t.isInBannerVideo)?"ibv":void 0}}]}}}Ap=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],Ap);class kp extends nr{init(){this._key="OpenPathLiveIntent",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],kp.prototype,"run",null),kp=B([hs("OpenPathLiveIntentExperiment"),M()],kp);class Ip{_getUspConfig(){return this._config.ccpa.required?{cmpApi:"iab",timeout:0}:{cmpApi:"static",consentData:{getUSPData:{uspString:"1---"}}}}_isCCPAConsentDenied(){return!!this._config.ccpa.userOptedOut}_isAct25ConsentDenied(){return this._config.act25.required&&!this._config.act25.consented}_getAllowActivites(){const e={rules:[{condition:()=>this._isCCPAConsentDenied()||this._isAct25ConsentDenied(),allow:!1}]};return{reportAnalytics:{rules:[{condition:()=>this._isCCPAConsentDenied(),allow:!1}]},enrichUfpd:{...e},enrichEids:{...e},syncUser:{...e},transmitEids:{...e},transmitPreciseGeo:{...e},transmitUfpd:{...e}}}customPreAuction(e,t){if(e&&t){let i=t;const s=e.code,r=t.split("/"),n=Ur.includes(s),a={Content:ge.Content,Sidebar:this._isSideBarNineAvailable?ge.Sidebar_9:ge.Sidebar_1,Recipe:ge.Recipe_1};for(const e in a)s.includes(e)&&(i=`/${r[1]}/AdThrive_${a[e]}/${r[3]}`);return n?t:i}}setDefaultConfig(e){const t=this.addPrebidConsent(),i={...this._defaultConfig,...e&&{eventHistoryTTL:60},consentManagement:t,...this._config.fledge.enabled&&{paapi:{enabled:!0,gpt:{configWithTargeting:!1}}},...this._config.prebid.currencyConversionEnabled&&{currency:{adServerCurrency:"USD"}}};this._prebidMethods.setConfig(i)}applyClientAndServerBidderSettings(e){this._prebidMethods.setBidderSettings(e.reduce(((e,t)=>this._setupBidderSettings(e,t)),{standard:this._standardPrebidBidderSetting.configuration}))}aliasBidders(e){e=[...new Set(e)].filter((e=>e.serverBidderName!==ae.RubiconServer&&e.serverBidderName!==ae.ImproveDigitalServer&&e.serverBidderName!==ae.AidemServer)),e.forEach((e=>{if(!e.adapterName)return;if(e.adapterName!==e.name||e.serverBidderName){const t=e.serverBidderName||e.name,i=e.adapterName;e.gvlid?this._prebidMethods.setAliasBidder(i,t,{gvlid:e.gvlid}):this._prebidMethods.setAliasBidder(i,t)}}))}_setupBidderSettings(e,t){return e[t.name]=this.getBidderSettings(t,t.name),t.serverBidderName&&(e[t.serverBidderName]=this.getBidderSettings(t,t.serverBidderName)),e.standard.adserverTargeting&&t.adServerTargeting&&e.standard.adserverTargeting.push(...t.adServerTargeting),e}_setIsSidebarNineAvailable(e){for(const t of e)if(t.location===ge.Sidebar&&9===t.sequence)return void(this._isSideBarNineAvailable=!0)}addPrebidConsent(){return!0===this._config.gdpr.enabled?this._gdprConfig:this._uspConfig}getBidderSettings(e,t){return{bidCpmAdjustment:(e,i)=>{const s=this._config;return Qe(s,e,t,i)},inverseBidAdjustment:(e,t)=>{const i=this._config,s=this._config.prebid.s2s.bidders.includes(t.bidder)?"server":t.bidder;return Je(i,s,t,e)},...e.settings}}constructor(e,t,i,s,r,n,a){this._config=e,this._prebidMethods=t,this._dcoExperiment=i,this._ortb2=s,this._standardPrebidBidderSetting=r,this._openPathLiveIntentExperiment=n,this._slotManagerEventBus=a,this._uspConfig={usp:this._getUspConfig()},this._clientVendorExceptions=["appnexus"],this._serverVendorExceptions=this._config.prebid.s2s.bidders,this._isSideBarNineAvailable=!1,this._gdprConfig={gdpr:{cmpApi:"iab",timeout:25e3,defaultGdprScope:!0,rules:[{purpose:"storage",enforcePurpose:!0,enforceVendor:!0},{purpose:"basicAds",enforcePurpose:!0,enforceVendor:!0,vendorExceptions:this._clientVendorExceptions.concat(this._serverVendorExceptions)},{purpose:"personalizedAds",enforcePurpose:!0,enforceVendor:!0},{purpose:"measurement",enforcePurpose:!0,enforceVendor:!0}]}},this._defaultConfig={maxRequestsPerOrigin:6,allowActivities:{...this._getAllowActivites()},auctionOptions:{secondaryBidders:["unruly","undertone","33across","nativo","colossus"]},bidderSequence:"fixed",sendBidsControl:{bidLimit:3},useBidCache:!0,enableTIDs:!0,enableSendAllBids:!0,disableAjaxTimeout:!0,userSync:{syncEnabled:!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut,idPriority:{tdid:this._openPathLiveIntentExperiment.result?["liveIntentId","unifiedId"]:["unifiedId","liveIntentId"]},auctionDelay:this._config.prebid.auctionDelay,syncsPerBidder:1,aliasSyncEnabled:!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut,enableOverride:!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut,filterSettings:{iframe:{bidders:"*",filter:"include"}}},gptPreAuction:{mcmEnabled:!0,enabled:!0,customPreAuction:this.customPreAuction.bind(this)},priceGranularity:wp,cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"},consentManagement:{},targetingControls:{allowTargetingKeys:this._config.prebid.targetingKeys,allowSendAllBidsTargetingKeys:this._config.prebid.sendAllBidsTargetingKeys},dchain:{validation:this._dcoExperiment.result},schain:{validation:"strict",config:(new Hl).getSupplyChainConfig(this._config.site.id)},sizeConfig:[],ortb2:this._ortb2.data,eventHistoryTTL:35,requestQueue:{enabled:!0,timeout:this._config.prebid.requestQueueTimeout},gvlMapping:{generic:this._config.gdpr.cafeMediaVendorId}},this._slotManagerEventBus.added.on((e=>{this._setIsSidebarNineAvailable(e)}))}}Ip=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Ss?Object:Ss,void 0===Tp?Object:Tp,void 0===Zc?Object:Zc,void 0===Ap?Object:Ap,void 0===kp?Object:kp,void 0===Vs?Object:Vs])],Ip);class Pp extends sr{init(){this._key="PredictiveAnalysis"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Pp.prototype,"run",null),Pp=B([hs("PredictiveAnalysisExperiment"),M()],Pp);class Op extends sr{init(){this._key="UserSyncLimit"}run(){try{const e=super.run();return this._validateResult(e),e}catch(e){return te.error("UserSyncLimitExperiment","run",e),-1}}_validateResult(e){if("number"!=typeof e)throw new Error(`Result is not a number: ${e}`);if(!Number.isInteger(e))throw new Error(`Result is not an integer: ${e}`);if(e<0||e>100)throw new Error(`Result out of range: ${e}`);return e}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Op.prototype,"run",null),Op=B([hs("UserSyncLimitExperiment"),M()],Op);class xp extends sr{init(){this._key="RaptiveRegionalPrebidServerExperiment3"}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],xp.prototype,"run",null),xp=B([hs("RaptiveRegionalPrebidServerExperiment"),M()],xp);class Rp extends sr{init(){this._key="S2STimeOutExperiment"}}Rp=B([hs("S2STimeoutExperiment"),M()],Rp);class Dp extends sr{init(){this._key="S2SRefreshTimeout"}}Dp=B([hs("S2SRefreshTimeoutExperiment"),M()],Dp);const Lp="default",Mp=Lp;class Bp extends nr{init(){this._key="RaptivePrebidServerProxyExperiment",this._default=!1}}Bp=B([hs("RaptivePrebidServerProxyExperiment"),M()],Bp);class Fp extends sr{init(){this._key="RaptivePBSMultistageAuctionExperiment"}}Fp=B([hs("RaptivePBSMultistageAuctionExperiment"),M()],Fp);class jp extends sr{init(){this._key="RaptivePBSDoubleRequestExperiment"}}jp=B([hs("RaptivePBSDoubleRequestExperiment"),M()],jp);class Np{init(){this._setShouldUseProxy(),this._setupURLs(),this._shouldUseProxy&&this._setAuctionParams()}_setAuctionParams(){this._handleSetAuctionDoubleRequestParam(),this._handleSetAuctionVersionParam(Mp)}get auction(){return this.auctionUrl.toString()}get sync(){return this.syncUrl.toString()}_setupURLs(){this.baseUrl=new URL(this._url),this.auctionUrl=new URL(this._getAuctionEndpoint(),this.baseUrl),this.syncUrl=new URL("/cookie_sync",this.baseUrl)}_getAuctionEndpoint(){return"/openrtb2/auction"}_setShouldUseProxy(){this._shouldUseProxy=R.resolve(Bp).result&&"off"!==R.resolve(Fp).result}_setDoubleRequest(){var e;this._doubleRequest=null!=(e=R.resolve(jp).result)?e:0}_handleSetAuctionVersionParam(e){this._shouldSetAuctionVersionParam(e)&&this._setAuctionVersionParam(e)}_shouldSetAuctionVersionParam(e){return e!==Lp}_setAuctionVersionParam(e){this.auctionUrl.searchParams.append("version",e)}_handleSetAuctionDoubleRequestParam(){this._setDoubleRequest(),"number"==typeof this._doubleRequest&&this._setDoubleRequestParam(this._doubleRequest.toString())}_setDoubleRequestParam(e){this.auctionUrl.searchParams.append("rpbsdr",e)}constructor(){this._shouldUseProxy=!1,this._doubleRequest=0}}class Up extends Np{constructor(){super(),this._url="https://rpbs-sjc.production.adthrive.com",this.init()}}Up=B([M(),j("design:type",Function),j("design:paramtypes",[])],Up);class Vp extends Np{constructor(){super(),this._url="https://prebid.production.adthrive.com",this.init()}}Vp=B([M(),j("design:type",Function),j("design:paramtypes",[])],Vp);class zp{get auction(){return`${this._host}/openrtb2/auction`}get sync(){return`${this._host}/cookie_sync`}constructor(){this._host="https://prebid-server.rubiconproject.com"}}zp=B([M()],zp);class $p{get auction(){return`${this._host}/openrtb2/auction`}get sync(){return`${this._host}/cookie_sync`}constructor(){this._host="https://pbs-raptive-us.ay.delivery"}}$p=B([M()],$p);class Hp{_runRaptivePrebidServerExperiments(){const e=this._raptiveRegionalPrebidServerExperiment.result;this._useRaptivePBS="mag"!==e,this._useAYPBS="ay"===e}_generateAliases(e){return{...e.includes(ae.ImproveDigitalServer)&&{[ae.ImproveDigitalServer]:ae.ImproveDigital},...e.includes(ae.RubiconServer)&&{[ae.RubiconServer]:ae.Rubicon},...e.includes(ae.AidemServer)&&{[ae.AidemServer]:ae.Aidem},...e.includes(ae.ColossusServer)&&{[ae.ColossusServer]:ae.Colossus}}}_getRubiconServer2ServerConfig(e){const t=new zp;return this._generateServer2ServerConfig(e,"9262",t)}_getRaptiveServer2ServerConfig(e){const t=this._getRPBSEndpoint();return this._generateServer2ServerConfig(e,"1234",t)}_getAssertiveYieldServer2ServerConfig(e){const t=this._getAYPBSEndpoint();return this._generateServer2ServerConfig(e,"1234",t)}_getRPBSEndpoint(){return this._isRPBSOracle()?new Up:new Vp}_getAYPBSEndpoint(){return new $p}_isRPBSOracle(){return"orcl"===this._raptiveRegionalPrebidServerExperiment.result}getServer2ServerConfigWithAppData(e,t,i){const s=i?this._getRaptiveServer2ServerConfig(e):this._getRubiconServer2ServerConfig(e);if(s.accountId=i?"6666":"9262",t&&0!==Object.keys(t).length)return s.ignoreDuplicateBidders=!0,s.appData=t,s}_generateServer2ServerConfig(e,t,i){var s,r,n;return{accountId:t,enabled:!0,...this._config.prebid.ortbEnrich&&{secure:1},bidders:e,extPrebid:{aliases:this._generateAliases(e),eidPermissions:[{source:"bidswitch.net",bidders:e.filter((e=>e!==ae.ThirtyThreeAcross))}]},defaultTtl:300,timeout:null!=(s=this._s2sTimeoutExperiment.result)?s:750,maxTimeout:null!=(r=this._s2sTimeoutExperiment.result)?r:750,refreshTimeout:null!=(n=this._s2sRefreshTimeoutExperiment.result)?n:1e3,adapter:"prebidServer",coopSync:!1,userSyncLimit:this._userSyncLimitExperiment.result,endpoint:{p1Consent:i.auction,noP1Consent:i.auction},syncEndpoint:{p1Consent:this._config.gpc.gpcEnabled||this._config.ccpa.userOptedOut?"":i.sync,noP1Consent:this._config.gpc.gpcEnabled||this._config.ccpa.userOptedOut?"":i.sync}}}_buildS2SConfigs(){var e;const t=this._config.prebid,i=t.s2s.bidders,s=t.rubiconS2SBidders,r=(null==(e=this._context.country)?void 0:e.toUpperCase())||"",n=["US","CA"].includes(r),a="US"===r,o=this._useRaptivePBS&&n,l=this._useAYPBS&&a;if(o||l){const e=i.filter((e=>!s.includes(e))),t=i.filter((e=>s.includes(e))),r=l?this._getAssertiveYieldServer2ServerConfig(e):this._getRaptiveServer2ServerConfig(e);this._s2sConfig.push(r),this._s2sConfig.push(this._getRubiconServer2ServerConfig(t));const n=this._appData?this.getServer2ServerConfigWithAppData(e,this._appData,!0):void 0;n&&this._s2sConfig.push(n);const a=this._appData?this.getServer2ServerConfigWithAppData(t,this._appData,!1):void 0;a&&this._s2sConfig.push(a)}else{this._s2sConfig.push(this._getRubiconServer2ServerConfig(i));const e=this._appData?this.getServer2ServerConfigWithAppData(i,this._appData,!1):void 0;e&&this._s2sConfig.push(e)}}init(){this._buildS2SConfigs(),this._prebidMethods.setConfig({s2sConfig:this._s2sConfig.filter((e=>e.bidders.length))})}constructor(e,t,i,s,r,n,a,o){this._config=e,this._context=t,this._prebidMethods=i,this._userSyncLimitExperiment=s,this._s2sTimeoutExperiment=r,this._ortb2=n,this._s2sRefreshTimeoutExperiment=a,this._raptiveRegionalPrebidServerExperiment=o,this._useRaptivePBS=!1,this._useAYPBS=!1,this._s2sConfig=[],this._appData=Gt(this._context.domain,this._ortb2.data.site),this._runRaptivePrebidServerExperiments()}}Hp=B([L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Ss?Object:Ss,void 0===Op?Object:Op,void 0===Rp?Object:Rp,void 0===Zc?Object:Zc,void 0===Dp?Object:Dp,void 0===xp?Object:xp])],Hp);class qp extends sr{init(){this._key="UserSyncTrigger"}}qp=B([hs("UserSyncTriggerExperiment"),M()],qp);class Gp extends Cs{triggerUserSyncBasedOnExperiment(e){const t=this._userSyncTriggerExperiment.result;t&&this._userSyncTriggerMap.get(t)===e&&!this._alreadyCalled&&(this._prebidMethods.triggerUserSyncs(),this._alreadyCalled=!0)}constructor(e,t){super(),this._userSyncTriggerExperiment=e,this._prebidMethods=t,this._alreadyCalled=!1,this._userSyncTriggerMap=new Map([[1,"onPageLoad"],[2,"onConfigSet"],[3,"onBeforeRequestEvent"],[4,"onBidsBackHandler"]])}}Gp=B([hs("UserSyncTriggerComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===qp?Object:qp,void 0===Ss?Object:Ss])],Gp);class Kp extends nr{init(){this._key="SspTakeRateMonitor",this._default=!1}}Kp=B([hs("SspTakeRateMonitorExperiment"),M()],Kp);class Wp extends tr{init(){this._key="AppBiddersList",this._default=[]}get choices(){return this._choices}}Wp=B([hs("AppBiddersExperiment"),M()],Wp);class Yp{isRoadblock(e){const t=Object.keys(e);return!this._gamSlotRequested&&!!t.filter((t=>t.indexOf("Footer")>-1&&e[t].bids.filter((e=>!!(e.meta&&e.meta.advertiserId&&e.meta.advertiserId===this._appnexusAdvertiserId&&e.creativeId)&&(this.creativeId=e.creativeId,!0))).length)).length}_init(){this._gamEventBus.slotRequested.once((()=>{this._gamSlotRequested=!0,this.creativeId=void 0}))}constructor(e){this._gamEventBus=e,this._gamSlotRequested=!1,this._appnexusAdvertiserId=10645616,this._init()}}Yp=B([L(),j("design:type",Function),j("design:paramtypes",[void 0===jl?Object:jl])],Yp);class Qp{get isPubmaticEidSetByLiveIntent(){var e,t;return null!=(t=null==(e=window.pbjs)?void 0:e.getUserIdsAsEids().some((e=>"pubmatic.com"===e.source&&e.uids.some((e=>{var t;return"liveintent.com"===(null==(t=e.ext)?void 0:t.provider)})))))&&t}}Qp=B([M()],Qp);class Xp extends nr{init(){this._key="SSPUserSync",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Xp.prototype,"run",null),Xp=B([hs("SSPUserSyncExperiment"),M()],Xp);class Jp extends Cs{get enabled(){return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut&&this._sspUserSyncExperiment.result}async init(){this.enabled&&(await Jl(),this._loadMessagesFromStorage(),this._setupPostMessageListener())}getTargetingData(){const e=Object.keys(this._cachedMessages).filter((e=>{const t=this._cachedMessages[e];return!(this._sspToDetailsMap[t.ssp.toLowerCase()].bidderCode===ae.Pubmatic&&this._userSyncConfig.isPubmaticEidSetByLiveIntent&&"pubmatic.com"===t.eid.source)}));return e?e.map((e=>`ssp:${this._sspToDetailsMap[e].storageKey}`)):[""]}_setupPostMessageListener(){window.addEventListener("message",(e=>{if(this._isOriginAllowed(e.origin)){let t=null;try{"string"==typeof e.data?t=JSON.parse(e.data):"object"==typeof e.data&&(t=e.data)}catch(t){te.error("SSPUserSyncComponent","_setupPostMessageListener","Error parsing message",t,e.data)}t&&"ssp-user-sync"===t.type&&this._handlePostMessage(t)}}))}_handlePostMessage(e){try{const t=e.ssp.toLowerCase();this._cachedMessages[t]||(this._storeMessage(e),this._processMessage(e),this._cachedMessages[t]=e)}catch(e){te.error("SSPUserSyncComponent","_handlePostMessage","Error processing message",e)}}_isOriginAllowed(e){return this._allowedDomains.includes(e)}_storeMessage(e){try{const t=e.ssp.toLowerCase(),i=this._sspToDetailsMap[t].storageKey||t.toLowerCase();K.setLocalStorageValue(`sspus_${i}`,e)}catch(e){te.error("SSPUserSyncComponent","_storeMessage","Error storing SSPUserSyncMessage",e)}}_loadMessagesFromStorage(){const e=Object.values(this._sspToDetailsMap).map((({storageKey:e})=>K.getLocalStorageValue(`sspus_${e}`))).filter((e=>null!==e));this._cachedMessages=e.reduce(((e,t)=>(e[t.ssp.toLowerCase()]=t,e)),this._cachedMessages),e.forEach((e=>{this._processMessage(e)}))}_processMessage(e){const t=e.eid,i=this._sspToDetailsMap[e.ssp.toLowerCase()].bidderCode;t&&i&&(i===ae.Pubmatic&&this._userSyncConfig.isPubmaticEidSetByLiveIntent&&"pubmatic.com"===t.source||this._prebidMethods.setBidderConfig({bidders:[i],config:{ortb2:{user:{ext:{data:{eids:[t]}}}}}}))}constructor(e,t,i,s,r){super(),this._gpcConfig=e,this._ccpaConfig=t,this._prebidMethods=i,this._userSyncConfig=s,this._sspUserSyncExperiment=r,this._allowedDomains=["https://ads.pubmatic.com"],this._sspToDetailsMap={pubmatic:{storageKey:"pubm",bidderCode:ae.Pubmatic}},this._cachedMessages={}}}Jp=B([hs("SSPUserSyncComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===an?Object:an,void 0===nn?Object:nn,void 0===Ss?Object:Ss,void 0===Qp?Object:Qp,void 0===Xp?Object:Xp])],Jp);var Zp="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var eg={exports:{}};!function(e,t){var i="__lodash_hash_undefined__",s=9007199254740991,r="[object Arguments]",n="[object Boolean]",a="[object Date]",o="[object Function]",l="[object GeneratorFunction]",d="[object Map]",c="[object Number]",h="[object Object]",u="[object Promise]",p="[object RegExp]",g="[object Set]",m="[object String]",_="[object Symbol]",f="[object WeakMap]",v="[object ArrayBuffer]",y="[object DataView]",b="[object Float32Array]",S="[object Float64Array]",E="[object Int8Array]",C="[object Int16Array]",T="[object Int32Array]",w="[object Uint8Array]",A="[object Uint8ClampedArray]",k="[object Uint16Array]",I="[object Uint32Array]",P=/\w*$/,O=/^\[object .+?Constructor\]$/,x=/^(?:0|[1-9]\d*)$/,R={};R[r]=R["[object Array]"]=R[v]=R[y]=R[n]=R[a]=R[b]=R[S]=R[E]=R[C]=R[T]=R[d]=R[c]=R[h]=R[p]=R[g]=R[m]=R[_]=R[w]=R[A]=R[k]=R[I]=!0,R["[object Error]"]=R[o]=R[f]=!1;var D="object"==typeof Zp&&Zp&&Zp.Object===Object&&Zp,L="object"==typeof self&&self&&self.Object===Object&&self,M=D||L||Function("return this")(),B=t&&!t.nodeType&&t,F=B&&e&&!e.nodeType&&e,j=F&&F.exports===B;function N(e,t){return e.set(t[0],t[1]),e}function U(e,t){return e.add(t),e}function V(e,t,i,s){for(var r=-1,n=e?e.length:0;++r<n;)i=t(i,e[r],r,e);return i}function z(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function $(e){var t=-1,i=Array(e.size);return e.forEach((function(e,s){i[++t]=[s,e]})),i}function H(e,t){return function(i){return e(t(i))}}function q(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}var G=Array.prototype,K=Function.prototype,W=Object.prototype,Y=M["__core-js_shared__"],Q=function(){var e=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),X=K.toString,J=W.hasOwnProperty,Z=W.toString,ee=RegExp("^"+X.call(J).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=j?M.Buffer:void 0,ie=M.Symbol,se=M.Uint8Array,re=H(Object.getPrototypeOf,Object),ne=Object.create,ae=W.propertyIsEnumerable,oe=G.splice,le=Object.getOwnPropertySymbols,de=te?te.isBuffer:void 0,ce=H(Object.keys,Object),he=Be(M,"DataView"),ue=Be(M,"Map"),pe=Be(M,"Promise"),ge=Be(M,"Set"),me=Be(M,"WeakMap"),_e=Be(Object,"create"),fe=Ve(he),ve=Ve(ue),ye=Ve(pe),be=Ve(ge),Se=Ve(me),Ee=ie?ie.prototype:void 0,Ce=Ee?Ee.valueOf:void 0;function Te(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}function we(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}function Ae(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}function ke(e){this.__data__=new we(e)}function Ie(e,t){var i=$e(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&He(e)}(e)&&J.call(e,"callee")&&(!ae.call(e,"callee")||Z.call(e)==r)}(e)?function(e,t){for(var i=-1,s=Array(e);++i<e;)s[i]=t(i);return s}(e.length,String):[],s=i.length,n=!!s;for(var a in e)!J.call(e,a)||n&&("length"==a||Ne(a,s))||i.push(a);return i}function Pe(e,t,i){var s=e[t];J.call(e,t)&&ze(s,i)&&(void 0!==i||t in e)||(e[t]=i)}function Oe(e,t){for(var i=e.length;i--;)if(ze(e[i][0],t))return i;return-1}function xe(e,t,i,s,u,f,O){var x;if(s&&(x=f?s(e,u,f,O):s(e)),void 0!==x)return x;if(!Ke(e))return e;var D=$e(e);if(D){if(x=function(e){var t=e.length,i=e.constructor(t);t&&"string"==typeof e[0]&&J.call(e,"index")&&(i.index=e.index,i.input=e.input);return i}(e),!t)return function(e,t){var i=-1,s=e.length;t||(t=Array(s));for(;++i<s;)t[i]=e[i];return t}(e,x)}else{var L=je(e),M=L==o||L==l;if(qe(e))return function(e,t){if(t)return e.slice();var i=new e.constructor(e.length);return e.copy(i),i}(e,t);if(L==h||L==r||M&&!f){if(z(e))return f?e:{};if(x=function(e){return"function"!=typeof e.constructor||Ue(e)?{}:(t=re(e),Ke(t)?ne(t):{});var t}(M?{}:e),!t)return function(e,t){return Le(e,Fe(e),t)}(e,function(e,t){return e&&Le(t,We(t),e)}(x,e))}else{if(!R[L])return f?e:{};x=function(e,t,i,s){var r=e.constructor;switch(t){case v:return De(e);case n:case a:return new r(+e);case y:return function(e,t){var i=t?De(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}(e,s);case b:case S:case E:case C:case T:case w:case A:case k:case I:return function(e,t){var i=t?De(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}(e,s);case d:return function(e,t,i){var s=t?i($(e),!0):$(e);return V(s,N,new e.constructor)}(e,s,i);case c:case m:return new r(e);case p:return function(e){var t=new e.constructor(e.source,P.exec(e));return t.lastIndex=e.lastIndex,t}(e);case g:return function(e,t,i){var s=t?i(q(e),!0):q(e);return V(s,U,new e.constructor)}(e,s,i);case _:return o=e,Ce?Object(Ce.call(o)):{}}var o}(e,L,xe,t)}}O||(O=new ke);var B=O.get(e);if(B)return B;if(O.set(e,x),!D)var F=i?function(e){return function(e,t,i){var s=t(e);return $e(e)?s:function(e,t){for(var i=-1,s=t.length,r=e.length;++i<s;)e[r+i]=t[i];return e}(s,i(e))}(e,We,Fe)}(e):We(e);return function(e,t){for(var i=-1,s=e?e.length:0;++i<s&&!1!==t(e[i],i,e););}(F||e,(function(r,n){F&&(r=e[n=r]),Pe(x,n,xe(r,t,i,s,n,e,O))})),x}function Re(e){return!(!Ke(e)||function(e){return!!Q&&Q in e}(e))&&(Ge(e)||z(e)?ee:O).test(Ve(e))}function De(e){var t=new e.constructor(e.byteLength);return new se(t).set(new se(e)),t}function Le(e,t,i,s){i||(i={});for(var r=-1,n=t.length;++r<n;){var a=t[r];Pe(i,a,e[a])}return i}function Me(e,t){var i,s,r=e.__data__;return("string"==(s=typeof(i=t))||"number"==s||"symbol"==s||"boolean"==s?"__proto__"!==i:null===i)?r["string"==typeof t?"string":"hash"]:r.map}function Be(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return Re(i)?i:void 0}Te.prototype.clear=function(){this.__data__=_e?_e(null):{}},Te.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Te.prototype.get=function(e){var t=this.__data__;if(_e){var s=t[e];return s===i?void 0:s}return J.call(t,e)?t[e]:void 0},Te.prototype.has=function(e){var t=this.__data__;return _e?void 0!==t[e]:J.call(t,e)},Te.prototype.set=function(e,t){return this.__data__[e]=_e&&void 0===t?i:t,this},we.prototype.clear=function(){this.__data__=[]},we.prototype.delete=function(e){var t=this.__data__,i=Oe(t,e);return!(i<0)&&(i==t.length-1?t.pop():oe.call(t,i,1),!0)},we.prototype.get=function(e){var t=this.__data__,i=Oe(t,e);return i<0?void 0:t[i][1]},we.prototype.has=function(e){return Oe(this.__data__,e)>-1},we.prototype.set=function(e,t){var i=this.__data__,s=Oe(i,e);return s<0?i.push([e,t]):i[s][1]=t,this},Ae.prototype.clear=function(){this.__data__={hash:new Te,map:new(ue||we),string:new Te}},Ae.prototype.delete=function(e){return Me(this,e).delete(e)},Ae.prototype.get=function(e){return Me(this,e).get(e)},Ae.prototype.has=function(e){return Me(this,e).has(e)},Ae.prototype.set=function(e,t){return Me(this,e).set(e,t),this},ke.prototype.clear=function(){this.__data__=new we},ke.prototype.delete=function(e){return this.__data__.delete(e)},ke.prototype.get=function(e){return this.__data__.get(e)},ke.prototype.has=function(e){return this.__data__.has(e)},ke.prototype.set=function(e,t){var i=this.__data__;if(i instanceof we){var s=i.__data__;if(!ue||s.length<199)return s.push([e,t]),this;i=this.__data__=new Ae(s)}return i.set(e,t),this};var Fe=le?H(le,Object):function(){return[]},je=function(e){return Z.call(e)};function Ne(e,t){return!!(t=null==t?s:t)&&("number"==typeof e||x.test(e))&&e>-1&&e%1==0&&e<t}function Ue(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||W)}function Ve(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ze(e,t){return e===t||e!=e&&t!=t}(he&&je(new he(new ArrayBuffer(1)))!=y||ue&&je(new ue)!=d||pe&&je(pe.resolve())!=u||ge&&je(new ge)!=g||me&&je(new me)!=f)&&(je=function(e){var t=Z.call(e),i=t==h?e.constructor:void 0,s=i?Ve(i):void 0;if(s)switch(s){case fe:return y;case ve:return d;case ye:return u;case be:return g;case Se:return f}return t});var $e=Array.isArray;function He(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}(e.length)&&!Ge(e)}var qe=de||function(){return!1};function Ge(e){var t=Ke(e)?Z.call(e):"";return t==o||t==l}function Ke(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function We(e){return He(e)?Ie(e):function(e){if(!Ue(e))return ce(e);var t=[];for(var i in Object(e))J.call(e,i)&&"constructor"!=i&&t.push(i);return t}(e)}e.exports=function(e){return xe(e,!0,!0)}}(eg,eg.exports);var tg=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(eg.exports);class ig extends $l{init(){const e=this._prebidConfiguration,t=this._orderedDisplayBidders,i=this._orderedVideoBidders,s=[...t,...i],r=Gt(this._context.domain,this._ortb2.data.site);this._appDataBidders.length&&this._prebidMethods.setConfig({appDataConfig:{appData:r,bidders:this._appDataBidders,bseat:this._bseatAppRequests}}),e.setDefaultConfig(this._roxotAnalytics.enabled),this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment("onConfigSet"),e.aliasBidders(s),this._s2s.init(),this._analytics.forEach((e=>void 0!==e.init&&e.init())),t.forEach((e=>void 0!==e.init&&e.init())),e.applyClientAndServerBidderSettings(s),Vi().then((()=>{this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment("onPageLoad")})).then((()=>this._registerSignalSources())).catch((e=>{te.error("PrebidAuctionManager","init","pageLoaded",e)})),this._setEvents(),this._predictiveAnalysisResult&&this._setVideoBidsFilter(),this._prebidEventBus.initialized.emit(),this._initialized=!0}get multiFormatBidders(){return this._orderedMultiformatBidders}_logAuctionDebug(){this._prebidEventBus.auctionDebug.on((e=>{if(e&&"ERROR"===e.type){const t="Error trying to write ad";[...e.arguments].some((e=>"string"==typeof e&&e.indexOf(t)>-1))||te.error("PrebidAuctionManager","_logAuctionDebug","auctionDebug",e)}}))}async _registerSignalSources(){if(this._config.ccpa.userOptedOut||this._config.gpc.gpcEnabled)return;if(this._config.gdpr.enabled){if(!await this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.cafeMediaVendorId,[1]))return}this._prebidMethods.setConfig({userSync:{encryptedSignalSources:{sources:[{source:["esp.criteo.com","id5-sync.com","pubcid.org","liveramp.com","33across.com","uidapi.com","loblawmedia.ca"],encrypt:!1}],registerDelay:2e3}}}),this._prebidMethods.registerSignalSources()}_getNoBidReason(e,t){return Object.keys(e).length?"":t||"noBid"}_handleAuctionEnd(){this._prebidEventBus.auctionEnd.on((e=>{var t;const i=e.bidsReceived.filter((e=>e.app));null==(t=e.adUnits)||t.forEach((e=>{const{code:t,noBidReason:s}=e,r=this._slots.get(t),n=r?r.id:t,a=this._prebidMethods.getAdserverTargetingForAdUnitCode(n),o=this._getNoBidReason(a,s);if(r&&(null==r||r.setSlotAppBids(i,t)),r&&o)r.googleTagSlot.setTargeting("hb_bidder",o);else{const e=o?{noBid:o}:a;this._slotEventBus.addPrebidSlotTargeting.emit({adUnitCode:t,slotTargeting:e})}}))}))}_handleAuctionInit(){this._prebidEventBus.auctionInit.on((e=>{e.adUnitCodes.forEach((t=>{const i=(this._prebidMethods.getPrebidAdUnits()||[]).filter((e=>e.code===t));i.length&&i.forEach((t=>{t.lastAuctionId=e.auctionId}))}));const t=this._slots.get(e.adUnitCodes[0]);if(t){const e=this._getActiveBidsInPool(t);t.setSlotTargetingFlag("bic",[e.length.toString()],!0),e.length}}))}_handleBidWon(){this._prebidEventBus.bidWon.on((e=>{const t=this._slots.get(e.adUnitCode);if(t){t.servedPrebidBidResponse=e,this._slots.bidServed.emit(t);Math.floor(100*Math.random())>=95&&this._sspTakeRateMonitorExperiment.result&&this._logBidResponseInfo(e.adUnitCode,t)}}))}_logBidResponseInfo(e,t){const i=this._prebidMethods.getBidResponsesForAdUnitCode(e).bids,s=this._bidResponseForAdUnitCount.get(e)||0;i.slice(s).forEach((e=>{const{bidder:i,cpm:s,adUnitCode:r,dealId:n,originalCpm:a,responseCpm:o,meta:l}=e,{hb_pb:d,hb_format:c}=e.adserverTargeting,{bp:h,wp:u}=this._extractPriceInfoFromPixelUrl(e);i&&s&&d&&h&&u&&r&&te.event("PrebidAuctionManager","_logBidResponseInfo","Info from bid response",{bidder:i,cpm:s,originalCpm:a,responseCpm:o,hb_pb:d,hb_format:c,meta:l,bp:h,wp:u,adUnitCode:r,nref:t.refreshCount,dealId:n})})),this._bidResponseForAdUnitCount.set(e,i.length)}_extractPriceInfoFromPixelUrl(e){const{ad:t,adUrl:i}=e;let s,r;if(!t&&!i)return{bp:void 0,wp:void 0};if(t){const e=t.match(/[?&]bp=([^&]*)/),i=t.match(/[?&]wp=([^&]*)/);s=e&&e[1],r=i&&i[1]}if(i){const e=i.match(/[?&]bp=([^&]*)/),t=i.match(/[?&]wp=([^&]*)/);s=!s&&e&&e[1],r=!r&&t&&t[1]}return{bp:s,wp:r}}_handleSetTargeting(){this._prebidEventBus.setTargeting.on((e=>{for(const t in e){const i=this._slots.get(t);if(i){const{hb_adid:s,hb_bidder:r}=e[t];try{this._oseq.setOseq(i,{hb_adid:s,hb_bidder:r})}catch(e){const t=this._prebidMethods.getVersion();te.error("PrebidAuctionManager","setEvents",e,t)}}}}))}_handleBeforeRequestEvent(){this._prebidEventBus.beforeRequestBids.on((e=>{var t,i;this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment("onBeforeRequestEvent"),!this._mediaType.additionalOutstreamUnitsExperiment&&this._mediaType.isOutstreamAllowed()||this._isBeforeRequestEventLoaded||this._updateHighImpactUnitTargeting();const s=[...this._userIdComponent.getTargetingData(),...this._sspUserSyncComponent.getTargetingData()];((null==(t=this._ortb2.data.device)?void 0:t.ip)||(null==(i=this._ortb2.data.device)?void 0:i.ipv6))&&s.push("cfip"),e.forEach((e=>{this._setupSlotRequestTargeting(e,s)})),this._isBeforeRequestEventLoaded=!0}))}_handleGamOnLoad(){this._googleAdManagerEventBus.slotOnload.on((({event:e,slot:t})=>{const i=e.slot.getResponseInformation(),s=null==i?void 0:i.advertiserId;s&&s===this._config.prebid.advertiserId||!t.bidPoolId||setTimeout((()=>{this._prebidMethods.clearTargetingForSharedBidPool(t.id)}),2e3)}))}_handleBidRequested(){this._prebidEventBus.bidRequested.on(this._setAuctionFloors.bind(this))}_setEvents(){this._logAuctionDebug(),this._handleAuctionEnd(),this._handleBidWon(),this._handleSetTargeting(),this._handleBeforeRequestEvent(),this._handleBidRequested(),this._handleGamOnLoad(),this._handleAuctionInit(),this._creativeMonitoring.setupCreativeEventListeners(),this._predictiveAnalysisResult&&this._setVideoBidsFilter(),this._setupEventListeners()}_setupEventListeners(){const e=this._prebidMethods,t=this._prebidEventBus;e.onEvent("adRenderFailed",(e=>t.adRenderFailed.emit(e))),e.onEvent("adRenderSucceeded",(e=>t.adRenderSucceeded.emit(e))),e.onEvent("auctionDebug",(e=>t.auctionDebug.emit(e))),e.onEvent("auctionEnd",(e=>t.auctionEnd.emit(e))),e.onEvent("auctionInit",(e=>t.auctionInit.emit(e))),e.onEvent("beforeRequestBids",(e=>t.beforeRequestBids.emit(e))),e.onEvent("bidRequested",(e=>t.bidRequested.emit(e))),e.onEvent("bidWon",(e=>t.bidWon.emit(e))),e.onEvent("rubiconBidError",(e=>t.rubiconBidError.emit(e))),e.onEvent("setTargeting",(e=>t.setTargeting.emit(e))),e.onEvent("staleRender",(e=>t.staleRender.emit(e))),e.onEvent("tcf2Enforcement",(e=>t.tcf2Enforcement.emit(e))),e.onEvent("vastExceededLimit",(e=>t.vastExceededLimit.emit(e)))}_setVideoBidsFilter(){if(!this._predictiveAnalysis.length)return;const e=e=>{const t=this._context.device;return"1"===e?"phone"===t:"tablet"===t||"desktop"===t};void 0===this._predictiveAnalysisResult&&te.error("PrebidAuctionManager","_setVideoBidsFilter","predictiveAnalysisExperiment result is undefined");const t=this._predictiveAnalysis.filter((t=>parseFloat(t.error_rate)>(this._predictiveAnalysisResult||.9)&&"1"===t.chrome===lt()&&e(t.mobile))),i={};t.forEach((e=>{const t=`${e.adomain},${e.bidder}`;i[t]=!0})),this._prebidMethods.setBidsReceivedFilter((e=>e.length&&this._config.video.instreamAdUnits.has(e[0].adUnitCode)?e.filter((e=>{let t=!0;const s=e.meta&&e.meta.advertiserDomains;return s&&Array.isArray(s)?(s.forEach((s=>{const r=s+","+e.bidder;i[r]&&(t=!1)})),t):t})):e))}_updateSlotTargeting(e){if(!this._mediaType.outstreamSlots.has(`${e.placementMapName}`))return;const t=this._config.adTypes.enabledMinified.map((e=>e.toLowerCase())).filter((e=>"od"===e||"om"===e));t.length&&this._gam.setSlotTargeting({key:"hi_au",value:t},e.googleTagSlot)}instlEnabled(e){return"Interstitial"===e&&this._config.adOptions.interstitial.prebid}get videoCreativeIdMapping(){return this._videoCreativeIdMapping}addSlots(e){this._applySlotFlags(e);const{bannerEligibleSlots:t,outstreamEligibleSlots:i,nativeEligibleSlots:s}=this._getSlotsByMediaType(e),{bannerBidderBidRequests:r,outstreamBidderBidRequests:n,nativeBidderBidRequests:a,multiFormatBidderBidRequests:o}=this._getBidsForMediaTypes(t,i,s),l={bannerBidderBidRequests:r,outstreamBidderBidRequests:n,nativeBidderBidRequests:a,multiFormatBidderBidRequests:o},d=e.filter((e=>this._shouldIncludeSlot(e))).sort(((e,t)=>e.auctionPriority-t.auctionPriority)).reduce(((e,t)=>{const i=this._generateAdUnits(t,l);return e.concat(i)}),[]);return this._prebidMethods.addAdUnits(d),this._setAdUnitOnSLot(e),d}reset(){return this._prebidMethods.removeAllAdUnits()}_getSlotsByMediaType(e){const t=[],i=[],s=[];return e.forEach((e=>{e.location!==ge.Video_StickyOutstream&&t.push(e),this._mediaType.outstreamEnabled(e).outstreamCapable&&i.push(e),this._mediaType.nativeEnabled(e)&&s.push(e)})),{bannerEligibleSlots:t,outstreamEligibleSlots:i,nativeEligibleSlots:s}}_getBidsForMediaTypes(e,t,i){const s=this._orderedDisplayBidders.map((t=>t.getBannerBidRequests(e))).filter(this._filterEmptyBids),r=this._orderedDisplayBidders.map((e=>e.getOutstreamBidRequests(t))).filter(this._filterEmptyBids),n=this._orderedDisplayBidders.map((e=>e.getNativeBidRequests(i))).filter(this._filterEmptyBids),a=this._orderedMultiformatBidders.map((t=>t.getMultiFormatBidRequests(e))).filter(this._filterEmptyBids);return{bannerBidderBidRequests:s,outstreamBidderBidRequests:r,nativeBidderBidRequests:n,multiFormatBidderBidRequests:a}}_filterEmptyBids(e){for(const[t,i]of e.entries())i&&i.length||e.delete(t);return 0!==e.size}_applySlotFlags(e){e.forEach((e=>{this._mediaType.outstreamEnabled(e).outstreamCapable&&e.location!==ge.Video_StickyOutstream&&(e.multiformat=!0),this._mediaType.nativeEnabled(e)&&(e.multiformat=!0,e.nativeEnabled=!0)}))}_generateAdUnits(e,t){const i=[],s=e.location===ge.Video_StickyOutstream,r=this._mediaType.outstreamEnabled(e).outstreamCapable&&!s,n=this._mediaType.nativeEnabled(e);if(this._mediaType.additionalOutstreamUnitsExperiment&&this._updateSlotTargeting(e),s){const s=this._getOutstreamUnit(e,t.outstreamBidderBidRequests);i.push(s)}else this.getNonStickyAdUnitsFromRequests(e,i,r,n,t);return i}getNonStickyAdUnitsFromRequests(e,t,i,s,r){const{bannerBidderBidRequests:n,outstreamBidderBidRequests:a,nativeBidderBidRequests:o,multiFormatBidderBidRequests:l}=r,d=this._getBannerUnit(e,n);if(t.push(d),a.length&&a.some((t=>t.has(e.id)))&&i&&t.push(this._getOutstreamUnit(e,a)),o.length&&o.some((t=>t.has(e.id)))&&s&&t.push(this._getNativeUnit(e,o)),l.length&&l.some((t=>t.has(e.id)))&&e.multiformat){const i=this._getMultiformatUnit(e,l);t.push(i)}}_getMultiformatUnit(e,t){return this._getBannerUnit(e,t,!0)}_getBannerUnit(e,t,i=!1){const s=this.instlEnabled(e.location),r=this._ortb2.addOrtb2Imp({slot:e},s),n={banner:!0,native:this._mediaType.nativeEnabled(e)&&i,outstream:this._mediaType.outstreamEnabled(e).outstreamCapable&&i};return{...i&&{multiformat:i},...e.bidPoolId&&{bidPoolId:e.bidPoolId},...e.passiveBidPoolId&&{passiveBidPoolId:e.passiveBidPoolId},code:s?this._config.prebid.interstitialAdUnitCode:e.element.id,mediaTypes:this._mediaType.getMediaType({slot:e},n),...r?{ortb2Imp:r}:{},bids:t.map((t=>t.get(e.id))).filter(Ji).reduce(((e,t)=>e.concat(t)),[])}}_getOutstreamUnit(e,t){const i=this.instlEnabled(e.location),s=this._ortb2.addOrtb2Imp({slot:e},i);return{...e.bidPoolId&&{bidPoolId:e.bidPoolId},...e.passiveBidPoolId&&{passiveBidPoolId:e.passiveBidPoolId},code:i?this._config.prebid.interstitialAdUnitCode:e.element.id,mediaTypes:this._mediaType.getMediaType({slot:e},{outstream:!0}),...s?{ortb2Imp:s}:{},bids:t.map((t=>t.get(e.id))).filter(Ji).reduce(((e,t)=>e.concat(t)),[])}}_getNativeUnit(e,t){const i=this.instlEnabled(e.location),s=this._ortb2.addOrtb2Imp({slot:e},i);return{...e.bidPoolId&&{bidPoolId:e.bidPoolId},...e.passiveBidPoolId&&{passiveBidPoolId:e.passiveBidPoolId},code:i?this._config.prebid.interstitialAdUnitCode:e.element.id,mediaTypes:this._mediaType.getMediaType({slot:e},{native:!0}),...s?{ortb2Imp:s}:{},bids:t.map((t=>t.get(e.id))).filter(Ji).reduce(((e,t)=>e.concat(t)),[])}}_setAdUnitOnSLot(e){e.length&&this._prebidMethods.addToQueue((()=>{const t=this._prebidMethods.getPrebidAdUnits();t&&e.forEach((e=>{const i=t.filter((t=>t.code===e.element.id));i.length&&(e.prebidAdUnit=i)}))}))}_updateSlots(e){e.forEach((e=>{this._updateAdUnitData(e,e.prebidAdUnit);const t=e.prebidAdUnit||[];t.length&&(this._updateAdUnitOrtb2Imp(e,t),e.isHighlyViewable()&&this._updateBidderBidParams(e,t))}))}_updateAdUnitOrtb2Imp(e,t){t.forEach((t=>{const i=this._ortb2.addOrtb2Imp({slot:e});t.ortb2Imp=i}))}_updateBidderBidParams(e,t){t.forEach((t=>{t.bids&&t.bids.length&&t.bids.forEach((t=>{const i=this._bidderSetup.biddersParams.get(t.bidder);i&&i.updateBidParams(t,e)}))}))}_updateAdUnitData(e,t){t&&e.location!==ge.Video_StickyOutstream&&t.forEach((t=>{if(t.multiformat){const i={banner:!0,native:this._mediaType.nativeEnabled(e),outstream:this._mediaType.outstreamEnabled(e).outstreamCapable};t.mediaTypes=this._mediaType.getMediaType({slot:e},i)}t.viewability=e.refreshCount?Math.max(e.viewability,.7):e.viewability}))}_updateHighImpactUnitTargeting(){const e=this._gam;Vl.pushToQueue((()=>{const t="hi_au",i=e.getTargetingValuesForKey(t).filter((e=>"od"!==e&&"om"!==e));i.length?e.setTargeting({key:t,value:i}):e.clearTargetingForKey(t)}))}_shouldIncludeSlot(e){return!this._excludedSlots.includes(e.location)||e.location===ge.Interstitial&&this.instlEnabled(e.location)}_addOutstreamLabel(e,t){return this._mediaType.isOutstreamAllowed()&&e.forEach((e=>{this._mediaType.outstreamEnabled(e).outstreamCapable&&t.push(`outstreamCapable_${e.placementMapName}`)})),t}_addHvpLabel(e,t){e.forEach((e=>{e.isHighlyViewable()&&t.push(`hvp_${e.placementMapName}`)}))}_addRefreshLabel(e,t){e.forEach((e=>{e.refreshCount>0&&t.push("refresh")}))}_addInitialLabel(e,t){e.forEach((e=>{0===e.refreshCount&&t.push("initial")}))}_addAuctionLabels(e,t,i,s){const r=(i?this._config.prebid.refreshStickyOutstreamAuctionCount:this._config.prebid.refreshAuctionCount)||1;if(!t||1===t&&s)for(let t=0;t<r;t++){const i=t+1;e.push(`auction-${i}`)}else e.push(`auction-${t}`)}_addLabels(e,t,i,s){const r=e.some((e=>e.location===ge.Video_StickyOutstream));(r||1!==this._config.prebid.refreshAuctionCount)&&this._addAuctionLabels(t,i,r,s),this._addRefreshLabel(e,t),this._addOutstreamLabel(e,t),this._addHvpLabel(e,t),this._addInitialLabel(e,t)}_setDiscountTargeting(e){var t;const i=(null==e||null==(t=e.googleTagSlot)?void 0:t.getTargeting("hb_adid"))||[],s=(e.bidPoolId?this._prebidMethods.getBidResponsesForBidPoolId(e.bidPoolId):this._prebidMethods.getBidResponsesForAdUnitCode(e.id)).bids.filter((e=>e.adId===i[0]))[0]||{},r=s.responseCpm;if(r){const t=r-s.cpm;e.setSlotTargetingFlag("pbop",[r.toFixed(6).toString()]),e.setSlotTargetingFlag("pbpd",[t.toFixed(6).toString()])}}async _setRefreshOnVideoAdUnit(e){const t=this._prebidMethods;await t.waitForQueue();const i=t.getPrebidAdUnits();e.forEach((e=>{const t=null==i?void 0:i.filter((t=>t.code===e.name))[0];t&&(t.refresh=!0)}))}async _awaitPrebidReady(){return new Promise((e=>{this._prebidEventBus.initialized.once((()=>{e()}))}))}requestBids(e,t=this._config.timeouts.initialBidsRequest,i=[],s=0,r=!0){return e=e.filter((e=>this._shouldIncludeSlot(e))),new Promise((n=>{this.checkLibLoaded().then((async a=>{const o=e.map((e=>e.name)),l=Ul.markStartTask("microtask",["PrebidAuctionManager","requestBids","first","task"]);l.addMetadata({slotNames:o});const d=e.map((e=>this.instlEnabled(e.location)?this._config.prebid.interstitialAdUnitCode:e.element.id));let c=!1;const{reducer:h,sorter:u}=this._getBidSorters(d,e),p=()=>{c=!0,l.markEndTask(),n()},g=()=>{c||(r&&this._displayBidsBackhandler({},d,e,h,u),this._prebidMethods.addToQueue((()=>{p()})))};if(!a||!e.length)return void p();if(this._initialized)l.markEndTask();else{const e=this._awaitPrebidReady();l.markEndTask(),await e}const m=Ul.markStartTask("microtask",["PrebidAuctionManager","requestBids","second","task"]);m.addMetadata({slotNames:o}),this._addLabels(e,i,s,r),this._updateSlots(e),this._buildRequest(d,e,t,i,r,n);const _=()=>{this._prebidMethods.addToQueue((()=>{setTimeout(g,t+this._config.prebid.failsafeTimeout)}))};this._bootstrapConfig.gptLibFailedToLoad?_():Vl.pushToQueue((()=>_)),m.markEndTask()})).catch((e=>{te.error("PrebidAuctionManager","requestBids",e),n()}))}))}_buildRequest(e,t,i=this._config.timeouts.initialBidsRequest,s=[],r=!0,n,a,o){this._prebidMethods.requestBids({adUnitCodes:e,timeout:i,bidsBackHandler:i=>{r&&this._displayBidsBackhandler(i,e,t,a,o),this._prebidMethods.addToQueue((()=>{n()}))},labels:s})}_getBidSorters(e,t){var i;const s=e.length>1,r=(null==(i=t[0])?void 0:i.location)===ge.Video_StickyOutstream;let n,a;return!s&&r&&(n=this.cpmByDurationReducer.bind(this),a=this.cpmByDurationSorter.bind(this)),{reducer:n,sorter:a}}_displayBidsBackhandler(e,t,i,s,r){if(this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment("onBidsBackHandler"),this._bootstrapConfig.gptLibFailedToLoad)this.handleRenderingSlotsWhenGoogleAdManagerFailed(i);else{var n;this._config.fledge.enabled&&this._prebidMethods.setPAAPIConfigForGPT({adUnitCode:t[0]});const a=!!((null==(n=i[0])?void 0:n.location)===ge.Footer)&&this._roadblocksDetection.isRoadblock(e);a&&this._gam.setTargeting({key:"rb_crid",value:String(this._roadblocksDetection.creativeId)});const o=a?2:1;this._prebidMethods.setTargetingForGPTAsync(t,null,i[0].bidPoolId,o,s,r),this._setDiscountTargeting(i[0]),i.forEach((e=>{e.addRequestTypeSlotFlag()})),Object.keys(e).length>0&&this.setCurrencySlotTargetingFlag(i[0])}}_updateOrtb2WithJwPlayerSegments(e,t){var i,s,r,n,a;const o=tg(t),l=(null==(r=o.site)||null==(s=r.content)||null==(i=s.data)?void 0:i.filter((e=>"jwplayer.com"!==e.name)))||[];var d;const c={ext:{segtax:502,cids:[e.nextMediaId]},name:"jwplayer.com",segment:null!=(d=null==(n=e.jwPlayerSegments)?void 0:n.map((e=>({id:e}))))?d:[]};return l.push(c),o.site={...o.site,content:{...null==(a=o.site)?void 0:a.content,data:l}},o}requestVideoBids(e,t=this._config.timeouts.initialBidsRequest){const i=e.map((({name:e})=>e)),s=this._prebidMethods.getConfig("ortb2")||{},r=!Jc(e[0]);let n={};return r&&(n=this._updateOrtb2WithJwPlayerSegments(e[0],s)),new Promise((s=>{let a=!1;const o=()=>{s(),a=!0},l=()=>{a||s()};this.checkLibLoaded().then((async s=>{s||o(),this._initialized||await this._awaitPrebidReady(),this._setRefreshOnVideoAdUnit(e),this._prebidMethods.requestBids({adUnitCodes:i,timeout:t,bidsBackHandler:()=>{this._videoBidsBackhandler(),o()},...r?{ortb2:n}:{}});const a=()=>{this._prebidMethods.addToQueue((()=>{setTimeout(l,t+this._config.prebid.failsafeTimeout)}))};this._bootstrapConfig.gptLibFailedToLoad?a():Vl.pushToQueue((()=>a))})).catch((e=>{te.error("PrebidAuctionManager","requestVideoBids",e),o()}))}))}_getActiveBidsInPool(e){const t=this._prebidMethods,i=((e.bidPoolId?t.getBidResponsesForBidPoolId(e.bidPoolId):t.getBidResponsesForAdUnitCode(e.id))||{}).bids;return i&&i.filter((e=>{const t=e.ttl||300,i=e.responseTimestamp+1e3*t>(new Date).getTime(),s=e&&!e.sharedBidInUse&&"rendered"!==e.status;return i&&s}))}_videoBidsBackhandler(){this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment("onBidsBackHandler")}setCurrencySlotTargetingFlag(e){if(this._config.prebid.currencyConversionEnabled){const t="bidcur";let i=[];i=e.bidPoolId?this._prebidMethods.getHighestCpmBidsForPoolId(e.bidPoolId):this._prebidMethods.getHighestCpmBids(e.id);const s=null==i?void 0:i[0],r=null==s?void 0:s.originalCurrency,n=null==s?void 0:s.currency;r&&n&&r!==n?e.setSlotTargetingFlag(t,[n],!0):e.clearSlotTargetingFlag([t])}}handleRenderingSlotsWhenGoogleAdManagerFailed(e){e.forEach((e=>{e.isRefreshing=!1,this._slotEventBus.triggerRenderOutsideGam.emit(e)}))}addVideoSlots(e){const t=this._orderedVideoBidders.map((t=>t.getVideoBidRequests(e))),i=e.map((e=>{const i=this._ortb2.addOrtb2Imp({video:e}),s={code:e.name,ortb2Imp:i,mediaTypes:this._mediaType.getMediaType({video:e}),bids:t.map((t=>t.get(e.name))).filter(Ji).reduce(((e,t)=>e.concat(t)),[])};return e.videoAdUnit=s,s}));this._prebidMethods.addAdUnits(i),this._videoEventBus.videoAdUnitAdded.emit(e)}refreshBids(e,t=0,i=!0){return e.forEach((e=>{var t;null==(t=e.prebidAdUnit)||t.forEach((e=>e.refresh=!0))})),this.requestBids(e,this._config.timeouts.refreshBidsRequest,[],t,i)}checkLibLoaded(){return new Promise((e=>{this._bootstrapConfig.bootstrapLoaders[oe.Prebid].then((()=>e(!0))).catch((()=>e(!1)))}))}shouldTurnOffPrebidBasedOnGeoNDevice(){var e;const t=null!=(e=this._context.country)?e:"US",i=!this._highRevGeoCountries.includes(t)&&Wt()&&dt(),s=this._config.featureRolloutService.isRolloutEnabled("disable-prebid-non-high-geo-mob-chromium");return!!i&&s}get enabled(){return!(this.shouldTurnOffPrebidBasedOnGeoNDevice()||at())}cpmByDurationReducer(e,t){return this.getBidCpmByDuration(e)<this.getBidCpmByDuration(t)?t:e}cpmByDurationSorter(e,t){return this.getBidCpmByDuration(t)-this.getBidCpmByDuration(e)}getBidCpmByDuration(e){var t;const i=Math.max(1,null!=(t=e.duration)?t:this._defaultVideoDuration);return e.cpm/i}_setupSlotRequestTargeting(e,t){const i=this._slots.get(e.code);var s;const r=null!=(s=e&&e.ortb2Imp&&e.ortb2Imp.ext&&e.ortb2Imp.ext.tid)?s:"";if(i&&(i.setTransactionId(r),i.setSlotTargetingFlag("tid",[i.transactionId],!0),i.setTargeting({key:"idp",value:t}),i.multiformat&&i.refreshCount<2)){let e="b";this._mediaType.nativeEnabled(i)&&(e+="n"),this._mediaType.outstreamEnabled(i).outstreamCapable&&(e+="v"),i.setSlotTargetingFlag("mtr",[e],!0)}}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u,p,g,m,_,f,v,y,b,S,E,C,T,w,A,k,I){super(),this._bootstrapConfig=t,this._config=i,this._context=s,this._gam=r,this._s2s=n,this._bidderSetup=a,this._mediaType=o,this._prebidMethods=l,this._prebidConfiguration=d,this._predictiveAnalysisExperiment=c,this._userSyncTriggerComponent=h,this._slots=u,this._creativeMonitoring=p,this._ortb2=g,this._oseq=m,this._gdprEnforcement=_,this._prebidEventBus=f,this._slotEventBus=v,this._videoEventBus=y,this._floors=b,this._sspTakeRateMonitorExperiment=S,this._userIdComponent=E,this._sspUserSyncComponent=C,this._roxotAnalytics=T,this._googleAdManagerEventBus=w,this._roadblocksDetection=k,this._genericAnalytics=I,this.videoAdUnits=[],this.bidsRequested=new Q,this._isBeforeRequestEventLoaded=!1,this._excludedSlots=[ge.Interstitial,ge.Native_Recipe],this._defaultVideoDuration=30,this._bidResponseForAdUnitCount=new Map,this._highRevGeoCountries=["US","CA","AU","DE","NZ","GB","UK"],this._bseatAppRequests=["537073292","2307","377","39","5510"],this._initialized=!1,this._setAuctionFloors=e=>{const t=e&&e.auctionId&&!this._floors.auctionCaptured(e.auctionId),i=e.bids&&e.bids.length>0&&e.bids[0].floorData;if(t&&i){let t,i;const s=e.bids[0];try{i=(null==s?void 0:s.floorData)||{},t="function"==typeof e.bids[0].getFloor&&s.getFloor()}catch(e){te.error("PrebidAuctionManager","_handleBidRequested","could not call getFloor",e)}const r=this._config.prebid.s2s.bidders.includes(s.bidder)?"server":s.bidder;if(t&&"number"==typeof t.floor){const n=((e,t,i,s)=>Je(e,t,i,s,!1))(this._config,r,s,t.floor);this._floors.setAuctionFloors(e.auctionId,n,i,r)}else(null==i?void 0:i.skipped)&&this._floors.setAuctionFloors(e.auctionId,-1,i,r)}this.bidsRequested.emit()},this._orderedDisplayBidders=this._bidderSetup.orderedDisplayBidders,this._orderedVideoBidders=this._bidderSetup.orderedVideoBidders,this._videoCreativeIdMapping=this._bidderSetup.videoCreativeIdMapping,this._predictiveAnalysisResult=this._predictiveAnalysisExperiment.result||void 0,this._predictiveAnalysis=e.core.predictiveAnalysis,this._orderedMultiformatBidders=this._bidderSetup.multiFormatBidders,this._appDataBidders=A.result||[],this._analytics=[this._roxotAnalytics,this._genericAnalytics].filter((e=>e.enabled))}}ig=B([hs("PrebidAuctionManager"),M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive,void 0===tn?Object:tn,void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Vl?Object:Vl,void 0===Hp?Object:Hp,void 0===bp?Object:bp,void 0===vu?Object:vu,void 0===Ss?Object:Ss,void 0===Ip?Object:Ip,void 0===Pp?Object:Pp,void 0===Gp?Object:Gp,void 0===zr?Object:zr,void 0===Ep?Object:Ep,void 0===Zc?Object:Zc,void 0===Cp?Object:Cp,void 0===ih?Object:ih,void 0===Ms?Object:Ms,void 0===Es?Object:Es,void 0===zs?Object:zs,void 0===zl?Object:zl,void 0===Kp?Object:Kp,void 0===qh?Object:qh,void 0===Jp?Object:Jp,void 0===Wh?Object:Wh,void 0===jl?Object:jl,void 0===Wp?Object:Wp,void 0===Yp?Object:Yp,void 0===Qh?Object:Qh])],ig);class sg extends nr{init(){this._key="AmazonASRInitalRequest",this._default=!1}run(){return super.run()}}sg=B([hs("AmazonInitialAuctionExperiment"),M()],sg);const rg="AmazonAsrAuctionManager";class ng extends $l{init(){this._checkLibLoaded().then((()=>{this._amazonMethods.init(this._amazonConfig),this._enableASRPlacements()})).catch((e=>{te.error(rg,"init","Failed to initialize apstag",e)})),this._googleAdManagerEventBus.slotRenderEnded.on((({slot:e})=>{const t=this._amazonAsrValue;if(t&&t.adUnit===this._getSlotName(e)){const t=document.querySelector(`#${e.element.id} > iframe:nth-of-type(1)`);t&&t.style.setProperty("flex-basis","auto","important")}}))}_getASRValueFromMarmalade(){var e;const t=((null==(e=this._config.marmalade.amazonASR)?void 0:e.values)||[]).filter((e=>this._availableSlots.includes(e.adUnit)));if(!(null==t?void 0:t.length))return;return t[Math.floor(Math.random()*t.length)]}_getSlotName(e){let t=e.name;return"Content"===e.location&&e.sequence&&(t=e.sequence>=9?e.location:e.name),`AdThrive_${t}`}async requestBids(e,t=this._config.timeouts.initialBidsRequest-200,i=0){const s=new Promise(((e,i)=>{setTimeout((()=>i(!1)),t)}));return Promise.race([this._allowedToSetAsrTargeting,s]).then((t=>{e.forEach((s=>{const r=this._amazonAsrValue,n=this._config.prebid,a=e[0].location===ge.Video_StickyOutstream?n.refreshStickyOutstreamAuctionCount:n.refreshAuctionCount,o=r&&r.adUnit===this._getSlotName(s),l=this._initialAuctionEligible,d=this._initialAuctionEligible?!s.refreshCount||1===s.refreshCount:!!s.refreshCount;o&&d&&t&&(!i||i===a)&&Vl.pushToQueue((()=>{if(googletag.pubadsReady){s.refreshCount>(l?0:1)&&this._setCustomPlacements();const e=((e,t)=>{const i=e.partners.getBidderConfig("amazonASR").cpmMap.get("default");return qe({},i,t)})(this._config,Number(r.bidCpm)),t=Ze(e);s.googleTagSlot.setTargeting("amz_asr_pb",t),s.googleTagSlot.setTargeting("amznasr","true")}}))}))})).catch((e=>{}))}refreshBids(e,t=0){return e.forEach((e=>{this._clearAmazonAsrKeysFromSlot(e)})),this.requestBids(e,this._config.timeouts.refreshBidsRequest-200,t)}_clearAmazonAsrKeysFromSlot(e){if(e.googleTagSlot){const t=e.googleTagSlot.getTargetingKeys();this._asrTargetingKeys.forEach((i=>t.includes(i)&&e.googleTagSlot.clearTargeting(i)))}}get enabled(){return this._amazonMethods.isAmazonLoaded()&&!!this._config.partners.display.get("AmazonASR")&&this._config.marmalade.mcmp.some((e=>e.startsWith("SR_")))}async _checkLibLoaded(){try{return await this._bootstrapConfig.bootstrapLoaders[oe.Amazon],!0}catch(e){return te.error(rg,"checkLibLoaded",e),!1}}requestVideoBids(){return Promise.resolve()}constructor(e,t,i,s,r,n){super(),this._config=e,this._amazonMethods=t,this._bootstrapConfig=i,this._googleAdManagerEventBus=s,this._asrTargetingKeys=["amz_asr_pb","amznasr"],this._availableSlots=[],this._enableASRPlacements=()=>{this._allowedToSetAsrTargeting=new Promise(((e,t)=>{const i=this._amazonMethods.customPlacements();i&&(i=>{i.addEventListener&&i.addEventListener("PlacementResponse",(i=>{var s,r;const n=null==i||null==(s=i.detail)?void 0:s.aps;n&&(null==(r=n[0])?void 0:r.active)?e(!0):t(!1)})),this._setCustomPlacements(i)})(i)}))},this._setCustomPlacements=(e=!1)=>{const t=e||this._amazonMethods.customPlacements();t&&t.enable&&t.enable()},r.addSlots.on((e=>{e.forEach((e=>{const t=this._getSlotName(e);this._availableSlots.includes(t)||this._availableSlots.push(t)})),this._amazonAsrValue||(this._amazonAsrValue=this._getASRValueFromMarmalade())})),this._amazonConfig={pubID:this._config.amazon.pubId,deals:this._config.adOptions.pmp,adServer:"googletag",videoAdServer:"DFP",...this._config.ccpa.required&&this._config.ccpa.privacyString&&{params:{us_privacy:this._config.ccpa.privacyString}},schain:(new Hl).getSupplyChainConfig(this._config.site.id)},this._initialAuctionEligible=n.result}}ng=B([hs(rg),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Yl?Object:Yl,void 0===tn?Object:tn,void 0===jl?Object:jl,void 0===Es?Object:Es,void 0===sg?Object:sg])],ng);class ag{_setSlotEvents(){this._slotEventBus.addSlots.on((e=>this._addSlots(e))),this._slotEventBus.requestingBids.on((e=>this._requestBids(e))),this._slotEventBus.refreshingBids.on((e=>this._refreshBids(e.managedSlots,e.auctionCount,e.setTargeting)))}_setVideoEvents(){this._videoEventBus.videoPlayerAdded.on((e=>this._addVideoSlots(e))),this._videoEventBus.requestingVideoBids.on((({videos:e,timeout:t})=>this._requestVideoBids(e,t)))}init(){this._auctionManagers.forEach((e=>void 0!==e.init&&e.init()))}async _requestBids(e){return await Jl(),Promise.all(this._auctionManagers.map((t=>t.requestBids(e))))}_refreshBids(e,t=0,i=!0){return Promise.all(this._auctionManagers.map((s=>s.refreshBids(e,t,i))))}_addSlots(e){this._auctionManagers.forEach((t=>{void 0!==t.addSlots&&t.addSlots(e)}))}_addVideoSlots(e){this._auctionManagers.filter((e=>e.videoEnabled&&e.addVideoSlots)).forEach((t=>t.addVideoSlots(e)))}_requestVideoBids(e,t){return Promise.all(this._auctionManagers.filter((e=>e.videoEnabled)).map((i=>i.requestVideoBids(e,t))))}getPrebidAuctionManager(){for(const e of this._auctionManagers)if(e instanceof ig)return e}getAmazonAuctionManager(){for(const e of this._auctionManagers)if(e instanceof rh)return e}constructor(e,t,i,s,r){this._slotEventBus=s,this._videoEventBus=r,this._auctionManagers=[t,i,e],this._auctionManagers=this._auctionManagers.filter((e=>e.enabled)),this._setSlotEvents(),this._setVideoEvents()}}ag=B([hs("AuctionManagers"),M(),j("design:type",Function),j("design:paramtypes",[void 0===ig?Object:ig,void 0===rh?Object:rh,void 0===ng?Object:ng,void 0===Es?Object:Es,void 0===zs?Object:zs])],ag);class og{init(){if(this._commands.length>0){for(const e of this._commands){this._isGamMethod(e.toString())?this._addToGamQueue(e):this._call(e)}this._commands=[]}}push(e){if(this._commands.length>0)this._commands.push(e);else{this._isGamMethod(e.toString())?this._addToGamQueue(e):this._call(e)}}_call(e){try{e.call(void 0)}catch(e){te.error("CommandQueue","_call","Error calling command",e)}}_isGamMethod(e){return e&&(e.includes("setTargeting(")||e.includes("setTargetingFlag(")||e.includes("getTargeting(")||e.includes("getTargetingMap(")||e.includes("googletag")||e.includes("pubads"))}_addToGamQueue(e){Vl.pushToQueue((()=>{this._call(e)}))}constructor(e){this._commands=e.cmd||[]}}og=B([M(),F(0,D("AdThrive")),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdThrive?Object:AdThrive])],og);class lg{constructor(){this.wasClosed=!1,this.wasStarted=!1,this.totalTimeCollapsed=0}}lg=B([hs("CollapsibleVideoLoggingStore"),M()],lg);class dg{init(){}calculateCookieSizes(e){const t=this.getCookies();let i=0,s=0;t.forEach((e=>{const t=new Blob([e.value]).size;this.knownCookieKeys.includes(e.name)?i+=t:s+=t})),this.cookieEvents.push({e:e,knownSize:i,unknownSize:s})}getCookies(){const e=[];return document.cookie.split(";").forEach((t=>{const[i,s]=t.split("=").map((e=>e.trim()));e.push({name:i,value:s})})),e}constructor(e){this._identityEventBus=e,this.knownCookieKeys=["AMZN-Token","ccuid","ccsid","usprivacy","_pubcid","_pubcid_exp","connectId","lidid","TAPAD","panaoramaId","panaoramaId_expiry","krg_crb","krg_uid","cto_bundle","__li_idex_cache_e30"],this.cookieEvents=[],this._identityEventBus.dataCaptured.on((()=>{setTimeout((()=>this.calculateCookieSizes("piiSubmitted")),2e3)}))}}dg=B([hs("CookieDataStorage"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ls?Object:Ls])],dg);class cg extends nr{init(){this._key="UserPageDataLogging",this._default=!1}}cg=B([hs("UserPageDataLoggingExperiment"),M()],cg);class hg extends nr{init(){this._key="UserPageDataPrivacyLogging",this._default=!1}}hg=B([hs("UserPageDataPrivacyLoggingExperiment"),M()],hg);class ug extends Cs{init(){this._setupSlotManagerEventListeners(),this._setupUserPageDataLogEventCallbacks(),this._logUserPrivacyData().catch((()=>{te.error("_logUserPrivacyData: ","Could not log user privacy.")})),this._setLoadTimingProperties()}get enabled(){return this._userPageDataLoggingExperiment.result}_getBuildData(){const e=Kt(),t=e&&e.buildDate;return{bundleBuildDate:window.adthrive.buildDate,...t?{clsBuildDate:t}:{}}}_setTimingData(e,t,i){if(window.performance&&window.performance.timing){const r=window.performance.timing;if(r&&0!==r.navigationStart){const n={pageLoad:r.loadEventStart-r.navigationStart,domainLookup:r.domainLookupEnd-r.domainLookupStart,connect:r.connectEnd-r.connectStart,request:r.responseStart-r.requestStart,response:r.responseEnd-r.responseStart,navigation:r.fetchStart-r.navigationStart,domInteractive:r.domInteractive-r.navigationStart,domContentLoaded:r.domContentLoadedEventStart-r.navigationStart};if(Object.keys(n).map((e=>n[e])).every((e=>!isNaN(e)&&e>=0&&e<36e5))){this._setNonBlockingLibraryTimingData();const{reasons:r}=this._config.disableAds;var s;this._timingData={...n,...this._config.timing.timingData,disableAds:r.size>0?[...r].join(","):"none",cookieDeprecationLabel:null!=(s=this._config.fledge.cookieDeprecationLabel)?s:"none",auctionStarted:e,auctionFinished:t,displayed:i}}}}}_setNonBlockingLibraryTimingData(){this._config.timing.setNonBlockingLibraryTimingData(this._bootstrapConfig.bootstrapResult)}_logUserData(){this._cookieDataStorage.calculateCookieSizes("userDataLogged"),this._userPageDataLogEvents.loggingData.emit(),this._userPageDataLogEvents.setUserPageData({...this._timingData&&{UserPageTimingData:this._timingData},UserPageDataLoggingComponent:this._getUserData(),performanceTimingData:this._performanceTimingData})}async _logUserPrivacyData(){this._userPageDataPrivacyLoggingExperiment.result&&(this._userPrivacyData=await this._getUserPrivacyData())}async _getUserPrivacyData(){return{gpc:"navigator"in window&&"globalPrivacyControl"in window.navigator?window.navigator.globalPrivacyControl:null,dcp:await this._getDataConsent()}}async _getDataConsent(){if("dataConsentPreference"in document)try{return await document.dataConsentPreference()}catch(e){return null}return null}_getEventTiming(e,t){var i;return null!=(i=performance.getEntriesByType(e).filter(t)[0])?i:{}}_getEventTimingProperties(e,t,i){const s={},r=this._getEventTiming(e,t);return i.forEach((e=>{var t;s[e]=null!=(t=null==r?void 0:r[e])?t:null})),s}_getEventRegex(e){switch(e){case"adsmin":return/ads\.adthrive\.com\/sites\/.*\/ads\.min\.js\?.*/;case"marmalade":return/ads\.adthrive\.com\/api\/.*\/marmalade\?.*/;case"floors":return/ads\.adthrive\.com\/api\/.*\/raptiveFloors\.*/}return new RegExp("")}_setLoadTimingProperties(){const{duration:e}=this._getEventTimingProperties("resource",(e=>e.name.includes("adthrive.min.js")),["duration"]),t=this._getEventRegex("adsmin"),{duration:i,startTime:s}=this._getEventTimingProperties("resource",(e=>t.test(e.name)),["duration","startTime"]),{duration:r,responseEnd:n}=this._getEventTimingProperties("resource",(e=>e.name.includes("gpt.js")),["responseEnd","duration"]),a=this._getEventRegex("marmalade"),{responseEnd:o}=this._getEventTimingProperties("resource",(e=>a.test(e.name)),["responseEnd"]),l=this._getEventRegex("floors"),{responseEnd:d}=this._getEventTimingProperties("resource",(e=>l.test(e.name)),["responseEnd"]),c=Math.max(o,n,d),{domContentLoadedEventEnd:h,startTime:u,responseEnd:p,domInteractive:g,domContentLoadedEventStart:m,domComplete:_,loadEventStart:f,loadEventEnd:v}=this._getEventTimingProperties("navigation",(e=>!!e),["domContentLoadedEventEnd","startTime","responseEnd","domInteractive","domContentLoadedEventStart","domComplete","loadEventStart","loadEventEnd"]);this._performanceTimingData={durations:{adsMinLoadDuration:i,adCodeLoadDuration:e,gptLoadDuration:r},endTimes:{marmaladeEndTime:o,gptEndTime:n,floorsEndTime:d,domReadyEndTime:h},totalLoadTime:c-s,startTime:u,responseEnd:p,domInteractive:g,domContentLoadedEventStart:m,domContentLoadedEventEnd:h,domComplete:_,loadEventStart:f,loadEventEnd:v}}constructor(e,t,i,s,r,n,a,o,l,d,c,h){super(),this._bootstrapConfig=e,this._config=t,this._context=i,this._pageManager=s,this._spaEventBus=r,this._prebidMethods=n,this._userPageDataLoggingExperiment=a,this._userPageDataPrivacyLoggingExperiment=o,this._userPageDataLogEvents=l,this._collapsibleVideoLoggingStore=d,this._cookieDataStorage=c,this._slotManagerEventBus=h,this._userPrivacyData={},this._performanceTimingData={},this._setupSlotManagerEventListeners=()=>{const{reasons:e}=this._config.disableAds,t=0!==e.size,i={requestingBids:null,requestedBids:null,displayed:null};let s={...i,pageLoaded:!1};const r=(e,t)=>{s[e]=t,"number"==typeof s.requestingBids&&"number"==typeof s.requestedBids&&"number"==typeof s.displayed&&s.pageLoaded&&(this._setTimingData(s.requestingBids,s.requestedBids,s.displayed),s={...s,...i})};t?(s.requestedBids=0,s.requestingBids=0,s.displayed=0):(this._slotManagerEventBus.requestingBids.once((()=>r("requestingBids",ls()))),this._slotManagerEventBus.requestedBids.once((()=>r("requestedBids",ls()))),this._slotManagerEventBus.displayed.once((()=>r("displayed",ls())))),Vi().then((()=>r("pageLoaded",!0)))},this._setupUserPageDataLogEventCallbacks=()=>{Wt()&&this._userPageDataLogEvents.addCallbackToQueue([this._pageManager.visibilityChange],(()=>{"hidden"===document.visibilityState&&this._logUserData()})),this._userPageDataLogEvents.addCallbackToQueue([this._pageManager.beforeUnload,this._pageManager.pageHide,this._spaEventBus.routeChanged],(()=>this._logUserData()))},this._getUserData=()=>({...this._getBuildData(),device:this._context.device,gptv:googletag&&googletag.getVersion&&googletag.getVersion(),timePageOpen:ls()-this._config.timing.started,timeOnPage:this._config.timing.totalTimeOnPage,viewportWidth:window.innerWidth,viewportHeight:window.innerHeight,video:{nonclose:!this._collapsibleVideoLoggingStore.wasClosed,playerName:this._collapsibleVideoLoggingStore.playerName,totalTimeCollapsed:this._collapsibleVideoLoggingStore.totalTimeCollapsed,wasStarted:this._collapsibleVideoLoggingStore.wasStarted},cookieEvents:this._cookieDataStorage.cookieEvents,...this._userPrivacyData,...!this._config.gdpr.enabled&&!this._config.ccpa.userOptedOut&&{uid1:es("adserver.org",this._prebidMethods.isPrebidLoaded())}})}}ug=B([hs("UserPageDataLoggingComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===tn?Object:tn,void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===wr?Object:wr,void 0===Ns?Object:Ns,void 0===Ss?Object:Ss,void 0===cg?Object:cg,void 0===hg?Object:hg,void 0===ll?Object:ll,void 0===lg?Object:lg,void 0===dg?Object:dg,void 0===Vs?Object:Vs])],ug);const pg=()=>window.location.origin+"/"===window.location.href.split("?")[0];class gg{add(e,t,i,s=document){this._map.push({el:e,coords:t,dynamicAd:i,target:s})}get map(){return this._map}sort(){this._map.sort((({coords:e},{coords:t})=>e-t))}filterUsed(){this._map=this._map.filter((({dynamicAd:e})=>!e.used))}reset(){this._map=[]}constructor(){this._map=[]}}class mg extends gg{}mg=B([M()],mg);class _g extends nr{init(){this._key="AdDensity",this._default=!1}}_g=B([hs("RealizedAdDensityExperiment"),M()],_g);const fg=e=>{const t=e.firstChild?e.firstChild:void 0,i=t?getComputedStyle(t).height:"0px";return Number(i.slice(0,-2))};class vg extends Cs{init(){this._realizedAdDensityEventBus.metricsRequested.on((e=>e(this._getAdDensity())));const[e]=li(this._config.dynamicAds,this._adInjectionMap);this._mainContent=e,null!==this._mainContent&&(this._initObserver(this._mainContent),this._gamEventBus.slotOnload.on((()=>{this._heightsRegistered||(setTimeout((()=>{this._getSlotHeights()}),this._initialSlotsTimeout),this._heightsRegistered=!0)})),this._slotManagerEventBus.added.on((e=>{e.some((e=>e.infinite))||this._addSlots(e)})),this._userPageDataLogEvents.addCallbackToQueue([this._pageManager.beforeUnload],(()=>this._logAdDensity())))}_getAdDensity(){return this.enabled,{...this._endMainContentHeight&&this._slotsHeightEnd&&{addensend:Math.round(this._slotsHeightEnd/this._endMainContentHeight*100)}}}_logAdDensity(){const e=this._getAdDensity();Object.keys(e).length>0&&this._userPageDataLogEvents.setUserPageData({AdDensityComponent:e})}_addSlots(e){e.filter((e=>this._slotsForAdDensity.has(e.location))).filter((e=>!e.element.classList.contains("adthrive-slicksearch"))).forEach((e=>{!e.lazy&&this._addToMainContent.has(e.location)&&this._slotsForMainContent.add(e.name),this._slotsForEnd.add(e.name)}))}isSlotInMainContent(e){var t;return!(!(null==(t=this._mainContent)?void 0:t.querySelector(`#${e.id}`))||this.isSlotInComment(e))}isSlotInComment(e){return!(!this._commentElem||!this._commentElem.querySelector(`#${e.id}`))}_getSlotHeights(){let e=0;this._slots.get().forEach((t=>{this._slotsForMainContent.has(t.name)&&(e+=t.element.offsetHeight)})),this._mainContent&&(this._initMainContentHeight=ai(this._mainContent),this._initMainContentHeight+=e)}_initObserver(e){const t=e.querySelector(ni);this._observer=this.getIntersectionObserver(t),null!==t?(this._commentElem=t,this._observer.observe(this._commentElem)):this._observer.observe(e)}getIntersectionObserver(e){return new IntersectionObserver((t=>{for(const r of t)if(null!==this._initMainContentHeight){var i,s;if(null===e&&r.boundingClientRect.top<0)this._calculateSlotHeightsAtEnd(),null==(i=this._observer)||i.unobserve(this._mainContent);if(null!==e&&r.boundingClientRect.top>0)this._calculateSlotHeightsAtEnd(),null==(s=this._observer)||s.unobserve(e)}}),{})}_calculateSlotHeightsAtEnd(){let e=0,t=0;if(this._slots.get().forEach((i=>{if(this._slotsForEnd.has(i.name)&&(i.location!==ge.Content||this.isSlotInMainContent(i))){const t=fg(i.element);t&&t>1?this._parallaxExperiment.result&&t>=600&&t<=750?e+=400:e+=t:e+=i.element.offsetHeight}this._slotsForMainContent.has(i.name)&&(t+=i.element.offsetHeight)})),this._slotsHeightEnd=e,this._mainContent&&(this._endMainContentHeight=ai(this._mainContent),this._endMainContentHeight+=t),this._config.video.playlistPlayerAdded){const t=document.querySelector(".adthrive-collapse-player");e+=t?t.offsetHeight:0}if(this._config.video.relatedPlayerAdded){document.querySelectorAll(".adthrive-video-player").forEach((t=>{e+=t.offsetHeight}))}this._slotsHeightVideo=e}get enabled(){return this._realizedAdDensityExperiment.result&&"IntersectionObserver"in window&&!(null!==document.querySelector("body.home")||null!==document.querySelector("body.archive"))&&!pg()}start(){this._realizedAdDensityEventBus.realizedAdDensityCompReady.emit()}constructor(e,t,i,s,r,n,a,o,l,d){super(),this._config=e,this._realizedAdDensityExperiment=t,this._parallaxExperiment=i,this._slots=s,this._pageManager=r,this._userPageDataLogEvents=n,this._adInjectionMap=a,this._realizedAdDensityEventBus=o,this._gamEventBus=l,this._slotManagerEventBus=d,this._initialSlotsTimeout=1e4,this._addToMainContent=new Set([ge.Below_Post]),this._slotsForAdDensity=new Set([ge.Content,ge.Recipe,ge.Footer]),this._mainContent=null,this._commentElem=null,this._heightsRegistered=!1,this._initMainContentHeight=null,this._endMainContentHeight=null,this._slotsHeightEnd=null,this._slotsHeightVideo=null,this._slotsForMainContent=new Set,this._slotsForEnd=new Set}}vg=B([hs("RealizedAdDensityComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===_g?Object:_g,void 0===$a?Object:$a,void 0===zr?Object:zr,void 0===wr?Object:wr,void 0===ll?Object:ll,void 0===mg?Object:mg,void 0===$s?Object:$s,void 0===jl?Object:jl,void 0===Vs?Object:Vs])],vg);class yg extends Cs{init(){if(this._context.querystring.has("ad_test")){const e=this._context.querystring.get("ad_test");this._gam.setTargeting({key:"sec",value:e.split(",").map((e=>`test${e}`))})}}constructor(e,t){super(),this._context=e,this._gam=t}}yg=B([hs("AdTestComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Pr?Object:Pr,void 0===Vl?Object:Vl])],yg);class bg extends nr{init(){this._key="BrandMetrics",this._default=!0}}bg=B([hs("BrandMetricsExperiment"),M()],bg);class Sg extends Cs{init(){this._prebidAuctionManager.bidsRequested.once((()=>{this._load()}))}get enabled(){return this._brandMetricsExperiment.result}_load(){vi(this._url).then((()=>this._monitorSurvey())).catch((()=>{}))}_monitorSurvey(){window._brandmetrics=window._brandmetrics||[],window._brandmetrics.push({cmd:"_querySurvey",val:{callback:(e,t)=>{e&&t&&t.measurementId&&this._gam.setTargeting({key:"bms",value:[t.measurementId.toString()]})}}})}constructor(e,t,i){super(),this._brandMetricsExperiment=e,this._gam=t,this._prebidAuctionManager=i,this._url="https://cdn.brandmetrics.com/tag/aa466d868b2742ffa2cc31bb6341dc12/cafemedia.js"}}Sg=B([hs("BrandMetrics"),L(),j("design:type",Function),j("design:paramtypes",[void 0===bg?Object:bg,void 0===Vl?Object:Vl,void 0===ig?Object:ig])],Sg);class Eg extends Cs{init(){(e=>{const t=document.body,i=`adthrive-device-${e}`;if(!t.classList.contains(i))try{t.classList.add(i)}catch(e){te.error("BodyDeviceClassComponent","init",{message:e.message});const t="classList"in document.createElement("_");te.error("BodyDeviceClassComponent","init.support",{support:t})}})(this._context.device)}constructor(e){super(),this._context=e}}function Cg(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var s=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===i&&s.firstChild?s.insertBefore(r,s.firstChild):s.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}Eg=B([hs("BodyDeviceClassComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Pr?Object:Pr])],Eg);Cg(".adthrive-ccpa-modal{background-color:#000;background-color:rgba(0,0,0,.4);display:none;height:100%;left:0;overflow:auto;position:fixed;top:0;width:100%;z-index:2147483647}.adthrive-ccpa-modal-content{background-color:#fefefe;border:1px solid #888;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.5);font-family:Verdana,Geneva,Tahoma,sans-serif;margin:0 auto;max-width:592px;padding:20px 24px 24px;position:relative;top:50%;transform:translateY(-50%);width:80%}#adthrive-ccpa-modal-title{color:rgba(0,0,0,.87);font-size:20px;line-height:26px}.adthrive-ccpa-modal-btn:focus,.adthrive-ccpa-modal-btn:hover{color:#000;cursor:pointer;text-decoration:none}#adthrive-ccpa-modal-language{color:rgba(0,0,0,.87);display:block;font-size:14px;line-height:20px;margin:16px 0 32px}#adthrive-ccpa-modal-cancel-btn:focus,#adthrive-ccpa-modal-cancel-btn:hover,#adthrive-ccpa-modal-close-btn-container:focus,#adthrive-ccpa-modal-close-btn-container:hover{color:rgba(0,0,0,.8);cursor:pointer;text-decoration:none}#adthrive-ccpa-modal-continue-btn:focus,#adthrive-ccpa-modal-continue-btn:hover{color:hsla(0,0%,100%,.8);cursor:pointer;text-decoration:none}#adthrive-ccpa-modal-close-btn-container{color:#000;font-size:20px;font-weight:700;line-height:20px;position:absolute;right:8px;top:8px}.adthrive-ccpa-lower-buttons-container{color:#000;font-size:18px}#adthrive-ccpa-modal-cancel-btn{display:inline-block;text-align:left;width:calc(100% - 150px)}#adthrive-ccpa-modal-continue-btn{background-color:#010044;border-radius:10px;color:#fff;display:inline-block;height:44px;line-height:44px;text-align:center;width:150px}@media screen and (max-width:896px){.adthrive-ccpa-modal-content{margin:0 auto;position:relative;width:calc(100% - 80px)}#adthrive-ccpa-modal-title{font-size:16px;line-height:24px}#adthrive-ccpa-modal-language{font-size:12px;line-height:16px;text-align:left}.adthrive-ccpa-lower-buttons-container{font-size:14px}#adthrive-ccpa-modal-close-btn-container{font-size:14px;line-height:14px}}@media screen and (max-width:350px){#adthrive-ccpa-modal-title{font-size:14px;line-height:24px}#adthrive-ccpa-modal-language{font-size:10px;line-height:14px;text-align:left}.adthrive-ccpa-lower-buttons-container{display:block;font-size:12px;text-align:center;width:100%}#adthrive-ccpa-modal-close-btn-container{display:block;font-size:12px;line-height:12px}#adthrive-ccpa-modal-cancel-btn,#adthrive-ccpa-modal-continue-btn{display:block;text-align:center;width:100%}#adthrive-ccpa-modal-cancel-btn{margin-bottom:10px}}");class Tg extends Cs{init(){if(window.__uspapi=this.uspapi.bind(this),this.addLocatorFrame(),this.ccpaRequired){window.__uspapi("registerDeletion",1,this.deleteData),this.setGpcString();const e=this.gpcEnabled||this._config.ccpa.privacyString===this.ccpaOptOut?this.ccpaOptOut:this.ccpaOptIn;this.setPrivacyString(e),this.setDeviceAccess()}else this.setPrivacyString(this.ccpaNotApplicable)}setPrivacyString(e,t=!1){const i=this.ccpaRequired&&this.privacyString===this.ccpaNotApplicable,s=!this.ccpaRequired&&this.privacyString!==this.ccpaNotApplicable;(e||!0===t||i||s||this.gpcUpdated)&&(this.setPrivacyCookie(e),this.privacyString=e)}setPrivacyCookie(e){const t=new Date(2147483647e3).toUTCString();document.cookie=`usprivacy=${e};path=/;expires=${t}`}setGpcString(){null!==this.gpcEnabled&&!1!==this.gpcEnabled||!this.globalPrivacyControl?!0!==this.gpcEnabled||this.globalPrivacyControl||(K.removeLocalStorageValue("gpc"),this.gpcEnabled=this.globalPrivacyControl,this.gpcUpdated=!0):(K.setLocalStorageValue("gpc",`${this.globalPrivacyControl}`),this.gpcEnabled=!!`${this.globalPrivacyControl}`,this.gpcUpdated=!0)}uspapi(e,t,i){switch(e){case"performDeletion":this._deletionQueue.forEach((e=>e()));break;case"registerDeletion":this._deletionQueue.push(i);break;case"getUSPData":return i({command:e,version:t,uspString:kr.readExternalCookie("usprivacy")},!0);default:return null}}addLocatorFrame(){if(null===document.getElementById("__uspapiLocator")){const e=document.createElement("iframe");e.style.display="none",e.id="__uspapiLocator",e.name="__uspapiLocator",document.body.appendChild(e)}}setCCPAEventListener(e,t,i,s){i&&this.modal?i.addEventListener("click",(()=>{e&&this.optUserInOrOut(),t&&(this.modal.style.display="none")}).bind(this)):s&&this.modal&&s.addEventListener("click",(e=>{e.target==this.modal&&(this.modal.style.display="none")}).bind(this))}optUserInOrOut(){this.privacyString===this.ccpaOptIn?(this.setPrivacyString(this.ccpaOptOut,!0),window.__uspapi("performDeletion",1),this.modal.style.display="block",this.ccpaATag.textContent=this.ccpaOptInText,this._config.ccpa.userOptedOut=!0):(this.setPrivacyString(this.ccpaOptIn,!0),this.ccpaATag.textContent=this.ccpaOptOutText,this._config.ccpa.userOptedOut=!1),this._config.ccpa.consentChange.emit(this.privacyString),this.setDeviceAccess()}createCCPAModal(){document.body.append(this.modal),this.modal.append(this.modalContent),this.setCCPAEventListener(!1,!0,void 0,window);const e=yt("div","adthrive-ccpa-modal-close-btn-container",void 0,"<span>&#10005;</span>");this.modalContent.append(e),this.setCCPAEventListener(!1,!0,e);const t=yt("div","adthrive-ccpa-modal-title",void 0,this._config.ccpa.optOutText);this.modalContent.append(t);const i=yt("span","adthrive-ccpa-modal-language",void 0,'You have chosen to opt-out of the sale or sharing of your information from this site and any of its affiliates. To opt back in please click the "Customize my ad experience" link.<br>\n    <br>This site collects information through the use of cookies and other tracking tools. Cookies and these tools do not contain any information that personally identifies a user, but personal information that would be stored about you may be linked to the information stored in and obtained from them. This information would be used and shared for Analytics, Ad Serving, Interest Based Advertising, among other purposes.<br>\n    <br>For more information please visit this site\'s Privacy Policy.');this.modalContent.append(i)}createModalLowerButtons(){const e=yt("div",void 0,"adthrive-ccpa-lower-buttons-container");this.modalContent.append(e);const t=yt("div","adthrive-ccpa-modal-cancel-btn","adthrive-ccpa-modal-btn","CANCEL");e.append(t),this.setCCPAEventListener(!0,!0,t);const i=yt("div","adthrive-ccpa-modal-continue-btn","adthrive-ccpa-modal-btn","CONTINUE");e.append(i),this.setCCPAEventListener(!1,!0,i)}addOptOutElements(e=!0){this.ccpaOptOutDiv=yt("div",this.ccpaOptOutDivId,"adthrive-ccpa-link","Information from your device can be used to personalize your ad experience. <br><br>"),this.ccpaOptOutDiv.style.display=e?"block":"none",this.ccpaOptOutDiv.appendChild(this.ccpaATag),this.setCCPAEventListener(!0,!1,this.ccpaATag),this.createCCPAModal(),this.createModalLowerButtons()}deleteData(){}setDeviceAccess(){this._deviceAccess=this.privacyString===this.ccpaOptIn}constructor(e){super(),this._config=e,this._deviceAccess=!1,this.ccpaRequired=this._config.ccpa.required,this.privacyString=this._config.ccpa.privacyString,this.ccpaNotApplicable=this._config.ccpa.ccpaNotApplicable,this.ccpaOptIn=this._config.ccpa.ccpaOptIn,this.ccpaOptOut=this._config.ccpa.ccpaOptOut,this.ccpaOptOutText=this._config.ccpa.optOutText,this.ccpaOptInText=this._config.ccpa.optInText,this.gpcEnabled=!!this._config.ccpa.gpcEnabled,this.gpcUpdated=!1,this.globalPrivacyControl=window.navigator.globalPrivacyControl,this._deletionQueue=[],this.ccpaLinkText=""===this.privacyString||this.privacyString===this.ccpaOptIn?this.ccpaOptOutText:this.ccpaOptInText,this.modal=yt("div","adthrive-ccpa-modal","adthrive-ccpa-modal"),this.modalContent=yt("div","adthrive-ccpa-modal-content","adthrive-ccpa-modal-content"),this.ccpaATag=yt("a","ccpaTag",void 0,this.ccpaLinkText,"/"),this.ccpaOptOutDivId="adthrive-ccpa-link"}}class wg extends Tg{init(){if(super.init(),this.ccpaRequired){this._setupListeners();const e=document.querySelector(`#${this.ccpaOptOutDivId}`),t=this._isHomeOrFPV();e||this._config.act25.required||(this.addOptOutElements(t),this.injectFooter());const i=qi("health-directed-treatment");"US"===this._context.country&&i&&this._gam.setTargetingFlag("hmt",[Ki(this._context.region)?"1":"0"])}}uspapi(e,t,i){return super.uspapi(e,t,i)}createCCPAModal(){return super.createCCPAModal()}optUserInOrOut(){super.optUserInOrOut()}_isHomeOrFPV(){return"/"===window.location.pathname||this._context.isFirstPageview}_setupListeners(){this._didSetupListeners||(this._spaEventBus.routeChanged.once((()=>{this.init();const e=document.querySelector(`#${this.ccpaOptOutDivId}`),t=this._isHomeOrFPV()?"block":"none";e&&(e.style.display=t)})),this._didSetupListeners=!0)}injectFooter(){this.ccpaOptOutDiv&&this._config.footer.elements.push({order:1,element:this.ccpaOptOutDiv})}constructor(e,t,i,s){super(e),this._context=t,this._gam=s,this._didSetupListeners=!1,this._spaEventBus=i}}wg=B([hs("CCPAComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Ns?Object:Ns,void 0===Vl?Object:Vl])],wg);class Ag extends Cs{_isInApp(){return qt()||Ht()||$t()}_getBrowserCharacter(e=!1){return this._isInApp()&&e?"a":lt()?"c":ct()?"s":nt()?"f":at()?"i":rt()?"e":"o"}_getOSAndBrowserValue(){const e=di().slice(0,1).toLowerCase();if(!["m","w","i","a"].includes(e))return"o";const t=new Set(["m","a"]),i=`${e}${this._getBrowserCharacter(!t.has(e))}`;return new Set(["mc","ms","mf","wc","wi","we","wf","ws","ic","is","ia","io","ac","aa","ao"]).has(i)?i:"o"}_getConfigTargeting(){const e=this._config,t=this._context,i=this.debug,s=this._getOSAndBrowserValue(),r=[...this._getConfigGoogleAdManagerTargeting(e.gam.targeting),{key:"abgroup",value:e.abGroup.groups},{key:"pubab",value:e.pubAbGroup.groups},{key:"idho_p",value:e.idho.percentages},{key:"bucket",value:i?"unsupported":t.bucket},{key:"sens",value:e.site.sensitiveCategories},{key:"domain",value:t.domain},{key:"plugin",value:t.plugin},{key:"hi_au",value:e.adTypes.enabledMinified},{key:"vpwxvph",value:`${window.innerWidth}x${window.innerHeight}`},{key:"ri",value:t.ri},{key:"st",value:t.salesThrottle},{key:"rsi",value:t.rsi},{key:"pvk",value:t.pageviewKey},{key:"sess",value:t.sessionKey},{key:"branch",value:t.branch},{key:"deployment",value:i||t.invalidTraffic?"unsupported":t.deployment},{key:"doba",value:e.displayOpenBidding.bidders},{key:"gptv",value:window.googletag.getVersion()},{key:"id_region",value:e.locale.targetingValue},{key:"osb",value:s}];return e.hbho.filteredBidders.length&&r.push({key:"hbho",value:e.hbho.filteredBidders}),e.vbho.filteredBidders.length&&r.push({key:"vbho",value:e.vbho.filteredBidders}),r}_getConfigGoogleAdManagerTargeting(e){const t="verticals",i=[];return e.forEach((e=>{e.key===t?i.push({key:t,value:this._fixGamVerticalsValue(e.value)}):i.push({key:e.key,value:e.value})})),i}_fixGamVerticalsValue(e){if(!Array.isArray(e))return this._fixGamVerticalsValue([e])[0];const t=new RegExp(/[";'\^=\(\)!<>\+\[\]#,\*~`]/,"g");return e.map((e=>e.replace(t,"").replace(/&/g,"and")))}getConditionalTargeting(){const e=[],t=this._context,i=this._config.site,s=this._config.ccpa;return i.sensCategoriesOff.length&&e.push({key:"sens_off",value:i.sensCategoriesOff}),t.connectionTargeting.length&&e.push({key:"connection",value:t.connectionTargeting}),s.required&&e.push({key:"ccpaOptOut",value:s.userOptedOut?"1":"0"}),e}setConditionalFlagTargeting(){const e=this._context,t=pt();var i;"cookieDeprecationLabel"in navigator&&this._gam.setTargetingFlag("cookdep",[null!=(i=this._config.fledge.cookieDeprecationLabel)?i:""]);if(e.invalidTraffic&&this._gam.setTargetingFlag("bot",e.invalidTraffic),e.adsMinLoadDuration&&this._gam.setTargetingFlag("adsmnche",e.adsMinLoadDuration),this._config.gdpr.enabled&&this._gam.setTargetingFlag("gdpr",["1"]),this._config.locale.region&&this._gam.setTargetingFlag("region",[this._config.locale.region]),null!==pt()&&this._gam.setTargetingFlag("brwsrv",[`${t}`]),this._config.adOptions.pmp&&this._gam.setTargetingFlag("pmp_elig",["1"]),Bt()&&this._config.adTypes.largeFormatsDesktop&&this._gam.setTargetingFlag("lf_elig",["1"]),!Bt()&&this._config.adTypes.largeFormatsMobile&&this._gam.setTargetingFlag("lf_elig",["1"]),this._config.clsOptions&&(this._gam.setTargetingFlag("clson",[String(!!this._config.clsOptions.injectedFromPlugin)]),this._gam.setTargetingFlag("clsBranch",[this._config.clsOptions.branch||""]),this._gam.setTargetingFlag("clsBucket",[this._config.clsOptions.bucket||""])),e.integration&&this._gam.setTargetingFlag("integration",[e.integration]),e.deliveryVersion&&this._gam.setTargetingFlag("lmdv",[e.deliveryVersion]),e.isWordPressLogin&&this._gam.setTargetingFlag("wpadm",["1"]),this._config.optimalBidder.optdExperimentActive||this._config.optimalBidder.optvExperimentActive)if(this._config.optimalBidder.optimalBidderDataExists())this._gam.setTargetingFlag("bhov",[this._config.optimalBidder.modelVersion],!0);else{const e=Array.from(this._config.optimalBidder.errors);this._gam.setTargetingFlag("bhov",e,!0)}}init(){Vl.pushToQueue((()=>{this._gam.setTargeting([...this._getConfigTargeting(),...this.getConditionalTargeting()]),this.setConditionalFlagTargeting()}))}constructor(e,t,i){super(),this._config=e,this._gam=t,this._context=i,this.debug=!1,this.debug=this._context.debug}}Ag=B([hs("ConfigTargetingComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Vl?Object:Vl,void 0===Pr?Object:Pr])],Ag);class kg extends Cs{init(){this._gamEventBus.slotRenderEnded.on((e=>this.confirmedClickOverlay(e)))}confirmedClickOverlay({event:e,slot:t}){Vl.pushToQueue((()=>{const{id:i,location:s,sequence:r,nref:n}=t.getTargetingMap(),a=this.confirmedClickStatus(this._slots.get(e.slot.getSlotElementId()));Ci({event:e,ignoreOtherCompanyIds:!0})&&a&&te.event("confirmedClickOverlay","status",{id:i,location:s,sequence:r,nref:n,confirmedClick:a})}))}confirmedClickStatus(e){const t=["common_15click_overlay","common_15click_anchor"];try{const i=null==e?void 0:e.element.querySelectorAll("iframe[id^=google_ads_iframe]");let s;return i&&(null==i?void 0:i.length)>0&&(s=i[0]),t.some((e=>{var t;return null!=(null==s||null==(t=s.contentDocument)?void 0:t.getElementById(e))}))}catch(e){te.error("ConfirmedClickComponent","confirmedClickStatus",e)}return!1}constructor(e,t){super(),this._slots=e,this._gamEventBus=t}}kg=B([hs("ConfirmedClicksComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===zr?Object:zr,void 0===jl?Object:jl])],kg);class Ig extends Cs{init(){const e=this._slotManager;this._gamEventBus.slotRenderEnded.on((({event:t,slot:i})=>{this.isDeclaredRefreshCompliantSlot(i)&&Ci({event:t})&&e.updateRefreshTimeout(i.id,24e4)})),this._slotManagerEventBus.added.on((e=>e.forEach((e=>{this.isDeclaredRefreshCompliantSlot(e)&&Vl.pushToQueue((()=>{e.setTargeting({key:"decref",value:"240"})}))}))))}isDeclaredRefreshCompliantSlot(e){return e.location===ge.Sidebar&&("phone"===this._device||"tablet"===this._device)||e.location===ge.Header&&2===e.sequence&&("phone"===this._device||"tablet"===this._device)}constructor(e,t,i,s){super(),this._context=e,this._gamEventBus=t,this._slotManager=i,this._slotManagerEventBus=s,this._device=this._context.device}}Ig=B([hs("DeclaredRefreshComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Pr?Object:Pr,void 0===jl?Object:jl,void 0===id?Object:id,void 0===Vs?Object:Vs])],Ig);class Pg extends As{get result(){return this._result}run(){return new Is(this.weight).get()}constructor(e){super(),this._result=!1,this.abgroup="scae",this.key="StickyContainerAds",this._choices=[{choice:!0},{choice:!1}],this.weight=.99,this.shouldUseCoreOverride=!1;const t=window,i=t&&t.adthriveCLS,s=i&&i.experiments,r=s&&this.abgroup in s;this._result=r?s[this.abgroup]:this.run(),e.set(this.abgroup,this._result?"on":"off")}}Pg=B([hs("StickyContainerAdsExperiment"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Qs?Object:Qs])],Pg);class Og extends qs{run(){if(!this.enabled)return te.error("TargetAdDensitySiteExperiment","run","() => %o","No experiment config found. Defaulting to control."),"control";const e=new Ps(this._mappedChoices).get();return this._isValidResult(e)?e:(te.error("TargetAdDensitySiteExperiment","run","() => %o","Invalid result from experiment choices. Defaulting to control."),"control")}setExperimentTargeting(){if(!this.enabled||!this._isValidResult(this._result))return void te.error("TargetAdDensitySiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config and valid result");const e=this.experimentConfig,t=`${e.key.toLowerCase()}-${e.id}`,i="control"===this._result?"control":`${Math.round(100*this._result)}`;this._pubabgroup.set(t,i)}_mapChoices(){return this._choices.map((({weight:e,value:t})=>({weight:e,choice:"number"==typeof t?(t||0)/100:"control"})))}constructor(e,t,i,s){var r;super(),this._siteExperiments=e,this._pubabgroup=t,this._clsOptions=i,this._choices=[],this._mappedChoices=[],this._result="control",this._resultValidator=e=>"number"==typeof e,this.key=pe.AdDensity,this.abgroup=pe.AdDensity,(null==(r=s.siteAds)?void 0:r.siteExperiments)?this.experimentConfig=new Gs(s.siteAds).getSiteExperimentByKey(this.key):this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);const n=this._clsOptions.getWeightedChoiceExperiment(this.abgroup,!0);this.enabled&&this._isValidResult(n)?(this._result=n,this.setExperimentTargeting()):this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),this.setExperimentTargeting())}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Og.prototype,"run",null),Og=B([M(),F(3,D("AdthriveCLS")),j("design:type",Function),j("design:paramtypes",[void 0===Ks?Object:Ks,void 0===Xs?Object:Xs,void 0===Ba?Object:Ba,"undefined"==typeof AdthriveCLS?Object:AdthriveCLS])],Og);const xg=(e,t,i,s=[],r)=>{let n=`<div id="${t}" class="adthrive-ad ${s.join(" ")}"></div>`;if(r===ge.Video_StickyOutstream){n=`<div class="adthrive-sticky-outstream adthrive-sticky-outstream-${t.includes("phone")?"mobile":"desktop"}">`+n+"</div>"}return window.adthriveCLS&&window.adthriveCLS.injectedSlots&&window.adthriveCLS.injectedSlots.some((e=>e.element.id===t))||e.insertAdjacentHTML(i,n),document.getElementById(t)},Rg=({location:e,sequence:t,sticky:i,lazy:s,stickyOverlapSelector:r,special:n,auctionPriority:a},o,l,d)=>new Vr(e,t,l,o,i,s,a,r,n,!0,d),Dg=(e,t=document)=>t.querySelectorAll(e),Lg=e=>`adthrive-${e.location.replace("_","-").toLowerCase()}`,Mg=e=>`${Lg(e)}-${e.sequence}`;class Bg extends As{get result(){return this._result}run(){return new Is(1).get()}constructor(e){super(),this._result=!1,this._choices=[{choice:!0},{choice:!1}],this.shouldUseCoreExperimentsConfig=!1,this.key="RemoveRecipeCap",this.abgroup="rrc";const t=window.adthriveCLS,i=t&&t.experiments;this._result=i&&this.abgroup in i?i[this.abgroup]:this.run(),e.set(this.abgroup,this._result?"on":"off")}}Bg=B([hs("RemoveRecipeCapExperiment"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Qs?Object:Qs])],Bg);class Fg{inject(e,t=document){window.adthriveCLS&&window.adthriveCLS.targetDensityLog&&te.event("BaseDynamicAdsInjector","_logDensityInfo",window.adthriveCLS.targetDensityLog),this._densityDevice="desktop"===this._context.device?me.Desktop:me.Mobile,this._overrideDefaultAdDensitySettingsWithSiteExperiment();const i=this._config.targetDensity.enabled,s=e.filter((e=>i?e.location!==ge.Content:e)),r=e.filter((e=>i?e.location===ge.Content:null));return[...s.length?this._injectNonDensitySlots(s,t):[],...r.length?this._injectDensitySlots(r,t):[]]}_injectNonDensitySlots(e,t=document){const i=[];for(const s of e)this._insertNonDensityAds(s,i,t);return i}_insertNonDensityAds(e,t,i=document){let s=0,r=0,n=0;e.spacing>0&&(s=window.innerHeight*e.spacing,r=s);const a=this._repeatDynamicAds(e),o=Dg(e.elementSelector,i);e.skip;for(let l=e.skip;l<o.length&&!(n+1>a.length);l+=e.every){let d=o[l];if(s>0){const{bottom:e}=It(d);if(e<=r)continue;r=e+s}const c=a[n],h=`${c.location}_${c.sequence}`;if(t.some((e=>e.name===h))){n+=1;continue}const u=this.getDynamicElementId(c),p=Lg(e),g=Mg(e),m=[e.location===ge.Sidebar&&e.sticky&&e.sequence&&e.sequence<=5?"adthrive-sticky-sidebar":"",this._stickyContainerRecipeExperiment.result&&e.location===ge.Recipe&&e.sticky?"adthrive-recipe-sticky-container":"",p,g,...e.classNames],_=xg(d,u,e.position,m,e.location);if(_){const s=this._filterAdUnitSizes(c,_);s.length&&(t.push(Rg(c,_,s,i!==document)),e.location===ge.Recipe&&++this._recipeCount,n+=1),d=_}}}_injectDensitySlots(e,t=document){try{this._calculateMainContentHeightAndAllElements(e,t)}catch(e){return[]}const{onePerViewport:i,targetAll:s,targetDensityUnits:r,combinedMax:n,numberOfUnits:a}=this._getDensitySettings(e,t);return this._absoluteMinimumSpacingByDevice=i?window.innerHeight:this._absoluteMinimumSpacingByDevice,a?(this._adInjectionMap.filterUsed(),this._findElementsForAds(a,i,s,n,r,t),this._insertAds()):[]}_overrideDefaultAdDensitySettingsWithSiteExperiment(){const e=R.resolve(Og);if(!e.enabled)return;const t=e.result;"number"==typeof t&&(this._config.targetDensity.enabled=!0,this._config.targetDensity.settings[this._densityDevice].adDensity=t)}_getDensitySettings(e,t=document){const i=this._config.targetDensity.settings,s=this._determineOverrides(i.pageOverrides),r=s.length?s[0]:i[this._densityDevice],n=this._config.getTargetDensity(r.adDensity),a=r.onePerViewport,o=this._shouldTargetAllEligible(n),l=this._getTargetDensityUnits(n,o),d=this._getCombinedMax(e,t),c=Math.min(this._totalAvailableElements.length,l,...d>0?[d]:[]);return this._pubLog={onePerViewport:a,targetDensity:n,targetDensityUnits:l,combinedMax:d},{onePerViewport:a,targetAll:o,targetDensityUnits:l,combinedMax:d,numberOfUnits:c}}_determineOverrides(e){return e.filter((e=>{const t=ss(e.pageSelector);return""===e.pageSelector||t.elements&&t.elements.length})).map((e=>e[this._densityDevice]))}_shouldTargetAllEligible(e){return e===this._densityMax}_getTargetDensityUnits(e,t){return t?this._totalAvailableElements.length:Math.floor(e*this._mainContentHeight/(1-e)/this._getMinDivHeight())-this._recipeCount}_getMinDivHeight(e=ge.Content){return this._config.clsOptimizedAds.getDivHeight(e,this._context.device)}_getCombinedMax(e,t=document){return bt(e.filter((e=>{let i;try{i=t.querySelector(e.elementSelector)}catch(e){}return i})).map((e=>Number(e.max)+Number(e.lazyMaxDefaulted?0:e.lazyMax))).sort(((e,t)=>t-e))[0],0)}_elementLargerThanMainContent(e){return e.offsetHeight>=this._mainContentHeight&&this._totalAvailableElements.length>1}_elementDisplayNone(e){const t=window.getComputedStyle(e,null).display;return t&&"none"===t||"none"===e.style.display}_isBelowMaxes(e,t){return this._adInjectionMap.map.length<e&&this._adInjectionMap.map.length<t}_findElementsForAds(e,t,i,s,r,n=document){te.event("BaseDynamicAdsInjector","_logDensityInfo",{onePerViewport:t,combinedMax:s,targetDensityUnits:r,targetDensityPercentage:this._pubLog.targetDensity,mainContentHeight:this._mainContentHeight,recipeCount:this._recipeCount,numberOfEls:this._totalAvailableElements.length});const a=e=>{for(const{dynamicAd:t,element:a}of this._totalAvailableElements)if(this._logDensityInfo(a,t.elementSelector,e),!(!i&&this._elementLargerThanMainContent(a)||this._elementDisplayNone(a))){if(!this._isBelowMaxes(s,r))break;this._checkElementSpacing({dynamicAd:t,element:a,insertEvery:e,targetAll:i,target:n})}!this._usedAbsoluteMinimum&&this._smallerIncrementAttempts<5&&(++this._smallerIncrementAttempts,a(this._getSmallerIncrement(e)))},o=this._getInsertEvery(e,t,r);a(o)}_getSmallerIncrement(e){let t=.6*e;return t<=this._absoluteMinimumSpacingByDevice&&(t=this._absoluteMinimumSpacingByDevice,this._usedAbsoluteMinimum=!0),t}_insertAds(){const e=[];return this._adInjectionMap.filterUsed(),this._adInjectionMap.map.forEach((({el:t,dynamicAd:i,target:s},r)=>{const n=Number(i.sequence)+r,a=i.max,o=i.lazy&&n>a;i.sequence=n,i.lazy=o;const l=this._addContentAd(t,i,s);l&&(i.used=!0,e.push(l))})),e}_getInsertEvery(e,t,i){let s=this._absoluteMinimumSpacingByDevice;return this._moreAvailableElementsThanUnitsToInject(i,e)?(this._usedAbsoluteMinimum=!1,s=this._useWiderSpacing(i,e)):(this._usedAbsoluteMinimum=!0,s=this._useSmallestSpacing(t)),t&&window.innerHeight>s?window.innerHeight:s}_useWiderSpacing(e,t){return this._mainContentHeight/Math.min(e,t)}_useSmallestSpacing(e){return e&&window.innerHeight>this._absoluteMinimumSpacingByDevice?window.innerHeight:this._absoluteMinimumSpacingByDevice}_moreAvailableElementsThanUnitsToInject(e,t){return this._totalAvailableElements.length>e||this._totalAvailableElements.length>t}_logDensityInfo(e,t,i){const{onePerViewport:s,targetDensity:r,targetDensityUnits:n,combinedMax:a}=this._pubLog;this._totalAvailableElements.length}_checkElementSpacing({dynamicAd:e,element:t,insertEvery:i,targetAll:s,target:r=document}){(this._isFirstAdInjected()||this._hasProperSpacing(t,e,s,i))&&this._markSpotForContentAd(t,{...e},r)}_isFirstAdInjected(){return!this._adInjectionMap.map.length}_markSpotForContentAd(e,t,i=document){const s="beforebegin"===t.position||"afterbegin"===t.position;this._adInjectionMap.add(e,this._getElementCoords(e,s),t,i),this._adInjectionMap.sort()}_hasProperSpacing(e,t,i,s){const r="beforebegin"===t.position||"afterbegin"===t.position,n="beforeend"===t.position||"afterbegin"===t.position,a=i||this._isElementFarEnoughFromOtherAdElements(e,s,r),o=n||this._isElementNotInRow(e,r),l=-1===e.id.indexOf("AdThrive_Below_Post");return a&&o&&l}_isElementFarEnoughFromOtherAdElements(e,t,i){const s=this._getElementCoords(e,i);let r=!1;for(let e=0;e<this._adInjectionMap.map.length;e++){const i=this._adInjectionMap.map[e].coords,n=this._adInjectionMap.map[e+1]&&this._adInjectionMap.map[e+1].coords;if(r=s-t>i&&(!n||s+t<n),r)break}return r}_isElementNotInRow(e,t){const i=e.previousElementSibling,s=e.nextElementSibling,r=t?!i&&s||i&&e.tagName!==i.tagName?s:i:s;return!(!r||0!==e.getBoundingClientRect().height)||(!r||e.getBoundingClientRect().top!==r.getBoundingClientRect().top)}_calculateMainContentHeightAndAllElements(e,t=document){const[i,s]=li(e,this._adInjectionMap,t);this._mainContentDiv=i,this._totalAvailableElements=s,this._mainContentHeight=ai(this._mainContentDiv)}_getElementCoords(e,t=!1){const i=e.getBoundingClientRect();return(t?i.top:i.bottom)+window.scrollY}_addContentAd(e,t,i=document){let s=null;const r=Lg(t),n=Mg(t),a=this._config.adOptions.stickyContentEnabled&&this._stickyContainerAdsExperiment.result?"adthrive-sticky-container":"",o=xg(e,this.getDynamicElementId(t),t.position,[a,r,n,...t.classNames],t.location);if(o){const e=this._filterAdUnitSizes(t,o);e.length&&(s=Rg(t,o,e,i!==document))}return s}_filterAdUnitSizes(e,t){const i=kt(t),s=e.sticky&&e.location===ge.Sidebar;return e.sizes.filter((t=>{const r=!e.autosize||(t[0]<=i||t[0]<=320),n=!s||t[1]<=window.innerHeight-100;return r&&n}))}_repeatDynamicAds(e){const t=[],i=this._removeRecipeCapExperiment.result&&e.location===ge.Recipe?99:this.locationMaxLazySequence.get(e.location),s=e.lazy?bt(i,0):0,r=e.max,n=e.lazyMax,a=0===s&&e.lazy?r+n:Math.min(Math.max(s-e.sequence+1,0),r+n),o=Math.max(r,a);for(let i=0;i<o;i++){const s=Number(e.sequence)+i;if("Recipe_1"!==e.name||5!==s){const n=e.lazy&&i>=r;t.push({...e,sequence:s,lazy:n})}}return t}constructor(e,t){this._adInjectionMap=e,this._context=t,this._recipeCount=0,this._mainContentHeight=0,this._mainContentDiv=null,this._totalAvailableElements=[],this._densityDevice=me.Desktop,this._pubLog={onePerViewport:!1,targetDensity:0,targetDensityUnits:0,combinedMax:0},this._densityMax=.99,this._smallerIncrementAttempts=0,this._absoluteMinimumSpacingByDevice=250,this._usedAbsoluteMinimum=!1,this.locationMaxLazySequence=new Map([[ge.Recipe,5]]),this._stickyContainerAdsExperiment=R.resolve(Pg),this._stickyContainerRecipeExperiment=R.resolve(Xl),this._removeRecipeCapExperiment=R.resolve(Bg)}}class jg extends Fg{getDynamicElementId(e){return`${this._config.gam.prefix}_${e.location}_${e.sequence}_${this._context.device}`}constructor(e,t,i){super(i,t),this._config=e,this._context=t,this._adInjectionMap=i}}jg=B([hs("DynamicAdsInjector"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===mg?Object:mg])],jg);const Ng=(e=5)=>{Cg(`\n      .adthrive-sticky-container > div {\n        flex-basis: unset;\n        position: sticky !important;\n        display: block;\n        flex-direction: column;\n        top: ${e>5?e:5}px;\n      }\n    `)},Ug=(e=5)=>{Cg(`\n      .adthrive-recipe-sticky-container > div {\n        flex-basis: unset;\n        position: sticky !important;\n        display: block;\n        flex-direction: column;\n        top: ${e>5?e:5}px;\n      }\n    `)},Vg=e=>{if(e&&e.length){let t=0;for(let i=0;i<e.length;i++){const s=ss(e[i]);if(s.valid&&s.elements&&s.elements[0]){t=It(s.elements[0]).height;break}}return t}};class zg extends Cs{hasClsInjectedContent(){if(window.adthriveCLS&&window.adthriveCLS.injectedSlots)for(const e of window.adthriveCLS.injectedSlots)if(e.name.includes(ge.Content))return!0;return!1}start(){const e=this.hasClsInjectedContent(),t=this._config.adOptions,i=t.dynamicStickySidebarHeight,s=Vg(t.dynamicStickySidebarHeaderSelectors);var r,n;Cg(`\n    .adthrive-ad.adthrive-sticky-sidebar {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      justify-content: flex-start;\n      align-items: center;\n      min-height: ${null!=(r=i)?r:1800}px !important;\n      padding-bottom: 0px;\n      margin: 10px 0 10px 0;\n    }\n    .adthrive-ad.adthrive-sticky-sidebar > div {\n      flex-basis: unset;\n      position: sticky !important;\n      top: ${null!=(n=s)?n:5}px;\n    }\n  `);const a=this._config.dynamicAds.filter((e=>wt(this._config,e))).filter((e=>Tt(e,this._context.device))).filter((t=>!e||e&&t.location!==ge.Content)).filter((e=>{return e.location===ge.Interstitial||e.location===ge.Video_StickyOutstream?0===(t=e.pageSelector).length||!t.split(",").some((e=>null!==document.querySelector(e))):At(e);var t})).filter((e=>!this.pluginInjected(e))).filter((e=>e.location!==ge.Video_StickyOutstream||!this.shouldFilterStickyOutstream()));let o=this._injector.inject(a);if(this._config.clsOptions&&this._config.clsOptions.enabled){const e=[];this._config.clsOptions.injectedSlots.forEach((t=>{const i=o.find((e=>e.name===t.name)),s=e.find((e=>e.name===t.name));i||s||e.push(Rg(t.dynamicAd,t.element,t.sizes,t.infinite))})),o=o.concat(e)}this._slotManager.add(o).catch((e=>{te.error("DynamicAdsComponent","start","add",e)}))}get enabled(){return this._config.dynamicAds.length>0}shouldFilterStickyOutstream(){return!!(this._config.video.preventStickyOutstream||this._config.disableAds.video||!this._config.video.stickyOutstreamSettings.allowOnHomepage&&pg())||(this._config.video.hasStickyOutstream=!0,!1)}pluginInjected(e){const t=JSON.stringify(e);return this._config.clsOptions&&this._config.clsOptions.injectedSlots.some((e=>JSON.stringify(e.clsDynamicAd)===t))}constructor(e,t,i,s){super(),this._config=e,this._context=t,this._injector=i,this._slotManager=s}}zg=B([hs("DynamicAdsComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===jg?Object:jg,void 0===id?Object:id])],zg);class $g extends Cs{init(){try{this._gamEventBus.slotOnload.once((()=>this.refreshExternal()))}catch(e){te.error("ExternalSlotsComponent","init",e)}}refreshExternal(){Vl.pushToQueue((()=>{const{account:e}=this._config.gam,t=window.googletag.pubads().getSlots().filter((t=>null===RegExp(`^/?${e}/`).exec(t.getAdUnitPath()))).filter((e=>null!==document.getElementById(e.getSlotElementId())));t.length&&window.googletag.pubads().refresh(t)}))}constructor(e,t){super(),this._config=e,this._gamEventBus=t}}$g=B([hs("ExternalSlotsComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===jl?Object:jl])],$g);class Hg extends Cs{init(){const e=this._context.isFirstPageview?"1":"0",t=[1];this._config.gdpr.enabled?this._gdprEvents.consentCaptured.on((()=>{this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.cafeMediaVendorId,t).then((t=>{t&&this.setFPV(e)})).catch((()=>{}))})):this.setFPV(e),this.handleSPARouteChange()}setFPV(e="0"){+e&&K.setLocalStorageValue("fpv",(new Date).toString()),this._gam.setTargeting({key:"fpv",value:e})}handleSPARouteChange(){this._spaEventBus.routeChanged.on((()=>{this._context.isFirstPageview=!1,this.setFPV("0"),K.setSessionFpv()}))}constructor(e,t,i,s,r,n){super(),this._gam=e,this._gdprEvents=t,this._config=i,this._context=s,this._gdprEnforcement=r,this._spaEventBus=n}}Hg=B([hs("FirstPageviewComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Vl?Object:Vl,void 0===th?Object:th,void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===ih?Object:ih,void 0===Ns?Object:Ns])],Hg);class qg extends sr{init(){this._key="LazyFloorPercentile"}get result(){return this._result}}qg=B([hs("LazyFloorPercentileExperiment"),M()],qg);class Gg extends Cs{init(){this._offEvents.push(this._slotManagerEventBus.requestingBids.on((e=>{const t=this._floors.getDefaultFloorConfig();e.filter((e=>this._enabledAdUnits.includes(e.location)&&e.lazy)).forEach((e=>{const i=this._getPercentile(),s=Bi(this._adUnitCpms,i);s>0&&this._floors.setValues(t,e.id,s),e.setSlotTargetingFlag("fmlli",[`${s}@${i}`],!0),this._floors.prioritizeFloorsConfig(e.id,t,de.lazy)}))}))),this._offEvents.push(this._slotManagerEventBus.requestedBids.on((e=>{e.filter((e=>this._enabledAdUnits.includes(e.location))).forEach((e=>{this._prebidMethods.addToQueue((()=>{this._floors.saveBids(e,this._adUnitCpms)}))}))}))),this._offEvents.push(this._slotEventBus.amazonBidResponseReceived.on((e=>{e.forEach((({slot:e,cpm:t})=>{this._enabledAdUnits.includes(e.location)&&e.lazy&&t>0&&this._prebidMethods.addToQueue((()=>{this._saveAmazonSlotBid(t)}))}))}))),this._spaRouteChangeListenerSet||this._setSpaRouteChangeListener()}_setSpaRouteChangeListener(){this._spaRouteChangeListenerSet=!0,this._spaEventBus.routeChanged.on((()=>{this._offEvents.forEach((e=>{e()})),this._offEvents=[],this.init()}))}_saveAmazonSlotBid(e){this._adUnitCpms.push(e)}_getPercentile(){return this._lazyFloorPercentileExperiment.result||this.defaultPercentile}get defaultPercentile(){return this._percentile}get active(){return this.enabled}get enabled(){return this._floorsExperiment.result.legacy}constructor(e,t,i,s,r,n,a){super(),this._prebidMethods=e,this._floors=t,this._floorsExperiment=i,this._spaEventBus=s,this._slotManagerEventBus=r,this._slotEventBus=n,this._lazyFloorPercentileExperiment=a,this.floorsType=de.lazy,this._percentile=.6,this._enabledAdUnits=[ge.Content,ge.Recipe,ge.Below_Post],this._spaRouteChangeListenerSet=!1,this._offEvents=[()=>{}],this._adUnitCpms=[]}}Gg=B([hs("FloorsLazyComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ss?Object:Ss,void 0===zl?Object:zl,void 0===ya?Object:ya,void 0===Ns?Object:Ns,void 0===Vs?Object:Vs,void 0===Es?Object:Es,void 0===qg?Object:qg])],Gg);class Kg extends Cs{init(){const e=this._config.floors.floorsData;e?this._createFloorsMap(e):this._config.floors.floorsDataReady.once((()=>this._createFloorsMap(e)))}_createFloorsMap(e){if(e&&Object.keys(e).length){var t,i;const s=!this._floorsExperiment.result.fbrap,r=null==e||null==(t=e.modelGroups)?void 0:t[0],n=(null==r||null==(i=r.schema)?void 0:i.fields)||[];this._config.floors.setAdditionalSchemaFields(n),this._floors.setRaptiveFloors(e,s)}else te.error("FloorsRaptiveComponent","init","Raptive floor data not found")}get active(){return this.enabled}get enabled(){return this._floorsExperiment.result.raptive}constructor(e,t,i){super(),this._config=e,this._floors=t,this._floorsExperiment=i,this.floorsType=de.raptive}}Kg=B([hs("FloorsRaptiveComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===zl?Object:zl,void 0===ya?Object:ya])],Kg);class Wg extends sr{init(){this._key="FloorsStickyOutstreamRefresh"}}var Yg;Wg=B([hs("FloorsStickyOutstreamRefreshExperiment"),M()],Wg),function(e){e.banner="banner",e.instream="instream",e.stickyOutstream="stickyOutstream"}(Yg||(Yg={}));class Qg extends Cs{init(){this._slotManagerEventBus.refreshAuctionStart.on((e=>{this._prebidMethods.addToQueue((()=>{this._setRefreshFloors(e.map((e=>({adUnitCode:e.id,refreshCount:e.refreshCount,bidPoolId:e.bidPoolId,setSlotTargetingFlag:(t,i,s)=>{e.setSlotTargetingFlag(t,i,s)}}))))}))})),this._videoRequestManager.refreshingVideoBids.on((e=>{this._prebidMethods.addToQueue((()=>{this._setRefreshFloors(e.map((e=>{var t;return{adUnitCode:null==(t=e.videoAdUnit)?void 0:t.code,refreshCount:e.prerollNum}})))}))}))}_getFloorData(e,t,i,s,r){let n,a,o;if(r)({multiplier:a,weight:o}=this._getRefreshInflateMultiplierWithWeight(this._config.floors.raptiveMLRefreshFloors,s,t,i)),n=e&&e*a;else{const r=s<=5?"low":"high",o=t?"instream":i?"stickyOutstream":"banner";a=this._multipliers.get(o)[r],n=e&&e*a}return{floor:n,multiplier:a,weight:o}}_setRefreshFloors(e){const t=this._floors.getDefaultFloorConfig();for(const i of e){const{adUnitCode:e,bidPoolId:s,refreshCount:r}=i,n=Yi();this._floors.updateBidTTL(e,n,s);const[a]=s?this._prebidMethods.getHighestCpmBidsForPoolId(s):this._prebidMethods.getHighestCpmBids(e),o=this._config.floors.amazonSlotCpm.get(e)||0,l=(null==a?void 0:a.cpm)||0,d=Math.max(l,o),c=this._config.video.instreamAdUnits.has(e),h=e.includes(ge.Video_StickyOutstream),{shouldUseRaptiveMultipliers:u,isRaptiveSkipApplied:p}=this._shouldApplyRaptiveMLRefreshFloors(h),{floor:g,multiplier:m,weight:_}=this._getFloorData(d,c,h,r,u);g&&(this._floors.setValues(t,e,g),this._floors.setOGRefreshValue(e,d),this._setFmlriTargetingFlagSlot(g,i,c,m,_,!u)),this._floors.prioritizeFloorsConfig(e,t,de.refresh)}}_setFmlriTargetingFlagSlot(e,t,i,s,r,n){const{adUnitCode:a,setSlotTargetingFlag:o}=t,l=`${e}@${s}@${null!=r?r:0}${n?"h":""}`;o?o("fmlri",[l],!0):i&&this._floors.setVideoFlagSlot(a,{fmlri:l})}_shouldApplyRaptiveMLRefreshFloors(e=!1){const t=!!e&&!this._stickyOutstreamMLEnabled,i=this._floorsExperiment.result.fbrap&&void 0!==this._raptiveMLSkipRate;var s;const r=Math.random()<=(null!=(s=this._raptiveMLSkipRate)?s:0)/100;return{shouldUseRaptiveMultipliers:i&&!r&&!t,isRaptiveSkipApplied:i&&r}}_getRefreshInflateMultiplierWithWeight(e,t,i,s){const{inflator:r=[],defaultInflatorMultipliers:n,defaultInstreamInflatorMultipliers:a=[],defaultStickyOutstreamMultipliers:o=[],inflatorWeights:l}=e,{index:d,weight:c}=Ta(l);if(-1===d)return{multiplier:1,weight:-1};const h=r.find((e=>t>=e.minRefresh&&t<=e.maxRefresh));let u;var p;if(i)u=null!=(p=null==h?void 0:h.instreamMultipliers)?p:a;else if(s){var g;u=null!=(g=null==h?void 0:h.stickyOutstreamMultipliers)?g:o}else{var m;u=null!=(m=null==h?void 0:h.multipliers)?m:n}return{multiplier:u[d]||1,weight:c}}get active(){return this.enabled}get enabled(){return!0===this._floorsExperiment.result.legacy}constructor(e,t,i,s,r,n,a){var o;super(),this._config=e,this._floors=t,this._prebidMethods=i,this._videoRequestManager=s,this._floorsExperiment=r,this._stickyOutstreamExperiment=n,this._slotManagerEventBus=a,this.floorsType=de.refresh,this._bannerMultiplierLowRefresh=1.3,this._bannerMultiplierHighRefresh=1.1,this._instreamMultiplierLowRefresh=1.1,this._instreamMultiplierHighRefresh=1,this._stickyOutstreamMLEnabled=!1,this._multipliers=new Map([["banner",{low:this._bannerMultiplierLowRefresh,high:this._bannerMultiplierHighRefresh}],["instream",{low:this._instreamMultiplierLowRefresh,high:this._instreamMultiplierHighRefresh}],["stickyOutstream",{low:this._bannerMultiplierLowRefresh,high:this._bannerMultiplierHighRefresh}]]),this._raptiveMLSkipRate=null==(o=this._config.floors.raptiveMLRefreshFloors)?void 0:o.skipRate;const l=this._stickyOutstreamExperiment.result;"number"==typeof l&&l>0?this._multipliers.set("stickyOutstream",{low:l,high:l}):"ml"===l&&(this._stickyOutstreamMLEnabled=!0)}}Qg=B([hs("FloorsRefreshComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===zl?Object:zl,void 0===Ss?Object:Ss,void 0===sd?Object:sd,void 0===ya?Object:ya,void 0===Wg?Object:Wg,void 0===Vs?Object:Vs])],Qg);class Xg extends sr{init(){this._key="SessionFloorDisplayPercentileExperiment"}get result(){return this._result}}Xg=B([hs("SessionFloorDisplayPercentileExperiment"),M()],Xg);class Jg extends sr{init(){this._key="SessionFloorStickyOutstreamPercentileExperiment"}get result(){return this._result}}Jg=B([hs("SessionFloorStickyOutstreamPercentileExperiment"),M()],Jg);class Zg extends sr{init(){this._key="SessionFloorVideoPercentileExperiment"}get result(){return this._result}}Zg=B([hs("SessionFloorVideoPercentileExperiment"),M()],Zg);class em extends Cs{init(){this._sessionNonFPV&&(this._offEvent=this._slotManagerEventBus.requestingBids.on((e=>{e.filter((e=>Object.keys(this._savedBids).includes(e.location))).forEach((e=>{const t=this._floors.getDefaultFloorConfig(),i=this._getPercentile(e.location),s=Bi(this._savedBids[e.location],i);s>0&&this._floors.setValues(t,e.id,s),e.setSlotTargetingFlag("fmlsi",[`${s}@${i}`],!0),this._floors.prioritizeFloorsConfig(e.id,t,de.session)}))})),this._videoRequestManager.requestingVideoBids.on((e=>{e.filter((e=>Object.keys(this._savedBids).includes(e.name))).forEach((e=>{const t=this._floors.getDefaultFloorConfig(),i=this._getPercentile(e.name),s=Bi(this._savedBids[e.name],i)||1e-5;this._floors.setValues(t,e.name,s),this._floors.setVideoFlagSlot(e.name,{fmlsi:[`${s}@${i}`]}),this._floors.prioritizeFloorsConfig(e.name,t,de.session)}))}))),this._savedBidsRan||this.saveBids()}saveBids(){this._savedBidsRan=!0,this._spaEventBus.routeChanged.on((()=>{this._offEvent(),this.init()})),this._slotManagerEventBus.requestedBids.on((e=>{e.filter((e=>Object.keys(this._savedBids).includes(e.location))).forEach((e=>{this._prebidMethods.addToQueue((()=>{this.saveSlotBids(e)}))})),K.setLocalStorageValue("bc",ji(this._savedBids,this._rdx))})),this._slotEventBus.amazonBidResponseReceived.on((e=>{e.forEach((({slot:e,cpm:t})=>{Object.keys(this._savedBids).includes(e.location)&&t>0&&this._prebidMethods.addToQueue((()=>{this._saveAmazonSlotBid(e,t)}))})),K.setLocalStorageValue("bc",ji(this._savedBids,this._rdx))})),this._videoRequestManager.requestingVideoBids.on((e=>{e.filter((e=>Object.keys(this._savedBids).includes(e.name))).forEach((e=>{this._prebidMethods.addToQueue((()=>{this.saveVideoSlotBids(e)}))})),K.setLocalStorageValue("bc",ji(this._savedBids,this._rdx))})),this._videoRequestManager.amazonVideoBidResponseReceived.on((e=>{e.forEach((({video:e,cpm:t})=>{Object.keys(this._savedBids).includes(e.name)&&t>0&&this._prebidMethods.addToQueue((()=>{this._saveAmazonVideoSlotBid(e,t)}))})),K.setLocalStorageValue("bc",ji(this._savedBids,this._rdx))}))}saveSlotBids(e){this._prebidMethods.getBidResponsesForAdUnitCode(e.id).bids.forEach((t=>{zi(this._savedBids[e.location],1e3),this._savedBids[e.location].push(t.cpm)}))}_saveAmazonSlotBid(e,t){zi(this._savedBids[e.location],1e3),this._savedBids[e.location].push(t)}saveVideoSlotBids(e){this._prebidMethods.getBidResponsesForAdUnitCode(e.name).bids.forEach((t=>{zi(this._savedBids[e.name],1e3),this._savedBids[e.name].push(t.cpm)}))}_saveAmazonVideoSlotBid(e,t){zi(this._savedBids[e.name],1e3),this._savedBids[e.name].push(t)}_getPercentile(e){let t;return t=e.includes(ge.Video_StickyOutstream)?this._stickyOutstreamSessionPercentileExperiment.result:e.includes("Video")?this._videoSessionPercentileExperiment.result:this._displaySessionPercentileExperiment.result,t||this.defaultPercentile}get defaultPercentile(){return this._percentile}get active(){return this.enabled&&this._sessionNonFPV}get enabled(){return!0===this._floorsExperiment.result.legacy}constructor(e,t,i,s,r,n,a,o,l,d){super(),this._videoRequestManager=e,this._floors=t,this._prebidMethods=i,this._floorsExperiment=s,this._spaEventBus=r,this._slotManagerEventBus=n,this._slotEventBus=a,this._displaySessionPercentileExperiment=o,this._stickyOutstreamSessionPercentileExperiment=l,this._videoSessionPercentileExperiment=d,this.floorsType=de.session,this._percentile=.6,this._rdx=33,this._defaultSavedBids={Content:[],Recipe:[],Header:[],Below_Post:[],Sidebar:[],Footer:[],"Video_In-Post_ClicktoPlay_SoundOn":[],Video_Collapse_Autoplay_SoundOff:[],Video_Individual_Autoplay_SOff:[],Video_Coll_SOff_Smartphone:[],Video_StickyOutstream_1:[],Video_StickyOutstream:[]},this._savedBidsRan=!1,this._offEvent=()=>{},this._sessionNonFPV=!1===K.getLocalStorageValue("session_fpv");const c=K.getLocalStorageValue("bc");this._savedBids={...this._defaultSavedBids,...c&&Fi(c,this._rdx)}}}em=B([hs("FloorsSessionComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===sd?Object:sd,void 0===zl?Object:zl,void 0===Ss?Object:Ss,void 0===ya?Object:ya,void 0===Ns?Object:Ns,void 0===Vs?Object:Vs,void 0===Es?Object:Es,void 0===Xg?Object:Xg,void 0===Jg?Object:Jg,void 0===Zg?Object:Zg])],em);class tm extends sr{init(){this._key="LazyFloorMultiplier"}get result(){return this._result}}tm=B([hs("LazyFloorMultiplierExperiment"),M()],tm);class im extends Cs{init(){this._slotManagerEventBus.requestingBids.on((e=>{this._prebidMethods.addToQueue((()=>{this._setLazyBidPoolFloors(e.filter((e=>this._enabledAdUnits.includes(e.location)&&!e.refreshCount&&e.lazy&&e.bidPoolId)).map((e=>({adUnitCode:e.id,refreshCount:e.refreshCount,bidPoolId:e.bidPoolId}))))}))}))}_getLazyMultiplier(){const e=this._lazyFloorMultiplierExperiment.result;return"number"!=typeof e?1:e}_setLazyBidPoolFloors(e){const t=this._floors.getDefaultFloorConfig(),i=this._getLazyMultiplier();for(const s of e){const{adUnitCode:e,bidPoolId:r}=s,n=Yi();this._floors.updateBidTTL(e,n,r);const[a]=r?this._prebidMethods.getHighestCpmBidsForPoolId(r):this._prebidMethods.getHighestCpmBids(e),o=(null==a?void 0:a.cpm)*i;o&&this._floors.setValues(t,e,o),this._floors.prioritizeFloorsConfig(e,t,de.lazyBidPool)}}get active(){return this.enabled}get enabled(){return!0===this._floorsExperiment.result.legacy}constructor(e,t,i,s,r,n){super(),this._slotManager=e,this._floors=t,this._prebidMethods=i,this._floorsExperiment=s,this._slotManagerEventBus=r,this._lazyFloorMultiplierExperiment=n,this.floorsType=de.lazyBidPool,this._enabledAdUnits=[ge.Content,ge.Recipe,ge.Below_Post]}}im=B([hs("FloorsLazyBidPoolComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===id?Object:id,void 0===zl?Object:zl,void 0===Ss?Object:Ss,void 0===ya?Object:ya,void 0===Vs?Object:Vs,void 0===tm?Object:tm])],im);class sm extends Cs{init(){this._floorsComponents.forEach((e=>{e.active&&this._floorsConfig.addActiveFloorsType(e.floorsType),void 0!==e.init&&e.init()}))}constructor(e,t,i,s,r,n){super(),this._floorsConfig=n,this._floorsComponents=[e,t,i,s,r].filter((e=>e.enabled))}}sm=B([L(),j("design:type",Function),j("design:paramtypes",[void 0===im?Object:im,void 0===Gg?Object:Gg,void 0===Kg?Object:Kg,void 0===Qg?Object:Qg,void 0===em?Object:em,void 0===ba?Object:ba])],sm);class rm extends Cs{start(){if(this._config.footer.elements.length){this._footer=document.createElement("div"),this._footer.classList.add(...this._footerClassNames),this._config.footer.elements.sort(((e,t)=>e.order-t.order)).forEach((({element:e})=>{e instanceof Element?this._footer.insertAdjacentElement("beforeend",e):this._footer.insertAdjacentHTML("beforeend",e)}));const e=""===this._config.adOptions.footerSelector?".adthrive-mobile #page-wrapper":this._config.adOptions.footerSelector;(document.querySelector(e)||document.body).insertAdjacentElement("beforeend",this._footer),this._setupListeners()}}_setupListeners(){this._spaEventBus.routeChanged.once((()=>{document.querySelector(`.${this._footerClassNames.join(".")}`)||this.start()}))}_added(){this._footerConfigEventBus.footerElementAdded.on((e=>{this._config.footer.elements.push(e)}),{handleEventsAlreadyEmitted:!0})}constructor(e,t,i){super(),this._config=e,this._spaEventBus=t,this._footerConfigEventBus=i,this._footerClassNames=["adthrive-comscore","adthrive-footer-message"],this._footer={},this._added()}}rm=B([hs("FooterComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Ns?Object:Ns,void 0===Ds?Object:Ds])],rm);class nm extends Cs{init(){this._slotEventBus.triggerRenderOutsideGam.on(this._onTriggerRenderOutsideGam.bind(this)),this._googleAdManagerEventBus.slotRenderEnded.on(this._slotRenderedHandler.bind(this)),this._prebidEventBus.bidWon.on(this._bidWonEventHandler.bind(this))}_slotRenderedHandler({event:e,slot:t}){const i=[ge.Native_Recipe,ge.Interstitial],s=this._isGAMDisabled(t);!e.isEmpty&&!s||i.includes(t.location)||this._onTriggerRenderOutsideGam(t)}_bidWonEventHandler(e){const t=this._getSlot(e);t&&this._isGAMDisabled(t)&&this._handleGptLibFailedToLoad(e,t)}_handleGptLibFailedToLoad(e,t){this._slotEventBus.adRenderedOutsideGAM.emit({bidResponse:e,slot:t})}_getSlot(e){return this._slotManager.getSlot(e.sharedBidInUse||e.adUnitCode)}_isGAMDisabled(e){var t;return!(null==e||null==(t=e.googleTagSlot)?void 0:t.getResponseInformation())}_onTriggerRenderOutsideGam(e){(e.bidPoolId||e.passiveBidPoolId)&&this.clearSharedBidPool(e),this._config.gdpr.enabled||(te.event("GoogleAdManagerFallbackComponent","init","slotIsEmpty","adding prebid render to queue"),this.renderSlotOutsideGAM(e))}clearSharedBidPool(e){this._prebidMethods.clearTargetingForSharedBidPool(e.id)}_createGoogleAdManagerFallbackDiv(e){e.iframe=this._createGoogleAdManagerFallbackIframe();const t=document.createElement("div");t.className="google-ad-manager-fallback-container",t.style.margin="auto",e.location===ge.Video_StickyOutstream&&(t.style.height="0",e.iframe.style.width="0",e.iframe.style.height="0"),t.appendChild(e.iframe),this._clearSlotDiv(e),e.element.children.length<2&&e.element.appendChild(t),this._slotEventBus.googleAdManagerFallbackDivAdded.emit(e)}_createEmptyFallbackDiv(e){var t;const i=document.createElement("div");i.className="google-ad-manager-fallback-container",i.style.margin="auto",i.style.height="0",this._clearSlotDiv(e),(null==(t=e.element)?void 0:t.children.length)<2&&e.element.appendChild(i),this._slotEventBus.googleAdManagerFallbackDivAdded.emit(e)}_clearSlotDiv(e){var t;const i=null==(t=e.element)?void 0:t.firstElementChild;"google-ad-manager-fallback-container"===(null==i?void 0:i.className)&&e.element.removeChild(i)}_createGoogleAdManagerFallbackIframe(){const e=document.createElement("iframe");return e.style.border="0",e.style.display="inline!important",e.scrolling="no",e.frameBorder="0",e.marginHeight="0",e.marginWidth="0",e.style.height="1",e.style.width="1",e}_setTopPrebidBid(e){var t,i,s,r;const n=e.bidPoolId,a=e.passiveBidPoolId,o=n?(null==(i=this._prebidMethods.getBidResponsesForBidPoolId(n))||null==(t=i.bids.filter((e=>"rendered"!==e.status&&"native"!==e.mediaType&&!e.sharedBidInUse)).sort(((e,t)=>t.cpm-e.cpm)))?void 0:t[0])||(null==(s=this._prebidMethods.getHighestCpmBidsForPoolId(n))?void 0:s[0]):null==(r=this._prebidMethods.getHighestCpmBids(e.id))?void 0:r[0];return o&&(n||a)&&(o.sharedBidInUse=e.id),o}renderSlotOutsideGAM(e){const t=this._getTopBid(e);if(!t)return this._createEmptyFallbackDiv(e),void this._slotEventBus.gamEmptyNoBidResponse.emit(e);this._createGoogleAdManagerFallbackDiv(e),this._removePreviousSiblingDiv(e),this._setDisplayProperty(e),this._emitEventAndRenderAd(e,t)}_getAmazonBidData(e){const t=this._config.amazon._availableBids.get(e.id);if(!t)return;return t.pmpCpm&&t.cpm<t.pmpCpm?{amznbid:t.pmpAmznBid,amzniid:t.pmpAmazoniid,bidder:t.pmpBidder,cpm:t.pmpCpm,deal:t.pmpDeal,mediaType:t.pmpMediaType,size:t.pmpSize,slotID:t.slotID}:{amznbid:t.amznbid,amzniid:t.amzniid,bidder:t.bidder,cpm:t.cpm,mediaType:t.mediaType,size:t.size,slotID:t.slotID}}_getTopBid(e){const t=this._setTopPrebidBid(e),i=this._getAmazonBidData(e);if(t||i)return!t||i&&i.cpm>t.cpm?i:t}_removePreviousSiblingDiv(e){const t=e.iframe&&e.iframe.parentElement;if(t){const e=t.previousSibling;null==e||e.remove()}}_setDisplayProperty(e){const t=document.getElementById(e.element.id);null==t||t.style.setProperty("display","block")}_emitEventAndRenderAd(e,t){var i,s;const r=null==(s=e.iframe)||null==(i=s.contentWindow)?void 0:i.document,n=Ie(t);if(r){if(this._slotEventBus.adRenderingOutsideGAM.emit({bidResponse:t,slot:e}),e.location===ge.Video_StickyOutstream&&n)return;n?this._amazonMethods.renderImp(r,t.amzniid):this._prebidMethods.renderAd(r,t.adId)}}constructor(e,t,i,s,r,n,a,o){super(),this._config=e,this._context=t,this._googleAdManagerEventBus=i,this._prebidMethods=s,this._prebidEventBus=r,this._slotManager=n,this._slotEventBus=a,this._amazonMethods=o}}nm=B([hs("GoogleAdManagerFallbackComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===jl?Object:jl,void 0===Ss?Object:Ss,void 0===Ms?Object:Ms,void 0===id?Object:id,void 0===Es?Object:Es,void 0===Yl?Object:Yl])],nm);const am={"000000":"A","000001":"B","000010":"C","000011":"D","000100":"E","000101":"F","000110":"G","000111":"H","001000":"I","001001":"J","001010":"K","001011":"L","001100":"M","001101":"N","001110":"O","001111":"P","010000":"Q","010001":"R","010010":"S","010011":"T","010100":"U","010101":"V","010110":"W","010111":"X","011000":"Y","011001":"Z","011010":"a","011011":"b","011100":"c","011101":"d","011110":"e","011111":"f",1e5:"g",100001:"h",100010:"i",100011:"j",100100:"k",100101:"l",100110:"m",100111:"n",101e3:"o",101001:"p",101010:"q",101011:"r",101100:"s",101101:"t",101110:"u",101111:"v",11e4:"w",110001:"x",110010:"y",110011:"z",110100:"0",110101:"1",110110:"2",110111:"3",111e3:"4",111001:"5",111010:"6",111011:"7",111100:"8",111101:"9",111110:"-",111111:"_"};class om extends Cs{init(){window.__gpp=this._gpp.bind(this),this._addLocatorFrame(),this._enableEvents(),this._refreshPrivacyStrings(),this._setPrebidGPPString(),this._spaEventBus.routeChanged.on((()=>{this._setPrebidGPPString()}))}_refreshPrivacyStrings(){this._pingData.gppString=this._createGPPString(),this._pingData.parsedSections&&this._pingData.parsedSections.uspv1&&(this._pingData.parsedSections.uspv1=this._callUSPAPI("getUSPData").uspString)}_triggerEventCallbacks(e){const t=window.__gpp.events;if(t&&t.length){this._refreshPrivacyStrings();const i=this._pingData;t.forEach((t=>{const s={eventName:e,listenerId:t.id,data:this._getEventData(e),pingData:i};t.callback(s)}))}}_getEventData(e){return"sectionChange"===e?this._supportedAPIs:"signalStatus"===e?"ready":void 0}_enableEvents(){this._triggerEventCallbacks("signalStatus"),this._config.ccpa.consentChange.on((()=>{this._triggerEventCallbacks("sectionChange"),this._setPrebidGPPString(),this._triggerEventCallbacks("signalStatus")}))}_setPrebidGPPString(){const e=this._createGPPString();this._ortb2.addOrtb2Reg(e,this._sectionList)}_addEventListener(e,t){window.__gpp.events=window.__gpp.events||[],"lastId"in window.__gpp||(window.__gpp.lastId=0),window.__gpp.lastId++;const i=window.__gpp.lastId;window.__gpp.events.push({id:i,callback:e,parameter:t}),e({eventName:"listenerRegistered",listenerId:i,data:!0,pingData:this._pingData},!0)}_removeEventListener(e,t){let i=!1;const s=t;window.__gpp.events=window.__gpp.events||[];for(let e=0;e<window.__gpp.events.length;e++)if(window.__gpp.events[e].id==s){window.__gpp.events.splice(e,1),i=!0;break}e({eventName:"listenerRemoved",listenerId:s,data:i},!0)}_createUSNatString(){let e=this._usnatFieldOrder.reduce(((e,t)=>`${e}${this._getUSNatData(t,!0)}`),"");if(e.length<66){const t=66-e.length;for(let i=0;i<t;i++)e=`${e}0`}return(e.match(/.{6}/g)||[]).map((e=>am[e]||"A")).join("")}_padStart(e,t){return e.padStart?e.padStart(t,"0"):`${e}${Array(t).join("0")}`}_encodedUSNat(e,t){const i=this._usnatFields.get(e)&&this._usnatFields.get(e).fieldValLength||0,s=(+t>>>0).toString(2);return this._padStart(s,i)}_getUSNatData(e,t=!1){const i=this._usnatFields.get(e);if(!i)return"";if(void 0!==i.unencodedVal)return t?this._encodedUSNat(e,i.unencodedVal):i.unencodedVal;const s=this._config.ccpa.privacyString===this.ccpaOptOut?i.optOut:i.optIn;return t?this._encodedUSNat(e,s||"0"):s}_getUSNatObj(){return this._usnatFieldOrder.map((e=>{const t=this._getUSNatData(e);return{[e]:t}})).reduce(((e,t)=>({...e,...t})),{})}_getGPPData(){return{sectionId:3,gppVersion:1.1,sectionList:this._sectionList,applicableSections:this._sectionList,gppString:this._createGPPString(),pingData:this._pingData}}_hasSection(e){return!!this._sections[e]}_getSection(e){return this._sections[e]?this._sections[e]:null}_callUSPAPI(e){return this._ccpaComponent.uspapi(e,1,((e,t)=>{if(t)return e}))}_getField(e){const t=e.split("."),i=t[0],s=t[1];return this._hasSection(i)?"uspv1"===i?this._callUSPAPI(s):"usnat"===i?this._getUSNatData(s):void 0:null}_addLocatorFrame(){if(null===document.getElementById("__gppLocator")){const e=document.createElement("iframe");e.style.display="none",e.id="__gppLocator",e.name="__gppLocator",document.body.appendChild(e),window.__gpp_msghandler=e=>{const t="string"==typeof e.data;let i;try{i=t?JSON.parse(e.data):e.data}catch(e){i=null}if("object"==typeof i&&null!==i&&"__gppCall"in i){const s=i.__gppCall;window.__gpp(s.command,((i,r)=>{const n={__gppReturn:{returnValue:i,success:r,callId:s.callId}};e.source.postMessage(t?JSON.stringify(n):n,"*")}),s.parameter)}}}"__gpp"in window&&"function"==typeof window.__gpp||(window.__gpp=window.__gpp_stub,window.addEventListener("message",window.__gpp_msghandler,!1),window.__gpp_addFrame("__gppLocator"))}_createGPPString(){return`DBABzw~${this._callUSPAPI("getUSPData").uspString}~${this._createUSNatString()}`}_gpp(e,t,i){const s="function"==typeof t;switch(e){case"ping":return this._refreshPrivacyStrings(),s?t(this._pingData,!0):this._pingData;case"addEventListener":return s?this._addEventListener(t,i):null;case"removeEventListener":return s?this._removeEventListener(t,i):null;case"hasSection":if(i){const e=this._hasSection(i);return s?t(e,!0):e}case"getSection":if(i){const e=this._getSection(i);return s?t(e,!0):e}case"getField":if(i){const e=this._getField(i);return s?t(e,!0):e}case"getGPPData":return s?t(this._getGPPData()):this._getGPPData()}}get enabled(){return"US"===this._context.country}constructor(e,t,i,s,r){super(),this._config=e,this._context=t,this._ccpaComponent=i,this._ortb2=s,this._spaEventBus=r,this.ccpaRequired=this._config.ccpa.required,this.ccpaNotApplicable=this._config.ccpa.ccpaNotApplicable,this.ccpaOptIn=this._config.ccpa.ccpaOptIn,this.ccpaOptOut=this._config.ccpa.ccpaOptOut,this.gpcEnabled=this._config.gpc.gpcEnabled,this.gpcUpdated=!1,this.globalPrivacyControl=window.navigator.globalPrivacyControl,this._sectionList=[6,7],this._supportedAPIs=["6:uspv1","7:usnat"],this._usnatFieldOrder=Object.values(he),this._usnatFields=new Map([[he.Version,{unencodedVal:1,fieldValLength:6}],[he.SharingNotice,{unencodedVal:1,fieldValLength:2}],[he.SaleOptOutNotice,{unencodedVal:1,fieldValLength:2}],[he.SharingOptOutNotice,{unencodedVal:1,fieldValLength:2}],[he.TargetedAdvertisingOptOutNotice,{unencodedVal:1,fieldValLength:2}],[he.SensitiveDataProcessingOptOutNotice,{unencodedVal:0,fieldValLength:2}],[he.SensitiveDataLimitUseNotice,{unencodedVal:0,fieldValLength:2}],[he.SaleOptOut,{fieldValLength:2,optIn:ue.OptedIn,optOut:ue.OptedOut}],[he.SharingOptOut,{fieldValLength:2,optIn:ue.OptedIn,optOut:ue.OptedOut}],[he.TargetedAdvertisingOptOut,{fieldValLength:2,optIn:ue.OptedIn,optOut:ue.OptedOut}],[he.SensitiveDataProcessing,{unencodedVal:[0,0,0,0,0,0,0,0,0,0,0,0],fieldValLength:24}],[he.KnownChildSensitiveDataConsents,{unencodedVal:[0,0],fieldValLength:4}],[he.PersonalDataConsents,{unencodedVal:0,fieldValLength:2}],[he.MspaCoveredTransaction,{unencodedVal:2,fieldValLength:2}],[he.MspaOptOutOptionMode,{unencodedVal:0,fieldValLength:2}],[he.MspaServiceProviderMode,{unencodedVal:0,fieldValLength:2}],[he.SubSectionType,{unencodedVal:0,fieldValLength:2}],[he.Gpc,{unencodedVal:!!navigator.globalPrivacyControl,fieldValLength:1}]]),this._pingData={gppVersion:"1.1",cmpStatus:"loaded",cmpDisplayStatus:"visible",cmpId:3,supportedAPIs:this._supportedAPIs,signalStatus:"ready",sectionList:this._sectionList,applicableSections:this._sectionList,gppString:this._createGPPString(),parsedSections:{uspv1:this._config.ccpa.privacyString||null,usnat:this._getUSNatObj()}},this._sections={tcfeuv1:null,tcfeuv2:null,"":null,"--":null,tcfca:null,uspv1:this._config.ccpa.privacyString||null,usnat:this._getUSNatObj(),usca:null,usva:null,usco:null,usut:null,usct:null}}}om=B([hs("GPPComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===wg?Object:wg,void 0===Zc?Object:Zc,void 0===Ns?Object:Ns])],om);class lm extends Cs{init(){let e=!1;this._slots.bidServed.on((t=>{t.servedPrebidBidResponse&&"gumgum"===t.servedPrebidBidResponse.bidder&&t.location===ge.Footer&&(e=!0)})),this._slotManagerEventBus.refreshing.on((t=>{t.filter((e=>e.location===ge.Footer))&&e&&(e=!1,window.GUMGUM.removeISAd())}))}constructor(e,t){super(),this._slots=e,this._slotManagerEventBus=t}}lm=B([hs("GumGumInScreenComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===zr?Object:zr,void 0===Vs?Object:Vs])],lm);class dm extends Cs{init(){this._config.identityApi.optIn.on((({data:e,cb:t})=>this.identityOptIn(e,t).catch((()=>{})))),window.addEventListener("message",(e=>{if(window===window.top&&e&&e.origin===window.origin&&e.data&&"adthriveIdentityAPI"===e.data.message&&e.data.info){const t={message:"adthriveIdentityFinished",response:{}};this.identityOptIn(e.data.info,(i=>{var s;e.source instanceof MessagePort||e.source instanceof ServiceWorker||(t.response=i,null==(s=e.source)||s.postMessage(t,e.origin))})).catch((()=>{}))}}),!1)}start(){this._config.identityApi.apiReady.emit()}validateData(e){if(!e.source||"string"!=typeof e.source||e.source.length>20)throw Error("source required with 20 characters or less");if(!e.plainText&&!e.sha256&&!e.sha1)throw Error("plainText, sha256 or sha1 required");if(e.plainText&&("string"!=typeof e.plainText||!xt(e.plainText)))throw Error(`plainText not string or not valid email: ${e.plainText}`);if(e.sha256&&("string"!=typeof e.sha256||64!==e.sha256.length))throw Error(`sha256 not string or not encoded properly: ${e.sha256}`);if(e.sha1&&("string"!=typeof e.sha1||40!==e.sha1.length))throw Error(`sha256 not string or not encoded properly: ${e.sha1}`)}categorizeSource(e){var t;const i=e.source;"slickstream"===e.source||(null==(t=e.source)?void 0:t.startsWith(pi.PREFIXES.SLICKSTREAM))||(te.event("IdentityAPI","optIn",`source:${i}`),e.source="api")}buildPII(e){let t=e.source;t||(t="api_unknown",te.error("IdentityAPI","buildPII","source not provided with: ",e)),this._emailCaptureHandler.checkSources(t);const i={source:`${t}${pi.SUFFIXES.CAPTURE}`,sourceCollectedDate:ei()};return e.plainText&&(i.email=e.plainText),e.sha256&&(i.sha256Hash=e.sha256),e.sha1&&(i.sha1Hash=e.sha1),i}async identityOptIn(e,t){try{if(!this._config.identityApi.enabled)throw Error("Identity API not enabled");if(this._hasRun)throw Error("Identity API Already Successfully Called");if(this._config.ccpa.userOptedOut)throw Error("User has opted out of CCPA");if(this._config.gdpr.enabled){if(!await this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.cafeMediaVendorId,[1]))throw Error("CafeMedia not given Purpose 1 consent to process identity data.")}this.validateData(e),this.categorizeSource(e);const i=this.buildPII(e);this._emailCaptureHandler.emailCaptured.emit({pii:i,identityDataSource:"identityApi"}),t({success:!0,data:{message:"OK"}}),this._hasRun=!0}catch(e){t({success:!1,data:{message:e.message}})}}constructor(e,t,i){super(),this._emailCaptureHandler=e,this._config=t,this._gdprEnforcement=i,this._hasRun=!1}}dm=B([hs("IdentityAPIComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Hn?Object:Hn,void 0===Ol?Object:Ol,void 0===ih?Object:ih])],dm);class cm extends nr{init(){this._key="JumpToTracker",this._default=!1}}var hm;cm=B([M()],cm),function(e){e.Recipe="Recipe",e.Video="Video"}(hm||(hm={}));class um{init(){this._addElementListeners()}_processButtonClicked(e){if(!this._hasFired){const t=e.target.classList;this._logEvent(t)}this._cleanup()}_logEvent(e){te.event("JumpToTracker","_logEvent",this.trackerType.toLowerCase(),e)}_cleanup(){for(const e of this._elements)e.removeEventListener("click",this._buttonClicked)}_addElementListeners(){this.setElements()}setElements(){this._elements=Array.prototype.slice.call(document.querySelectorAll(this.selectors.join()));for(const e of this._elements)e.addEventListener("click",this._buttonClicked)}constructor(){this._elements=[],this._hasFired=!1,this._buttonClicked=this._processButtonClicked.bind(this)}}class pm extends um{constructor(){super(),this.trackerType=hm.Recipe,this.selectors=[".wprm-recipe-jump","#jump-to-recipe","#wprm-jump",".wprm-jump",".tasty-recipes-jump-link",".mv-create-jtr",".jump-to-recipe"],this.init()}}pm=B([L(),j("design:type",Function),j("design:paramtypes",[])],pm);class gm extends um{constructor(){super(),this.trackerType=hm.Video,this.selectors=[".wprm-recipe-jump-video"],this.init()}}gm=B([L(),j("design:type",Function),j("design:paramtypes",[])],gm);class mm extends Cs{start(){R.resolve(pm),R.resolve(gm)}get enabled(){return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut&&this._jumpToTrackerExperiment.result}constructor(e,t,i){super(),this._gpcConfig=e,this._ccpaConfig=t,this._jumpToTrackerExperiment=i}}mm=B([L(),hs("JumpToTrackerComponent"),j("design:type",Function),j("design:paramtypes",[void 0===an?Object:an,void 0===nn?Object:nn,void 0===cm?Object:cm])],mm);class _m extends Cs{init(){this._gamEventBus.slotRenderEnded.on((e=>this._bannerSlotRenderEnded(e))),this._videoEventProxy.videoSlotRendered.on(this._videoSlotRenderEnded.bind(this)),this._slotEventBus.adRenderedOutsideGAM.on(this._onRenderedOutsideGAM.bind(this)),this._slotEventBus.adRenderingOutsideGAM.on(this._onRenderingOutsideGAM.bind(this))}get enabled(){return!0}_onRenderedOutsideGAM(e){this._onBidWonEvent(e.bidResponse,e.slot)}_onBidWonEvent(e,t){const i=this._createEventData(e,t);te.event("ImpressionLogComponent","bidWon",i)}_onRenderingOutsideGAM(e){Ie(e.bidResponse)&&this._onBidWonEvent(e.bidResponse,e.slot)}_getDecodedURI(e){try{return decodeURIComponent(e)}catch(e){return""}}_getTargetingData(e){const t=Rt(e.split("?")[1]);return{custParams:this._getDecodedURI(t.get("cust_params")||""),iu:t.get("iu")||"",sz:this._sizeStringToArray(t.get("sz"))||[1,1]}}_sizeStringToArray(e){if(e)return e.split("x").map((e=>parseInt(e)))}_bannerSlotRenderEnded({event:e,slot:t}){const i=e.slot.getAdUnitPath(),s=fs();this._renderedSlotKey.set(i,s);const r={adUnitPath:i,advertiserId:e.advertiserId,agnosticCreativeId:e.sourceAgnosticCreativeId,agnosticLineItemId:e.sourceAgnosticLineItemId,campaignId:e.campaignId,companyIds:e.companyIds,creativeId:e.creativeId,isEmpty:e.isEmpty,lineItemId:e.lineItemId,serviceName:e.serviceName,siteTargeting:this._filterTargeting(this._gam.getTargetingMap()),size:e.size,slotElementId:t.id,slotKey:s,slotTargeting:this._filterTargeting(t.getTargetingMap()),yieldGroupIds:e.yieldGroupIds,transactionId:t.transactionId};this._logImpressionEvent(r)}_videoSlotRenderEnded(e){const t=this._getTargetingData(e.tag),i={adUnitPath:t.iu,creativeId:e.gamCreativeId,isEmpty:e.isEmpty,lineItemId:e.gamLineItemId,size:t.sz,slotElementId:e.adUnitName,slotKey:fs(),slotTargeting:this._filterTargeting(Dt(t.custParams))};this._logImpressionEvent(i)}_filterTargeting(e){return Object.keys(e).filter((t=>!this._filterKeys.has(t)&&e[t].length)).reduce(((t,i)=>(t[i]=e[i],t)),{})}_logImpressionEvent(e){te.event("SlotRenderEnded","adImpression",e)}_getPrebidData(e,t){const{adUnitCode:i,adserverTargeting:{hb_pb:s},bidder:r,adId:n,auctionId:a,width:o,height:l,cpm:d,meta:c,requestTimestamp:h,responseTimestamp:u,timeToRespond:p,expired:g,dealId:m,size:_,source:f,mediaType:v,ttl:y,originalCpm:b}=e;return{adUnitPath:i,adomain:(null==c?void 0:c.advertiserDomains)||[],hb_pb:s,bidder:r,adId:n,auctionId:a,width:o,height:l,cpm:d,requestTimestamp:h,responseTimestamp:u,timeToRespond:p,expired:g,dealId:m,size:_,source:f,mediaType:v,ttl:y,originalCpm:b,isEmpty:!0,...t&&{location:t.location,sequence:t.sequence,nref:t.refreshCount,...t.googleTagSlot&&{slotTargeting:this._filterTargeting(t.getTargetingMap())}}}}_getAmazonData(e,t){const{amzniid:i,bidder:s,deal:r,cpm:n,mediaType:a,size:o}=e,[l,d]=(o||"").split("x");return{amzniid:i,bidder:s,cpm:n,...r&&{deal:r},height:d,isEmpty:!0,mediaType:"default"===a?"banner":a,size:o,width:l,...t&&{adUnitPath:t.id,location:t.location,sequence:t.sequence,nref:t.refreshCount,...t.googleTagSlot&&{slotTargeting:this._filterTargeting(t.getTargetingMap())}}}}_createEventData(e,t){return Ie(e)?this._getAmazonData(e,t):this._getPrebidData(e,t)}constructor(e,t,i,s,r){super(),this._config=e,this._gam=t,this._videoEventProxy=i,this._gamEventBus=s,this._slotEventBus=r,this._renderedSlotKey=new Map,this._filterKeys=new Set(["abgroup","pvk","bucket","branch","deployment","siteName","siteId","site_code","mcmp","sense"])}}_m=B([hs("ImpressionLogComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Vl?Object:Vl,void 0===tu?Object:tu,void 0===jl?Object:jl,void 0===Es?Object:Es])],_m);class fm extends sr{init(){this._key="FooterCloseButtonLocation"}isEnabled(){const e=!(R.resolve(Cr).isRolloutEnabled("mobile-footer-close-button-css-conflict")&&Wt());return super.isEnabled()&&e}}fm=B([hs("FooterCloseButtonExperiment"),M()],fm);class vm extends Cs{init(){this._gamEventBus.slotRenderEnded.on((({slot:e,event:t})=>{this.slotRenderEnded(e,t)}))}slotRenderEnded(e,t){var i;t.isEmpty||2!==(null==(i=t.size)?void 0:i.length)||(e.element&&this._locations.includes(e.location)&&e.sticky&&(e.element.setAttribute("closable","true"),this._addCloseButton(e)),this._slotEventBus.adRenderedOutsideGAM.on((e=>{this._addCloseButton(e.slot)})))}_addCloseButton(e){const{element:t,location:i,refreshCount:s}=e;if(e.element&&this._locations.includes(e.location)&&e.sticky&&t.hasAttribute("closable")){const e=t.querySelector(".adthrive-close")||this._createButton(t,i,s);this._changeCloseButtonLocation(t,e),t.appendChild(e)}}_createButton(e,t,i){const s=document.createElement("span");return s.innerHTML="&times;",s.className="adthrive-close",s.addEventListener("click",(()=>{const s=document.createEvent("Event");t===ge.Footer&&kr.setSessionStorage("adthrive_footer_closed","true"),s.initEvent(`adthrive${location}Close`,!0,!0);const r=e.parentElement;r&&(window.dispatchEvent(s),r.removeChild(e),te.event("CloseButtonComponent","logCloseFooter","User clicked footer close button",{nref:i}),this._slotManager.destroy(e.id))})),s}_changeCloseButtonLocation(e,t){const i=this._footerCloseLocationExperiment.result;if(i&&i.includes("topLeft")&&(t.style.right="initial",t.style.left=Bt()?"10px":"5px","topLeftAboveAd"===i)){var s;const i=(null==(s=e.firstChild)?void 0:s.firstChild).getBoundingClientRect();t.style.left=(i.left-26).toString()+"px",t.style.top="5px"}}get enabled(){return this._config.adOptions.footerCloseButtonMigrated?"phone"===this._context.device?this._config.adOptions.footerCloseButtonMobile:this._config.adOptions.footerCloseButtonDesktop:this._config.adOptions.footerCloseButton}constructor(e,t,i,s,r,n){super(),this._config=e,this._context=t,this._slotManager=i,this._footerCloseLocationExperiment=s,this._gamEventBus=r,this._slotEventBus=n,this._locations=[ge.Footer]}}vm=B([hs("CloseButtonComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===id?Object:id,void 0===fm?Object:fm,void 0===jl?Object:jl,void 0===Es?Object:Es])],vm);class ym extends nr{init(){this._key="EnhancedStickySidebarAds",this._default=!1}}ym=B([hs("EnhancedStickySidebarAdsExperiment"),M()],ym);class bm extends Cs{createDefaultButton(e){const t=document.createElement("div");return t.innerHTML="<span>&times;</span>",t.className="adthrive-wrapper-close",t.style.display="none",t.id="adthrive-collapse-close",t.onclick=e,t}createPlayerCloseButton(e,t,i,s=!1,r=!1){this._hasTitleBar=s,this._isTopCollapse=r,this._isInstreamExperiment="instream"===t||r,this._isButtonOutsideContainerTop="instream"===t,this._isButtonInsideContainer="sticky outstream"===t&&!r;const n=this._config.isStickyOutstreamTopCenterColorsDisabled&&"sticky outstream"===t;if(n){const e=document.createElement("style");e.textContent="#adthrive-sticky-outstream-close > svg > * { stroke: white; }",document.head.appendChild(e)}const a=this._getButtonClasses(),o=this._getSvgOptions(!this._isTopCollapse||"instream"!==t&&n?null:this._config.adOptions.secColor),l=this._createCloseButton(a,i,o);return l.onclick=e,l.onkeydown=e=>{"Space"===e.code&&e.preventDefault()},l.onkeyup=t=>{["Space","Enter"].includes(t.code)&&e()},this._isButtonInsideContainer?this.applyCloseButtonWrapper(l):l}_getButtonClasses(){let e=[];return this._isButtonOutsideContainerTop&&e.push("adthrive-wrapper-float-close"),this._isInstreamExperiment&&(e=[...e,...this._getInstreamClasses()]),e}_getInstreamClasses(){const e=["adthrive-instream-close"];return this._isTopCollapse?e.push("adthrive-top-collapse-close"):this._isButtonOutsideContainerTop&&e.push("adthrive-top-left-outer","adthrive-float-left"),e}_getSvgOptions(e){let t="white",i="black";return(this._isButtonInsideContainer||this._isTopCollapse)&&(t="transparent",i="white"),e&&(i=e),{fillColor:t,strokeColor:i}}_buildNewCloseButton(e,t){e.appendChild(this._createCloseButtonX(t)),e.appendChild(this._createCloseButtonCircleThatGoesAroundTheX(t))}_createCloseButton(e,t,i){const{fillColor:s,strokeColor:r}=null!=i?i:{fillColor:"white",strokeColor:"black"},n=this._createButtonHtml(e,t),a=this._createSvg(s);if(this._isTopCollapse)this._buildNewCloseButton(a,r);else{const e=this._createPath(r);a.appendChild(e)}return n.appendChild(a),n}_createButtonHtml(e,t){const i=document.createElement("div");return i.tabIndex=0,i.className=e.join(" "),i.id=t,i}_createSvg(e){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttribute("width","18"),t.setAttribute("height","18"),t.setAttribute("text-anchor","middle"),t.setAttribute("dominant-baseline","central"),t.setAttribute("fill",e),t.setAttribute("text-anchor","middle"),t.setAttribute("dominant-baseline","central"),t}_createPath(e){const t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d","M 0.5 9 A 5 5 0 0 0 17.5 9 A 5 5 0 0 0 0.5 9 M 9 9 L 7 7 L 11 11 M 9 9 L 7 11 L 11 7"),t.setAttribute("stroke",e),t.setAttribute("stroke-width","1"),t}_createCloseButtonCircleThatGoesAroundTheX(e){const t=document.createElementNS("http://www.w3.org/2000/svg","circle");return t.setAttribute("cx","9"),t.setAttribute("cy","9"),t.setAttribute("r","8"),t.setAttribute("stroke",e),t.setAttribute("stroke-width","2"),t.setAttribute("fill","none"),t}_createCloseButtonX(e){const t=document.createElementNS("http://www.w3.org/2000/svg","text");return t.setAttribute("x","9"),t.setAttribute("y","9"),t.setAttribute("text-anchor","middle"),t.setAttribute("stroke",e),t.setAttribute("fill",e),t.setAttribute("stroke-width","1px"),t.setAttribute("font-size","13px"),t.setAttribute("alignment-baseline","middle"),t.textContent="x",t}applyCloseButtonWrapper(e){const t=document.createElement("div"),i=["adthrive-wrapper-float-close","adthrive-wrapper-close-bkgd-50"];return this._hasTitleBar?i.push("adthrive-top-left-inner-wrapper"):i.push("adthrive-top-left-inner"),t.classList.add(...i),t.appendChild(e),t}constructor(e){super(),this._config=e,this._hasTitleBar=!1,this._isButtonInsideContainer=!1,this._isButtonOutsideContainerTop=!1,this._isInstreamExperiment=!1,this._isTopCollapse=!1}}bm=B([hs("VideoCloseButtonComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],bm);class Sm{_setupEventListeners(e,t){this._onScrollEvent=()=>{this._element&&!e.closed?this._check(t):this._removeEventListeners()},this._onThrottledScrollEvent=kl((()=>this._update()),500),this._onThrottledResizeEvent=kl((()=>{this._element&&!e.closed?(this._unstick(),this._update(),this._check(t)):this._removeEventListeners()}),500),window.addEventListener("scroll",this._onThrottledScrollEvent),window.addEventListener("resize",this._onThrottledResizeEvent),window.addEventListener("scroll",this._onScrollEvent)}_removeEventListeners(){window.removeEventListener("scroll",this._onScrollEvent),window.removeEventListener("scroll",this._onThrottledScrollEvent),window.removeEventListener("resize",this._onThrottledResizeEvent),this._onThrottledScrollEvent&&this._onThrottledScrollEvent.cancel&&this._onThrottledScrollEvent.cancel(),this._onThrottledResizeEvent&&this._onThrottledResizeEvent.cancel&&this._onThrottledResizeEvent.cancel(),this._element=null,this._overlap=null,this._closed=!0}_update(){this._element&&(this._stuck||(this._start=this._getTop(this._element)),this._overlap&&(this._cutoff=this._getTop(this._overlap)))}_updateStickyOutstreamPosition(e){if(window.pageYOffset+window.innerHeight-this._stickyOutstreamStyleBottom>=e){const t=window.innerHeight+window.pageYOffset-e+"px";this._element.style.bottom=t,this._element.parentElement.style.bottom=t}else{const e=vt();this._element.parentElement.style.bottom=`${e}px`}}_check(e){if(!this._closed){if(0!==this._start){const t=window.pageYOffset,i=this._element.offsetHeight+this._cutoffBuffer,s=0!==this._cutoff&&t+i>this._cutoff;this._start<t&&!s?this._stick(e):e||this._unstick()}if(e&&this._overlap){const e=this._getTop(this._overlap);this._updateStickyOutstreamPosition(e)}}}_stick(e){if(!this._stuck){const t=getComputedStyle(this._element,null),i=this._element.parentElement;if(i){const t=getComputedStyle(i,null);i.style.minHeight=t.getPropertyValue("height"),e&&i.classList.add(this._stickyClass)}this._element.style.width||(this._element.style.width=t.getPropertyValue("width")),e||this._element.classList.add(this._stickyClass),this._stuck=!0}}_unstick(){this._stuck&&(this._element.classList.remove(this._stickyClass),this._stuck=!1)}_getTop(e){return e.getBoundingClientRect().top+window.pageYOffset}_findOverlap(e){let t=null;for(;e.parentElement;){let i=(e=e.parentElement).nextElementSibling;for(;i&&Di(i);)i=i.nextElementSibling;i&&i.offsetTop>0&&(!t||i.offsetTop<t.offsetTop)&&(t=i)}return t}constructor(e,t,i){this._overlap=null,this._stuck=!1,this._start=0,this._cutoff=0,this._cutoffBuffer=20,this._stickyClass="adthrive-stuck",this._stickyOutstreamStyleBottom=51,this._onScrollEvent=()=>{},this._onThrottledScrollEvent=()=>{},this._onThrottledResizeEvent=()=>{},this._closed=!1;const s=e.location===ge.Video_StickyOutstream;this._element=e.element;const r=s?i.video.footerSelector:"";t&&(e.stickyOverlapSelector?this._overlap=document.querySelector(e.stickyOverlapSelector):r.length?this._overlap=document.querySelector(r):this._overlap=this._findOverlap(this._element),this._overlap,s&&this._stick(s)),this._setupEventListeners(e,s)}}class Em{applyTransitionToElement(e){this._mobileRaptivePlayerEnabled||this._desktopRaptivePlayerEnabled||(e.style.transition="all 0.2s ease-in-out")}pushElementBelowHeader(e,t){null!==t&&e.style.setProperty("top",`${t}px`)}anchorVideoPlayerBelowNavbar(e,t){const{playerContainer:i,topBackgroundElement:s}=e,r=()=>{const e=this.getHeaderHeight(t);if(null!==e){this.applyTransitionToElement(s),this.applyTransitionToElement(i),this.pushElementBelowHeader(s,e),this.pushElementBelowHeader(i,e);const t=i.querySelector(".adthrive-top-collapse-wrapper-bar");t&&this.pushElementBelowHeader(t,e)}},n=()=>{s.style.top="0",i.style.top="0"};this._isHeaderVisible?r():n(),this._pushVideoPlayerDown=r,this._pushVideoPlayerUp=n}getHeaderHeight(e){const t=this.getSiteHeader(e);if(!t)return null;return this.getElementHeight(t)}getElementHeight(e){return e.getBoundingClientRect().height}getSiteHeader(e){if(this._header)return this._header;const t=document.querySelector(e);return t?(this._header=t,this._header):null}constructor(e,t){this._raptiveMobilePlayerExperiment=e,this._raptiveDesktopPlayerExperiment=t,this._pushVideoPlayerDown=()=>{},this._pushVideoPlayerUp=()=>{},this._header=null,this._isHeaderVisible=!0,this._desktopRaptivePlayerEnabled=!1,this._mobileRaptivePlayerEnabled=!1,this._isMobile=Wt(),this._open=!1,this.handleUncollapse=(e,t)=>{const{playerContainer:i,topBackgroundElement:s}=e;if(i.style.removeProperty("top"),s.style.removeProperty("top"),t){this.collapsiblePersistentHeaderObserver.disconnect();const e=this.getSiteHeader(t);e&&(e.onclick=null)}},this.handleCollapse=e=>{if(e.mobileHeaderSelector){this.anchorVideoPlayerBelowNavbar(e,e.mobileHeaderSelector);const t=this.getSiteHeader(e.mobileHeaderSelector);t&&(this.collapsiblePersistentHeaderObserver.observe(t),t.onclick=()=>{this._open=!this._open,this._open?(e.programmaticPause(),e.playerContainer.style.display="none"):(e.programmaticPlay(),e.playerContainer.style.display="block")})}},this.collapsiblePersistentHeaderObserver=new IntersectionObserver((e=>{for(const t of e)this._isHeaderVisible=t.isIntersecting,this._isHeaderVisible?this._pushVideoPlayerDown():this._pushVideoPlayerUp()}),{threshold:.95});const i=R.resolve(bo).result;this._desktopRaptivePlayerEnabled=i||!this._isMobile&&this._raptiveDesktopPlayerExperiment.result,this._mobileRaptivePlayerEnabled=i||this._isMobile&&this._raptiveMobilePlayerExperiment.result}}Em=B([M(),hs("TopCenterVideoPlayerForPersistentHeaderUtils"),j("design:type",Function),j("design:paramtypes",[void 0===vo?Object:vo,void 0===_o?Object:_o])],Em);let Cm,Tm=ml.getScrollTop();class wm{static changeState(e,t){const i=this._handleOtherVideoPlaying(t,e);if(!(e.playerState&&(e.playerState===Se.UserPauseCollapsed||i||e.playerState===Se.UserPauseUncollapsed)&&t===Ee.UserClick)){const i=this._shouldCollapse(e);switch(e.playerState){case Se.Unstarted:this._handleUnstarted(t,e);break;case Se.UncollapsedPlay:this._handleUncollapsedPlay(t,i,e);break;case Se.CollapsedPlay:this._handleCollapsedPlay(t,i,e);break;case Se.UserPauseUncollapsed:this._handleUserPauseUncollapsed(t,i,e);break;case Se.UserPauseCollapsed:this._handleUserPauseCollapsed(t,i,e);break;case Se.PausedNotVisible:this._handlePausedNotVisible(t,e);break;case Se.Overlapped:this._handleOverlapped(t,i,e);break;default:return e.playerState}}return e.playerState}static _handleUnstarted(e,t){this.offsetheight||(this.offsetheight=t.playerContainer.offsetHeight),e===Ee.InView&&(t.programmaticPlay(),t.collapseTimer.firstInView||(t.collapseTimer.firstInView=new Date),wm.startEvent.emit(),t.playerState=Se.UncollapsedPlay)}static _setPlayerClosed(e){e.playerState=Se.Closed,this._isTopCollapse(e)&&R.resolve(zs).topCenterVideoClosed.emit()}static _handleOtherVideoPlaying(e,t){const{programmaticPause:i}=t;return e===Ee.OtherVideoPlaying&&(this.uncollapse(t),i(),this._setPlayerClosed(t),!0)}static _handleUncollapsedPlay(e,t,i){const{programmaticPause:s,programmaticPlay:r}=i;e===Ee.InView?t&&(this.collapse(i),i.playerState=Se.CollapsedPlay):e===Ee.OutOfView?t?(r(),this.collapse(i),i.playerState=Se.CollapsedPlay):i.playerState!==Se.UserPauseUncollapsed&&(s(),i.playerState=Se.PausedNotVisible):e===Ee.UserClick&&(i.playerState=Se.UserPauseUncollapsed)}static _handleCollapsedPlay(e,t,i){const{programmaticPause:s,playerContainer:r}=i;e===Ee.InView?t||(this.uncollapse(i),i.playerState=Se.UncollapsedPlay):e===Ee.OutOfView?t||(this.uncollapse(i),s(),i.playerState=Se.PausedNotVisible):e===Ee.UserClick?i.playerState=Se.UserPauseCollapsed:e===Ee.Overlapping?(i.lastCollapsedClasses=r.className,this.uncollapse(i),s(),i.playerState=Se.Overlapped):e===Ee.Close&&(this.uncollapse(i),s(),this._setPlayerClosed(i))}static _handleUserPauseCollapsed(e,t,i){const{programmaticPause:s}=i;e!==Ee.InView||t?e===Ee.UserClick?i.playerState=Se.CollapsedPlay:e===Ee.Close&&(this.uncollapse(i),s(),this._setPlayerClosed(i)):(this.uncollapse(i),i.playerState=Se.UserPauseUncollapsed)}static _handleUserPauseUncollapsed(e,t,i){const{programmaticPlay:s}=i;e===Ee.InView&&t?t?(this.collapse(i),i.playerState=Se.UserPauseCollapsed):s():e===Ee.UserClick&&(i.playerState=Se.UncollapsedPlay)}static _handlePausedNotVisible(e,t){const{programmaticPlay:i}=t;e===Ee.InView&&(i(),t.playerState=Se.UncollapsedPlay)}static _handleOverlapped(e,t,i){const{programmaticPlay:s}=i;t&&!this.playerWouldOverlapFooter(i)&&(this.collapse(i),s(),i.playerState=Se.CollapsedPlay)}static handleResize(e){this._isCollapsed(e.playerState)&&(e.collapseType===ve.Mobile&&"adthrive-collapse-top-center"===e.collapseMobileSubType&&e.topBackgroundElement&&(e.topBackgroundElement.style.height=`${e.playerContainer.offsetHeight}px`,e.topBackgroundElement.style.width=`${window.innerWidth}px`),e.forceMobile||e.collapseType!==ve.Sticky||this._stickToSidebar(e))}static handleScroll(e){const{playerState:t,playerContainer:i,playbackStarted:s,mobileCollapseOnScrollUp:r}=e,n=ml.getScrollTop(),a=n>Tm;Tm=n;const o=this._shouldCollapseOnScrollUp(e),l=!(ml.playerViewable(i)||o&&s),d=this._isWarmupComplete(e);let c;if(c=l?Ee.OutOfView:this.playerWouldOverlapFooter(e)?Ee.Overlapping:Ee.InView,"off"!==r){const s=Pt(i)&&t===Se.PausedNotVisible&&!d;this._isTopOfPage()?(c=Ee.OutOfView,this.stopCollapseWarmupTimer(e)):a&&s?(this.startCollapseWarmupTimer(e),c=Ee.OutOfView,"1"===r&&(clearTimeout(Cm),Cm=setTimeout((()=>{this._isWarmupComplete(e)&&(this.stopCollapseWarmupTimer(e),e.playerState=Se.UncollapsedPlay,this.changeState(e,c))}),1e3))):d&&this.stopCollapseWarmupTimer(e)}this.changeState(e,c),e.playerState===Se.CollapsedPlay||e.playerState===Se.UserPauseCollapsed?wm.startCollapseTimer(e):wm.stopCollapseTimer(e)}static handleOtherVideoPlaying(e){this.changeState(e,Ee.OtherVideoPlaying)}static handlePageVisibilityChange(e,t){if(t.playerState!==Se.Closed&&t.playerState!==Se.Unstarted&&t.playerState!==Se.UserPauseUncollapsed&&t.playerState!==Se.UserPauseCollapsed&&t.playerState!==Se.PausedNotVisible&&t.playerState!==Se.Overlapped){const{programmaticPause:i,programmaticPlay:s}=t;e?i():s()}}static handleWidthBreak(e,t){t.playerState!==Se.Closed&&t.playerState!==Se.Unstarted&&(e.matches?(this._isCollapsed(t.playerState)&&(this.toggleCollapsedPlayerClasses(!1,t),t.collapseType===ve.Sticky&&this._unstickFromSidebar(t.playerContainer),t.forceMobile=!0,this.toggleCollapsedPlayerClasses(!0,t)),t.forceMobile=!0):(this.toggleCollapsedPlayerClasses(!1,t),t.forceMobile=!1,this._isCollapsed(t.playerState)&&(this.toggleCollapsedPlayerClasses(!0,t),t.collapseType===ve.Sticky&&this._stickToSidebar(t))))}static handleClose(e,t=0){wm.closeEvent.emit(),this.changeState(e,Ee.Close),wm.stopCollapseTimer(e),te.event("RaptivePlayer","handleClose",{timeElapsed:e.collapseTimer.timeCollapsed,device:Bt()?"desktop":"mobile",playerType:e.playerType,vp:t})}static handleUserClick(e){this.changeState(e,Ee.UserClick)}static collapse(e){const{playerContainer:t,topBackgroundElement:i,programmaticPause:s,programmaticPlay:r}=e;if(this.disableCollapse)return;e.playerCollapsed=!0,this.toggleCollapsedPlayerClasses(!0,e),e.hasPreviouslyCollapsed=!0,this.collapseEvent.emit(),e.forceMobile||e.collapseType!==ve.Sticky||this._stickToSidebar(e),i&&R.resolve(Em).handleCollapse({topBackgroundElement:i,mobileHeaderSelector:e.mobileHeaderSelector,playerContainer:t,programmaticPause:s,programmaticPlay:r}),setTimeout((e=>{this.displayCloseButton(e)}),0,e);const n=R.resolve(zs);n.topCenterVideoCollapsed.emit(e),n.videoCollapsed.emit(e)}static displayCloseButton(e){this._isCollapsed(e.playerState)&&(e.closeButton.style.display="inline-flex")}static uncollapse(e){const{playerContainer:t,topBackgroundElement:i,mobileHeaderSelector:s}=e,r=R.resolve(zs);this.toggleCollapsedPlayerClasses(!1,e),this._unstickFromSidebar(t),e.playerCollapsed=!1,wm.uncollapseEvent.emit(),e.closeButton.style.display="none",i&&(R.resolve(Em).handleUncollapse({playerContainer:t,topBackgroundElement:i},s),r.topCenterVideoUnCollapsed.emit()),r.videoUnCollapsed.emit()}static _shouldCollapse(e){const{playbackStarted:t,playerPosition:i,mobileCollapseOnScrollUp:s}=e;if(!t)return!1;const r=this._shouldCollapseOnScrollUp(e);if(ml.isMobileLandscape())return!1;const n=this._isTopCollapse(e);if("off"!==s&&n){const t=!!e.collapseTimer.warmupStartTime,i=this._isWarmupComplete(e);if(this._isTopOfPage()||t&&!i)return!1}const a=ml.getScrollTop(),o=ml.getScrollBottom(),l=It(i),d=this.offsetheight,c=l.top,h=c+d;return n?a>=c||r&&o<=h:a>=c+d/2||r&&o<=h-d/2}static _shouldCollapseOnScrollUp(e){const{desktopCollapseOnScrollUp:t,hasPreviouslyCollapsed:i,mobileCollapseOnScrollUp:s}=e;return i&&(t||"off"!==s)}static _isCollapsed(e){return e===Se.CollapsedPlay||e===Se.UserPauseCollapsed}static _isWarmupComplete(e){const{collapseTimer:t,mobileCollapseOnScrollUp:i,playerContainer:s}=e;return!!t.warmupStartTime&&("1"===i?Date.now()-t.warmupStartTime.getTime()>1e3:"2"===i?Ot(s):void 0)}static _isTopOfPage(){return window.scrollY<1}static _isTopCollapse(e){return e.collapseMobileSubType&&"adthrive-collapse-top-center"===e.collapseMobileSubType}static _stickToSidebar(e){e.stickyElement&&(e.playerContainer.style.left=`${e.stickyElement.getBoundingClientRect().left}px`,e.playerContainer.style.width=`${e.stickyElement.clientWidth}px`),e.playerContainer.style.top=`${e.topMargin}px`}static _unstickFromSidebar(e){e.style.bottom=""}static playerWouldOverlapFooter(e){if(!e.footerElement)return!1;if(e.playerContainer.className.includes("adthrive-collapse-bottom")||e.lastCollapsedClasses&&e.lastCollapsedClasses.includes("adthrive-collapse-bottom")){const t=vt();return!(window.innerHeight-t<e.footerElement.getBoundingClientRect().top)}return!((e.topMargin||0)+e.playerContainer.getBoundingClientRect().height<e.footerElement.getBoundingClientRect().top)}static _castArray(e){return Array.isArray(e)?e:[e]}static toggleClass(e,t,i){(t=this._castArray(t)).forEach((t=>{i?(e.playerContainer.classList.add(t),e.adContainer.classList.add(t)):(e.playerContainer.classList.remove(t),e.adContainer.classList.remove(t))}))}static toggleCollapsedPlayerClasses(e,t){this.toggleClass(t,"raptive-player-collapse",e),t.forceMobile?(this.toggleClass(t,ve.Mobile,e),this.toggleClass(t,t.collapseMobileSizeType,e),this.toggleClass(t,t.collapseMobileSubType,e),this.repositionCollapseMobile(t,e),this.classesToggled.emit()):(this.toggleClass(t,t.collapseType,e),t.collapseSubType&&this.toggleClass(t,t.collapseSubType,e),t.collapseMobileSizeType&&this.toggleClass(t,t.collapseMobileSizeType,e),t.collapseType===ve.Mobile&&(this.toggleClass(t,t.collapseMobileSubType,e),this.repositionCollapseMobile(t,e)),this.classesToggled.emit())}static repositionCollapseMobile(e,t){"adthrive-collapse-bottom-left"===e.collapseMobileSubType||"adthrive-collapse-bottom-right"===e.collapseMobileSubType?this.repositionCollapseMobileBottom(e):"adthrive-collapse-top-center"===e.collapseMobileSubType&&this.repositionCollapseMobileTop(e,t)}static repositionCollapseMobileTop(e,t){e.topBackgroundElement&&(t?e.topBackgroundElement.style.height=`${e.playerContainer.offsetHeight}px`:(e.topBackgroundElement.style.height="0",e.topBackgroundElement.classList.remove("extra-height")))}static repositionCollapseMobileBottom(e){if(e.playerContainer.className.includes("adthrive-collapse-bottom")||e.collapseMobileSubType&&e.collapseMobileSubType.indexOf("bottom")>-1){const t=vt();e.playerContainer.style.setProperty("top","auto","important"),e.playerContainer.style.setProperty("bottom",`${t}px`,"important")}}static startCollapseTimer(e){e.collapseTimer.isRunning||(e.collapseTimer.startTime?e.collapseTimer.lastCollapsedTime=new Date:(e.collapseTimer.startTime=new Date,e.collapseTimer.lastCollapsedTime=e.collapseTimer.startTime),e.collapseTimer.isRunning=!0)}static stopCollapseTimer(e){e.collapseTimer.isRunning&&(e.collapseTimer.lastCollapsedTime&&(e.collapseTimer.timeCollapsed+=Yi()-e.collapseTimer.lastCollapsedTime.getTime()),e.collapseTimer.isRunning=!1)}static startCollapseWarmupTimer(e){e.collapseTimer.warmupStartTime||(e.collapseTimer.warmupStartTime=new Date)}static stopCollapseWarmupTimer(e){e.collapseTimer.warmupStartTime&&(e.collapseTimer.warmupStartTime=void 0)}}wm.collapseEvent=new Q,wm.uncollapseEvent=new Q,wm.classesToggled=new Q,wm.closeEvent=new Q,wm.startEvent=new Q,wm.disableCollapse=!1,wm.offsetheight=0,wm=B([hs("CollapseUtils")],wm);class Am{applyTransitionToElement(e){e.style.transition="all 0.2s ease-in-out"}pushElementBelowHeader(e,t){const i=this.getHeaderHeight(t);null!==i&&(e.style.top=`${i}px`)}anchorVideoPlayerBelowNavbar(e,t){const{playerElement:i,topBackgroundElement:s}=e,r=i.querySelector(".adthrive-top-collapse-wrapper-bar"),n=()=>{null!==this.getHeaderHeight(t)&&(this.applyTransitionToElement(s),this.applyTransitionToElement(i),this.pushElementBelowHeader(s,t),this.pushElementBelowHeader(i,t),r&&this.pushElementBelowHeader(r,t))},a=()=>{s.style.top="0",i.style.top="0",r&&(r.style.top="0")};this._isHeaderVisible?n():a(),this._headerVisibleEvents.push(n),this._headerHiddenEvents.push(a)}getHeaderHeight(e){const t=this.siteHeader(e);if(!t)return null;return this.getElementHeight(t)}getElementHeight(e){return e.getBoundingClientRect().height}siteHeader(e){if(this._header)return this._header;const t=document.querySelector(e);return t?(this._header=t,this.collapsiblePersistentHeaderObserver.observe(this._header),this._header):null}constructor(){this._headerVisibleEvents=[],this._headerHiddenEvents=[],this._header=null,this._isHeaderVisible=!0,this._open=!1,this.handleUncollapse=()=>{},this.handleCollapse=e=>{if(e.mobileHeaderSelector){this.anchorVideoPlayerBelowNavbar(e,e.mobileHeaderSelector);const t=this.siteHeader(e.mobileHeaderSelector);t&&(t.onclick=()=>{this._open=!this._open,this._open?(e.programmaticPause(),e.playerContainer&&(e.playerContainer.style.display="none")):(e.programmaticPlay(),e.playerContainer&&(e.playerContainer.style.display="block"))})}},this.collapsiblePersistentHeaderObserver=new IntersectionObserver((e=>{for(const t of e)this._isHeaderVisible=t.isIntersecting,this._isHeaderVisible?this._headerVisibleEvents.forEach((e=>e())):this._headerHiddenEvents.forEach((e=>e()))}),{threshold:.95})}}Am=B([M(),hs("TopCenterVideoPlayerForPersistentHeaderLegacyUtils"),j("design:type",Function),j("design:paramtypes",[])],Am);let km,Im=ml.getScrollTop();class Pm{static changeState(e,t){const i=this._shouldCollapse(e);if(!this._handleOtherVideoPlaying(t,e))switch(e.playerState){case Se.Unstarted:this._handleUnstarted(t,i,e);break;case Se.UncollapsedPlay:this._handleUncollapsedPlay(t,i,e);break;case Se.CollapsedPlay:this._handleCollapsedPlay(t,i,e);break;case Se.NonLinearAdPlay:this._handleNonLinearAdPlay(t,i,e);break;case Se.UserPauseCollapsed:this._handleUserPauseCollapsed(t,i,e);break;case Se.UserPauseUncollapsed:this._handleUserPauseUncollapsed(t,i,e);break;case Se.PausedNotVisible:this._handlePausedNotVisible(t,e);break;case Se.NonLinearAdPaused:this._handleNonLinearAdPaused(t,e);break;case Se.Overlapped:this._handleOverlapped(t,i,e);break;case Se.NonLinearAdOverlapped:this._handleNonLinearAdOverlapped(t,i,e);break;default:return e.playerState}return e.playerState}static _handleUnstarted(e,t,i){this.offsetheight||(this.offsetheight=i.playerContainer.offsetHeight);const s=i.playerInstance;e===Ee.InView&&(i.collapseTimer.firstInView||(i.collapseTimer.firstInView=new Date),Pm.startEvent.emit(),t?(this.collapse(i),s.getViewable()&&s.play(!0),i.playerState=s._nonLinearAd?Se.NonLinearAdPlay:Se.CollapsedPlay):i.playerState=s._nonLinearAd?Se.NonLinearAdPlay:Se.UncollapsedPlay)}static _setPlayerClosed(e){e.playerState=Se.Closed,this._isTopCollapse(e)&&R.resolve(zs).topCenterVideoClosed.emit()}static _handleOtherVideoPlaying(e,t){return e===Ee.OtherVideoPlaying&&(this.uncollapse(t),t.playerInstance.pause(!0),this._setPlayerClosed(t),!0)}static _setCollapsedPlay(e,t){Pm.collapse(e),e.playerState=Se.CollapsedPlay,this._isPlayingOrAboutToPlay(t,e)||t.play(!0)}static _isPlayingOrAboutToPlay(e,t){if(!t.isMobile)return!1;const i=null==e?void 0:e.getState(),s="playing"===i||"buffering"===i,r=!(!(null==t?void 0:t.getIsRunningAdPlay)||!t.getIsRunningAdPlay());return s||r}static _handleUncollapsedPlay(e,t,i){const{playerInstance:s}=i;e===Ee.InView?t?this._setCollapsedPlay(i,s):this._isPlayingOrAboutToPlay(s,i)||s.play(!0):e===Ee.OutOfView?t?this._setCollapsedPlay(i,s):(s.pause(!0),i.playerState=Se.PausedNotVisible):e===Ee.UserClick&&(i.playerState=Se.UserPauseUncollapsed)}static _handleVideoHeight(e){const{playerElement:t,topBackgroundElement:i}=e;i&&t.offsetHeight>=i.offsetHeight&&(i.style.height="101px")}static _handleCollapsedPlay(e,t,i){const{playerInstance:s,playerElement:r}=i;e===Ee.InView?(t||(this.uncollapse(i),i.playerState=Se.UncollapsedPlay),!this._isPlayingOrAboutToPlay(s,i)&&s.play(!0)):e===Ee.OutOfView?t||(this.uncollapse(i),s.pause(!0),i.playerState=Se.PausedNotVisible):e===Ee.UserClick?i.playerState=Se.UserPauseCollapsed:e===Ee.Overlapping?(i.lastCollapsedClasses=r.className,this.uncollapse(i),s.pause(!0),i.playerState=Se.Overlapped):e===Ee.Close&&(this.uncollapse(i),s.pause(!0),this._setPlayerClosed(i))}static _handleNonLinearAdPlay(e,t,i){const{playerInstance:s}=i;e===Ee.InView?t&&this.collapse(i):e===Ee.OutOfView?(s.pauseAd(!0),i.playerState=Se.NonLinearAdPaused):e===Ee.Overlapping&&(this.uncollapse(i),s.pauseAd(!0),i.playerState=Se.NonLinearAdOverlapped)}static _handleUserPauseCollapsed(e,t,i){const{playerInstance:s}=i;e!==Ee.InView||t?e===Ee.UserClick?i.playerState=Se.CollapsedPlay:e===Ee.Close&&(this.uncollapse(i),s.pause(!0),this._setPlayerClosed(i)):(this.uncollapse(i),i.playerState=Se.UserPauseUncollapsed)}static _handleUserPauseUncollapsed(e,t,i){e===Ee.InView&&t?(this.collapse(i),i.playerState=Se.UserPauseCollapsed):e===Ee.UserClick&&(i.playerState=Se.UncollapsedPlay)}static _handlePausedNotVisible(e,t){const{playerInstance:i}=t;e===Ee.InView&&(i.play(!0),t.playerState=Se.UncollapsedPlay)}static _handleNonLinearAdPaused(e,t){const{playerInstance:i}=t;e===Ee.InView?(i.pauseAd(!1),t.playerState=Se.NonLinearAdPlay):this.playerWouldOverlapFooter(t)&&(t.playerState=Se.NonLinearAdOverlapped)}static _handleOverlapped(e,t,i){const{playerInstance:s}=i;t&&!this.playerWouldOverlapFooter(i)?(this.collapse(i),s.play(!0),i.playerState=Se.CollapsedPlay):i.playerState=Se.Overlapped}static _handleNonLinearAdOverlapped(e,t,i){const{playerInstance:s}=i;t&&!this.playerWouldOverlapFooter(i)?(this.collapse(i),s.pauseAd(!1),i.playerState=Se.NonLinearAdPlay):(s.pauseAd(!0),i.playerState=Se.NonLinearAdOverlapped)}static handleResize(e){this.isCollapsed(e.playerState)?(e.collapseType===ve.Mobile&&"adthrive-collapse-top-center"===e.collapseMobileSubType&&e.topBackgroundElement&&(e.topBackgroundElement.style.height=`${e.playerElement.offsetHeight}px`,e.topBackgroundElement.style.width=`${window.innerWidth}px`),e.forceMobile||e.collapseType!==ve.Sticky||this._stickToSidebar(e)):this.resizeContainer(e)}static handleScroll(e){const{playerState:t,playerElement:i,playerContainer:s,mediaStarted:r,mobileCollapseOnScrollUp:n}=e;if("adthrive-collapse-top-center"===e.collapseMobileSubType&&"none"===e.playerContainer.style.display)return;const a=ml.getScrollTop(),o=a>Im;Im=a;const l=this.playerWouldOverlapFooter(e),d=this._shouldCollapseOnScrollUp(e),c=!(ml.playerViewable(i)||d&&r),h=this._isWarmupComplete(e);let u=c?Ee.OutOfView:l?Ee.Overlapping:Ee.InView;if("off"!==n){const i=Pt(s)&&t===Se.PausedNotVisible&&!h;this._isTopOfPage()?(u=Ee.OutOfView,this.stopCollapseWarmupTimer(e)):o&&i?(this.startCollapseWarmupTimer(e),u=Ee.OutOfView,"1"===n&&(clearTimeout(km),km=setTimeout((()=>{this._isWarmupComplete(e)&&(this.stopCollapseWarmupTimer(e),e.playerState=Se.UncollapsedPlay,this.changeState(e,u))}),1e3))):h&&this.stopCollapseWarmupTimer(e)}this.changeState(e,u),e.playerState===Se.CollapsedPlay||e.playerState===Se.UserPauseCollapsed?Pm.startCollapseTimer(e):Pm.stopCollapseTimer(e)}static handleOtherVideoPlaying(e){this.changeState(e,Ee.OtherVideoPlaying)}static handlePageVisibilityChange(e,t){t.playerState!==Se.Closed&&t.playerState!==Se.Unstarted&&t.playerState!==Se.UserPauseUncollapsed&&t.playerState!==Se.UserPauseCollapsed&&t.playerState!==Se.PausedNotVisible&&t.playerState!==Se.Overlapped&&(e?t.playerInstance.pause(!0):t.playerInstance.play(!0))}static handleWidthBreak(e,t){t.playerState!==Se.Closed&&t.playerState!==Se.Unstarted&&(e.matches?(this.isCollapsed(t.playerState)&&(this.toggleCollapsedPlayerClasses(!1,t),t.collapseType===ve.Sticky&&this._unstickFromSidebar(t.playerElement),t.forceMobile=!0,this.toggleCollapsedPlayerClasses(!0,t)),t.forceMobile=!0):(this.toggleCollapsedPlayerClasses(!1,t),t.forceMobile=!1,this.isCollapsed(t.playerState)&&(this.toggleCollapsedPlayerClasses(!0,t),t.collapseType===ve.Sticky&&this._stickToSidebar(t))))}static handleClose(e,t=0){Pm.closeEvent.emit(),this.changeState(e,Ee.Close),Pm.stopCollapseTimer(e),te.event("JwPlayer","handleClose",{timeElapsed:e.collapseTimer.timeCollapsed,device:Bt()?"desktop":"mobile",playerType:e.playerType,vp:t})}static handleUserClick(e){this.changeState(e,Ee.UserClick)}static collapse(e){const{playerElement:t,topBackgroundElement:i,playerContainer:s}=e;this.disableCollapse||(this.collapseEvent.emit(),this.toggleCollapsedPlayerClasses(!0,e),e.hasPreviouslyCollapsed=!0,e.forceMobile||e.collapseType!==ve.Sticky||this._stickToSidebar(e),i&&(this._handleVideoHeight(e),R.resolve(Am).handleCollapse({playerElement:t,playerContainer:s,topBackgroundElement:i,programmaticPause:()=>{e.playerInstance.pause(!0)},programmaticPlay:()=>{e.playerInstance.play(!0)},mobileHeaderSelector:e.mobileHeaderSelector})),e.playerInstance.resize(),setTimeout((e=>{this.displayCloseButton(e)}),0,e),R.resolve(zs).topCenterVideoCollapsed.emit(e))}static displayCloseButton(e){this.isCollapsed(e.playerState)&&(e.closeButton.style.display="inline-flex")}static hideCloseButton(e){e.closeButton.style.display="none",e.closeButton.setAttribute("style","display: none!important")}static uncollapse(e){Pm.uncollapseEvent.emit(),this.toggleCollapsedPlayerClasses(!1,e),this._unstickFromSidebar(e.playerElement),this.hideCloseButton(e),this.resizeContainer(e),R.resolve(Am).handleUncollapse(),R.resolve(zs).topCenterVideoUnCollapsed.emit()}static _shouldCollapse(e){const{mediaStarted:t,playerContainer:i,mobileCollapseOnScrollUp:s}=e,r=this._shouldCollapseOnScrollUp(e);if(ml.isMobileLandscape())return!1;const n=this._isTopCollapse(e);if("off"!==s&&n){const t=!!e.collapseTimer.warmupStartTime,i=this._isWarmupComplete(e);if(this._isTopOfPage()||t&&!i)return!1}const a=ml.getScrollTop(),o=ml.getScrollBottom(),l=this.offsetheight,d=It(i).top,c=d+l;return n?t&&(a>=d||r&&o<=c):t&&(a>=d+l/2||r&&o<=c-l/2)}static _shouldCollapseOnScrollUp(e){const{desktopCollapseOnScrollUp:t,hasPreviouslyCollapsed:i,mobileCollapseOnScrollUp:s}=e;return i&&(t||"off"!==s)}static isCollapsed(e){return e===Se.CollapsedPlay||e===Se.UserPauseCollapsed}static _isWarmupComplete(e){const{collapseTimer:t,mobileCollapseOnScrollUp:i,playerContainer:s}=e;return!!t.warmupStartTime&&("1"===i?Date.now()-t.warmupStartTime.getTime()>1e3:"2"===i?Ot(s):void 0)}static _isTopOfPage(){return window.scrollY<1}static _isTopCollapse(e){return e.collapseMobileSubType&&"adthrive-collapse-top-center"===e.collapseMobileSubType}static _stickToSidebar(e){e.stickyElement&&(e.playerElement.style.left=`${e.stickyElement.getBoundingClientRect().left}px`,e.playerElement.style.width=`${e.stickyElement.clientWidth}px`),e.playerElement.style.top=`${e.topMargin}px`}static _unstickFromSidebar(e){e.style.cssText=""}static playerWouldOverlapFooter(e){if(!e.footerElement)return!1;if(e.playerElement.className.includes("adthrive-collapse-bottom")||e.lastCollapsedClasses&&e.lastCollapsedClasses.includes("adthrive-collapse-bottom")){const t=vt();return!(window.innerHeight-t<e.footerElement.getBoundingClientRect().top)}return!((e.topMargin||0)+e.playerElement.getBoundingClientRect().height<e.footerElement.getBoundingClientRect().top)}static toggleCollapsedPlayerClasses(e,t){const i=t.playerInstance.utils,s=Zi(i,"toggleClass")&&"function"==typeof i.toggleClass?i.toggleClass:()=>{};s(t.playerElement,"adthrive-jw-player-collapse",e),t.forceMobile?(s(t.playerElement,ve.Mobile,e),s(t.playerElement,t.collapseMobileSizeType,e),s(t.playerElement,t.collapseMobileSubType,e),this.repositionCollapseMobile(t,e)):(s(t.playerElement,t.collapseType,e),t.collapseSubType&&s(t.playerElement,t.collapseSubType,e),t.collapseMobileSizeType&&s(t.playerElement,t.collapseMobileSizeType,e),t.collapseType===ve.Mobile&&(s(t.playerElement,t.collapseMobileSubType,e),this.repositionCollapseMobile(t,e)))}static repositionCollapseMobile(e,t){"adthrive-collapse-bottom-left"===e.collapseMobileSubType||"adthrive-collapse-bottom-right"===e.collapseMobileSubType?this.repositionCollapseMobileBottom(e):"adthrive-collapse-top-center"===e.collapseMobileSubType&&this.repositionCollapseMobileTop(e,t)}static repositionCollapseMobileTop(e,t){e.topBackgroundElement&&(e.topBackgroundElement.style.height=t?`${e.playerElement.offsetHeight}px`:"0")}static repositionCollapseMobileBottom(e){if(e.playerElement.className.includes("adthrive-collapse-bottom")||e.collapseMobileSubType&&e.collapseMobileSubType.indexOf("bottom")>-1){const t=vt();e.playerElement.style.setProperty("top","auto","important"),e.playerElement.style.setProperty("bottom",`${t}px`,"important")}}static resizeContainer(e){e.playerContainer.style.height=`${e.playerElement.offsetHeight+30}px`}static startCollapseTimer(e){e.collapseTimer.isRunning||(e.collapseTimer.startTime?e.collapseTimer.lastCollapsedTime=new Date:(e.collapseTimer.startTime=new Date,e.collapseTimer.lastCollapsedTime=e.collapseTimer.startTime),e.collapseTimer.isRunning=!0)}static stopCollapseTimer(e){e.collapseTimer.isRunning&&(e.collapseTimer.lastCollapsedTime&&(e.collapseTimer.timeCollapsed+=Yi()-e.collapseTimer.lastCollapsedTime.getTime()),e.collapseTimer.isRunning=!1)}static startCollapseWarmupTimer(e){e.collapseTimer.warmupStartTime||(e.collapseTimer.warmupStartTime=new Date)}static stopCollapseWarmupTimer(e){e.collapseTimer.warmupStartTime&&(e.collapseTimer.warmupStartTime=void 0)}}var Om;Pm.collapseEvent=new Q,Pm.uncollapseEvent=new Q,Pm.closeEvent=new Q,Pm.startEvent=new Q,Pm.disableCollapse=!1,Pm.offsetheight=0,Pm=B([hs("LegacyCollapseUtils")],Pm),function(e){e.firstOnload="so-fo",e.onload="so-o",e.closeBtnVisible="so-cbv",e.closeClicked="so-cc",e.closeSinceFirstImp="so-csfi",e.closeSinceOnload="so-cso",e.closeSinceBtnVisible="so-csbv"}(Om||(Om={}));class xm{setup(){this._isRendered||(this._isRendered=!0,this._appendCloseButton(),this._activate()),this._slot.setSlotTargetingFlag("fref",[`${this._slot.noAdRefreshCount}`],!0),Pm.collapseEvent.on((()=>{this._closeOnRelatedCollapse()})),wm.collapseEvent.on((()=>{this._closeOnRelatedCollapse()}))}get renderState(){return this._isRendered}_activate(){this._handleWidthBreak();const e=this._slot.element.parentElement;e&&(e.classList.add(`${this._elementClassNamePrefix}-idle`),this._isMobile&&this._setElementStyle(e),this._gamEventBus.slotRequested.on(this._handleSlotRequested.bind(this)),this._gamEventBus.slotRenderEnded.on(this._handleSlotRenderEnded.bind(this)),this._gamEventBus.slotOnload.on(this._handleSlotOnload.bind(this)))}_setElementStyle(e){if("top-center"===this._mobileLocation)this._setTopCenterStyle(e);else{const t=this._mobileLocation?this._mobileLocation.split("-")[1]:"right";e.classList.add(`${this._elementClassNamePrefix}-mobile-${t}`)}}_setScrollListener(e,t,i){this._scrollEventHandler=kl((()=>{const s=t.getBoundingClientRect().bottom,r=i&&i.getBoundingClientRect().bottom,n=s>r?s:r;e.style.setProperty("top",`${n}px`)}),20),window.addEventListener("scroll",this._scrollEventHandler)}_setTopCenterStyle(e){const t=this._mobileHeaderSelector?ss(this._mobileHeaderSelector):null,i=t&&t.valid&&t.elements&&t.elements[0]||null;let s=0;if(i){const t=document.querySelector(".slick-film-strip");s=t?t.getBoundingClientRect().bottom:i.getBoundingClientRect().bottom,this._setScrollListener(e,i,t)}e.classList.add(`${this._elementClassNamePrefix}-top-center`);const r=this._config.isStickyOutstreamTopCenterColorsDisabled?"#000000":this._config.adOptions.bgColor;e.style.setProperty("background-color",r),e.style.setProperty("top",`${s}px`)}_handleSlotOnload({slot:e}){if("Video_StickyOutstream"===e.location){performance.mark("so-o");performance.getEntriesByName("so-fo").length||performance.mark("so-fo")}}_handleSlotRenderEnded({event:e,slot:t}){if(!("Video_StickyOutstream"!==t.location||e.isEmpty||e.advertiserId&&this._prebidAmazonAdvertiserIds.includes(e.advertiserId))){const e=this._slot.element.parentElement;if(!e)return;e.classList.add(`${this._elementClassNamePrefix}-active`),e.classList.remove(`${this._elementClassNamePrefix}-idle`)}}_handleSlotRequested({slot:e}){if("Video_StickyOutstream"===e.location){const e=this._slot.element.parentElement;if(!e||e.classList.contains(`${this._elementClassNamePrefix}-idle`))return;e.classList.remove(`${this._elementClassNamePrefix}-active`),e.classList.add(`${this._elementClassNamePrefix}-idle`)}}_createObserver(e){this._observer=new MutationObserver((e=>{e.forEach((e=>{e.target.classList.contains(`${this._elementClassNamePrefix}-active`)?this._displayCloseButton():this._hideCloseButton()}))})),this._observer.observe(e.parentElement||e,{attributes:!0,attributeFilter:["class"]})}_hideCloseButton(){const e=this._closeButton;e&&(e.style.display="none")}_displayCloseButton(){const e=this._closeButton;e&&setTimeout((()=>{e.style.display="inline-flex",performance.mark("so-cbv")}),this._config.video.stickyOutstreamCloseButtonTimeout)}_appendCloseButton(){var e;const t=this._slot.element,i=this._videoCloseButton.createPlayerCloseButton(this._handleCloseClick.bind(this),"sticky outstream",`${this._elementClassNamePrefix}-close`,!1,this._isMobile&&"top-center"===this._mobileLocation);this._hideCloseButton(),null==(e=t.parentNode)||e.insertBefore(i,t),this._closeButton=i,this._createObserver(t)}_addSlickDialogListeners(){document.addEventListener("slick-auth-dialog-opened",(()=>{this._slot.element.classList.add(this._hiddenClassName)})),document.addEventListener("slick-auth-dialog-closed",(()=>{this._slot.element.classList.remove(this._hiddenClassName)}))}_getMeasure(e,t,i){try{return(performance.measure(e,t,i).duration/1e3).toFixed(2)}catch(e){return-1}}_getDurations(){return{slotTime:this._getMeasure("so-cso","so-o","so-cc"),btnTime:this._getMeasure("so-csbv","so-cbv","so-cc"),firstImp:this._getMeasure("so-csfi","so-fo","so-cc"),pageLoad:(performance.now()/1e3).toFixed(2),refresh:this._slot.refreshCount}}_cleanUpLogging(){var e;null==(e=this._observer)||e.disconnect(),this._markNames.forEach((e=>performance.clearMarks&&performance.clearMarks(e))),this._measureNames.forEach((e=>performance.clearMeasures&&performance.clearMeasures(e)))}_logPlayerClose(e){xm.closeEvent.emit(),te.event("StickyOutstream","handleClose",{device:Bt()?"desktop":"mobile",closeReason:e,...this._getDurations()}),this._cleanUpLogging(),window.removeEventListener("scroll",this._scrollEventHandler)}_closeOnRelatedCollapse(){this._handleClose("relatedCollapse")}_handleCloseClick(){performance.mark("so-cc"),this._handleClose("closeClick")}_handleClose(e){if(this._isClosed)return;this._isClosed=!0;const t=this._slot.element,i=t.parentElement;this._logPlayerClose(e),i&&(i.removeChild(t),i.classList.remove(`${this._elementClassNamePrefix}-active`),this._slotManager.destroy(t.id),this._removeListener())}_handleWidthBreak(){this._removeListener=this._footerEventBus.footerRefreshed.on(this._handleFooterRefreshedEvent.bind(this)),this._repositionCollapseBottom()}_handleFooterRefreshedEvent(){this._repositionCollapseBottom()}_repositionCollapseBottom(){this._isMobile&&"top-center"!==this._mobileLocation&&(this._footerBottom=vt(),this._slot.element.parentElement&&(this._slot.element.parentElement.style.setProperty("top","auto","important"),this._slot.element.parentElement.style.setProperty("bottom",`${this._footerBottom}px`,"important")))}_addOffset(e){const t="bottom-right"===this._config.video.stickyOutstreamSettings.mobileLocation&&document.querySelector("slick-sticky-toolbar"),i=e-this._footerBottom,s=t?-76:0;this._slot.element.parentElement&&this._slot.element.parentElement.style.setProperty("transform",`translate(${s}px, -${i}px)`,"important"),document.querySelectorAll(".raptive-sales-footer")&&this._adjustPositionForCeltraAds()}_adjustPositionForCeltraAds(){const e=document.querySelector("#AdThrive_Video_StickyOutstream_1_phone");if(!e)return;const t=()=>{"fixed"===e.style.position&&e.style.setProperty("position","static")};new MutationObserver((()=>{t()})).observe(e,{attributes:!0,attributeFilter:["class"]}),t()}constructor(e,t,i,s,r,n,a){this._config=e,this._context=t,this._slotManager=i,this._slot=s,this._videoCloseButton=r,this._gamEventBus=n,this._footerEventBus=a,this._isRendered=!1,this._isClosed=!1,this._elementClassNamePrefix="adthrive-sticky-outstream",this._isMobile="phone"===this._context.device,this._hiddenClassName="adthrive-player-hidden",this._markNames=["so-fo","so-o","so-cc","so-cbv"],this._measureNames=["so-csfi","so-cso","so-csbv"],this._scrollEventHandler=()=>{},this._footerBottom=52,this._prebidAmazonAdvertiserIds=[e.prebid.advertiserId,e.amazon.advertiserId];const{mobileHeaderSelector:o,mobileLocation:l}=this._config.video.stickyOutstreamSettings;this._mobileHeaderSelector=o,this._mobileLocation=bt(l,"bottom-right"),this._addSlickDialogListeners(),this._footerEventBus.footerHeightChanged.on((e=>{this._addOffset(e)}))}}xm.closeEvent=new Q;class Rm extends nr{init(){this._key="StickySidebarFeatureFlag",this._default=!1}}Rm=B([hs("StickySidebarExperiment"),M()],Rm);class Dm extends Cs{_callAmazonVastEndpoint(e,t){if(!Ie(t))return;const i=Math.floor(1e11*Math.random()),s=`https://aax.amazon-adsystem.com/e/dtb/vast?b=${t.amzniid}&rnd=${i}&pp=${t.amznbid}`;this._outstream.callRendererWithUrl(s,e.id,!0)}stickyOutstreamReady(){this._stickyOutstream&&!this._stickyOutstream.renderState&&this._stickyOutstream.setup()}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u){super(),this._slots=e,this._config=t,this._context=i,this._slotManager=s,this._videoCloseButton=r,this._outstream=n,this._amazonMethods=a,this._gamEventBus=c,this._slotEventBus=h,this._footerEventBus=u,this._sticky=[],this._slots.added.on((e=>{if((!l.result||(null==e?void 0:e.location)!==ge.Recipe)&&e&&e.sticky){if(e.element.classList.add("adthrive-sticky"),e.location===ge.Sidebar){const t=o.result&&e.sequence&&e.sequence<=5,i=this._config.adOptions.dynamicStickySidebarEnabled&&d.result&&e.sequence&&e.sequence>=9;t||i&&e.element.classList.contains("adthrive-sticky-sidebar")?ft(e.element):this._sticky.push(new Sm(e,!0,this._config))}e.location===ge.Video_StickyOutstream&&(this._stickyOutstream=new xm(this._config,this._context,this._slotManager,e,this._videoCloseButton,this._gamEventBus,this._footerEventBus),this._sticky.push(new Sm(e,!0,this._config)))}})),this._amazonMethods.isAmazonLoaded()&&this._config.amazon.enabled&&(this._gamEventBus.slotOnload.on((({slot:e})=>{const t=window.apsBidObject?window.apsBidObject.VAST:null;e.location===ge.Video_StickyOutstream&&t&&(this._outstream.callRendererWithUrl(t,e.id,!0),delete window.apsBidObject)})),this._slotEventBus.adRenderingOutsideGAM.on((({slot:e,bidResponse:t})=>{this._callAmazonVastEndpoint(e,t)})))}}Dm=B([hs("StickyComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===zr?Object:zr,void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===id?Object:id,void 0===bm?Object:bm,void 0===hu?Object:hu,void 0===Yl?Object:Yl,void 0===Rm?Object:Rm,void 0===Xl?Object:Xl,void 0===ym?Object:ym,void 0===jl?Object:jl,void 0===Es?Object:Es,void 0===Ds?Object:Ds])],Dm);class Lm extends Cs{init(){const e=this._slotManager;this._slotManagerEventBus.added.on((t=>{for(const i of t)i.lazy?(Vl.pushToQueue((()=>{i.googleTagSlot.setTargeting("lazy","true")})),this._intersectionObserverManager.observe(this._config.lazyLoad.googleLazyLoadSettings.hbMarginPercent,i)):i.location===ge.Video_StickyOutstream?(this._sticky.stickyOutstreamReady(),e.display([i]).catch((e=>{te.error("GoogleLazyLoadComponent","init","display stickyOutstream slot",e)}))):(Vl.pushToQueue((()=>{i.googleTagSlot.setTargeting("lazy","false")})),e.display(i).catch((e=>{te.error("GoogleLazyLoadComponent","init","display non lazy slot",e)})))}))}constructor(e,t,i,s,r){super(),this._config=e,this._slotManager=t,this._sticky=i,this._intersectionObserverManager=s,this._slotManagerEventBus=r}}Lm=B([hs("GoogleLazyLoadComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===id?Object:id,void 0===Dm?Object:Dm,void 0===$r?Object:$r,void 0===Vs?Object:Vs])],Lm);class Mm extends Cs{init(){this._slotManagerEventBus.added.on((e=>{Vl.pushToQueue((()=>{for(const t of e){const e=Jt(t)||0;t.hvp=e,e>=50&&t.setTargeting({key:"hvp",value:e.toString()})}}))})),this._slotManagerEventBus.refreshing.on((e=>{Vl.pushToQueue((()=>{for(const t of e)if(t.refreshCount<=2&&(!t.hvp||t.hvp<80)){const e=Xt(t)||0;t.hvp=e,e>=60&&t.setTargeting({key:"hvp",value:`${e}`})}}))}))}constructor(e){super(),this._slotManagerEventBus=e}}Mm=B([hs("HvpComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Vs?Object:Vs])],Mm);class Bm{inject(){try{return this._config.marmalade.selectorMatches.reduce(this.processMatch.bind(this),[])}catch(e){te.error("MarmaladeInjector","inject",e)}return[]}filterBasedOnSettings(){const e=this._config.adTypes,t=Wt()?e.inRecipeRecommendationMobile:e.inRecipeRecommendationDesktop,i=Wt()?e.sponsorTileMobile:e.sponsorTileDesktop;return this._config.marmalade.selectorMatches.filter((({adUnit:e})=>"Native_Recipe"===e.location?(t&&this._gam.setTargetingFlag("irrEligible",["true"],!0),t):"Sponsor_Tile"!==e.location||(i&&this._gam.setTargetingFlag("stEligible",["true"],!0),i)))}processMatch(e,t){const{adUnit:i,match:s}=t,r=this.getElementId(i.location,i.sequence);if(!e.some((e=>e.location===i.location&&e.sequence===i.sequence))){const t=this.addAd(s,r,i.position,i.classNames);if(t){const s=new Vr(i.location,i.sequence,i.size,t,!1,i.lazy);e.push(s)}}return e}getElementId(e,t){return[this._config.gam.prefix,e,t].filter(Ji).join("_")}addAd(e,t,i,s=[]){const r=`<div id="${t}" class="adthrive-ad ${s.join(" ")}"></div>`;return e.insertAdjacentHTML(i,r),document.getElementById(t)}constructor(e,t){this._config=e,this._gam=t,this._config.marmalade.selectorMatches=this.filterBasedOnSettings()}}Bm=B([hs("MarmaladeInjector"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Vl?Object:Vl])],Bm);class Fm extends Cs{init(){this._marmaladeEventBus.marmaladeResponseLoaded.on((()=>{this._initializeMarmalade()})),this._slotEventBus.preRequestBids.on((e=>{e.forEach((e=>{Vl.pushToQueue((()=>{e.setTargeting(this.getMcmpTargeting())}))}))})),this._addDynamicSlots(),this._addFlpMessaging(),this._setPageLevelTargeting(),this._setIXTargeting();const e=()=>{this._setMcmpTargeting(),this._setIXTargeting()};this._config.marmalade.rfDataProcessed.emitted?e():this._config.marmalade.rfDataProcessed.on((()=>e()))}getMcmpTargeting(){const e=[...this._mcmp,...this._getRfCodes("gam")],t=this._config.trackScroll,i=t.trackScrollEnabled&&t.getTargetingValue();return i&&e.push(i),{key:"mcmp",value:e}}_initializeMarmalade(){this._mcmp=this._config.marmalade.mcmp.filter(Mt),this._siteCodes=this._config.marmalade.siteCodes,this._filteredSiteCodes=this._config.marmalade.filteredSiteCodes,this._siteCodeObject=this._filteredSiteCodes.reduce(((e,t)=>(e[t]="True",e)),{}),this.init()}_getRfCodes(e){const t=[];if(e){const i=this._config.marmalade;[...i.rfMcmpCodes,...i.rfIabCodes].forEach((i=>{const s=i[0];i[1].includes(e)&&t.push(s)}))}return t}_setMcmpTargeting(){const e=this._getRfCodes("gam");this._config.marmalade.mcmpTargeting=[...this._mcmp,...e]}_setIXTargeting(){const e=this._getRfCodes("ix"),t=this._config.trackScroll.getTargetingValue(),i=t?[t]:[];Si({MCMP:[...e,...this._mcmp,...i].join("#MCMP:"),...this._siteCodeObject},this._prebidMethods)}_setPageLevelTargeting(){this._slotManagerEventBus.requestingBids.once((()=>{this._gam.setTargetingFlag("rf",[String(this._marmaladeEventBus.recencyFrequencyDataSet.emitted)])})),this._setMcmpTargeting(),this._gam.setTargeting({key:"site_code",value:this._siteCodes}),this._gam.setTargeting({key:"marmalade",value:this._config.marmalade.loaded?"true":"false"})}_addDynamicSlots(){const e=this._marmaladeInjector.inject();e.forEach((e=>e.refreshInterval=0)),e.length>0&&this.gamEventBus.started.on((()=>this._slotManager.add(e).catch((e=>{te.error("MarmaladeComponent","init",e)}))))}_addFlpMessaging(){const e=this._config.marmalade.flpProdIds.filter(Mt);if(e){((e,t)=>{window.addEventListener("message",(i=>{try{const{origin:s,source:r}=i,n=JSON.parse(i.data),a=n&&n.message===t.message;if(!s||!s.match(e)||!a)return;r.postMessage(JSON.stringify(t),s)}catch(e){return}}))})(/https:\/\/\S*\.safeframe.googlesyndication.com/i,{message:"adthriveFlippData",flippData:e})}}get enabled(){return!this._config.disableAds.all}constructor(e,t,i,s,r,n,a,o,l){super(),this._config=e,this._marmaladeInjector=t,this._slotManager=i,this._gam=s,this._prebidMethods=r,this.gamEventBus=n,this._marmaladeEventBus=a,this._slotEventBus=o,this._slotManagerEventBus=l,this._siteCodeObject={};const d=this._config.marmalade;this._mcmp=d.mcmp.filter(Mt),this._siteCodes=d.siteCodes,this._filteredSiteCodes=d.filteredSiteCodes,this._siteCodeObject=this._filteredSiteCodes.reduce(((e,t)=>(e[t]="True",e)),{})}}Fm=B([hs("MarmaladeComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Bm?Object:Bm,void 0===id?Object:id,void 0===Vl?Object:Vl,void 0===Ss?Object:Ss,void 0===jl?Object:jl,void 0===js?Object:js,void 0===Es?Object:Es,void 0===Vs?Object:Vs])],Fm);class jm extends nr{init(){this._key="MagniteCarbon",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],jm.prototype,"run",null),jm=B([hs("MagniteCarbonExperiment"),M()],jm);class Nm extends Cs{async init(){this._pageEngagement.id=this._generateUUID(),this._pageEngagement.startTime=Date.now(),this._pageEngagement.timeLastEngage=Date.now(),this.pageViewId=this._generateUUID().toString(),this.profileId=this._getProfileId(),this.sessionId=this._getSessionId();const e=await this._createBaseEngagementEvent();this._sendEngagementEvent(e,"page_load"),this._prebidEventBus.auctionEnd.once((()=>{this._auctionEndEvent()})),this._prebidEventBus.tcf2Enforcement.on((e=>{this.tcf2EnforcementEvent(e)}))}async tcf2EnforcementEvent(e){var t,i,s;if((null==(t=e.storageBlocked)?void 0:t.length)>0||(null==(i=e.biddersBlocked)?void 0:i.length)>0||(null==(s=e.analyticsBlocked)?void 0:s.length)>0){this._registerEngagement();const t=await this._createBaseEngagementEvent();t.tcf_events=e,this._sendEngagementEvent(t,"tcf_enforcement")}}async _auctionEndEvent(){if(this.auctionEndEventCount++,1===this.auctionEndEventCount){this._registerEngagement();const e=await this._createBaseEngagementEvent();this._sendEngagementEvent(e,"auction_end")}}async _createBaseEngagementEvent(){const e={profile_id:this.profileId,session_id:this.sessionId,pageview_id:this.pageViewId,engagement_id:this._pageEngagement.id,engagement_count:this._pageEngagement.count,engagement_ttl:this._pageEngagement.ttl,start_time:this._pageEngagement.startTime,end_time:Date.now(),script_id:window.location.host,url:window.location.href,referrer:document.referrer,consent:this._getConsentData()},t=await this.getExternalIds();return e.external_ids=t,e}_registerEngagement(){const e=Date.now(),t=(e-this._pageEngagement.timeLastEngage)/1e3;this._pageEngagement.timeLastEngage=e,t<this._pageEngagement.ttl||(this._pageEngagement.count++,this._pageEngagement.startTime=e,this._pageEngagement.id=this._generateUUID())}handleGdprConsent(){return"function"==typeof window.__tcfapi&&window.__tcfapi("getTcData",2,(e=>{if(e&&e.tcString&&e.tcString.length)return e.tcString})),""}_getConsentData(){var e;const t=null!=(e=this._config.ccpa.privacyString)?e:"";return{gdpr_consent:this._config.gdpr.enabled?this.handleGdprConsent():"",ccpa_consent:this._config.ccpa.required?t:""}}async getExternalIds(){const e={};let t=[];return await this._prebidMethods.waitForQueue().then((i=>{!0===i&&(t=this._prebidMethods.getUserIdsAsEids()),t.forEach((t=>{t.source&&(null==t?void 0:t.uids.length)&&(e[t.source]=t.uids.map((e=>e.id)))}))})),e}_sendEngagementEvent(e,t){const i=`${this.ANALYTICS_HOST}/${this.ANALYTICS_VERSION}/parent/${this.PARENT_ID}/engagement/trigger/${t}`;fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{try{this._updateProfileId(e)}catch(e){te.error("MagniteCarbonComponent","importScript","unable to parse API response")}})).catch((e=>te.error("MagniteCarbonComponent","importScript",e)))}_updateProfileId(e){(null==e?void 0:e.update)&&""!=(null==e?void 0:e.id)&&(kr.setExternalCookie(this.PROFILE_ID_COOKIE,e.id,{expiry:{unit:"days",value:89},sameSite:"Lax"}),K.setLocalStorageValue(this.PROFILE_ID_KEY,e.id,!1))}_getProfileId(){const e=K.getLocalStorageValue(this.PROFILE_ID_KEY),t=kr.readExternalCookie(this.PROFILE_ID_COOKIE);if(e)return kr.setExternalCookie(this.PROFILE_ID_COOKIE,e,{expiry:{unit:"days",value:89},sameSite:"Lax"}),e;if(t)return K.setLocalStorageValue(this.PROFILE_ID_KEY,t,!1),t;const i=this._generateUUID();return K.setLocalStorageValue(this.PROFILE_ID_KEY,i,!1),kr.setExternalCookie(this.PROFILE_ID_COOKIE,e,{expiry:{unit:"days",value:89},sameSite:"Lax"}),i.toString()}_getSessionId(){const e=kr.readExternalCookie(this.SESSION_ID_COOKIE);if(e&&""!=e)return kr.setExternalCookie(this.PROFILE_ID_COOKIE,e,{expiry:{unit:"minutes",value:5},sameSite:"Lax"}),e;const t=this._generateUUID();return kr.setExternalCookie(this.PROFILE_ID_COOKIE,t.toString(),{expiry:{unit:"minutes",value:5},sameSite:"Lax"}),t.toString()}_generateUUID(e){let t=0;return t=window&&window.crypto&&void 0!==window.crypto.getRandomValues?crypto.getRandomValues(new Uint8Array(1))[0]%16:16*Math.random(),e?(e^t>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,this._generateUUID)}get enabled(){return this._magniteCarbonExperiment.result&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}constructor(e,t,i,s){super(),this._magniteCarbonExperiment=e,this._prebidMethods=t,this._prebidEventBus=i,this._config=s,this.ANALYTICS_VERSION="v1.0",this.PROFILE_ID_KEY="carbon_ccuid",this.PROFILE_ID_COOKIE="ccuid",this.SESSION_ID_COOKIE="ccsid",this.PARENT_ID="8fea659f19",this.ANALYTICS_HOST="https://pb-ing.ccgateway.net",this.pageViewId="",this.profileId="",this.sessionId="",this._pageEngagement={ttl:60,count:0,id:0,startTime:0,timeLastEngage:0},this.auctionEndEventCount=0}}Nm=B([hs("MagniteCarbonComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===jm?Object:jm,void 0===Ss?Object:Ss,void 0===Ms?Object:Ms,void 0===Ol?Object:Ol])],Nm);class Um extends nr{init(){this._key="TopicsAPI",this._default=!1}isEnabled(){return super.isEnabled()&&mt()}}Um=B([hs("TopicsAPIExperiment"),M()],Um);class Vm extends Cs{get enabled(){return!this._config.gdpr.enabled&&!this._config.ccpa.userOptedOut&&this._context.browsingTopicsSupported&&this._browsingTopicsAPIExperiment.result}get topics(){return this._topics}async start(){const e=await this.fetchTopics(),t=e.map((e=>`${e.id}`));t.length>0&&this._gam.setTargetingFlag("topicapi",t),this._topics=e,this._context.browsingTopics=e,this._browsingTopicsAPIEventBus.topicsReceived.emit(e)}async fetchTopics(){try{const t=await window.fetch(`${this._topicsUrl}?ts=${Date.now()}`,{browsingTopics:!0}),i=await t.json();var e;return null!=(e=i.topics)?e:[]}catch(e){return[]}}async pollForTopics(){const e=await this.fetchTopics();return 0===e.length?(await vs(15e3),this.pollForTopics()):e}constructor(e,t,i,s,r){super(),this._config=e,this._context=t,this._gam=i,this._browsingTopicsAPIExperiment=s,this._browsingTopicsAPIEventBus=r,this._topics=[],this._storageKey="browsing_topics",this._topicsUrl=`https://${this._context.host}/api/v2/topics`}}Vm=B([hs("BrowsingTopicsAPIComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Vl?Object:Vl,void 0===Um?Object:Um,void 0===xs?Object:xs])],Vm);class zm extends sr{init(){this._key="PaapiDecisionLogicSelection"}}zm=B([hs("PaapiDecisionLogicSelectionExperiment"),M()],zm);class $m extends Cs{get enabled(){return this._config.fledge.enabled}init(){this.enabled&&(this._gam.setTargeting({key:"fledge",value:"true"}),this._setPrebidFledgeBidderConfig())}_getDecisionLogicUrl(){const e=this._privateDecisionLogicSelectionExperiment.result,t="string"==typeof e&&e.length?`experiments/${encodeURIComponent(e)}/decision-logic.js`:"decision-logic.js";return`https://${this._context.privacySandboxHost}/${t}`}_setPrebidFledgeBidderConfig(){this._bidderCodeList.forEach((e=>{const t={fledgeEnabled:!0,fledgeConfig:{}};e===ae.Rtbhouse&&(t.fledgeConfig={seller:this._sellerUrl,decisionLogicUrl:this._decisionLogicUrl,interestGroupBuyers:[this._ownerUrl,"https://grid-mercury.criteo.com","https://ads.optable.co"]}),this._prebidMethods.setBidderConfig({bidders:[e],config:t},!0)}))}constructor(e,t,i,s,r){super(),this._config=e,this._gam=t,this._prebidMethods=i,this._privateDecisionLogicSelectionExperiment=s,this._context=r,this._bidderCodeList=[ae.Rtbhouse,ae.Triplelift,ae.Pubmatic,ae.OpenX,ae.Criteo,ae.IndexExchange,ae.Rubicon],this._ownerUrl=`https://${this._context.host}`,this._sellerUrl=`https://${this._context.privacySandboxHost}`,this._decisionLogicUrl=this._getDecisionLogicUrl()}}$m=B([hs("FledgeComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Vl?Object:Vl,void 0===Ss?Object:Ss,void 0===zm?Object:zm,void 0===Pr?Object:Pr])],$m);class Hm{init(){this._emailCaptureHandler.emailCaptured.on((e=>this._handleEmailCapture(e)),{handleEventsAlreadyEmitted:!0}),this._gdprEvents.consentCaptured.on((e=>this._handleConsentCapture(e))),this._config.ccpa.consentChange.on((e=>{this._handleCCPAConsentChange(null!=e?e:"")}))}_atLeastOneHashProvided(e){return Object.values(e).some((e=>e.length>0))}async _handleEmailCapture(e){const{pii:{email:t,sha256Hash:i,sha1Hash:s,source:r,sourceCollectedDate:n},shareWithPartners:a,identityDataSource:o}=e;i||s?this._hashObj={sha256Hash:i||"",sha1Hash:s||""}:t&&await this._hashEmail(t),this._email=t,this._source=r,this._sourceCollectedDate=n,o&&(this._identityData=this._identityDataMigration.createIdentityData({sha256Hash:this._hashObj.sha256Hash,sha1Hash:this._hashObj.sha1Hash},this._source,this._sourceCollectedDate,o)),this._shareWithPartners=a||this._shareBasedOnSource(r),this._config.gdpr.enabled&&!this._consentReceived||this._processPii()}_shareBasedOnSource(e){const t=this._hemSourceAllowlist.checkSource(e);return fi({source:e,identifierType:"truedata"})?t&&this._optableConfig.enabled&&this._optableConfig.useOptableHem:t}_handleConsentCapture(e){this._consentReceived=!0,this._consent=e,(this._email||this._atLeastOneHashProvided(this._hashObj))&&this._processPii()}_processPii(){K.setLocalStorageValue(pi.KEY,this._source,!1),K.setLocalStorageValue(ui.KEY,this._hashObj,!1),this._identityData&&(aa(this._identityData,this._config.site.id,"false"!==this._context.querystring.get("adt_encrypt")),this._gam.setTargetingFlag("adti",[this._source],!0)),this._gam.setTargetingFlag("emsrc",[this._source],!0),this._gam.setTargetingFlag("hem",["1"],!0),this._sourceCollectedDate&&(K.setLocalStorageValue(gi.KEY,this._sourceCollectedDate,!1),this._gam.setTargetingFlag("hem_cd",[this._sourceCollectedDate],!0)),this._shareWithPartners&&(this._identityEventBus.dataCaptured.emit({email:this._email,...this._hashObj,consent:this._consent,source:this._source,sourceCollectedDate:this._sourceCollectedDate}),this._gam.setTargetingFlag("hem_shared",["1"],!0),this._identityData&&this._identityEventBus.dataCapturedForIframe.emit(this._identityData))}async _hashEmail(e){if(!("msCrypto"in window)&&"https:"===location.protocol&&"crypto"in window&&"TextEncoder"in window){const t=(new TextEncoder).encode(e),[i,s]=await Promise.all([this._convertToSpecificHashType("SHA-256",t),this._convertToSpecificHashType("SHA-1",t)]);this._hashObj.sha256Hash=i,this._hashObj.sha1Hash=s}}async _convertToSpecificHashType(e,t){const i=await crypto.subtle.digest(e,t),s=Array.from(new Uint8Array(i)).map((e=>("00"+e.toString(16)).slice(-2))).join("");return s}_handleCCPAConsentChange(e=""){const t=K.getLocalStorageValue(ui.KEY,!1),i=K.getLocalStorageValue(pi.KEY,!1),s=e===this._config.ccpa.ccpaOptOut;if(dt()){const e=kr.readInternalCookie(ui.KEY),t=kr.readInternalCookie(pi.KEY);(e||t)&&s&&(kr.deleteCookie(ui.KEY),kr.deleteCookie(pi.KEY),kr.deleteCookie(hi.KEY))}(t||i)&&s&&(K.removeLocalStorageValue(ui.KEY,!1),K.removeLocalStorageValue(pi.KEY,!1),K.removeLocalStorageValue(gi.KEY,!1),K.removeLocalStorageValue(hi.KEY,!1))}constructor(e,t,i,s,r,n,a,o,l){this._emailCaptureHandler=e,this._gdprEvents=t,this._config=i,this._context=s,this._gam=r,this._identityEventBus=n,this._hemSourceAllowlist=a,this._optableConfig=o,this._identityDataMigration=l,this._email="",this._consent="",this._hashObj={sha256Hash:"",sha1Hash:""},this._source="",this._sourceCollectedDate=null,this._shareWithPartners=!0,this._consentReceived=!1,this._emailCounted=!1,this._identityData=null,this.piiCaptured=new Q}}Hm=B([hs("PiiManager"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Hn?Object:Hn,void 0===th?Object:th,void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Vl?Object:Vl,void 0===Ls?Object:Ls,void 0===la?Object:la,void 0===Zn?Object:Zn,void 0===$n?Object:$n])],Hm);class qm extends xh{get enabled(){var e,t;return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut&&null!=(t=null==(e=this._userId)?void 0:e.enabled)&&t}updateUserIds(){var e;return(null!=(e=this._prebidMethods.getConfig("userSync.userIds"))?e:[]).map((e=>(this._userId&&e.name===this._userId.id.name&&(e=this._userId.id),e)))}processPii(e){this._prebidMethods.addToQueue((()=>{this.run(e)}))}run(e){if(this._userId&&e.sha256Hash&&this._userId.id.params){this._userId.id.params.he=e.sha256Hash;const t=this.updateUserIds();this._prebidMethods.setConfig({userSync:{userIds:t}}),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._name]},callback:()=>{}})}}constructor(e,t,i,s,r){super(),this._gpcConfig=e,this._ccpaConfig=t,this._prebidMethods=i,this._userIds=s,this._userIdEventBus=r,this._name="connectId",this._userId=this._userIds.get(this._name)}}qm=B([hs("YahooPiiPartner"),L(),j("design:type",Function),j("design:paramtypes",[void 0===an?Object:an,void 0===nn?Object:nn,void 0===Ss?Object:Ss,void 0===Oh?Object:Oh,void 0===Fs?Object:Fs])],qm);class Gm extends xh{get enabled(){var e,t;return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut&&null!=(t=null==(e=this._userId)?void 0:e.enabled)&&t}processPii(e){this._prebidMethods.addToQueue((()=>{this.run(e)}))}updateUserIds(){var e;return(null!=(e=this._prebidMethods.getConfig("userSync.userIds"))?e:[]).map((e=>(this._userId&&e.name===this._userId.id.name&&(e=this._userId.id),e)))}run(e){if(e.sha256Hash&&this._userId&&this._userId.id.params){const t=this.updateUserIds();if(fi({source:e.source,identifierType:"truedata"}))return;e.sha256Hash&&(this._userId.id.params.pd=this._id5IdModule.getPdString(e.sha256Hash)),this._prebidMethods.setConfig({userSync:{userIds:t}}),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._userId.id.name]},callback:()=>{}})}}constructor(e,t,i,s,r,n){super(),this._gpcConfig=e,this._ccpaConfig=t,this._prebidMethods=i,this._userIds=s,this._userIdEventBus=r,this._id5IdModule=n,this._name="id5Id",this._userId=this._userIds.get(this._name)}}Gm=B([L(),hs("Id5PiiPartner"),j("design:type",Function),j("design:paramtypes",[void 0===an?Object:an,void 0===nn?Object:nn,void 0===Ss?Object:Ss,void 0===Oh?Object:Oh,void 0===Fs?Object:Fs,void 0===lh?Object:lh])],Gm);class Km extends xh{get enabled(){const e=this._config.partners;return!(this._config.gpc.gpcEnabled||this._config.ccpa.userOptedOut||!e.display.get(ae.Criteo)&&!e.video.get(ae.Criteo))}processPii(e){this._prebidMethods.addToQueue((()=>{this.run(e)}))}run(e){e&&e.sha256Hash&&this._prebidMethods.setBidderConfig({bidders:[ae.Criteo],config:{ortb2:{user:{ext:{data:{eids:[{source:"cafemedia.com",uids:[{id:e.sha256Hash,atype:3,ext:{stype:"hemsha256"}}]}]}}}}}})}constructor(e,t){super(),this._config=e,this._prebidMethods=t}}Km=B([L(),hs("CriteoBidderPiiPartner"),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Ss?Object:Ss])],Km);class Wm extends xh{get enabled(){var e,t;return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut&&null!=(t=null==(e=this._userId)?void 0:e.enabled)&&t}processPii(e){this._prebidMethods.addToQueue((()=>{this._run(e)}))}_run(e){var t;const i=null!=(t=this._prebidMethods.getConfig("userSync.userIds"))?t:[],s=i.find((e=>e.name===this._name)),r=i.filter((e=>e.name!==this._name)),n=!!s,a=this._userId&&this._userId.id.params&&this._userId.id.params.hasOwnProperty("e");n&&!a&&(this._prebidMethods.setConfig({userSync:{userIds:[...r,{...s,params:{...null==s?void 0:s.params,e:e.sha256Hash}}]}}),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._name]},callback:()=>{}}))}constructor(e,t,i,s,r){super(),this._gpcConfig=e,this._ccpaConfig=t,this._prebidMethods=i,this._userIds=s,this._userIdEventBus=r,this._name="fabrickId",this._userId=this._userIds.get(this._name)}}Wm=B([L(),hs("FabrickPiiPartner"),j("design:type",Function),j("design:paramtypes",[void 0===an?Object:an,void 0===nn?Object:nn,void 0===Ss?Object:Ss,void 0===Oh?Object:Oh,void 0===Fs?Object:Fs])],Wm);class Ym extends xh{get enabled(){return this._optableConfig.enabled&&this._optableConfig.useOptableHem&&!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.enabled}async init(){if(this.enabled)try{this._setupEventListeners();const[t,i]=await Promise.all([this._collectIdentifiersFromSSP(),this._collectIdentifiersFromUserIds()]);var e;await this._processIdentifiers([...t,...i]);const s={os:this._userAgentConfig.os,browser:this._userAgentConfig.browser,device:this._userAgentConfig.device,cookieDeprecationLabel:null!=(e=this._fledgeConfig.cookieDeprecationLabel)?e:""};await this._processTraits(s)}catch(e){}}processPii(e){var t;if(!this.enabled)return;if(!(null==(t=window.optable)?void 0:t.auth))return;if(!(null==e?void 0:e.source)||!(null==e?void 0:e.sha256Hash))return;const i={},s=[];if(e.sourceCollectedDate&&(i.hem_cd=e.sourceCollectedDate),_i(e.source)){const t=`${ci}${e.sha256Hash}`;s.push(t),i.hem_sources=e.source,i.hem_dates=ei(),i.hem_sites=`s-${this._siteConfig.id}`,this._optableStore.truedataHems.length&&(i.td_hems=this._optableStore.truedataHems.join(","))}this._processIdentifiers(s),this._processTraits(i)}_setupEventListeners(){this._identityEventBus.optableIdentitiesCaptured.on((e=>{this._processIdentifiers(e)}),{handleEventsAlreadyEmitted:!0}),this._identityEventBus.optableTraitsCaptured.on((e=>{this._processTraits(e)}),{handleEventsAlreadyEmitted:!0})}async _collectIdentifiersFromUserIds(){try{const e=this._userIdSources.reduce(((e,{userId:t,variant:i})=>{if(!t)return e;const s=this._userIdTargeting.getParsedUserIdStoredValue(t);return s?[...e,this._optableSdkWrapper.cid(s,i)]:e}),[]);return Promise.all(e)}catch(e){return te.error("OptablePiiPartner","_collectIdentifiersFromUserIds","Failed to collect identifiers from UserIds",e),[]}}async _collectIdentifiersFromSSP(){try{await vs(3e3);const e=this._prebidMethods.getUserIdsAsEids(),t=this._sspSources.reduce(((t,{source:i,variant:s})=>{if(!i)return t;const r=null==e?void 0:e.find((e=>e.source===i));return r&&r.uids.length>0?[...t,this._optableSdkWrapper.cid(r.uids[0].id,s)]:t}),[]);return Promise.all(t)}catch(e){return te.error("OptablePiiPartner","_collectIdentifiersFromSSP","Failed to collect identifiers from SSPs",e),[]}}async _processIdentifiers(e){const t=this._santitizeIdentifiers(e);if(t.length)try{await this._optableSdkWrapper.identify(...t)}catch(t){te.event("OptablePiiPartner","_processIdentifiers","Failed to process identifiers",{identifiers:e,error:t})}}_santitizeIdentifiers(e){return e.filter((e=>{if("string"!=typeof e||!e.length)return!1;const[t,i]=e.split(":",2),s=this._identityValidators[t];return!!s&&s(i)}))}async _processTraits(e){const t=this._sanitizeTraits(e);Object.keys(t).length&&await this._optableSdkWrapper.profile(t)}_sanitizeTraits(e){return Object.entries(e).reduce(((e,[t,i])=>("string"==typeof i&&i.length&&(e[t]=i),e)),{})}constructor(e,t,i,s,r,n,a,o,l,d,c,h){super(),this._optableConfig=e,this._gpcConfig=t,this._ccpaConfig=i,this._fledgeConfig=s,this._userAgentConfig=r,this._siteConfig=n,this._optableStore=a,this._optableSdkWrapper=o,this._userIds=l,this._userIdTargeting=d,this._identityEventBus=c,this._prebidMethods=h,this._userIdSources=[{userId:this._userIds.get("id5Id"),variant:0},{userId:this._userIds.get("unifiedId"),variant:5},{userId:this._userIds.get("sharedId"),variant:6}],this._sspSources=[{source:"liveintent.sovrn.com",variant:1},{source:"pubmatic.com",variant:2},{source:"flashtalking.com",variant:4},{source:"crwdcntrl.net",variant:7},{source:"openx.net",variant:8},{source:"rubiconproject.com",variant:9}],this._identityValidators={e:U,i4:U,i6:U,p:U,c:U,c1:$(10),c2:V,c4:z,c5:V,c6:V,c7:U,c8:V,c9:$(10)}}}Ym=B([hs("OptablePiiPartner"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Zn?Object:Zn,void 0===an?Object:an,void 0===nn?Object:nn,void 0===Uo?Object:Uo,void 0===Pl?Object:Pl,void 0===Ys?Object:Ys,void 0===Qn?Object:Qn,void 0===Wn?Object:Wn,void 0===Oh?Object:Oh,void 0===Hh?Object:Hh,void 0===Ls?Object:Ls,void 0===Ss?Object:Ss])],Ym);class Qm extends xh{get enabled(){var e,t;return!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut&&null!=(t=null==(e=this._userId)?void 0:e.enabled)&&t}_getGdprConsent(){let e="tcunavailable",t=0;return"function"==typeof window.__tcfapi&&window.__tcfapi("getTCData",2,(i=>{i&&i.tcString&&i.tcString.length&&(e=i.tcString,t=1)})),`&gdpr=${t}&gdpr_consent=${e}`}_pixelSync(e=!1){const t=`https://pixel.rubiconproject.com/token?pid=49096${e?this._getGdprConsent():""}${this._config.ccpa.required?`&us_privacy=${this._config.ccpa.privacyString}`:""}`,i=new Image;i.src=t,i.style.display="none",i.alt="",document.body.appendChild(i)}processPii(e){this._prebidMethods.addToQueue((()=>{this.run(e)}))}run(e){var t;const i=null==(t=window.liQ_instances)?void 0:t[0],s=!!(null==i?void 0:i.ready),r=fi({source:e.source,identifierType:"truedata"});if(s&&!r&&e.sha256Hash&&this._userId&&this._userId.id.params){let t=e.sha256Hash;t&&t.length>64&&(te.event("LiveIntentPiiPartner","run","Detected nested sha256Hash value. Attempting to extract value before sending to liveConnect."),t=this._retrieve64BitString(t)),this._userId.id.params.emailHash=t;const s=this.updateUserIds();this._prebidMethods.setConfig({userSync:{userIds:s}}),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._userId.id.name]},callback:()=>{}}),i.push({hash:null!=t?t:""})}}updateUserIds(){var e;return(null!=(e=this._prebidMethods.getConfig("userSync.userIds"))?e:[]).map((e=>(this._userId&&e.name===this._userId.id.name&&(e=this._userId.id),e)))}_retrieve64BitString(e){const t=e.match(/\w{64}/);return t?t[0]:void 0}constructor(e,t,i,s,r){super(),this._config=e,this._events=t,this._prebidMethods=i,this._userIdEventBus=r,this._name="liveIntentId",this._userId=s.get(this._name),this._config.gdpr.enabled?this._events.consentCaptured.on((()=>this._pixelSync(!0))):this._pixelSync()}}Qm=B([L(),hs("LiveIntentPiiPartner"),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===th?Object:th,void 0===Ss?Object:Ss,void 0===Oh?Object:Oh,void 0===Fs?Object:Fs])],Qm);class Xm extends xh{get enabled(){var e,t;return!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut&&null!=(t=null==(e=this._userId)?void 0:e.enabled)&&t}processPii(e){this._prebidMethods.addToQueue((()=>{this.run(e).catch((t=>{te.error("Uid2PiiPartner","processPii","Error processing PII",{pii:e,error:t})}))}))}async run(e){const t=!fi({source:e.source}),i=this._idGraphUid2Experiment.result;if(!this._blocklist.some((t=>e.source.includes(t)))&&!this._config.gdpr.enabled&&!this._config.uid2TokenCleanup.active&&e.sha256Hash){if(t)return this._setTTDUId2ServerToken(e,"raptive");if(i)return this._setTTDUId2ServerToken(e,"optable")}}updateUserIds(){var e;return(null!=(e=this._prebidMethods.getConfig("userSync.userIds"))?e:[]).map((e=>(this._userId&&e.name===this._name&&(e=this._userId.id),e)))}async _setTTDUId2ServerToken(e,t){if(kr.readExternalLocalStorage(this._uid2ServerTokenKey))return;let i;"raptive"===t?i=await this._getTTDUId2ServerTokenFromRaptive(e):"optable"===t&&(i=await this._getTTDUId2ServerTokenFromOptable(e)),i&&(kr.setExternalLocalStorage(this._uid2ServerTokenKey,i),this._setUid2WithUpdatedToken({token:i,declareBridged:this._userIdBridgeManager.shouldDeclareBridgedId(e.source)}))}async _getTTDUId2ServerTokenFromOptable(e){return new Promise(((t,i)=>{this._optableSdkWrapper.tokenize(`e:${e.sha256Hash}`).then((e=>{if(e.user.eids){const s=e.user.eids.find((e=>"uidapi.com"===e.source));if(s){const e=s.uids[0].ext;return(null==e?void 0:e.advertising_token)?(e.provider="optable",t(e)):i()}}return i()})).catch((e=>(te.error("Uid2PiiPartner","_setTTDUId2ServerTokenFromOptable","Failed to tokenize PII",e),i(e))))}))}async _getTTDUId2ServerTokenFromRaptive(e){return new Promise(((t,i)=>{const s=(new Date).setUTCHours(0,0,0,0),r=`https://${this._context.host}/api/v2/uid?format=email_hash&value=${e.sha256Hash}&optout_check=1&ts=${s}`;fetch(r).then((async e=>{const{body:s,status:r}=await e.json(),n=s;return"optout"===r?(kr.deleteLocalStorage(this._uid2ServerTokenKey),i()):(null==n?void 0:n.advertising_token)?(n.provider="raptive",t(n)):i()})).catch((e=>(te.error("Uid2PiiPartner","_getTTDUId2ServerTokenFromRaptive","Failed to fetch uid2 token",e),i(e))))}))}_setUid2WithUpdatedToken(e){if(!e.token)return;const t=this._prebidMethods.getConfig("userSync.userIds");this._prebidMethods.setConfig({userSync:{userIds:t.map((t=>(t.name===this._name&&t.params&&(t.params.uid2Token=e.token,e.declareBridged&&(t.params.declareBridged=e.declareBridged)),t)))}}),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._name]},callback:()=>{this._userIdEventBus.uid2Refreshed.emit()}})}constructor(e,t,i,s,r,n,a,o){super(),this._config=e,this._context=t,this._prebidMethods=i,this._userIds=s,this._userIdEventBus=r,this._idGraphUid2Experiment=n,this._userIdBridgeManager=a,this._optableSdkWrapper=o,this._name="uid2",this._blocklist=[pi.VALUES.IDENTITY_IFRAME],this._uid2ServerTokenKey="__uid2_server_token",this._userId=this._userIds.get(this._name)}}Xm=B([L(),hs("Uid2PiiPartner"),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Ss?Object:Ss,void 0===Oh?Object:Oh,void 0===Fs?Object:Fs,void 0===Ch?Object:Ch,void 0===Ah?Object:Ah,void 0===Wn?Object:Wn])],Xm);class Jm extends xh{init(){this._regulatoryValidation()}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}processPii(e){const t={...this._getHashedRecords(e.sha256Hash),...this._getGDPRConfig(e.consent),...this._getOptOut()};Ct().then((async()=>{await this._bootstrapConfig.bootstrapLoaders[oe.Amazon],this._amazonMethods.rpa(t)}))}_getHashedRecords(e=""){return{hashedRecords:[{type:"email",record:e}]}}_getGDPRConfig(e){const t=this._gdprEnabled;return{gdpr:{enabled:t,...t&&{consent:e}}}}_getOptOut(){return{optOut:this._userOptedOut}}_regulatoryValidation(){kr.readExternalCookie(this._tokenKey)&&this._userOptedOut&&this._optOut()}_optOut(){this._amazonMethods.upa({hashedRecords:[],optOut:!0})}constructor(e,t,i){super(),this._config=e,this._amazonMethods=t,this._bootstrapConfig=i,this._name="amz",this._tokenKey="AMZN-Token",this._gdprEnabled=this._config.gdpr.enabled,this._userOptedOut=this._config.ccpa.userOptedOut}}Jm=B([hs("AmazonPublisherAudiencesPiiPartner"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Yl?Object:Yl,void 0===tn?Object:tn])],Jm);class Zm extends Cs{start(){this.enabled&&(this._partners.forEach((e=>e.init&&e.init())),this._piiManager.init())}get enabled(){return!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u){super(),this._config=e,this._context=t,this._piiManager=i,this._identityEventBus=s,this._partners=[r,n,a,o,l,d,c,h,u].filter((e=>e.enabled&&!this._context.isWordPressLogin)),this._identityEventBus.dataCaptured.on((e=>{this._partners.forEach((t=>{t.processPii(e)}))}))}}Zm=B([hs("PiiCaptureComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Hm?Object:Hm,void 0===Ls?Object:Ls,void 0===Jm?Object:Jm,void 0===Km?Object:Km,void 0===Wm?Object:Wm,void 0===Gm?Object:Gm,void 0===Qm?Object:Qm,void 0===Dh?Object:Dh,void 0===Ym?Object:Ym,void 0===qm?Object:qm,void 0===Xm?Object:Xm])],Zm);class e_ extends Cs{init(){this._slotManagerEventBus.displaying.on((e=>{Vl.pushToQueue((()=>{e.forEach((e=>e.setTargeting({key:"refresh",value:"00"}))),e.forEach((e=>e.setTargeting({key:"nref",value:"0"})))}))})),this._slotManagerEventBus.refreshing.on((e=>{Vl.pushToQueue((()=>{for(const t of e){const e=`0${Math.min(t.refreshCount,this._maxSlotRefreshCount)}`.slice(-2);t.setTargeting({key:"refresh",value:e}),t.setTargeting({key:"nref",value:t.refreshCount.toString()})}}))}))}constructor(e){super(),this._slotManagerEventBus=e,this._maxSlotRefreshCount=4}}e_=B([hs("RefreshCountComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Vs?Object:Vs])],e_);class t_ extends nr{init(){this._key="RefreshRebuild",this._default=!0}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],t_.prototype,"run",null),t_=B([hs("RefreshRebuildExperiment"),M()],t_);class i_ extends Cs{init(){this._slotManagerEventBus.refreshing.on((e=>{e.filter(this.slotHasHighRefreshCountIncrement).forEach((e=>this._slotManager.rebuild(e)))}))}slotHasHighRefreshCountIncrement(e){return e.refreshCount%100==0}get enabled(){return this._refreshRebuildExperiment.result}constructor(e,t,i){super(),this._slotManager=e,this._refreshRebuildExperiment=t,this._slotManagerEventBus=i}}i_=B([hs("RefreshRebuildComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===id?Object:id,void 0===t_?Object:t_,void 0===Vs?Object:Vs])],i_);class s_ extends Cs{init(){Vl.pushToQueue((()=>{try{Object.keys(localStorage).filter((e=>e.startsWith("_GESPSK-"))).forEach((e=>{const t=kr.readExternalLocalStorage(e);if(t){const e=JSON.parse(t)[1];e&&"string"==typeof e&&this._googleAdManager.setTargetingFlag("ssp_len",[e.length.toString()])}}))}catch(e){}this._prebidMethods.waitForQueue().then((e=>{if(!0===e){const e=this._mapIdsToEids();window.googletag.secureSignalProviders&&window.googletag.secureSignalProviders.push({networkCode:this._config.gam.networkCode,collectorFunction:async()=>{const t=(await this.fetchAsyncSignals(e)).obfuscate();return this._googleAdManager.setTargetingFlag("ssp_len",[t.length.toString()]),t}})}}))}))}_mapIdsToEids(){return this._prebidMethods.getUserIdsAsEids().filter((e=>this._ids.includes(e.source))).map((e=>{const{id:t,ext:i}=e.uids[0];return{source:e.source,data:t,...i&&"provider"in i&&{provider:i.provider},isPubCreated:!0}}))}fetchAsyncSignals(e){return Promise.resolve({obfuscate:()=>btoa(JSON.stringify({signals:[...e,{source:"mcmp",data:this._config.marmalade.mcmp,isPubCreated:!0},{source:"sens",data:this._config.site.sensitiveCategories,isPubCreated:!0}]}))})}constructor(e,t,i){super(),this._config=e,this._prebidMethods=t,this._googleAdManager=i,this._ids=["adserver.org","flashtalking.com","neustar.biz","pubmatic.com","media.net","liveintent.indexexchange.com","openx.net","liveintent.triplelift.com"]}}s_=B([hs("SecureSignalsComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Ss?Object:Ss,void 0===Vl?Object:Vl])],s_);class r_ extends nr{init(){const e=R.resolve(Ol);this._key="SinglePageAppSupport_"+String(e.site.id),this._default=!1}}r_=B([hs("SpaMultiSiteExperiment"),M()],r_);class n_ extends nr{init(){const e=R.resolve(r_).key,t=this._coreExperimentConfig.getCoreExperiment(e);this._key=t?e:"SinglePageAppSupport";const i=R.resolve(Ol);this.setABGroup(!!this.isEnabled(),"SinglePageAppSupport"===this._key?"spa":"spa_"+String(i.site.id)),this._default=!1}isEnabled(){return!0===R.resolve(Ol).adOptions.spa&&super.isEnabled()}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",Object)],n_.prototype,"run",null),n_=B([hs("SinglePageAppManagerExperiment"),M()],n_);class a_ extends Cs{start(){this._addRouteChangeObserver(),this._setupRouteChangeListener()}get enabled(){return this._singlePageAppManagerExperiment.result}_setupRouteChangeListener(){this._spaEventBus.routeChanged.on((e=>{this._handleRouteChange().catch((e=>{te.error("SinglePageAppManagerComponent","routeChanged",e),this._isTransitioning=!1}))}))}_resetStatefulEmitters(){Y.forEach((e=>{e.resetEmitted(),e.resetOnces()}))}async _handleRouteChange(){var e,t;const i=()=>{const e=$i(document.location.href);return e&&e!==this._lastHref};if(this._isTransitioning=!0,this._config.disableAds.clear(),this._intersectionObserverManager.unobserveAll(!1),this._adInjectionMap.reset(),await vs(this._routeChangeBufferDuration),i())throw new Error("Handler canceled after route change buffer.");if(this._slotManager.removeAllElements(),this._prebidActionManager.reset(),this._prebidMethods.clearAllAuctions(),this._slotManager.destroyAll(),this._refreshPageviewKey(),os.resetTimeOrigin(),this._config.disableAds.init(),this._context.sessionKey=this._context.setSessionKey(),this._context.isFirstPageview=xi(),this._context.pageUrl=window.location.href,await this._waitForPageMutations(),i())throw new Error("Handler canceled after page settled.");this._resetStatefulEmitters(),this._config.resetDynamicAds(),null==(e=this._config.clsOptions)||e.injectedSlots.splice(0,this._config.clsOptions.injectedSlots.length),null==(t=this._config.clsOptions)||t.injectedVideoSlots.splice(0,this._config.clsOptions.injectedVideoSlots.length),this._dynamicAdsComponent.start(),this._spaEventBus.resetCompleted.emit(),this._gam.setTargetingFlag("spa_rc",["1"]),this._isTransitioning=!1}_refreshPageviewKey(){const e=this._context.pageviewKey,t=fs();return this._context.pageviewKey=t,this._gam.setTargeting({key:"pvk",value:t}),e}_addRouteChangeObserver(){if(!document.body)return void te.error("SinglePageAppManagerComponent","_addRouteChangeObserver","DOM is not ready");new MutationObserver(Fn((e=>{const t=$i(document.location.href);if(t&&this._lastHref!==t){try{this._spaEventBus.routeChanged.emit({to:t,from:this._lastHref})}catch(e){te.error("SinglePageAppManagerComponent","_addRouteChangeObserver",'Error while emitting "routeChanged" event',(e=>{let t;return t=e instanceof Error?e.message:String(e),t})(e))}this._lastHref=t}else this._isTransitioning&&this._hasPageContentMutated(e)&&(this._lastContentMutationTimestamp=Date.now())}),this._observerDebounceDuration,{leading:!0})).observe(document.body,{childList:!0,subtree:!0,attributes:!0})}async _waitForPageMutations(){try{return await ys({condition:()=>Date.now()-this._lastContentMutationTimestamp>this._observerSettledDuration})}catch(e){return}}_hasPageContentMutated(e){return e.some((e=>{const t="childList"===e.type,i=e.addedNodes.length>0||e.removedNodes.length>0,s=e.target,r=(null==s?void 0:s.id.includes("AdThrive_"))||(null==s?void 0:s.id.includes("google_ad"));return t&&i&&!r}))}constructor(e,t,i,s,r,n,a,o,l,d,c){super(),this._config=e,this._context=t,this._spaEventBus=i,this._slotManager=s,this._prebidActionManager=r,this._prebidMethods=n,this._singlePageAppManagerExperiment=a,this._dynamicAdsComponent=o,this._intersectionObserverManager=l,this._gam=d,this._adInjectionMap=c,this._routeChangeBufferDuration=500,this._observerDebounceDuration=500,this._observerSettledDuration=1e3,this._lastContentMutationTimestamp=1/0,this._lastHref=$i(document.location.href),this._isTransitioning=!1}}a_=B([hs("SinglePageAppManagerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Ns?Object:Ns,void 0===id?Object:id,void 0===ig?Object:ig,void 0===Ss?Object:Ss,void 0===n_?Object:n_,void 0===zg?Object:zg,void 0===$r?Object:$r,void 0===Vl?Object:Vl,void 0===mg?Object:mg])],a_);class o_ extends Cs{start(){window.camAddRouteObserver&&window.camAddRouteObserver()}get enabled(){return!this._singlePageAppManagerExperiment.result}constructor(e){super(),this._singlePageAppManagerExperiment=e}}o_=B([hs("CamSinglePageAppManagerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===n_?Object:n_])],o_);class l_ extends Cs{start(){this._config.site.style&&this._config.site.style.length>0?Cg(this._config.site.style):this._context.styleUrl&&(e=>{const t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.head.appendChild(t)})(this._context.styleUrl)}constructor(e,t){super(),this._config=e,this._context=t}}l_=B([hs("SiteStyleComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr])],l_);class d_ extends Cs{init(){const e=this.getReferrer();null!==e&&this._gam.setTargeting({key:"doc_ref",value:e})}getReferrer(){const e=ri(this._context.savedReferrer);return e&&e.length&&K.setLocalStorageValue("referrer",e),e}constructor(e,t){super(),this._gam=e,this._context=t}}d_=B([hs("TrafficSourceComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Vl?Object:Vl,void 0===Pr?Object:Pr])],d_);class c_ extends Cs{init(){const e=bt(K.getLocalStorageValue("utm",!0,!0,18e5),{});["utm_medium","utm_campaign","utm_session","utm_source"].forEach((t=>{const i=this._context.querystring.get(t),s=bt(i,e[t]);this._gam.setTargeting({key:t,value:s}),s&&(e[t]=s)})),K.setLocalStorageValue("utm",e)}constructor(e,t){super(),this._context=e,this._gam=t}}c_=B([hs("UTMComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Pr?Object:Pr,void 0===Vl?Object:Vl])],c_);class h_{init(e){this.setup(e)}constructor(){}}class u_{logEvents(e,t){this._logPlayerPlayEvents(e,t),this._logPlayerPauseEvents(e,t),this._logPlayerMuteEvents(e,t),this._logPlayerVolumeEvents(e,t),this._logPlayerSeekEvents(e,t)}_logPlayerPlayEvents(e,t){e.on("play",(e=>this._onPlayerPlayEvent(e,t)))}_logPlayerPauseEvents(e,t){e.on("pause",(e=>this._onPlayerPauseEvent(e,t)))}_logPlayerMuteEvents(e,t){e.on("mute",(e=>this._onPlayerMuteEvent(e,t)))}_logPlayerVolumeEvents(e,t){e.on("volume",(e=>this._onPlayerVolumeEvent(e,t)))}_logPlayerSeekEvents(e,t){e.on("seek",(e=>this._onPlayerSeekEvent(e,t)))}_onPlayerPlayEvent(e,t){"interaction"===e.playReason&&te.event("JwPlayer","play",t)}_onPlayerPauseEvent(e,t){"interaction"===e.pauseReason&&te.event("JwPlayer","pause",t)}_onPlayerMuteEvent(e,t){te.event("JwPlayer","mute",{mute:e.mute,...t})}_onPlayerVolumeEvent(e,t){}_onPlayerSeekEvent(e,t){}}u_=B([M()],u_);class p_ extends h_{get name(){return`${this._name}`}get collapsible(){return this._isCollapsible}get mediaOrPlaylistId(){return this._mediaOrPlaylistId}get playerContainer(){return this._playerContainer}get playerContainerId(){return`${this._playlistId}_${this._mediaIdCount}`}get playerElement(){return this._playerElement}get size(){return this._size}set videoAdUnit(e){this._videoAdUnit=e}get videoAdUnit(){return this._videoAdUnit}getJwBoostTargeting(){return{playerID:this._playlistId,...(this.name===_e.Video_In_Post_ClicktoPlay_SoundOn||this.name===_e.Video_Individual_Autoplay_SOff)&&{mediaID:this._playlistId}}}get transactionId(){return this._transactionId}set transactionId(e){this._transactionId=e}set userIdTargetingData(e){this._userIdTargetingData=e}get userIdTargetingData(){return this._userIdTargetingData}get vp(){return this.prerollNum<=1?this.prerollNum:this.prerollNum<=9?2:3}get retryAttempts(){return this._retryAttempts}get isPlayerType(){return this._playerType}init(){this.setup()}getDefaults(){return this._defaults}setDefaults(e){this._defaults=e}_incrementSessionPrerollAdCount(){this.prerollNum++}_incrementVideoContentPlayCount(){this._numberOfVideoContentPlayed++}setIsRunningAdPlay(e){this._isRunningAdPlay=!!this._canApplyPreloadedAdExperience()&&e}getIsRunningAdPlay(){return this._isRunningAdPlay}_createCollapsibleCollection(e){const{playerElement:t,playerContainer:i,footerElement:s,stickyElement:r,mobileHeaderSelector:n}=e;this.collapseCollection={playerInstance:this.playerInstance,playerType:this._playerType,playerState:this._state,playerContainer:i,playerElement:t,topBackgroundElement:this._topBackgroundElement,footerElement:s,stickyElement:r,closeButton:this._closeButton,forceMobile:"desktop"!==this._context.device,isMobile:this._isMobile,collapseType:this._collapseType,collapseMobileSizeType:this._collapseMobileSizeType,collapseSubType:be.BottomRight,collapseMobileSubType:this._getCollapseMobileSubType(),mobileHeaderSelector:n,collapseTimer:{timeCollapsed:0,isRunning:!1},mediaStarted:!1,desktopCollapseOnScrollUp:this._desktopCollapseOnScrollUp,mobileCollapseOnScrollUp:this._mobileCollapseOnScrollUp,hasPreviouslyCollapsed:this._hasPreviouslyCollapsed,getIsRunningAdPlay:()=>this.getIsRunningAdPlay()}}_resetAdVars(){this._bidMarkedOnCurrentAd=!1,this._adDetails=null,this._nextAdFetched=!1,this._adDurationLogged=!1,this._currentAdTime=0,this._currentAdDurationWithBuffer=0,this._pendingBidRequests.length=0,this._clearStaleTimers(),this._lastAdSuccessful=!0,this._retryAttempts=0,this._isRunningAdPlay=!1}async _handleNextAdFetch(){this._nextAdFetched||(this._incrementSessionPrerollAdCount(),this._nextAdFetched=!0,await this._fetchBids(),this._pendingBidRequests.length>0&&this._pendingBidRequests[0].then((()=>{this._fetchBids()})).catch((()=>{})))}async _checkForConsent(){const e=this._config.gdpr;!e.consentCaptured&&e.enabled&&await this.waitForConsent()}async _inViewPlayAd(){await this._checkForConsent(),await this._fetchBids(),this._triggerAdPlay()}_setPlayerVersions(){const e=new RegExp("^[0-9]+.[0-9]+.[0-9]+"),t=this.playerInstance,i=e.exec(t.version);this.jwVersion=i&&i[0],this.imaVersion=t.plugins&&t.plugins.googima&&t.plugins.googima.version}_getPlayerVersions(){return{imaSDKVersion:this.imaVersion,jwVersion:this.jwVersion}}async _fetchBids(){if(this._pendingBidRequests.length<2){const e=this.requestVideoBids([this]);e&&(this._pendingBidRequests.push(e),await e)}}_playerReady(e){this._startTearDownTimer(),this._configureQuality(),this._setPlayerVersions(),this.playerInstance.on("playlistItem",(e=>{this._handleTitleLinkWrapper(e)}))}_jwSetup(e){const t={...this._defaults,...this._baseConfig,...e};if(this.playerInstance.setup)try{this.playerInstance.setup(t),this._handleNonLinearAd(),this._setupEventListeners()}catch(e){te.error("InstreamPlayer","jwSetup","Unexpected issue while setting up JWPlayer",{playerId:this._playerId,err:e})}else te.error("InstreamPlayer","jwSetup","Unexpected issue while setting up JWPlayer",{playerId:this._playerId})}_handleNonLinearAd(){this.playerInstance.on("adImpression",(e=>{const t=Zi(e.ima,"ad")?e.ima.ad:null,i=this._getAdDetailsFromAd(t);if(i&&Zi(i,"linear")&&!1===i.linear||"nonlinear"===e.linear){this.playerInstance._nonLinearAd=!0,this.playerInstance.pause();const e=document.getElementById(`${this._playlistId}`),t=e.querySelector("div > div.jw-overlays.jw-reset");t.style.backgroundColor="black";const i=e.querySelector("div.jw-wrapper.jw-reset > div.jw-controls.jw-reset");i.style.zIndex="-1",this.playerInstance.once("adComplete",(()=>{this.playerInstance._nonLinearAd=!1,t.style.backgroundColor="transparent",i.style.zIndex="",this.playerInstance.play()}))}}))}async _handleScroll(){await this._checkForConsent(),this.collapseCollection&&(this._isFirstPlay&&!this.getIsRunningAdPlay()&&await this._fetchBids(),Pm.handleScroll(this.collapseCollection))}_handleResize(){this.collapseCollection&&Pm.handleResize(this.collapseCollection)}_handlePageVisibilityChange(e){this.collapseCollection&&Pm.handlePageVisibilityChange(e,this.collapseCollection)}_displayCloseButton(){this.collapseCollection&&Pm.displayCloseButton(this.collapseCollection)}_onCloseClick(){this.collapseCollection&&(this._saveVideoCloseState&&K.setLocalStorageValue("video_closed",!0),Pm.handleClose(this.collapseCollection,this.prerollNum))}_handleUserClick(){this.collapseCollection&&Pm.handleUserClick(this.collapseCollection)}_handleWidthBreak(e){this.collapseCollection&&Pm.handleWidthBreak(e,this.collapseCollection)}_handleVideoPlayingEvent({playerId:e,mediaIdCount:t}){e===this._playlistId&&t===this._mediaIdCount||(this.collapseCollection?Pm.handleOtherVideoPlaying(this.collapseCollection):this.playerInstance.pause(!0))}_handleTitleClick(e){this.collapseCollection.collapseTimer.firstInView&&te.event("jw-player","handleTitleClick",{timeElapsed:Date.now()-this.collapseCollection.collapseTimer.firstInView.valueOf(),link:e.currentTarget.getAttribute("href")})}_handleFooterRefreshedEvent(){this.collapseCollection&&Pm.repositionCollapseMobileBottom(this.collapseCollection)}_configureQuality(){Bt()||this.playerInstance.on("levels",(e=>{this.playerInstance.setCurrentQuality(e.levels.length-1)}))}_createPlayerCloseButton(){const e=this._wrapperTitleWrapperElement||this._videoTitleElement;return this._closeButton=this._videoCloseButtonComponent.createPlayerCloseButton(this._onCloseClick.bind(this),"instream","adthrive-collapse-close",!!e,this._isTopCollapse),this._closeButton}_createPlayerCollapseBackgroundElement(){const e=document.createElement("div");return e.classList.add("adthrive-collapse-mobile-background"),e.style.backgroundColor=this._config.adOptions.bgColor,e.style.width=`${window.innerWidth}px`,e.style.display="inline",e.style.height="0",e}_createLinkIcon(e){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","24"),t.setAttribute("height","24"),t.setAttribute("style","margin-bottom:6px");const i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d","M 16 1 H 23 V 8 Z M 19.5 12.5 V 23 H 1 V 4.5 H 12 l 1 1 H 2 V 22 H 18.5 V 11.5 l 1 1 v 1 M 19 4 L 11.5 11.5 l 1 1 L 20 5"),i.setAttribute("stroke","white"),i.setAttribute("stroke-width","2"),i.setAttribute("stroke-linejoin","round"),t.appendChild(i),t.id=`${e}-svg-link`,t}_createLearnMoreLink(e){const t=document.createElement("a");return t.classList.add("adthrive-learn-more-link"),t.innerText="Tap here to learn more.",t.style.setProperty("color",this._config.adOptions.secColor),t.id=`${e}-learn-more-link`,t}_createPlayerWrapper(e){if(e){this._wrapperTitleWrapperElement=document.createElement("a");const e=this._createLinkIcon(this._playlistId);this._wrapperTitleWrapperElement.appendChild(e)}else this._wrapperTitleWrapperElement=document.createElement("div");this._videoTitleElement=document.createElement("span"),this._videoTitleElement.id="video-title-text";const t=document.createElement("div"),i=document.createElement("div");return i.className="adthrive-wrapper-title-wrapper",this._videoTitleElement.classList.add("adthrive-video-text-cutoff"),this._videoTitleElement.classList.add("adthrive-video-title"),this._wrapperTitleWrapperElement.className="adthrive-video-text-cutoff",this._wrapperTitleWrapperElement.appendChild(this._videoTitleElement),this._wrapperTitleWrapperElement.target="_blank",this._wrapperTitleWrapperElement.onclick=this._handleTitleClick.bind(this),this._closeButton=this._createPlayerCloseButton(),i.appendChild(this._wrapperTitleWrapperElement),t.className="adthrive-wrapper-bar",t.appendChild(i),t.appendChild(this._closeButton),t}_createTopCollapseWrapper(e=!0){const t=document.createElement("div");t.className="adthrive-top-collapse-wrapper-bar",this._closeButton=this._createPlayerCloseButton();const i=document.createElement("div");i.className="adthrive-top-collapse-close-spacer",i.appendChild(this._closeButton),t.appendChild(i);const s=document.createElement("a");if(this._topCollapseVideoTitleElement=document.createElement("span"),this._topCollapseVideoTitleElement.classList.add("adthrive-top-collapse-wrapper-video-title"),this._topCollapseVideoTitleElement.style.color=this._config.adOptions.secColor,s.appendChild(this._topCollapseVideoTitleElement),e){const e=this._createLearnMoreLink(this._playlistId);s.appendChild(e),s.onclick=this._handleTitleClick.bind(this)}return t.appendChild(s),this._wrapperText=s,t}_trimEventData(e){var t,i;const s={...e},r=s.ima&&s.ima.ad&&this._getAdDetailsFromAd(s.ima.ad);return(null==s?void 0:s.tag)&&delete s.tag,r&&r.traffickingParameters&&delete r.traffickingParameters,(null==s||null==(i=s.ima)||null==(t=i.userRequestContext)?void 0:t.adTagUrl)&&delete s.ima.userRequestContext.adTagUrl,(null==s?void 0:s.mediaFile)&&delete s.mediaFile,s}_handleOneVideoContentPlaylist(){this.playerInstance.pause(),this.playerInstance.seek(0),this._adHasPlayed=!1,this.collapseCollection&&!this._canPlayPrerollAdBeforeSecondVideoContent()?this.playerInstance.play():this.playerInstance.once("firstFrame",(()=>{this._triggerAdPlay()})),this.playerInstance.trigger("firstFrame",{loadTime:0,viewable:1}),this._incrementVideoContentPlayCount()}_handleNextButton(){this._calledNextVideo=!0,this._removeSkipContainer(),this._isAdvancePlaylist&&1===this.playerInstance.getPlaylist().length?this._handleOneVideoContentPlaylist():this.playerInstance.next()}_createNavButton(e){const t=document.createElement("div"),i=document.createElement("span");return t.id=`${e}-video`,i.textContent=e,t.appendChild(i),jt(15)||jt(16)||((e=navigator.userAgent)=>ct(e)&&Bt(e))()||t.classList.add("video-box-shadow"),t}_createSkipContainer(){const e=document.createElement("div");e.id="next-stay-container";const t=this._createNavButton("next");return t.onclick=this._handleNextButton.bind(this),e.appendChild(t),e.appendChild(this._createNavButton("stay")),e}_initSkipContainer(){const e=this._canApplyAdvancePlaylistOptimizations()&&this._advancePlaylistDelayExperiment.result?this._advancePlaylistDelayExperiment.result:25,t=5+e+10,i=e+5-10;this.playerInstance.on("time",(({position:s,duration:r})=>{if(!this._canSkip||this.playerInstance._nonLinearAd||this._wasClicked||r<5)return;const n=r<t,a=n?s>=r-5:s>=e,o=n?s>=r:s>=e+5,l=n?s>=r:s>=i;if(!this._skipContainer&&l&&!this._nextAdFetched){(!this.collapseCollection||this._canPlayPrerollAdBeforeSecondVideoContent())&&this._handleNextAdFetch()}!this._skipContainer&&a?(this._skipContainer=this._createSkipContainer(),this.playerInstance.getContainer().appendChild(this._skipContainer),getComputedStyle(this._skipContainer).backgroundColor&&this._skipContainer.classList.add("loaded")):this._skipContainer&&!this._calledNextVideo&&o&&this._handleNextButton()}))}_handleVideoPlayerClicked(){this._wasClicked=!0,this._removeSkipContainer()}_removeSkipContainer(){this._skipContainer&&this._skipContainer.parentNode&&(this._skipContainer.parentNode.removeChild(this._skipContainer),this._skipContainer=void 0)}_handleFirstFrame(){this._calledNextVideo=!1,this._wasClicked=!1}_getCollapseMobileSubType(){return this._mobileStickyPlayerPositionSiteExperiment.enabled&&"control"!==this._mobileStickyPlayerPositionSiteExperiment.result?ml.setMobileLocation(this._mobileStickyPlayerPositionSiteExperiment.result):this._mobileStickyPlayerPositionCoreExperiment.mobileLocation?ml.setMobileLocation(this._mobileStickyPlayerPositionCoreExperiment.mobileLocation):this._mobileLocation}get _isTopCollapse(){return"adthrive-collapse-top-center"===this._getCollapseMobileSubType()}isTopCenterCollapse(){return this._collapseType===ve.Mobile&&this._isTopCollapse}_createTopCenterBackground(e){this._topBackgroundElement=this._createPlayerCollapseBackgroundElement(),e.appendChild(this._topBackgroundElement)}_clearStaleTimers(){this._stalePlayerTimer&&(clearTimeout(this._stalePlayerTimer),this._stalePlayerTimer=null)}_listenForLargeVastError(){this._prebidEventBus.vastExceededLimit.on((e=>{const t={meta:e.bids[0].meta,bidder:e.bids[0].bidder,adId:e.bids[0].adId,creativeId:e.bids[0].creativeId,responseSize:e.responseSize,maxSizeAllowed:e.maxSizeAllowed};te.error("JwPlayer","listenForLargeVastError",t)}))}_getErrorLogAdDetails(){return(({wrapperIds:e,wrapperCreativeIds:t,wrapperSystems:i,vastCreativeId:s,mediaFileURL:r,adId:n,adUnitName:a,adomain:o,hb_bidder:l,amznp:d,hb_pb:c,hb_crid:h,amznbid:u,hb_deal:p})=>({wrapperIds:e,wrapperCreativeIds:t,wrapperSystems:i,vastCreativeId:s,mediaFileURL:r,adId:n,adUnitName:a,adomain:o&&encodeURIComponent(o),hb_bidder:l,amznp:d,hb_pb:c,hb_crid:h,amznbid:u,hb_deal:p}))(this._adDetails||{})}_setStaleAdDetection(){const e=this._currentAdDurationWithBuffer-this._currentAdTime;this._stalePlayerTimer||(this._stalePlayerTimer=window.setTimeout((()=>{te.error("JwPlayer","stalePlayer",{message:"JwPlayer encountered an unknown error during ad play",...this._getPlayerVersions(),...this._getErrorLogAdDetails()}),-1===this._tearDownPlayerTimeout?(this._enableTearDown(),this._tearDownPlayer()):this.playerInstance.playlistItem(this.playerInstance.getPlaylistIndex())}),1e3*e))}_getJwEventLog(e){return{playerName:this._name,rawData:this._trimEventData(e)}}_tearDownPlayer(){if(this._tearDownAfterNextAd){var e;const t={adUnit:this._name,playerType:this._playerType,playerId:this._playerId,mediaId:this.mediaOrPlaylistId,state:this._state,collapseState:null==(e=this.collapseCollection)?void 0:e.playerState,vp:this.prerollNum};te.event("JwPlayer","tearDownPlayer",t),this._tearDownAfterNextAd=!1,this._tearDownTimer&&clearTimeout(this._tearDownTimer),this.playerInstance.remove(),this.setPlayerInstance(this),this._handleScroll(),this._adPlayMap=new Map,this._adHasPlayed=!1}}_enableTearDown(){this._tearDownAfterNextAd=!0}_startTearDownTimer(){const e=this._tearDownPlayerTimeout;this._canTearDown&&(this._tearDownTimer=window.setTimeout(this._enableTearDown.bind(this),e))}_disableErroredOutCreativeIds(){const e=this._config.video.creativeFailureThreshold;if(this.name&&e){this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids.forEach((t=>{var i;const s=null==(i=t.creativeId)?void 0:i.toString(),r=s&&this._erroredOutCreativeIds.get(s);r&&r>=e&&this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:t.adId})}))}}_excludedErroredOutAdIdsFromGamAuction(){if(this.name){this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids.forEach((e=>{this._erroredOutAdIds.has(e.adId)&&this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:e.adId})}))}}_handleErrors(){["adError","setupError","error"].forEach((e=>{this._bidMarkedOnCurrentAd=!1;const t="adError"===e;this.playerInstance.on(e,(i=>{if(this._clearStaleTimers(),!this._adDetails){const e="tag"in i&&i.tag||"";this._addAdDetailFields(e),this._adDetails={...this._additionalAdFields,adUnitName:this._name,tag:e,isEmpty:!0}}if(900===i.code&&this._eventProxy.emitVideoSlotRenderedEvent(this._adDetails),"setupError"===e&&this._preventCollapse(),te.error("JwPlayer",e,{code:i.code,...t&&{message:i.message,adErrorCode:i.adErrorCode},...this._getJwEventLog(i)}),t){this._checkRenderedAdDetails(!0),this._adDetails.adId&&this._erroredOutAdIds.add(this._adDetails.adId),this._lastAdSuccessful=!1,this._adPlayMap.set(this.prerollNum,!1),this.setIsRunningAdPlay(!1);const e={message:i.message,code:i.code,adErrorCode:i.adErrorCode,...this._getPlayerVersions(),...this._getErrorLogAdDetails()};te.error("JwPlayer","vastError",e),this._isSecondPreloadedAd()||this._adFailedLogic()}}))}))}_handleAdSkipped(){!this._preloadedAdsCompleted&&this._isSecondPreloadedAd()&&this._forceRunSecondPrerollAd(),this.setIsRunningAdPlay(!1)}_handleTimeEvents(){this.playerInstance.on("beforeComplete",(()=>{this._resetAdVars(),this.playerInstance._nonLinearAd=!1})),this.playerInstance.on("time",(({position:e,duration:t})=>{if(t-e<10){(!this.collapseCollection||this._canPlayPrerollAdBeforeSecondVideoContent())&&this._handleNextAdFetch()}})),this.playerInstance.on("adTime",(e=>{if(this._currentAdTime=e.position,this._config.video.logAdDuration&&!this._adDurationLogged){const t={adDuration:e.duration,roundedAdDuration:Math.round(e.duration)};te.event("VideoManager","VideoAdDuration",t),this._adDurationLogged=!0}})),this.playerInstance.on("adSkipped",(()=>this._handleAdSkipped())),this.playerInstance.on("adComplete",(()=>{this._tearDownPlayer(),!this._preloadedAdsCompleted&&this._isSecondPreloadedAd()&&this._forceRunSecondPrerollAd(),this.setIsRunningAdPlay(!1)}))}_canApplyPreloadedAdExperience(){return this._config.adOptions.optimizeVideoPlayersForEarnings}_canApplyAdvancePlaylistOptimizations(){return!this._config.featureRolloutService.isRolloutEnabled("disable-adv-playlist-optimization")}_canFetchSecondPreloadedAd(){return this._canApplyPreloadedAdExperience()&&this.collapseCollection&&0===this.prerollNum}_isSecondPreloadedAd(){return 1===this.prerollNum&&0===this._numberOfVideoContentPlayed&&this.collapseCollection&&this._canApplyPreloadedAdExperience()}_canPlayPrerollAdBeforeSecondVideoContent(){if(!this._canApplyPreloadedAdExperience()||1!==this.prerollNum)return!0;const e=this._isSecondPreloadedAd(),t=this._adPlayMap.get(0)&&this._adPlayMap.get(1);return!(e&&t)}_shouldPlayAd(){return!this.getIsRunningAdPlay()&&this._shouldPlayPrerollAds()}async _triggerAdPlay(){await this._checkForConsent(),this._shouldPlayAd()&&(this._playLinearAd(),this._isFirstPlay=!1)}_handleVideoEvents(){this.playerInstance.on("playlistItem",(({item:e})=>{var t;this._mediaOrPlaylistId=null!=(t=e.mediaid)?t:"nf",this._adHasPlayed=!1,this.getIsRunningAdPlay()||(this._isFirstPlay?this._numberOfVideoContentPlayed=0:this._incrementVideoContentPlayCount())})),["play","adPlay","pause","adSkipped","adPause"].forEach((e=>{const t="play"===e,i="adPlay"===e,s="pause"===e,r="adPause"===e,n="adSkipped"===e;this.playerInstance.on(e,(e=>{if((t||r||n)&&(this._clearStaleTimers(),r&&this.playerInstance.once("adPlay",(()=>{0!==this._currentAdTime&&this._setStaleAdDetection()}))),(t||i)&&(this._eventProxy.emitVideoPlayingEvent(this._playlistId,this._mediaIdCount),i&&this._checkRenderedAdDetails()),t||s){const t="pauseReason"in e&&e.pauseReason||"playReason"in e&&e.playReason&&!this._calledNextVideo;t&&"interaction"===t&&this._handleUserClick()}})),(t||i)&&this.collapseCollection&&this.playerInstance.once(e,(()=>{this.collapseCollection.mediaStarted=!0,this._handleScroll()}))})),this.playerInstance.on("beforePlay",(()=>{this._shouldPlayAd()&&(this.playerInstance.pause(),this._triggerAdPlay())})),document.addEventListener("slick-auth-dialog-opened",(()=>{this._playerElement.classList.add(this._hiddenClassName),this.collapseCollection&&this.playerInstance.pause()})),document.addEventListener("slick-auth-dialog-closed",(()=>{var e;this._playerElement.classList.remove(this._hiddenClassName);const t=(null==(e=this.collapseCollection)?void 0:e.playerState)!==Se.UserPauseCollapsed;this.collapseCollection&&t&&this.playerInstance.play(!0)}))}_checkRenderedAdDetails(e=!1){const t=this._prebidAuctionManager,i=this._adDetails;if("off"!==this._instreamRerequestOnErrorResult&&(this._bidMarkedOnCurrentAd=!1),!t||!i||this._bidMarkedOnCurrentAd)return;const s=i.gamCreativeId,r=i.wrapperSystems;this._markPrebidBidAsUsed(s,t,r,e)}_markPrebidBidAsUsed(e="",t,i=[],s=!1){const r=e&&t.videoCreativeIdMapping.get(e);let n=!1,a=!1,o=!1;if(i.forEach((e=>{const t=e.toLowerCase();"gdfp"===t&&(a=!0),"prebid.org wrapper"===t?n=!0:"amazon"===t&&(o=!0)})),r){const e=this._adDetails,t=(e&&e.tag&&this._getCustParamsFromQueryString(e.tag)||{})[`hb_adid_${r}`.substring(0,20)];t&&(this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:t}),this._bidMarkedOnCurrentAd=!0,s&&this._creativeFailureDetection(t),!s&&this._logCreativeIdWithPreviousError(t))}else e||(n||a&&!o||!i.length)&&(this._bidMarkedOnCurrentAd=!0,this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name}))}_creativeFailureDetection(e){const t=this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids||[];for(const i of t)if(i.adId===e&&i.creativeId){let e=this._erroredOutCreativeIds.get(i.creativeId.toString())||0;e++,this._erroredOutCreativeIds.set(i.creativeId.toString(),e);break}}_logCreativeIdWithPreviousError(e){const t=this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids||[];for(const i of t)if(i.adId===e&&i.creativeId){(this._erroredOutCreativeIds.get(i.creativeId.toString())||0)&&te.event("JWPlayer","_logCreativeIdWithPreviousError",{creativeId:i.creativeId});break}}_getCustParamsFromQueryString(e){const t=e&&Rt(e.split("?")[1]),i=t&&t.get("cust_params");return i&&Dt(this._getDecodedURI(i))}_getDecodedURI(e){try{return decodeURIComponent(e)}catch(e){return""}}_getAdDetailsFromAd(e){return e&&Object.keys(e).length>0?e[Object.keys(e)[0]]:null}async _doubleFetchSecondPreloadedAd(){this._incrementSessionPrerollAdCount(),await this._fetchBids(),await this._fetchBids()}_handleAdTrackingEvents(){this.playerInstance.on("adLoaded",(e=>{const t=e.ima&&e.ima.ad&&this._getAdDetailsFromAd(e.ima.ad),i=t&&t.duration||e.duration||this._defaultAdDuration;this._currentAdDurationWithBuffer=i+this._adTimingBuffer;const s=e.tag;t&&(this._addAdDetailFields(s),this._adDetails={...this._additionalAdFields,wrapperIds:t.adWrapperIds,gamCreativeId:t.adWrapperCreativeIds[t.adWrapperCreativeIds.length-1],gamLineItemId:t.adWrapperIds[t.adWrapperIds.length-1],wrapperCreativeIds:t.adWrapperCreativeIds,vastCreativeId:t.creativeId,mediaFileURL:t.mediaUrl,adUnitName:this._name,tag:e.tag,isEmpty:!1,wrapperSystems:t.adWrapperSystems}),this._setStaleAdDetection()})),this.playerInstance.on("adImpression",(()=>{this._lastAdSuccessful=!0,this._retryAttempts=0;const e=this._adDetails||{};this._eventProxy.emitVideoSlotRenderedEvent(e),this._canFetchSecondPreloadedAd()&&this._doubleFetchSecondPreloadedAd()})),this._config.video.logAdLifeCycle&&["adRequest","adImpression","adStarted","adViewableImpression"].forEach((e=>{this.playerInstance.on(e,(t=>{"adImpression"===e&&te.event("JwPlayer","adImpression",this._getJwEventLog(t))}))}))}_maxRetriesReached(){const e=this._maxRetries,t="vpr"===this._instreamRerequestOnErrorResult&&this.prerollNum>5,i="vpr2"===this._instreamRerequestOnErrorResult&&this._retryAttempts>=2,s=this._retryAttempts>=e;return t||i||s}_forceRunSecondPrerollAd(){this.setIsRunningAdPlay(!0),this._runAdPlay(),this._preloadedAdsCompleted=!0}async _adFailedLogic(){if(this._maxRetriesReached()||"off"===this._instreamRerequestOnErrorResult||this._lastAdSuccessful||!this._midrollBugFixExperiment.result)return this._resetAdVars(),void(!this._preloadedAdsCompleted&&this._isSecondPreloadedAd()&&this._forceRunSecondPrerollAd());this._retryAttempts+=1,this.playerInstance.pause(!0),this.playerInstance.seek(0),this._prebidMethods.getHighestCpmBids(this.name).length||await this._fetchBids(),"dbc"===this._instreamRerequestOnErrorResult&&this._excludedErroredOutAdIdsFromGamAuction(),this._runAdPlay(!1)}_addAdDetailFields(e){const t=e&&this._getCustParamsFromQueryString(e);t&&(this._additionalAdFields={adId:String(t.hb_adid),adomain:String(t.hb_adomain),hb_bidder:String(t.hb_bidder),amznp:String(t.amznp),hb_pb:String(t.hb_pb),hb_crid:String(t.hb_crid),amznbid:String(t.amznbid),hb_deal:String(t.hb_deal)})}_setupEventProxies(){if(this._collapseType===ve.Mobile){R.resolve(Ds).footerRefreshed.on(this._handleFooterRefreshedEvent.bind(this))}this._spaListeners.push(this._eventProxy.scroll.on(this._handleScroll.bind(this))),this._spaListeners.push(this._eventProxy.resize.on(this._handleResize.bind(this))),this._spaListeners.push(this._eventProxy.pageVisibility.on(this._handlePageVisibilityChange.bind(this))),this._spaListeners.push(this._eventProxy.videoPlaying.on(this._handleVideoPlayingEvent.bind(this)))}_onBeforeRequestBids(){this._prebidEventBus.beforeRequestBids.on((e=>{e.forEach((e=>{const t=e.code===this.name,i=[...this._userIdComponent.getTargetingData(),...this._sspUserSyncComponent.getTargetingData()];var s;t&&i&&(this.userIdTargetingData=i);const r=null!=(s=e.ortb2Imp&&e.ortb2Imp.ext&&e.ortb2Imp.ext.tid)?s:"";t&&r&&(this.transactionId=r)}))}))}_setupEventListeners(){this._onBeforeRequestBids(),this._handleErrors(),this._listenForLargeVastError(),this._handleTimeEvents(),this._handleVideoEvents(),this._handleAdTrackingEvents(),this._setupEventProxies(),this._listenForPlayerEventsToLog(),this.playerInstance.on("ready",this._playerReady.bind(this))}_listenForPlayerEventsToLog(){R.resolve(u_).logEvents(this.playerInstance,{mediaId:this._playlistId,siteId:this._config.site.id,playerId:this._playerId,mediaIdCount:`${this._mediaIdCount||0}`})}_preventCollapse(){Pm.disableCollapse=!0,this.collapseCollection&&Pm.uncollapse(this.collapseCollection)}async _playLinearAd(){if(this.setIsRunningAdPlay(!0),this._config.video.logAdLifeCycle&&this._isRunningAdPlay&&te.event("JwPlayer","doubleGAMRequest",{vprenum:this.prerollNum}),await this._fetchBids(),this._pendingBidRequests.length>0){const e=this._pendingBidRequests.pop();e&&e.then((()=>{this._runAdPlay()})).catch((()=>{this._adHasPlayed=!1,this._lastAdSuccessful=!1,this._adPlayMap.set(this.prerollNum,!1),this.setIsRunningAdPlay(!1)}))}}_linkProvidedByPublisher(e){return!e.startsWith("https://cdn.jwplayer.com")}_updateElementsToIncludeAnchor(){var e,t;const i=document.createElement("a");i.id="video-link",i.target="_blank",i.className="adthrive-video-text-cutoff";const s=null==(e=this._wrapperTitleWrapperElement)?void 0:e.parentNode,r=document.getElementById("video-title-text");null==(t=this._wrapperTitleWrapperElement)||t.remove(),this._wrapperTitleWrapperElement=i,r&&this._wrapperTitleWrapperElement.appendChild(r),null==s||s.appendChild(this._wrapperTitleWrapperElement)}_updateTitle(e){this._videoTitleElement&&Zi(e,"title")&&"string"==typeof e.title&&(this._videoTitleElement.innerText=e.title),this._topCollapseVideoTitleElement&&Zi(e,"title")&&"string"==typeof e.title&&(this._topCollapseVideoTitleElement.innerText=e.title)}_handleTitleLinkWrapper(e){const t=e.item,i=this._playlistId,s=document.getElementById(`${i}-learn-more-link`),r=document.getElementById(`${i}-svg-link`),n="related"===this._playerType,a="related"===this._playerType&&0===e.index,o=!n||!a,l=Zi(t,"link")&&"string"==typeof t.link&&this._linkProvidedByPublisher(t.link),d=this._wrapperTitleWrapperElement&&l&&o,c=this._wrapperText&&l&&o;this._updateTitle(t),d&&(n&&!document.getElementById("video-link")&&this._updateElementsToIncludeAnchor(),this._wrapperTitleWrapperElement.href=t.link,r||this._wrapperTitleWrapperElement.prepend(this._createLinkIcon(i))),c&&(this._wrapperText.href=t.link,s||this._wrapperText.append(this._createLearnMoreLink(i))),t&&Zi(t,"link")&&"string"==typeof t.link&&!this._linkProvidedByPublisher(t.link)&&(null==r||r.remove(),null==s||s.remove())}constructor(e,t=1,i,s,r,n,a,o,l,d=ve.Float,c,h,u,p,g,m,_,f,v,y){super(),this._playerId=e,this._mediaIdCount=t,this._playlistId=i,this._name=s,this._size=r,this._pageElement=n,this._eventProxy=a,this._config=o,this._context=l,this._collapseType=d,this._collapseMobileSizeType=c,this._prebidEventBus=h,this._prebidMethods=u,this._auctionManagers=p,this._playerType=g,this._isCollapsible=m,this._desktopCollapseOnScrollUp=_,this._mobileCollapseOnScrollUp=f,this._saveVideoCloseState=v,this._mobileLocation=y,this.type="JwPlayer",this.initialAuctionPlayer=!1,this.prerollNum=0,this.jwVersion="",this.imaVersion="",this._lastAdSuccessful=!0,this._retryAttempts=0,this._playlistMaxRetries=4,this._relatedPlayerMaxRetries=2,this._erroredOutAdIds=new Set,this._numberOfVideoContentPlayed=0,this._erroredOutCreativeIds=new Map,this.requestVideoBids=()=>{throw new Error("Request video bids not set")},this.buildVideoUrl=()=>{throw new Error("Build video url not set")},this.setPlayerInstance=()=>{throw new Error("Reset player not set")},this.waitForConsent=()=>{throw new Error("Wait for consent not set")},this.collapseCollection=null,this._defaults={},this._state=Se.Unstarted,this._nextAdFetched=!1,this._adDurationLogged=!1,this._isFirstPlay=!0,this._calledNextVideo=!1,this._wasClicked=!1,this._canSkip=!0,this._isAdvancePlaylist=!1,this._adDetails=null,this._additionalAdFields=null,this._canTearDown=!1,this._tearDownAfterNextAd=!1,this._tearDownTimer=null,this._tearDownPlayerTimeout=0,this._stalePlayerTimer=null,this._currentAdTime=0,this._currentAdDurationWithBuffer=0,this._adTimingBuffer=10,this._defaultAdDuration=30,this._autoplayBehaviorConfig={mute:!0},this._topBackgroundElement=null,this._hasPreviouslyCollapsed=!1,this._bidMarkedOnCurrentAd=!1,this._baseConfig={advertising:{adscheduleid:"DmULPHgQ",client:"googima",maxRedirects:this._config.video.maxRedirect,requestTimeout:this._config.video.jwRequestTimeout,vastLoadTimeout:this._config.video.vastTimeoutISV,vpaidmode:"insecure",vpaidcontrols:!0},generateSEOMetadata:!0,preload:"metadata"},this._spaListeners=[],this._transactionId="",this._userIdTargetingData=[],this._pendingBidRequests=[],this._adPlayMap=new Map,this._mediaOrPlaylistId="nf",this._adHasPlayed=!1,this._hiddenClassName="adthrive-hidden",this._isRunningAdPlay=!1,this._isMobile=!1,this._preloadedAdsCompleted=!1,this._shouldPlayPrerollAds=()=>!(this._adPlayMap.has(this.prerollNum)||this._midrollBugFixExperiment.result&&this._adHasPlayed),this._runAdPlay=async(e=!0)=>{await this._videoEventBus.auctionsCompleted.legacyEmit([this]),this._disableErroredOutCreativeIds();const t=this.buildVideoUrl(this);this.playerInstance._nonLinearAd=!1,this._adPlayMap.set(this.prerollNum,!0),this.playerInstance.playAd(t),e&&this._resetAdVars(),this._adHasPlayed=!0},this._isMobile="phone"===this._context.device,this._instreamRerequestOnErrorResult=R.resolve(Qa).result;if(R.resolve(Ns).routeChanged.on((()=>{this._spaListeners.forEach((e=>e())),this._spaListeners.length=0})),this._videoEventBus=R.resolve(zs),this._maxRetries=this._playerType===au.Playlist?this._playlistMaxRetries:this._relatedPlayerMaxRetries,this._prebidAuctionManager=this._auctionManagers.getPrebidAuctionManager(),this._mobileStickyPlayerPositionSiteExperiment=R.resolve(ho),this._mobileStickyPlayerPositionCoreExperiment=R.resolve(co),this._midrollBugFixExperiment=R.resolve(lo),this._advancePlaylistDelayExperiment=R.resolve(qa),this._videoCloseButtonComponent=R.resolve(bm),window.matchMedia){const e=window.matchMedia(`only screen and (max-width: ${this._config.site.breakpoints.desktop-1}px)`);e.addListener(this._handleWidthBreak.bind(this)),this._handleWidthBreak(e)}const b=this._config.video.advancePlaylist;var S;(this._isAdvancePlaylist=this._playerType===au.Playlist?b.playlistPlayer.enabled:b.relatedPlayer.enabled,this._playerType!==au.Related||this._isCollapsible&&b)&&(this._tearDownPlayerTimeout=null!=(S=R.resolve(Io).result)?S:0,this._canTearDown=0!==this._tearDownPlayerTimeout&&-1!==this._tearDownPlayerTimeout);this._userIdComponent=R.resolve(qh),this._sspUserSyncComponent=R.resolve(Jp)}}class g_ extends p_{_appendPlayer(){const e=document.createElement("div");e.id=this.playerContainerId,e.className="adthrive-jw-static-player",this._isCollapsible?(this._pageElement.id="adthrive-contextual-container",this._playerElement.className="adthrive-player-position",this._playerElement.id="adthrive-contextual-position",this.isTopCenterCollapse()&&this._createTopCenterBackground(this._pageElement),this._config.video.removeVideoTitleWrapper?this._addCloseWithoutWrapper():this.isTopCenterCollapse()?this._addTopCenterWrapper():this._addPlayerWithoutWrapper(),this._playerElement.appendChild(e),this._pageElement.appendChild(this._playerElement)):this._pageElement.appendChild(e)}setup(){if(this._isFirstPlay&&this._appendPlayer(),this.playerInstance=window.jwplayer(this.playerContainerId),this._isCollapsible){const e={playerElement:this._playerElement,playerContainer:this._pageElement,footerElement:this._config.video.footerSelector?document.querySelector(this._config.video.footerSelector):null,stickyElement:this._stickyElement,mobileHeaderSelector:this._mobileHeaderSelector||null};this._createCollapsibleCollection(e),this._playerConfig.playlist=ml.addMaxResolutionQueryParam(this._playerConfig.playlist)}this._jwSetup(this._playerConfig),this._config.video.relatedPlayerAdded=!0}_handleNextButton(){super._handleNextButton()}_playerReady(e){super._playerReady(e),this._initRelatedPlaylist();const t=this._autoplayStationaryPlayer;(t||this.collapseCollection)&&(e.viewable&&this._inViewPlayAd(),t&&this._logStationaryAutoplay()),this._isCollapsible&&this._setupCollapsible()}_logStationaryAutoplay(){this._config.video.logAdLifeCycle&&te.event("JwPlayer","StaticPlayer",{message:`Static Player set to autoplay for playlist id ${this._playlistId}`,...this._getPlayerVersions()})}_loadPlaylistPlayerVideos(){const e=this._config.video.jwPlaylistObj.playlist,{hasContentSpecificPlaylist:t,shuffle:i}=this._config.video.jwPlaylistObj;e.then((e=>{if(e.playlist&&e.playlist.length){const s=!t||i?ml.shufflePlaylist(e.playlist):e.playlist,r=this.playerInstance.getPlaylist().concat(s);this.playerInstance.once("userInactive",(()=>{var e;!(null==(e=this.collapseCollection)?void 0:e.mediaStarted)&&this._handleScroll().catch((()=>{}))})),this.playerInstance.load(r),this._handleScroll().catch((()=>!1))}})).catch((()=>!1))}_setupAllowSkip(){this._config.video.advancePlaylist.relatedPlayer.applyToFirst&&(this._canSkip=!0),this.playerInstance.once("complete",(()=>{this._canSkip=!0}))}_shouldStationaryAutoplay(){return!this._config.video.playlistPlayerAdded&&!!document.querySelector("body.adthrive-video-autoplay")}_setWrapperBar(){this._wrapperBar=this._playerElement.querySelector(".adthrive-wrapper-bar")}_hideWrapperBar(){const e=this._wrapperBar,t=this._playerElement;!this._wrapperBarRemoved&&e&&(this._wrapperBarRemoved=!0,e.parentNode&&e.parentNode.removeChild(e),this._wrapperBar=null,t.insertBefore(this._createPlayerCloseButton(),t.firstChild),this.collapseCollection&&(this.collapseCollection.closeButton=this._closeButton,this._displayCloseButton()))}_addCloseWithoutWrapper(){this._playerElement.appendChild(this._createPlayerCloseButton()),this._playerElement.classList.add("adthrive-player-without-wrapper-text")}_addTopCenterWrapper(){this._playerElement.appendChild(this._createPlayerWrapper(!1)),this._playerElement.appendChild(this._createTopCollapseWrapper(!1)),this._playerElement.classList.add("adthrive-player-with-wrapper-text")}_addPlayerWithoutWrapper(){this._playerElement.appendChild(this._createPlayerWrapper(!1)),this._playerElement.classList.add("adthrive-player-without-wrapper-text")}_initRelatedPlaylist(){this._config.video.advancePlaylist.relatedPlayer.shouldRun.then((e=>{e&&(this._loadPlaylistPlayerVideos(),this._setupAllowSkip(),this.playerInstance.on("firstFrame",(()=>this._handleFirstFrame())),this.playerInstance.getContainer().addEventListener("click",(()=>this._handleVideoPlayerClicked())),this._initSkipContainer())})).catch((()=>!1))}_setupCollapsible(){this._setWrapperBar(),this._wrapperBar&&this._wrapperBar.style.setProperty("display","flex"),this._handleResize()}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u,p,g,m,_,f,v){super(e,t,i,s,r,n,a,o,l,c,h,u,p,g,au.Related,d,m,_,undefined,f),this._mobileHeaderSelector=v,this._topBackgroundElement=null,this._playerConfig={repeat:!0,nextupoffset:-.01,playlist:`https://cdn.jwplayer.com/v2/media/${this._playlistId}`,height:"auto"},this._wrapperBarRemoved=!1,this._playerElement=document.createElement("div"),this._canSkip=!1,this._autoplayStationaryPlayer=this._shouldStationaryAutoplay(),(d||this._autoplayStationaryPlayer)&&(this._playerConfig={...this._playerConfig,...this._autoplayBehaviorConfig},this.initialAuctionPlayer=!0,this._stickyElement=null,this._playerContainer=this._pageElement)}}g_=B([hs("RelatedPlayer"),j("design:type",Function),j("design:paramtypes",[Object,Number,String,void 0===_e?Object:_e,Array,"undefined"==typeof HTMLElement?Object:HTMLElement,void 0===tu?Object:tu,void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,Boolean,void 0===ve?Object:ve,void 0===ye?Object:ye,void 0===Ms?Object:Ms,void 0===Ss?Object:Ss,void 0===ag?Object:ag,Boolean,"undefined"==typeof VideoCollapseScrollUpTopCenterExperimentVariant?Object:VideoCollapseScrollUpTopCenterExperimentVariant,"undefined"==typeof CollapseMobileSubType?Object:CollapseMobileSubType,Object])],g_);class m_ extends Cs{setPotentialPlayersMap(){const e=this._videoConfig.players||[],t=this._filterPlayerMap(),i=e.filter((e=>"stationaryRelated"===e.type&&e.enabled));return t.stationaryRelated=i,this._potentialPlayerMap=t,this._potentialPlayerMap}_filterPlayerMap(){const e=this._videoConfig.players,t={stickyRelated:[],stickyPlaylist:[],stationaryRelated:[]};return e&&e.length?e.filter((e=>{var t;return null==(t=e.devices)?void 0:t.includes(this._device)})).reduce(((e,t)=>(e[t.type]||(te.event(this._component,"constructor","Unknown Video Player Type detected",t.type),e[t.type]=[]),t.enabled&&e[t.type].push(t),e)),t):t}_checkPlayerSelectorOnPage(e){const t=this._potentialPlayerMap[e].map((e=>({player:e,playerElement:this._getPlacementElement(e)})));return t.length?t[0]:{player:null,playerElement:null}}_getOverrideElement(e,t,i){if(e&&t){const s=document.createElement("div");t.insertAdjacentElement(e.position,s),i=s}else{const{player:e,playerElement:t}=this._checkPlayerSelectorOnPage("stickyPlaylist");if(e&&t){const s=document.createElement("div");t.insertAdjacentElement(e.position,s),i=s}}return i}_shouldOverrideElement(e){const t=e.getAttribute("override-embed");return"true"===t||"false"===t?"true"===t:!!this._videoConfig.relatedSettings&&this._videoConfig.relatedSettings.overrideEmbedLocation}_checkPageSelector(e,t,i=[]){if(e&&t&&0===i.length){return!("/"===window.location.pathname)&&te.event("VideoUtils","getPlacementElement",new Error(`PSNF: ${e} does not exist on the page`)),!1}return!0}_getElementSelector(e,t,i){return t&&t.length>i?t[i]:(te.event("VideoUtils","getPlacementElement",new Error(`ESNF: ${e} does not exist on the page`)),null)}_getPlacementElement(e){const{pageSelector:t,elementSelector:i,skip:s}=e,{valid:r,elements:n,...a}=ss(t),{valid:o,elements:l,...d}=is(i);if(""!==t&&!r)return te.error("VideoUtils","getPlacementElement",new Error(`${t} is not a valid selector`),a),null;if(!o)return te.error("VideoUtils","getPlacementElement",new Error(`${i} is not a valid selector`),d),null;if(!this._checkPageSelector(t,r,n))return null;return this._getElementSelector(i,l,s)||null}_getEmbeddedPlayerType(e){let t=e.getAttribute("data-player-type");return t&&"default"!==t||(t=this._videoConfig.relatedSettings?this._videoConfig.relatedSettings.defaultPlayerType:"static"),this._stickyRelatedOnPage&&(t="static"),t}_getMediaId(e){const t=e.getAttribute("data-video-id");return!!t&&(this._relatedMediaIds.push(t),t)}_createRelatedPlayer(e,t,i,s){"collapse"===t?this._createCollapsePlayer(e,i):"static"===t&&this._createStaticPlayer(e,i,s)}_createCollapsePlayer(e,t){const{player:i,playerElement:s}=this._checkPlayerSelectorOnPage("stickyRelated"),r=i||this._potentialPlayerMap.stationaryRelated[0];if(r&&r.playerId){this._shouldOverrideElement(t)&&(t=this._getOverrideElement(i,s,t)),t=document.querySelector(`#cls-video-container-${e} > div`)||t,this._createStickyRelatedPlayer({...r,mediaId:e},t)}else te.error(this._component,"_createCollapsePlayer","No video player found")}_createStaticPlayer(e,t,i){if(this._potentialPlayerMap.stationaryRelated.length&&this._potentialPlayerMap.stationaryRelated[0].playerId){const s=this._potentialPlayerMap.stationaryRelated[0];this._createStationaryRelatedPlayer({...s,mediaOrPlaylistId:e},t,i)}else te.error(this._component,"_createStaticPlayer","No video player found")}_shouldRunAutoplayPlayers(){return!(!this._isVideoAllowedOnPage()||!this._potentialPlayerMap.stickyRelated.length&&!this._potentialPlayerMap.stickyPlaylist.length)}_determineAutoplayPlayers(){const e=this._component,t="VideoManagerComponent"===e,i=this._context;if(this._stickyRelatedOnPage)return void te.event(e,"stickyRelatedOnPage",t&&{device:i&&i.device,isDesktop:this._device}||{});const{player:s,playerElement:r}=this._checkPlayerSelectorOnPage("stickyPlaylist");s&&s.playerId&&s.playlistId&&r?this._createPlaylistPlayer(s,r):Math.random()<.01&&setTimeout((()=>{te.event(e,"noStickyPlaylist",t&&{vendor:"none",device:i&&i.device,isDesktop:this._device}||{})}),1e3)}_initializeRelatedPlayers(e){const t=new Map;for(let i=0;i<e.length;i++){const s=e[i],r=s.offsetParent,n=this._getEmbeddedPlayerType(s),a=this._getMediaId(s);if(r&&a){const e=(t.get(a)||0)+1;t.set(a,e),this._createRelatedPlayer(a,n,s,e)}}}constructor(e,t,i){super(),this._videoConfig=e,this._component=t,this._context=i,this._stickyRelatedOnPage=!1,this._relatedMediaIds=[],this._device=Bt()?"desktop":"mobile",this._potentialPlayerMap=this.setPotentialPlayersMap()}}function __(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var f_={exports:{}};!function(e){var t,i,s,r,n;t=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,n={buildAbsoluteURL:function(e,t,s){if(s=s||{},e=e.trim(),!(t=t.trim())){if(!s.alwaysNormalize)return e;var r=n.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=n.normalizePath(r.path),n.buildURLFromParts(r)}var a=n.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return s.alwaysNormalize?(a.path=n.normalizePath(a.path),n.buildURLFromParts(a)):t;var o=n.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=i.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var d={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(d.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,h=c.substring(0,c.lastIndexOf("/")+1)+a.path;d.path=n.normalizePath(h)}else d.path=o.path,a.params||(d.params=o.params,a.query||(d.query=o.query));return null===d.path&&(d.path=s.alwaysNormalize?n.normalizePath(a.path):a.path),n.buildURLFromParts(d)},parseURL:function(e){var i=t.exec(e);return i?{scheme:i[1]||"",netLoc:i[2]||"",path:i[3]||"",params:i[4]||"",query:i[5]||"",fragment:i[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(s,"");e.length!==(e=e.replace(r,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=n}(f_);var v_=f_.exports;function y_(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function b_(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?y_(Object(i),!0).forEach((function(t){S_(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):y_(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function S_(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function E_(){return E_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},E_.apply(this,arguments)}const C_=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)};let T_=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e}({}),w_=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),A_=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown",e}({});const k_=function(){},I_={trace:k_,debug:k_,log:k_,warn:k_,info:k_,error:k_};let P_=I_;function O_(e,...t){t.forEach((function(t){P_[t]=e[t]?e[t].bind(e):function(e){const t=self.console[e];return t?t.bind(self.console,`[${e}] >`):k_}(t)}))}const x_=P_,R_=/^(\d+)x(\d+)$/,D_=/(.+?)=(".*?"|.*?)(?:,|$)/g;class L_{decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const i=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)i[e]=parseInt(t.slice(2*e,2*e+2),16);return i}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){const t=R_.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const i={};for(D_.lastIndex=0;null!==(t=D_.exec(e));){let e=t[2];0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1&&(e=e.slice(1,-1));i[t[1].trim()]=e}return i}constructor(e){"string"==typeof e&&(e=L_.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&("X-"===t.substring(0,2)&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}}function M_(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}class B_{get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(C_(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&C_(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const i=t.attr;for(const t in i)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==i[t]){x_.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=E_(new L_({}),i,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=new Date(this.attr["END-DATE"]);C_(e.getTime())&&(this._endDate=e)}}}class F_{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var j_="audio",N_="video",U_="audiovideo";class V_{setByteRange(e,t){const i=e.split("@",2),s=[];1===i.length?s[0]=t?t.byteRangeEndOffset:0:s[0]=parseInt(i[1]),s[1]=parseInt(i[0])+s[0],this._byteRange=s}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=v_.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[j_]:null,[N_]:null,[U_]:null},this.baseurl=e}}class z_ extends V_{get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!C_(this.programDateTime))return null;const e=C_(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,i,s,r,n=!1){const{elementaryStreams:a}=this,o=a[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,i),o.startDTS=Math.min(o.startDTS,s),o.endDTS=Math.max(o.endDTS,r)):a[e]={startPTS:t,endPTS:i,startDTS:s,endDTS:r,partial:n}}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[j_]=null,e[N_]=null,e[U_]=null}constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new F_,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}}class $_ extends V_{get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}constructor(e,t,i,s,r){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new F_,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=s;const n=e.enumeratedString("BYTERANGE");n&&this.setByteRange(n,r),r&&(this.fragOffset=r.fragOffset+r.duration)}}class H_{reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&i>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&C_(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;if(e>0){return 1e3*(this.driftEnd-this.driftStart)/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}}function q_(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}function G_(e){const t=e.split(":");let i=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),s=e[e.length-1].split(",");if(2===s.length){const t="base64"===s[0],r=s[1];t?(e.splice(-1,1),i=q_(r)):i=function(e){const t=K_(e).subarray(0,16),i=new Uint8Array(16);return i.set(t,16-t.length),i}(r)}}return i}function K_(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(e=>e.charCodeAt(0)))}var W_={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Y_="org.w3.clearkey",Q_="com.apple.streamingkeydelivery",X_="com.microsoft.playready",J_="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function Z_(e){switch(e){case Q_:return W_.FAIRPLAY;case X_:return W_.PLAYREADY;case J_:return W_.WIDEVINE;case Y_:return W_.CLEARKEY}}var ef="edef8ba979d64acea3c827dcd51d21ed";function tf(e){switch(e){case W_.FAIRPLAY:return Q_;case W_.PLAYREADY:return X_;case W_.WIDEVINE:return J_;case W_.CLEARKEY:return Y_}}function sf(e){const{drmSystems:t,widevineLicenseUrl:i}=e,s=t?[W_.FAIRPLAY,W_.WIDEVINE,W_.PLAYREADY,W_.CLEARKEY].filter((e=>!!t[e])):[];return!s[W_.WIDEVINE]&&i&&s.push(W_.WIDEVINE),s}const rf="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function nf(e,t,i){return Uint8Array.prototype.slice?e.slice(t,i):new Uint8Array(Array.prototype.slice.call(e,t,i))}const af=(e,t)=>t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,of=(e,t)=>t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,lf=(e,t)=>{const i=t;let s=0;for(;af(e,t);){s+=10;s+=df(e,t+6),of(e,t+10)&&(s+=10),t+=s}if(s>0)return e.subarray(i,i+s)},df=(e,t)=>{let i=0;return i=(127&e[t])<<21,i|=(127&e[t+1])<<14,i|=(127&e[t+2])<<7,i|=127&e[t+3],i},cf=(e,t)=>af(e,t)&&df(e,t+6)+10<=e.length-t,hf=e=>e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info,uf=e=>{const t=String.fromCharCode(e[0],e[1],e[2],e[3]),i=df(e,4);return{type:t,size:i,data:e.subarray(10,10+i)}},pf=e=>{let t=0;const i=[];for(;af(e,t);){const s=df(e,t+6);t+=10;const r=t+s;for(;t+8<r;){const s=uf(e.subarray(t)),r=gf(s);r&&i.push(r),t+=s.size+10}of(e,t)&&(t+=10)}return i},gf=e=>"PRIV"===e.type?mf(e):"W"===e.type[0]?ff(e):_f(e),mf=e=>{if(e.size<2)return;const t=yf(e.data,!0),i=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:i.buffer}},_f=e=>{if(e.size<2)return;if("TXXX"===e.type){let t=1;const i=yf(e.data.subarray(t),!0);t+=i.length+1;const s=yf(e.data.subarray(t));return{key:e.type,info:i,data:s}}const t=yf(e.data.subarray(1));return{key:e.type,data:t}},ff=e=>{if("WXXX"===e.type){if(e.size<2)return;let t=1;const i=yf(e.data.subarray(t),!0);t+=i.length+1;const s=yf(e.data.subarray(t));return{key:e.type,info:i,data:s}}const t=yf(e.data);return{key:e.type,data:t}},vf=e=>{if(8===e.data.byteLength){const t=new Uint8Array(e.data),i=1&t[3];let s=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return s/=45,i&&(s+=47721858.84),Math.round(s)}},yf=(e,t=!1)=>{const i=Sf();if(i){const s=i.decode(e);if(t){const e=s.indexOf("\0");return-1!==e?s.substring(0,e):s}return s.replace(/\0/g,"")}const s=e.length;let r,n,a,o="",l=0;for(;l<s;){if(r=e[l++],0===r&&t)return o;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:n=e[l++],o+=String.fromCharCode((31&r)<<6|63&n);break;case 14:n=e[l++],a=e[l++],o+=String.fromCharCode((15&r)<<12|(63&n)<<6|63&a)}}return o};let bf;function Sf(){return bf||void 0===self.TextDecoder||(bf=new self.TextDecoder("utf-8")),bf}const Ef=function(e){let t="";for(let i=0;i<e.length;i++){let s=e[i].toString(16);s.length<2&&(s="0"+s),t+=s}return t},Cf=Math.pow(2,32)-1,Tf=[].push,wf={video:1,audio:2,id3:3,text:4};function Af(e){return String.fromCharCode.apply(null,e)}function kf(e,t){const i=e[t]<<8|e[t+1];return i<0?65536+i:i}function If(e,t){const i=Pf(e,t);return i<0?4294967296+i:i}function Pf(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function Of(e,t,i){e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i}function xf(e,t){const i=[];if(!t.length)return i;const s=e.byteLength;for(let r=0;r<s;){const n=If(e,r),a=n>1?r+n:s;if(Af(e.subarray(r+4,r+8))===t[0])if(1===t.length)i.push(e.subarray(r+8,a));else{const s=xf(e.subarray(r+8,a),t.slice(1));s.length&&Tf.apply(i,s)}r=a}return i}function Rf(e){const t=[],i=e[0];let s=8;const r=If(e,s);s+=4;s+=0===i?8:16,s+=2;let n=e.length+0;const a=kf(e,s);s+=2;for(let i=0;i<a;i++){let i=s;const a=If(e,i);i+=4;const o=2147483647&a;if(1===(2147483648&a)>>>31)return x_.warn("SIDX has hierarchical references (not supported)"),null;const l=If(e,i);i+=4,t.push({referenceSize:o,subsegmentDuration:l,info:{duration:l/r,start:n,end:n+o-1}}),n+=o,i+=4,s=i}return{earliestPresentationTime:0,timescale:r,version:i,referencesCount:a,references:t}}function Df(e){const t=[],i=xf(e,["moov","trak"]);for(let e=0;e<i.length;e++){const s=i[e],r=xf(s,["tkhd"])[0];if(r){let e=r[0],i=0===e?12:20;const n=If(r,i),a=xf(s,["mdia","mdhd"])[0];if(a){e=a[0],i=0===e?12:20;const r=If(a,i),o=xf(s,["mdia","hdlr"])[0];if(o){const e=Af(o.subarray(8,12)),i={soun:j_,vide:N_}[e];if(i){const e=xf(s,["mdia","minf","stbl","stsd"])[0];let a;e&&(a=Af(e.subarray(12,16))),t[n]={timescale:r,type:i},t[i]={timescale:r,id:n,codec:a}}}}}}return xf(e,["moov","mvex","trex"]).forEach((e=>{const i=If(e,4),s=t[i];s&&(s.default={duration:If(e,12),flags:If(e,20)})})),t}function Lf(e){const t=xf(e,["schm"])[0];if(t){const i=Af(t.subarray(4,8));if("cbcs"===i||"cenc"===i)return xf(e,["schi","tenc"])[0]}return x_.error("[eme] missing 'schm' box"),null}function Mf(e){const t=If(e,0);let i=8;1&t&&(i+=4),4&t&&(i+=4);let s=0;const r=If(e,4);for(let n=0;n<r;n++){if(256&t){s+=If(e,i),i+=4}512&t&&(i+=4),1024&t&&(i+=4),2048&t&&(i+=4)}return s}function Bf(e,t){const i=new Uint8Array(e.length+t.length);return i.set(e),i.set(t,e.length),i}function Ff(e,t){const i=[],s=t.samples,r=t.timescale,n=t.id;let a=!1;return xf(s,["moof"]).map((o=>{const l=o.byteOffset-8;xf(o,["traf"]).map((o=>{const d=xf(o,["tfdt"]).map((e=>{const t=e[0];let i=If(e,4);return 1===t&&(i*=Math.pow(2,32),i+=If(e,8)),i/r}))[0];return void 0!==d&&(e=d),xf(o,["tfhd"]).map((d=>{const c=If(d,4),h=16777215&If(d,0);let u=0;const p=!!(16&h);let g=0;const m=!!(32&h);let _=8;c===n&&(!!(1&h)&&(_+=8),!!(2&h)&&(_+=4),!!(8&h)&&(u=If(d,_),_+=4),p&&(g=If(d,_),_+=4),m&&(_+=4),"video"===t.type&&(a=function(e){if(!e)return!1;const t=e.indexOf("."),i=t<0?e:e.substring(0,t);return"hvc1"===i||"hev1"===i||"dvh1"===i||"dvhe"===i}(t.codec)),xf(o,["trun"]).map((n=>{const o=n[0],d=16777215&If(n,0),c=!!(1&d);let h=0;const p=!!(4&d),m=!!(256&d);let _=0;const f=!!(512&d);let v=0;const y=!!(1024&d),b=!!(2048&d);let S=0;const E=If(n,4);let C=8;c&&(h=If(n,C),C+=4),p&&(C+=4);let T=h+l;for(let l=0;l<E;l++){if(m?(_=If(n,C),C+=4):_=u,f?(v=If(n,C),C+=4):v=g,y&&(C+=4),b&&(S=0===o?If(n,C):Pf(n,C),C+=4),t.type===N_){let t=0;for(;t<v;){const n=If(s,T);if(T+=4,jf(a,s[T])){Nf(s.subarray(T,T+n),a?2:1,e+S/r,i)}T+=n,t+=n+4}}e+=_/r}})))}))}))})),i}function jf(e,t){if(e){const e=t>>1&63;return 39===e||40===e}return 6===(31&t)}function Nf(e,t,i,s){const r=Uf(e);let n=0;n+=t;let a=0,o=0,l=!1,d=0;for(;n<r.length;){a=0;do{if(n>=r.length)break;d=r[n++],a+=d}while(255===d);o=0;do{if(n>=r.length)break;d=r[n++],o+=d}while(255===d);const e=r.length-n;if(!l&&4===a&&n<r.length){l=!0;if(181===r[n++]){const e=kf(r,n);if(n+=2,49===e){const e=If(r,n);if(n+=4,1195456820===e){const e=r[n++];if(3===e){const t=r[n++],o=64&t,l=o?2+3*(31&t):0,d=new Uint8Array(l);if(o){d[0]=t;for(let e=1;e<l;e++)d[e]=r[n++]}s.push({type:e,payloadType:a,pts:i,bytes:d})}}}}}else if(5===a&&o<e){if(l=!0,o>16){const e=[];for(let t=0;t<16;t++){const i=r[n++].toString(16);e.push(1==i.length?"0"+i:i),3!==t&&5!==t&&7!==t&&9!==t||e.push("-")}const t=o-16,l=new Uint8Array(t);for(let e=0;e<t;e++)l[e]=r[n++];s.push({payloadType:a,pts:i,uuid:e.join(""),userData:yf(l),userDataBytes:l})}}else if(o<e)n+=o;else if(o>e)break}}function Uf(e){const t=e.byteLength,i=[];let s=1;for(;s<t-2;)0===e[s]&&0===e[s+1]&&3===e[s+2]?(i.push(s+2),s+=2):s++;if(0===i.length)return e;const r=t-i.length,n=new Uint8Array(r);let a=0;for(s=0;s<r;a++,s++)a===i[0]&&(a++,i.shift()),n[s]=e[a];return n}function Vf(e,t,i){if(16!==e.byteLength)throw new RangeError("Invalid system id");let s,r,n;s=0,r=new Uint8Array,n=new Uint8Array;const a=new Uint8Array(4);return i&&i.byteLength>0&&new DataView(a.buffer).setUint32(0,i.byteLength,!1),function(e,...t){const i=t.length;let s=8,r=i;for(;r--;)s+=t[r].byteLength;const n=new Uint8Array(s);for(n[0]=s>>24&255,n[1]=s>>16&255,n[2]=s>>8&255,n[3]=255&s,n.set(e,4),r=0,s=8;r<i;r++)n.set(t[r],s),s+=t[r].byteLength;return n}([112,115,115,104],new Uint8Array([0,0,0,0]),e,n,r,a,i||new Uint8Array)}let zf={};class $f{static clearKeyUriToKeyIdMap(){zf={}}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case Q_:case J_:case X_:case Y_:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof e&&("AES-128"!==this.method||this.iv||x_.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=function(e){const t=new Uint8Array(16);for(let i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t}(e);return new $f(this.method,this.uri,"identity",this.keyFormatVersions,t)}const t=G_(this.uri);if(t)switch(this.keyFormat){case J_:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case X_:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Vf(e,0,t);const i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),s=String.fromCharCode.apply(null,Array.from(i)),r=s.substring(s.indexOf("<"),s.length),n=(new DOMParser).parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(n){const e=n.childNodes[0]?n.childNodes[0].nodeValue:n.getAttribute("VALUE");if(e){const t=q_(e).subarray(0,16);!function(e){const t=function(e,t,i){const s=e[t];e[t]=e[i],e[i]=s};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(t),this.keyId=t}}break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=zf[this.uri];if(!e){const t=Object.keys(zf).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16);new DataView(e.buffer,12,4).setUint32(0,t),zf[this.uri]=e}this.keyId=e}return this}constructor(e,t,i,s=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=s,this.iv=r,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}}const Hf=/\{\$([a-zA-Z0-9-_]+)\}/g;function qf(e){return Hf.test(e)}function Gf(e,t,i){if(null!==e.variableList||e.hasVariableRefs)for(let s=i.length;s--;){const r=i[s],n=t[r];n&&(t[r]=Kf(e,n))}}function Kf(e,t){if(null!==e.variableList||e.hasVariableRefs){const i=e.variableList;return t.replace(Hf,(t=>{const s=t.substring(2,t.length-1),r=null==i?void 0:i[s];return void 0===r?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),t):r}))}return t}function Wf(e,t,i){let s,r,n=e.variableList;if(n||(e.variableList=n={}),"QUERYPARAM"in t){s=t.QUERYPARAM;try{const e=new self.URL(i).searchParams;if(!e.has(s))throw new Error(`"${s}" does not match any query parameter in URI: "${i}"`);r=e.get(s)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${t.message}`))}}else s=t.NAME,r=t.VALUE;s in n?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):n[s]=r||""}function Yf(e,t,i){const s=t.IMPORT;if(i&&s in i){let t=e.variableList;t||(e.variableList=t={}),t[s]=i[s]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${s}"`))}function Qf(){if("undefined"!=typeof self)return self.MediaSource||self.WebKitMediaSource}const Xf={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},Jf=Qf();function Zf(e,t){var i;return null!=(i=null==Jf?void 0:Jf.isTypeSupported(`${t||"video"}/mp4;codecs="${e}"`))&&i}const ev=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,tv=/#EXT-X-MEDIA:(.*)/g,iv=/^#EXT(?:INF|-X-TARGETDURATION):/m,sv=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),rv=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class nv{static findGroup(e,t){for(let i=0;i<e.length;i++){const s=e[i];if(s.id===t)return s}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let e=t.shift()+".";return e+=parseInt(t.shift()).toString(16),e+=("000"+parseInt(t.shift()).toString(16)).slice(-4),e}return e}static resolve(e,t){return v_.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return iv.test(e)}static parseMasterPlaylist(e,t){const i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:qf(e)},s=[];let r;for(ev.lastIndex=0;null!=(r=ev.exec(e));)if(r[1]){var n;const e=new L_(r[1]);Gf(i,e,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const a=Kf(i,r[2]),o={attrs:e,bitrate:e.decimalInteger("AVERAGE-BANDWIDTH")||e.decimalInteger("BANDWIDTH"),name:e.NAME,url:nv.resolve(a,t)},l=e.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),lv((e.CODECS||"").split(/[ ,]+/).filter((e=>e)),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=nv.convertAVC1ToAVCOTI(o.videoCodec)),null!=(n=o.unknownCodecs)&&n.length||s.push(o),i.levels.push(o)}else if(r[3]){const e=r[3],s=r[4];switch(e){case"SESSION-DATA":{const e=new L_(s);Gf(i,e,["DATA-ID","LANGUAGE","VALUE","URI"]);const t=e["DATA-ID"];t&&(null===i.sessionData&&(i.sessionData={}),i.sessionData[t]=e);break}case"SESSION-KEY":{const e=av(s,t,i);e.encrypted&&e.isSupported()?(null===i.sessionKeys&&(i.sessionKeys=[]),i.sessionKeys.push(e)):x_.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${s}"`);break}case"DEFINE":{const e=new L_(s);Gf(i,e,["NAME","VALUE","QUERYPARAM"]),Wf(i,e,t)}break;case"CONTENT-STEERING":{const e=new L_(s);Gf(i,e,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:nv.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":i.startTimeOffset=ov(s)}}const a=s.length>0&&s.length<i.levels.length;return i.levels=a?s:i.levels,0===i.levels.length&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,i){let s;const r={},n=i.levels,a={AUDIO:n.map((e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec}))),SUBTITLES:n.map((e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec}))),"CLOSED-CAPTIONS":[]};let o=0;for(tv.lastIndex=0;null!==(s=tv.exec(e));){const e=new L_(s[1]),n=e.TYPE;if(n){const s=a[n],l=r[n]||[];r[n]=l,Gf(i,e,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const d={attrs:e,bitrate:0,id:o++,groupId:e["GROUP-ID"]||"",instreamId:e["INSTREAM-ID"],name:e.NAME||e.LANGUAGE||"",type:n,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:e.LANGUAGE,url:e.URI?nv.resolve(e.URI,t):""};if(null!=s&&s.length){const e=nv.findGroup(s,d.groupId)||s[0];dv(d,e,"audioCodec"),dv(d,e,"textCodec")}l.push(d)}}return r}static parseLevelPlaylist(e,t,i,s,r,n){const a=new H_(t),o=a.fragments;let l,d,c,h=null,u=0,p=0,g=0,m=0,_=null,f=new z_(s,t),v=-1,y=!1;for(sv.lastIndex=0,a.m3u8=e,a.hasVariableRefs=qf(e);null!==(l=sv.exec(e));){y&&(y=!1,f=new z_(s,t),f.start=g,f.sn=u,f.cc=m,f.level=i,h&&(f.initSegment=h,f.rawProgramDateTime=h.rawProgramDateTime,h.rawProgramDateTime=null));const e=l[1];if(e){f.duration=parseFloat(e);const t=(" "+l[2]).slice(1);f.title=t||null,f.tagList.push(t?["INF",e,t]:["INF",e])}else if(l[3]){if(C_(f.duration)){f.start=g,c&&uv(f,c,a),f.sn=u,f.level=i,f.cc=m,f.urlId=r,o.push(f);const e=(" "+l[3]).slice(1);f.relurl=Kf(a,e),cv(f,_),_=f,g+=f.duration,u++,p=0,y=!0}}else if(l[4]){const e=(" "+l[4]).slice(1);_?f.setByteRange(e,_):f.setByteRange(e)}else if(l[5])f.rawProgramDateTime=(" "+l[5]).slice(1),f.tagList.push(["PROGRAM-DATE-TIME",f.rawProgramDateTime]),-1===v&&(v=o.length);else{if(l=l[0].match(rv),!l){x_.warn("No matches on slow regex match for level playlist!");continue}for(d=1;d<l.length&&void 0===l[d];d++);const e=(" "+l[d]).slice(1),r=(" "+l[d+1]).slice(1),g=l[d+2]?(" "+l[d+2]).slice(1):"";switch(e){case"PLAYLIST-TYPE":a.type=r.toUpperCase();break;case"MEDIA-SEQUENCE":u=a.startSN=parseInt(r);break;case"SKIP":{const e=new L_(r);Gf(a,e,["RECENTLY-REMOVED-DATERANGES"]);const t=e.decimalInteger("SKIPPED-SEGMENTS");if(C_(t)){a.skippedSegments=t;for(let e=t;e--;)o.unshift(null);u+=t}const i=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");i&&(a.recentlyRemovedDateranges=i.split("\t"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(r),1);break;case"VERSION":a.version=parseInt(r);break;case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(r||g)&&f.tagList.push(g?[r,g]:[r]);break;case"DISCONTINUITY":m++,f.tagList.push(["DIS"]);break;case"GAP":f.gap=!0,f.tagList.push([e]);break;case"BITRATE":f.tagList.push([e,r]);break;case"DATERANGE":{const e=new L_(r);Gf(a,e,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Gf(a,e,e.clientAttrs);const t=new B_(e,a.dateRanges[e.ID]);t.isValid||a.skippedSegments?a.dateRanges[t.id]=t:x_.warn(`Ignoring invalid DATERANGE tag: "${r}"`),f.tagList.push(["EXT-X-DATERANGE",r]);break}case"DEFINE":{const e=new L_(r);Gf(a,e,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in e?Yf(a,e,n):Wf(a,e,t)}break;case"DISCONTINUITY-SEQUENCE":m=parseInt(r);break;case"KEY":{const e=av(r,t,a);if(e.isSupported()){if("NONE"===e.method){c=void 0;break}c||(c={}),c[e.keyFormat]&&(c=E_({},c)),c[e.keyFormat]=e}else x_.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${r}"`);break}case"START":a.startTimeOffset=ov(r);break;case"MAP":{const e=new L_(r);if(Gf(a,e,["BYTERANGE","URI"]),f.duration){const r=new z_(s,t);hv(r,e,i,c),h=r,f.initSegment=h,h.rawProgramDateTime&&!f.rawProgramDateTime&&(f.rawProgramDateTime=h.rawProgramDateTime)}else hv(f,e,i,c),h=f,y=!0;break}case"SERVER-CONTROL":{const e=new L_(r);a.canBlockReload=e.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=e.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&e.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=e.optionalFloat("PART-HOLD-BACK",0),a.holdBack=e.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const e=new L_(r);a.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=a.partList;e||(e=a.partList=[]);const i=p>0?e[e.length-1]:void 0,s=p++,n=new L_(r);Gf(a,n,["BYTERANGE","URI"]);const o=new $_(n,f,t,s,i);e.push(o),f.duration+=o.duration;break}case"PRELOAD-HINT":{const e=new L_(r);Gf(a,e,["URI"]),a.preloadHint=e;break}case"RENDITION-REPORT":{const e=new L_(r);Gf(a,e,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(e);break}default:x_.warn(`line parsed but not handled: ${l}`)}}}_&&!_.relurl?(o.pop(),g-=_.duration,a.partList&&(a.fragmentHint=_)):a.partList&&(cv(f,_),f.cc=m,a.fragmentHint=f,c&&uv(f,c,a));const b=o.length,S=o[0],E=o[b-1];if(g+=a.skippedSegments*a.targetduration,g>0&&b&&E){a.averagetargetduration=g/b;const e=E.sn;a.endSN="initSegment"!==e?e:0,a.live||(E.endList=!0),S&&(a.startCC=S.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(g+=a.fragmentHint.duration),a.totalduration=g,a.endCC=m,v>0&&function(e,t){let i=e[t];for(let s=t;s--;){const t=e[s];if(!t)return;t.programDateTime=i.programDateTime-1e3*t.duration,i=t}}(o,v),a}}function av(e,t,i){var s,r;const n=new L_(e);Gf(i,n,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=null!=(s=n.METHOD)?s:"",o=n.URI,l=n.hexadecimalInteger("IV"),d=n.KEYFORMATVERSIONS,c=null!=(r=n.KEYFORMAT)?r:"identity";o&&n.IV&&!l&&x_.error(`Invalid IV: ${n.IV}`);const h=o?nv.resolve(o,t):"",u=(d||"1").split("/").map(Number).filter(Number.isFinite);return new $f(a,h,c,u,l)}function ov(e){const t=new L_(e).decimalFloatingPoint("TIME-OFFSET");return C_(t)?t:null}function lv(e,t){["video","audio","text"].forEach((i=>{const s=e.filter((e=>function(e,t){const i=Xf[t];return!!i&&!0===i[e.slice(0,4)]}(e,i)));if(s.length){const r=s.filter((e=>0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)));t[`${i}Codec`]=r.length>0?r[0]:s[0],e=e.filter((e=>-1===s.indexOf(e)))}})),t.unknownCodecs=e}function dv(e,t,i){const s=t[i];s&&(e[i]=s)}function cv(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),C_(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function hv(e,t,i,s){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=i,e.sn="initSegment",s&&(e.levelkeys=s),e.initSegment=null}function uv(e,t,i){e.levelkeys=t;const{encryptedFragments:s}=i;s.length&&s[s.length-1].levelkeys===t||!Object.keys(t).some((e=>t[e].isCommonEncryption))||s.push(e)}var pv="manifest",gv="level",mv="audioTrack",_v="subtitleTrack",fv="main",vv="audio",yv="subtitle";function bv(e){const{type:t}=e;switch(t){case mv:return vv;case _v:return yv;default:return fv}}function Sv(e,t){let i=e.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i}class Ev{startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.LEVEL_LOADING,this.onLevelLoading,this),e.on(T_.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(T_.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.LEVEL_LOADING,this.onLevelLoading,this),e.off(T_.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(T_.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,i=t.pLoader,s=t.loader,r=new(i||s)(t);return this.loaders[e.type]=r,r}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:pv,url:i,deliveryDirectives:null})}onLevelLoading(e,t){const{id:i,level:s,url:r,deliveryDirectives:n}=t;this.load({id:i,level:s,responseType:"text",type:gv,url:r,deliveryDirectives:n})}onAudioTrackLoading(e,t){const{id:i,groupId:s,url:r,deliveryDirectives:n}=t;this.load({id:i,groupId:s,level:null,responseType:"text",type:mv,url:r,deliveryDirectives:n})}onSubtitleTrackLoading(e,t){const{id:i,groupId:s,url:r,deliveryDirectives:n}=t;this.load({id:i,groupId:s,level:null,responseType:"text",type:_v,url:r,deliveryDirectives:n})}load(e){var t;const i=this.hls.config;let s,r=this.getInternalLoader(e);if(r){const t=r.context;if(t&&t.url===e.url)return void x_.trace("[playlist-loader]: playlist request ongoing");x_.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}if(s=e.type===pv?i.manifestLoadPolicy.default:E_({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),null!=(t=e.deliveryDirectives)&&t.part){let t;if(e.type===gv&&null!==e.level?t=this.hls.levels[e.level].details:e.type===mv&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===_v&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,i=t.targetduration;if(e&&i){const t=1e3*Math.max(3*e,.8*i);s=E_({},s,{maxTimeToFirstByteMs:Math.min(t,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,s.maxTimeToFirstByteMs)})}}}const n=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:n.maxNumRetry||0,retryDelay:n.retryDelayMs||0,maxRetryDelay:n.maxRetryDelayMs||0},o={onSuccess:(e,t,i,s)=>{const r=this.getInternalLoader(i);this.resetInternalLoader(i.type);const n=e.data;0===n.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),nv.isMediaPlaylist(n)?this.handleTrackOrLevelPlaylist(e,t,i,s||null,r):this.handleMasterPlaylist(e,t,i,s)):this.handleManifestParsingError(e,i,new Error("no EXTM3U delimiter"),s||null,t)},onError:(e,t,i,s)=>{this.handleNetworkError(t,i,!1,e,s)},onTimeout:(e,t,i)=>{this.handleNetworkError(t,i,!0,void 0,e)}};r.load(e,a,o)}handleMasterPlaylist(e,t,i,s){const r=this.hls,n=e.data,a=Sv(e,i),o=nv.parseMasterPlaylist(n,a);if(o.playlistParsingError)return void this.handleManifestParsingError(e,i,o.playlistParsingError,s,t);const{contentSteering:l,levels:d,sessionData:c,sessionKeys:h,startTimeOffset:u,variableList:p}=o;this.variableList=p;const{AUDIO:g=[],SUBTITLES:m,"CLOSED-CAPTIONS":_}=nv.parseMasterPlaylistMedia(n,a,o);if(g.length){g.some((e=>!e.url))||!d[0].audioCodec||d[0].attrs.AUDIO||(x_.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new L_({}),bitrate:0,url:""}))}r.trigger(T_.MANIFEST_LOADED,{levels:d,audioTracks:g,subtitles:m,captions:_,contentSteering:l,url:a,stats:t,networkDetails:s,sessionData:c,sessionKeys:h,startTimeOffset:u,variableList:p})}handleTrackOrLevelPlaylist(e,t,i,s,r){const n=this.hls,{id:a,level:o,type:l}=i,d=Sv(e,i),c=C_(a)?a:0,h=C_(o)?o:c,u=bv(i),p=nv.parseLevelPlaylist(e.data,d,h,u,c,this.variableList);if(l===pv){const e={attrs:new L_({}),bitrate:0,details:p,name:"",url:d};n.trigger(T_.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:d,stats:t,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=p,this.handlePlaylistLoaded(p,e,t,i,s,r)}handleManifestParsingError(e,t,i,s,r){this.hls.trigger(T_.ERROR,{type:w_.NETWORK_ERROR,details:A_.MANIFEST_PARSING_ERROR,fatal:t.type===pv,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:s,stats:r})}handleNetworkError(e,t,i=!1,s,r){let n=`A network ${i?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===gv?n+=`: ${e.level} id: ${e.id}`:e.type!==mv&&e.type!==_v||(n+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(n);x_.warn(`[playlist-loader]: ${n}`);let o=A_.UNKNOWN,l=!1;const d=this.getInternalLoader(e);switch(e.type){case pv:o=i?A_.MANIFEST_LOAD_TIMEOUT:A_.MANIFEST_LOAD_ERROR,l=!0;break;case gv:o=i?A_.LEVEL_LOAD_TIMEOUT:A_.LEVEL_LOAD_ERROR,l=!1;break;case mv:o=i?A_.AUDIO_TRACK_LOAD_TIMEOUT:A_.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case _v:o=i?A_.SUBTITLE_TRACK_LOAD_TIMEOUT:A_.SUBTITLE_LOAD_ERROR,l=!1}d&&this.resetInternalLoader(e.type);const c={type:w_.NETWORK_ERROR,details:o,fatal:l,url:e.url,loader:d,context:e,error:a,networkDetails:t,stats:r};if(s){const i=(null==t?void 0:t.url)||e.url;c.response=b_({url:i,data:void 0},s)}this.hls.trigger(T_.ERROR,c)}handlePlaylistLoaded(e,t,i,s,r,n){const a=this.hls,{type:o,level:l,id:d,groupId:c,deliveryDirectives:h}=s,u=Sv(t,s),p=bv(s),g="number"==typeof s.level&&p===fv?l:void 0;if(!e.fragments.length){const e=new Error("No Segments found in Playlist");return void a.trigger(T_.ERROR,{type:w_.NETWORK_ERROR,details:A_.LEVEL_EMPTY_ERROR,fatal:!1,url:u,error:e,reason:e.message,response:t,context:s,level:g,parent:p,networkDetails:r,stats:i})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const m=e.playlistParsingError;if(m)a.trigger(T_.ERROR,{type:w_.NETWORK_ERROR,details:A_.LEVEL_PARSING_ERROR,fatal:!1,url:u,error:m,reason:m.message,response:t,context:s,level:g,parent:p,networkDetails:r,stats:i});else switch(e.live&&n&&(n.getCacheAge&&(e.ageHeader=n.getCacheAge()||0),n.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),o){case pv:case gv:a.trigger(T_.LEVEL_LOADED,{details:e,level:g||0,id:d||0,stats:i,networkDetails:r,deliveryDirectives:h});break;case mv:a.trigger(T_.AUDIO_TRACK_LOADED,{details:e,id:d||0,groupId:c||"",stats:i,networkDetails:r,deliveryDirectives:h});break;case _v:a.trigger(T_.SUBTITLE_TRACK_LOADED,{details:e,id:d||0,groupId:c||"",stats:i,networkDetails:r,deliveryDirectives:h})}}constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}}function Cv(e,t){let i;try{i=new Event("addtrack")}catch(e){i=document.createEvent("Event"),i.initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)}function Tv(e,t){const i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(i){x_.debug(`[texttrack-utils]: ${i}`);try{const i=new self.TextTrackCue(t.startTime,t.endTime,t.text);i.id=t.id,e.addCue(i)}catch(e){x_.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}"disabled"===i&&(e.mode=i)}function wv(e){const t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let t=e.cues.length;t--;)e.removeCue(e.cues[t]);"disabled"===t&&(e.mode=t)}function Av(e,t,i,s){const r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length>0){const r=function(e,t,i){const s=[],r=function(e,t){if(t<e[0].startTime)return 0;const i=e.length-1;if(t>e[i].endTime)return-1;let s=0,r=i;for(;s<=r;){const n=Math.floor((r+s)/2);if(t<e[n].startTime)r=n-1;else{if(!(t>e[n].startTime&&s<i))return n;s=n+1}}return e[s].startTime-t<t-e[r].startTime?s:r}(e,t);if(r>-1)for(let n=r,a=e.length;n<a;n++){const r=e[n];if(r.startTime>=t&&r.endTime<=i)s.push(r);else if(r.startTime>i)return s}return s}(e.cues,t,i);for(let t=0;t<r.length;t++)s&&!s(r[t])||e.removeCue(r[t])}"disabled"===r&&(e.mode=r)}var kv="org.id3",Iv="com.apple.quicktime.HLS",Pv="https://aomedia.org/emsg/ID3";function Ov(){if("undefined"!=typeof self)return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const xv=(()=>{const e=Ov();try{new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Rv(e,t){return e.getTime()/1e3-t}class Dv{destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(T_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T_.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(T_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T_.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(wv(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const i=e[t];if("metadata"===i.kind&&"id3"===i.label)return Cv(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:s}}}=this;if(!i&&!s)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const n=Ov();for(let e=0;e<r.length;e++){const t=r[e].type;if(t===Pv&&!i||!s)continue;const a=pf(r[e].data);if(a){const i=r[e].pts;let s=i+r[e].duration;s>xv&&(s=xv);s-i<=0&&(s=i+.25);for(let e=0;e<a.length;e++){const r=a[e];if(!hf(r)){this.updateId3CueEnds(i,t);const e=new n(i,s,"");e.value=r,t&&(e.type=t),this.id3Track.addCue(e)}}}}}updateId3CueEnds(e,t){var i;const s=null==(i=this.id3Track)?void 0:i.cues;if(s)for(let i=s.length;i--;){const r=s[i];r.type===t&&r.startTime<e&&r.endTime===xv&&(r.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:s}){const{id3Track:r,hls:n}=this;if(!n)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:o}}=n;if(r&&(a||o)){let e;e="audio"===s?e=>e.type===kv&&o:"video"===s?e=>e.type===Pv&&a:e=>e.type===kv&&o||e.type===Pv&&a,Av(r,t,i,e)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:i,id3Track:s}=this,{dateRanges:r}=t,n=Object.keys(r);if(s){const e=Object.keys(i).filter((e=>!n.includes(e)));for(let t=e.length;t--;){const r=e[t];Object.keys(i[r].cues).forEach((e=>{s.removeCue(i[r].cues[e])})),delete i[r]}}const a=t.fragments[t.fragments.length-1];if(0===n.length||!C_(null==a?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=a.programDateTime/1e3-a.start,l=Ov();for(let e=0;e<n.length;e++){const t=n[e],s=r[t],a=i[t],h=(null==a?void 0:a.cues)||{};let u=(null==a?void 0:a.durationKnown)||!1;const p=Rv(s.startDate,o);let g=xv;const m=s.endDate;if(m)g=Rv(m,o),u=!0;else if(s.endOnNext&&!u){const e=n.reduce(((e,t)=>{const i=r[t];return i.class===s.class&&i.id!==t&&i.startDate>s.startDate&&e.push(i),e}),[]).sort(((e,t)=>e.startDate.getTime()-t.startDate.getTime()))[0];e&&(g=Rv(e.startDate,o),u=!0)}const _=Object.keys(s.attr);for(let e=0;e<_.length;e++){const i=_[e];if("ID"===(c=i)||"CLASS"===c||"START-DATE"===c||"DURATION"===c||"END-DATE"===c||"END-ON-NEXT"===c)continue;let r=h[i];if(r)u&&!a.durationKnown&&(r.endTime=g);else{let e=s.attr[i];r=new l(p,g,""),M_(i)&&(d=e,e=Uint8Array.from(d.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),r.value={key:i,data:e},r.type=Iv,r.id=t,this.id3Track.addCue(r),h[i]=r}}i[t]={cues:h,dateRange:s,durationKnown:u}}var d,c}constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}}class Lv{get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(null===e)return null;const{holdBack:t,partHoldBack:i,targetduration:s}=e,{liveSyncDuration:r,liveSyncDurationCount:n,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let l=a&&i||t;(o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==r?r:n*s);const d=s;return l+Math.min(1*this.stallCount,d)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,i=this.levelDetails;if(null===e||null===t||null===i)return null;const s=i.edge,r=e-t-this.edgeStalled,n=s-i.totalduration,a=s-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(n,r),a)}get drift(){const{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(T_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(T_.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(T_.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(T_.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(T_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(T_.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(T_.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(T_.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var i;t.details===A_.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(i=this.levelDetails)&&i.live&&x_.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const i=this.computeLatency();if(null===i)return;this._latency=i;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:r}=this.config;if(!s||1===r)return;const n=this.targetLatency;if(null===n)return;const a=i-n,o=a<Math.min(this.maxLatency,n+t.targetduration);if(t.live&&o&&a>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,r)),i=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(t,Math.max(1,i))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}}const Mv=["NONE","TYPE-0","TYPE-1",null];var Bv="",Fv="YES",jv="v2";class Nv{addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}}class Uv{get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return null==(e=this.audioGroupIds)?void 0:e[this.urlId]}get textGroupId(){var e;return null==(e=this.textGroupIds)?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter((e=>e)).join(",").replace(/\.[^.,]+/g,"")}}function Vv(e,t){const i=t.startPTS;if(C_(i)){let s,r=0;t.sn>e.sn?(r=i-e.start,s=e):(r=e.start-i,s=t),s.duration!==r&&(s.duration=r)}else if(t.sn>e.sn){e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration}else t.start=Math.max(e.start-t.duration,0)}function zv(e,t,i,s,r,n){s-i<=0&&(x_.warn("Fragment should have a positive duration",t),s=i+t.duration,n=r+t.duration);let a=i,o=s;const l=t.startPTS,d=t.endPTS;if(C_(l)){const e=Math.abs(l-i);C_(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,a=Math.max(i,l),i=Math.min(i,l),r=Math.min(r,t.startDTS),o=Math.min(s,d),s=Math.max(s,d),n=Math.max(n,t.endDTS)}const c=i-t.start;0!==t.start&&(t.start=i),t.duration=s-t.start,t.startPTS=i,t.maxStartPTS=a,t.startDTS=r,t.endPTS=s,t.minEndPTS=o,t.endDTS=n;const h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;let u;const p=h-e.startSN,g=e.fragments;for(g[p]=t,u=p;u>0;u--)Vv(g[u],g[u-1]);for(u=p;u<g.length-1;u++)Vv(g[u],g[u+1]);return e.fragmentHint&&Vv(g[g.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,c}function $v(e,t){let i=null;const s=e.fragments;for(let e=s.length-1;e>=0;e--){const t=s[e].initSegment;if(t){i=t;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;let r,n=0;if(function(e,t,i){const s=t.skippedSegments,r=Math.max(e.startSN,t.startSN)-t.startSN,n=(e.fragmentHint?1:0)+(s?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let e=r;e<=n;e++){const r=l[a+e];let n=o[e];s&&!n&&e<s&&(n=t.fragments[e]=r),r&&n&&i(r,n)}}(e,t,((e,s)=>{e.relurl&&(n=e.cc-s.cc),C_(e.startPTS)&&C_(e.endPTS)&&(s.start=s.startPTS=e.startPTS,s.startDTS=e.startDTS,s.maxStartPTS=e.maxStartPTS,s.endPTS=e.endPTS,s.endDTS=e.endDTS,s.minEndPTS=e.minEndPTS,s.duration=e.endPTS-e.startPTS,s.duration&&(r=s),t.PTSKnown=t.alignedSliding=!0),s.elementaryStreams=e.elementaryStreams,s.loader=e.loader,s.stats=e.stats,s.urlId=e.urlId,e.initSegment&&(s.initSegment=e.initSegment,i=e.initSegment)})),i){(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach((e=>{var t;e.initSegment&&e.initSegment.relurl!==(null==(t=i)?void 0:t.relurl)||(e.initSegment=i)}))}if(t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some((e=>!e)),t.deltaUpdateFailed){x_.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=function(e,t,i){const s=E_({},e);i&&i.forEach((e=>{delete s[e]}));return Object.keys(t).forEach((e=>{const i=new B_(t[e].attr,s[e]);i.isValid?s[e]=i:x_.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[e].attr)}"`)})),s}(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));const a=t.fragments;if(n){x_.warn("discontinuity sliding from playlist, take drift into account");for(let e=0;e<a.length;e++)a[e].cc+=n}t.skippedSegments&&(t.startCC=t.fragments[0].cc),function(e,t,i){if(e&&t){let s=0;for(let r=0,n=e.length;r<=n;r++){const n=e[r],a=t[r+s];n&&a&&n.index===a.index&&n.fragment.sn===a.fragment.sn?i(n,a):s--}}}(e.partList,t.partList,((e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),r?zv(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):Hv(e,t),a.length&&(t.totalduration=t.edge-a[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const o=t.advancedDateTime;if(t.advanced&&o){const e=t.edge;t.driftStart||(t.driftStartTime=o,t.driftStart=e),t.driftEndTime=o,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function Hv(e,t){const i=t.startSN+t.skippedSegments-e.startSN,s=e.fragments;i<0||i>=s.length||qv(t,s[i].start)}function qv(e,t){if(t){const i=e.fragments;for(let s=e.skippedSegments;s<i.length;s++)i[s].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function Gv(e,t,i){var s;return null!=e&&e.details?Kv(null==(s=e.details)?void 0:s.partList,t,i):null}function Kv(e,t,i){if(e)for(let s=e.length;s--;){const r=e[s];if(r.index===i&&r.fragment.sn===t)return r}return null}function Wv(e){switch(e.details){case A_.FRAG_LOAD_TIMEOUT:case A_.KEY_LOAD_TIMEOUT:case A_.LEVEL_LOAD_TIMEOUT:case A_.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Yv(e,t){const i=Wv(t);return e.default[(i?"timeout":"error")+"Retry"]}function Qv(e,t){const i="linear"===e.backoff?1:Math.pow(2,t);return Math.min(i*e.retryDelayMs,e.maxRetryDelayMs)}function Xv(e){return b_(b_({},e),{errorRetry:null,timeoutRetry:null})}function Jv(e,t,i,s){return!!e&&t<e.maxNumRetry&&(function(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}(s)||!!i)}const Zv={search:function(e,t){let i=0,s=e.length-1,r=null,n=null;for(;i<=s;){r=(i+s)/2|0,n=e[r];const a=t(n);if(a>0)i=r+1;else{if(!(a<0))return n;s=r-1}}return null}};function ey(e,t,i=0,s=0){let r=null;if(e?r=t[e.sn-t[0].sn+1]||null:0===i&&0===t[0].start&&(r=t[0]),r&&0===ty(i,s,r))return r;const n=Zv.search(t,ty.bind(null,i,s));return!n||n===e&&r?r:n}function ty(e=0,t=0,i){if(i.start<=e&&i.start+i.duration>e)return 0;const s=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-s<=e?1:i.start-s>e&&i.start?-1:0}function iy(e,t,i){const s=1e3*Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-s>e}var sy=0,ry=2,ny=5,ay=0,oy=1,ly=2;function dy(e,t,i){if(performance.now()-e.lastErrorPerfMs>3e5)return!0;const s=e.details;if(t.details===A_.FRAG_GAP&&s&&t.frag){const e=t.frag.start,i=ey(null,s.fragments,e);if(i&&!i.gap)return!0}if(i&&e.errors.length<i.errors.length){const i=e.errors[e.errors.length-1];if(s&&i.frag&&t.frag&&Math.abs(i.frag.start-t.frag.start)>3*s.targetduration)return!0}return!1}class cy{destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const i=null==t?void 0:t.renditionReports;if(i){let s=-1;for(let r=0;r<i.length;r++){const n=i[r];let a;try{a=new self.URL(n.URI,t.url).href}catch(e){x_.warn(`Could not construct new URL for Rendition Report: ${e}`),a=n.URI||""}if(a===e){s=r;break}a===e.substring(0,a.length)&&(s=r)}if(-1!==s){const e=i[s],r=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let n=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);n>=0&&e>t.partTarget&&(n+=1)}return new Nv(r,n>=0?n:void 0,Bv)}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,i){const{details:s,stats:r}=t,n=self.performance.now(),a=r.loading.first?Math.max(0,n-r.loading.first):0;if(s.advancedDateTime=Date.now()-a,s.live||null!=i&&i.live){if(s.reloaded(i),i&&this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),i&&s.fragments.length>0&&$v(i,s),!this.canLoad||!s.live)return;let a,o,l;if(s.canBlockReload&&s.endSN&&s.advanced){const e=this.hls.config.lowLatencyMode,r=s.lastPartSn,n=s.endSN,d=s.lastPartIndex,c=r===n;-1!==d?(o=c?n+1:r,l=c?e?0:d:d+1):o=n+1;const h=s.age,u=h+s.ageHeader;let p=Math.min(u-s.partTarget,1.5*s.targetduration);if(p>0){if(i&&p>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${p} with playlist age: ${s.age}`),p=0;else{const e=Math.floor(p/s.targetduration);if(o+=e,void 0!==l){l+=Math.round(p%s.targetduration/s.partTarget)}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${h.toFixed(2)}s goal: ${p} skip sn ${e} to part ${l}`)}s.tuneInGoal=p}if(a=this.getDeliveryDirectives(s,t.deliveryDirectives,o,l),e||!c)return void this.loadPlaylist(a)}else(s.canBlockReload||s.canSkipUntil)&&(a=this.getDeliveryDirectives(s,t.deliveryDirectives,o,l));const d=this.hls.mainForwardBufferInfo,c=d?d.end-d.len:0,h=function(e,t=1/0){let i=1e3*e.targetduration;if(e.updated){const s=e.fragments,r=4;if(s.length&&i*r>t){const e=1e3*s[s.length-1].duration;e<i&&(i=e)}}else i/=2;return Math.round(i)}(s,1e3*(s.edge-c));s.updated&&n>this.requestScheduled+h&&(this.requestScheduled=r.loading.start),void 0!==o&&s.canBlockReload?this.requestScheduled=r.loading.first+h-(1e3*s.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+h<n?this.requestScheduled=n:this.requestScheduled-n<=0&&(this.requestScheduled+=h);let u=this.requestScheduled-n;u=Math.max(0,u),this.log(`reload live playlist ${e} in ${Math.round(u)} ms`),this.timer=self.setTimeout((()=>this.loadPlaylist(a)),u)}else this.clearTimer()}getDeliveryDirectives(e,t,i,s){let r=function(e,t){const{canSkipUntil:i,canSkipDateRanges:s,endSN:r}=e;return i&&(void 0!==t?t-r:0)<i?s?jv:Fv:Bv}(e,i);return null!=t&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,s=t.part,r=Bv),new Nv(i,s,r)}checkRetry(e){const t=e.details,i=Wv(e),s=e.errorAction,{action:r,retryCount:n=0,retryConfig:a}=s||{},o=!!s&&!!a&&(r===ny||!s.resolved&&r===ry);if(o){var l;if(this.requestScheduled=-1,n>=a.maxNumRetry)return!1;if(i&&null!=(l=e.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${n+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=Qv(a,n);this.timer=self.setTimeout((()=>this.loadPlaylist()),e),this.warn(`Retrying playlist loading ${n+1}/${a.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,s.resolved=!0}return o}constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=x_.log.bind(x_,`${t}:`),this.warn=x_.warn.bind(x_,`${t}:`),this.hls=e}}let hy;class uy extends cy{_registerListeners(){const{hls:e}=this;e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(T_.FRAG_LOADED,this.onFragLoaded,this),e.on(T_.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(T_.FRAG_LOADED,this.onFragLoaded,this),e.off(T_.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach((e=>{e.loadError=0,e.fragmentError=0})),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const i=[],s={};let r;t.levels.forEach((e=>{var t;const n=e.attrs;-1!==(null==(t=e.audioCodec)?void 0:t.indexOf("mp4a.40.34"))&&(hy||(hy=/chrome|firefox/i.test(navigator.userAgent)),hy&&(e.audioCodec=void 0));const{AUDIO:a,CODECS:o,"FRAME-RATE":l,"PATHWAY-ID":d,RESOLUTION:c,SUBTITLES:h}=n,u=`${`${d||"."}-`}${e.bitrate}-${c}-${l}-${o}`;r=s[u],r?r.addFallback(e):(r=new Uv(e),s[u]=r,i.push(r)),py(r,"audio",a),py(r,"text",h)})),this.filterAndSortMediaOptions(i,t)}filterAndSortMediaOptions(e,t){let i=[],s=[],r=!1,n=!1,a=!1,o=e.filter((({audioCodec:e,videoCodec:t,width:i,height:s,unknownCodecs:o})=>(r||(r=!(!i||!s)),n||(n=!!t),a||(a=!!e),!(null!=o&&o.length)&&(!e||Zf(e,"audio"))&&(!t||Zf(t,"video")))));if((r||n)&&a&&(o=o.filter((({videoCodec:e,width:t,height:i})=>!!e||!(!t||!i)))),0===o.length)return void Promise.resolve().then((()=>{if(this.hls){const e=new Error("no level with compatible codecs found in manifest");this.hls.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}}));t.audioTracks&&(i=t.audioTracks.filter((e=>!e.audioCodec||Zf(e.audioCodec,"audio"))),gy(i)),t.subtitles&&(s=t.subtitles,gy(s));const l=o.slice(0);o.sort(((e,t)=>e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"]?(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1:e.bitrate!==t.bitrate?e.bitrate-t.bitrate:e.attrs["FRAME-RATE"]!==t.attrs["FRAME-RATE"]?e.attrs.decimalFloatingPoint("FRAME-RATE")-t.attrs.decimalFloatingPoint("FRAME-RATE"):e.attrs.SCORE!==t.attrs.SCORE?e.attrs.decimalFloatingPoint("SCORE")-t.attrs.decimalFloatingPoint("SCORE"):r&&e.height!==t.height?e.height-t.height:0));let d=l[0];if(this.steering&&(o=this.steering.filterParsedLevels(o),o.length!==l.length))for(let e=0;e<l.length;e++)if(l[e].pathwayId===o[0].pathwayId){d=l[e];break}this._levels=o;for(let e=0;e<o.length;e++)if(o[e]===d){this._firstLevel=e,this.log(`manifest loaded, ${o.length} level(s) found, first bitrate: ${d.bitrate}`);break}const c=a&&!n,h={levels:o,audioTracks:i,subtitleTracks:s,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:n,altAudio:!c&&i.some((e=>!!e.url))};this.hls.trigger(T_.MANIFEST_PARSED,h),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const i=new Error("invalid level idx"),s=e<0;if(this.hls.trigger(T_.ERROR,{type:w_.OTHER_ERROR,details:A_.LEVEL_SWITCH_ERROR,level:e,fatal:s,error:i,reason:i.message}),s)return;e=Math.min(e,t.length-1)}const i=this.currentLevelIndex,s=this.currentLevel,r=s?s.attrs["PATHWAY-ID"]:void 0,n=t[e],a=n.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=n,i===e&&n.details&&s&&r===a)return;this.log(`Switching to level ${e}${a?" with Pathway "+a:""} from level ${i}${r?" with Pathway "+r:""}`);const o=E_({},n,{level:e,maxBitrate:n.maxBitrate,attrs:n.attrs,uri:n.uri,urlId:n.urlId});delete o._attrs,delete o._urlId,this.hls.trigger(T_.LEVEL_SWITCHING,o);const l=n.details;if(!l||l.live){const e=this.switchParams(n.uri,null==s?void 0:s.details);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){!t.fatal&&t.context&&t.context.type===gv&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(void 0!==t&&t.type===fv){const e=this._levels[t.level];void 0!==e&&(e.loadError=0)}}onLevelLoaded(e,t){var i;const{level:s,details:r}=t,n=this._levels[s];var a;if(!n)return this.warn(`Invalid level index ${s}`),void(null!=(a=t.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));s===this.currentLevelIndex?(0===n.fragmentError&&(n.loadError=0),this.playlistLoaded(s,t,n.details)):null!=(i=t.deliveryDirectives)&&i.skip&&(r.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const i=this.currentLevel;if(!i)return;const s=this.hls.audioTracks[t.id].groupId;if(i.audioGroupIds&&i.audioGroupId!==s){let e=-1;for(let t=0;t<i.audioGroupIds.length;t++)if(i.audioGroupIds[t]===s){e=t;break}-1!==e&&e!==i.urlId&&(i.urlId=e,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,i=this.currentLevel;if(i&&this.shouldLoadPlaylist(i)){const s=i.urlId;let r=i.uri;if(e)try{r=e.addDirectives(r)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}const n=i.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""} with${n?" Pathway "+n:""} URI ${s+1}/${i.url.length} ${r}`),this.clearTimer(),this.hls.trigger(T_.LEVEL_LOADING,{url:r,level:t,id:s,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const i=(e,i)=>i!==t,s=this._levels.filter(((s,r)=>r!==e||(s.url.length>1&&void 0!==t?(s.url=s.url.filter(i),s.audioGroupIds&&(s.audioGroupIds=s.audioGroupIds.filter(i)),s.textGroupIds&&(s.textGroupIds=s.textGroupIds.filter(i)),s.urlId=0,!0):(this.steering&&this.steering.removeLevel(s),!1))));this.hls.trigger(T_.LEVELS_UPDATED,{levels:s})}onLevelsUpdated(e,{levels:t}){t.forEach(((e,t)=>{const{details:i}=e;null!=i&&i.fragments&&i.fragments.forEach((e=>{e.level=t}))})),this._levels=t}constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}}function py(e,t,i){i&&("audio"===t?(e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds[e.url.length-1]=i):"text"===t&&(e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds[e.url.length-1]=i))}function gy(e){const t={};e.forEach((e=>{const i=e.groupId||"";e.id=t[i]=t[i]||0,t[i]++}))}var my="NOT_LOADED",_y="APPENDING",fy="PARTIAL",vy="OK";class yy{_registerListeners(){const{hls:e}=this;e.on(T_.BUFFER_APPENDED,this.onBufferAppended,this),e.on(T_.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T_.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(T_.BUFFER_APPENDED,this.onBufferAppended,this),e.off(T_.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T_.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const i=this.activePartLists[t];if(i)for(let t=i.length;t--;){const s=i[t];if(!s)break;const r=s.end;if(s.start<=e&&null!==r&&e<=r)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:i}=this,s=Object.keys(i);for(let r=s.length;r--;){const n=i[s[r]];if((null==n?void 0:n.body.type)===t&&n.buffered){const t=n.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,i,s){this.timeRanges&&(this.timeRanges[e]=t);const r=(null==s?void 0:s.fragment.sn)||-1;Object.keys(this.fragments).forEach((s=>{const n=this.fragments[s];if(!n)return;if(r>=n.body.sn)return;if(!n.buffered&&!n.loaded)return void(n.body.type===i&&this.removeFragment(n.body));const a=n.range[e];a&&a.time.some((e=>{const i=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return i&&this.removeFragment(n.body),i}))}))}detectPartialFragments(e){const t=this.timeRanges,{frag:i,part:s}=e;if(!t||"initSegment"===i.sn)return;const r=Sy(i),n=this.fragments[r];if(!n||n.buffered&&i.gap)return;const a=!i.relurl;if(Object.keys(t).forEach((e=>{const r=i.elementaryStreams[e];if(!r)return;const o=t[e],l=a||!0===r.partial;n.range[e]=this.getBufferedTimes(i,s,l,o)})),n.loaded=null,Object.keys(n.range).length){n.buffered=!0;(n.body.endList=i.endList||n.body.endList)&&(this.endListFragments[n.body.type]=n),by(n)||this.removeParts(i.sn-1,i.type)}else this.removeFragment(n.body)}removeParts(e,t){const i=this.activePartLists[t];i&&(this.activePartLists[t]=i.filter((t=>t.fragment.sn>=e)))}fragBuffered(e,t){const i=Sy(e);let s=this.fragments[i];!s&&t&&(s=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(e,t,i,s){const r={time:[],partial:i},n=e.start,a=e.end,o=e.minEndPTS||a,l=e.maxStartPTS||n;for(let e=0;e<s.length;e++){const t=s.start(e)-this.bufferPadding,i=s.end(e)+this.bufferPadding;if(l>=t&&o<=i){r.time.push({startPTS:Math.max(n,s.start(e)),endPTS:Math.min(a,s.end(e))});break}if(n<i&&a>t)r.partial=!0,r.time.push({startPTS:Math.max(n,s.start(e)),endPTS:Math.min(a,s.end(e))});else if(a<=t)break}return r}getPartialFragment(e){let t,i,s,r=null,n=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach((l=>{const d=o[l];d&&by(d)&&(i=d.body.start-a,s=d.body.end+a,e>=i&&e<=s&&(t=Math.min(e-i,s-e),n<=t&&(r=d.body,n=t)))})),r}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||by(t))}getState(e){const t=Sy(e),i=this.fragments[t];return i?i.buffered?by(i)?fy:vy:_y:my}isTimeBuffered(e,t,i){let s,r;for(let n=0;n<i.length;n++){if(s=i.start(n)-this.bufferPadding,r=i.end(n)+this.bufferPadding,e>=s&&t<=r)return!0;if(t<=s)return!1}return!1}onFragLoaded(e,t){const{frag:i,part:s}=t;if("initSegment"===i.sn||i.bitrateTest)return;const r=s?null:t,n=Sy(i);this.fragments[n]={body:i,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:i,part:s,timeRanges:r}=t;if("initSegment"===i.sn)return;const n=i.type;if(s){let e=this.activePartLists[n];e||(this.activePartLists[n]=e=[]),e.push(s)}this.timeRanges=r,Object.keys(r).forEach((e=>{const t=r[e];this.detectEvictedFragments(e,t,n,s)}))}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Sy(e);return!!this.fragments[t]}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,i,s,r){s&&!this.hasGaps||Object.keys(this.fragments).forEach((n=>{const a=this.fragments[n];if(!a)return;const o=a.body;o.type!==i||s&&!o.gap||o.start<t&&o.end>e&&(a.buffered||r)&&this.removeFragment(o)}))}removeFragment(e){const t=Sy(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const t=e.sn;this.activePartLists[e.type]=i.filter((e=>e.fragment.sn!==t))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}}function by(e){var t,i,s;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(i=e.range.audio)?void 0:i.partial)||(null==(s=e.range.audiovideo)?void 0:s.partial))}function Sy(e){return`${e.type}_${e.level}_${e.urlId}_${e.sn}`}const Ey=Math.pow(2,17);class Cy{destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const i=e.url;if(!i)return Promise.reject(new Ay({type:w_.NETWORK_ERROR,details:A_.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(i?"part list":"url")),networkDetails:null}));this.abort();const s=this.config,r=s.fLoader,n=s.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some((e=>"GAP"===e[0])))return void o(wy(e));e.gap=!1}const l=this.loader=e.loader=r?new r(s):new n(s),d=Ty(e),c=Xv(s.fragLoadPolicy.default),h={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:Ey};e.stats=l.stats,l.load(d,h,{onSuccess:(t,i,s,r)=>{this.resetLoader(e,l);let n=t.data;s.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(n.slice(0,16)),n=n.slice(16)),a({frag:e,part:null,payload:n,networkDetails:r})},onError:(t,s,r,n)=>{this.resetLoader(e,l),o(new Ay({type:w_.NETWORK_ERROR,details:A_.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:b_({url:i,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:r,stats:n}))},onAbort:(t,i,s)=>{this.resetLoader(e,l),o(new Ay({type:w_.NETWORK_ERROR,details:A_.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:s,stats:t}))},onTimeout:(t,i,s)=>{this.resetLoader(e,l),o(new Ay({type:w_.NETWORK_ERROR,details:A_.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:s,stats:t}))},onProgress:(i,s,r,n)=>{t&&t({frag:e,part:null,payload:r,networkDetails:n})}})}))}loadPart(e,t,i){this.abort();const s=this.config,r=s.fLoader,n=s.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void o(wy(e,t));const l=this.loader=e.loader=r?new r(s):new n(s),d=Ty(e,t),c=Xv(s.fragLoadPolicy.default),h={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Ey};t.stats=l.stats,l.load(d,h,{onSuccess:(s,r,n,o)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const d={frag:e,part:t,payload:s.data,networkDetails:o};i(d),a(d)},onError:(i,s,r,n)=>{this.resetLoader(e,l),o(new Ay({type:w_.NETWORK_ERROR,details:A_.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:b_({url:d.url,data:void 0},i),error:new Error(`HTTP Error ${i.code} ${i.text}`),networkDetails:r,stats:n}))},onAbort:(i,s,r)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),o(new Ay({type:w_.NETWORK_ERROR,details:A_.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:r,stats:i}))},onTimeout:(i,s,r)=>{this.resetLoader(e,l),o(new Ay({type:w_.NETWORK_ERROR,details:A_.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:r,stats:i}))}})}))}updateStatsFromPart(e,t){const i=e.stats,s=t.stats,r=s.total;if(i.loaded+=s.loaded,r){const s=Math.round(e.duration/t.duration),n=Math.min(Math.round(i.loaded/r),s),a=(s-n)*Math.round(i.loaded/n);i.total=i.loaded+a}else i.total=Math.max(i.loaded,i.total);const n=i.loading,a=s.loading;n.start?n.first+=a.first-a.start:(n.start=a.start,n.first=a.first),n.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}}function Ty(e,t=null){const i=t||e,s={frag:e,part:t,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},r=i.byteRangeStartOffset,n=i.byteRangeEndOffset;if(C_(r)&&C_(n)){var a;let t=r,i=n;if("initSegment"===e.sn&&"AES-128"===(null==(a=e.decryptdata)?void 0:a.method)){const e=n-r;e%16&&(i=n+(16-e%16)),0!==r&&(s.resetIV=!0,t=r-16)}s.rangeStart=t,s.rangeEnd=i}return s}function wy(e,t){const i=new Error(`GAP ${e.gap?"tag":"attribute"} found`),s={type:w_.MEDIA_ERROR,details:A_.FRAG_GAP,fatal:!1,frag:e,error:i,networkDetails:null};return t&&(s.part=t),(t||e).stats.aborted=!0,new Ay(s)}class Ay extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class ky{abort(e){for(const t in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[t].loader;if(i){if(e&&e!==i.context.frag.type)return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=A_.KEY_LOAD_ERROR,i,s,r){return new Ay({type:w_.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:i,networkDetails:s})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:i,cc:s}=e;for(let e=0;e<t.length;e++){const r=t[e];if(s<=r.cc&&("initSegment"===i||"initSegment"===r.sn||i<r.sn)){this.emeController.selectKeySystemFormat(r).then((e=>{r.setKeyFormat(e)}));break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then((t=>this.loadInternal(e,t))):this.loadInternal(e)}loadInternal(e,t){var i,s;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const i=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,A_.KEY_LOAD_ERROR,i))}const n=r.uri;if(!n)return Promise.reject(this.createKeyLoadError(e,A_.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${n}"`)));let a=this.keyUriToKeyInfo[n];if(null!=(i=a)&&i.decryptdata.key)return r.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});var o;if(null!=(s=a)&&s.keyLoadPromise)switch(null==(o=a.mediaKeySessionContext)?void 0:o.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then((t=>(r.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:a})))}switch(a=this.keyUriToKeyInfo[n]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,A_.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(i);if(t)return(e.keyLoadPromise=t.then((t=>(e.mediaKeySessionContext=t,i)))).catch((t=>{throw e.keyLoadPromise=null,t}))}return Promise.resolve(i)}loadKeyHTTP(e,t){const i=this.config,s=new(0,i.loader)(i);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise(((r,n)=>{const a={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},o=i.keyLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(e,t,i,s)=>{const{frag:a,keyInfo:o,url:l}=i;if(!a.decryptdata||o!==this.keyUriToKeyInfo[l])return n(this.createKeyLoadError(a,A_.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),s));o.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,o.loader=null,r({frag:a,keyInfo:o})},onError:(e,i,s,r)=>{this.resetLoader(i),n(this.createKeyLoadError(t,A_.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),s,b_({url:a.url,data:void 0},e)))},onTimeout:(e,i,s)=>{this.resetLoader(i),n(this.createKeyLoadError(t,A_.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),s))},onAbort:(e,i,s)=>{this.resetLoader(i),n(this.createKeyLoadError(t,A_.INTERNAL_ABORTED,new Error("key loading aborted"),s))}};s.load(a,l,d)}))}resetLoader(e){const{frag:t,keyInfo:i,url:s}=e,r=i.loader;t.keyLoader===r&&(t.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[s],r&&r.destroy()}constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}}class Iy{destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}}const Py={length:0,start:()=>0,end:()=>0};class Oy{static isBuffered(e,t){try{if(e){const i=Oy.getBuffered(e);for(let e=0;e<i.length;e++)if(t>=i.start(e)&&t<=i.end(e))return!0}}catch(e){}return!1}static bufferInfo(e,t,i){try{if(e){const s=Oy.getBuffered(e),r=[];let n;for(n=0;n<s.length;n++)r.push({start:s.start(n),end:s.end(n)});return this.bufferedInfo(r,t,i)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,i){t=Math.max(0,t),e.sort((function(e,t){const i=e.start-t.start;return i||t.end-e.end}));let s=[];if(i)for(let t=0;t<e.length;t++){const r=s.length;if(r){const n=s[r-1].end;e[t].start-n<i?e[t].end>n&&(s[r-1].end=e[t].end):s.push(e[t])}else s.push(e[t])}else s=e;let r,n=0,a=t,o=t;for(let e=0;e<s.length;e++){const l=s[e].start,d=s[e].end;if(t+i>=l&&t<d)a=l,o=d,n=o-t;else if(t+i<l){r=l;break}}return{len:n,start:a||0,end:o||0,nextStart:r}}static getBuffered(e){try{return e.buffered}catch(e){return x_.log("failed to get media.buffered",e),Py}}}class xy{constructor(e,t,i,s=0,r=-1,n=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=i,this.size=s,this.part=r,this.partial=n}}function Ry(e,t){let i=null;for(let s=0,r=e.length;s<r;s++){const r=e[s];if(r&&r.cc===t){i=r;break}}return i}function Dy(e,t){if(e){const i=e.start+t;e.start=e.startPTS=i,e.endPTS=i+e.duration}}function Ly(e,t){const i=t.fragments;for(let t=0,s=i.length;t<s;t++)Dy(i[t],e);t.fragmentHint&&Dy(t.fragmentHint,e),t.alignedSliding=!0}function My(e,t,i){t&&(!function(e,t,i){if(function(e,t,i){return!(!t.details||!(i.endCC>i.startCC||e&&e.cc<i.startCC))}(e,i,t)){const e=function(e,t){const i=e.fragments,s=t.fragments;if(!s.length||!i.length)return void x_.log("No fragments to align");const r=Ry(i,s[0].cc);if(r&&(!r||r.startPTS))return r;x_.log("No frag in previous level to align on")}(i.details,t);e&&C_(e.start)&&(x_.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),Ly(e.start,t))}}(e,i,t),!i.alignedSliding&&t.details&&function(e,t){if(!t.fragments.length||!e.hasProgramDateTime||!t.hasProgramDateTime)return;const i=t.fragments[0].programDateTime,s=e.fragments[0].programDateTime,r=(s-i)/1e3+t.fragments[0].start;r&&C_(r)&&(x_.log(`Adjusting PTS using programDateTime delta ${s-i}ms, sliding:${r.toFixed(3)} ${e.url} `),Ly(r,e))}(i,t.details),i.alignedSliding||!t.details||i.skippedSegments||Hv(t.details,i))}function By(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const i=e.fragments,s=t.fragments;if(!i.length||!s.length)return;const r=s[Math.round(s.length/2)-1],n=Ry(i,r.cc)||i[Math.round(i.length/2)-1],a=r.programDateTime,o=n.programDateTime;if(null===a||null===o)return;Ly((o-a)/1e3-(n.start-r.start),e)}class Fy{decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}}class jy{expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}}class Ny{uint8ArrayToUint32Array_(e){const t=new DataView(e),i=new Uint32Array(4);for(let e=0;e<4;e++)i[e]=t.getUint32(4*e);return i}initTable(){const e=this.sBox,t=this.invSBox,i=this.subMix,s=i[0],r=i[1],n=i[2],a=i[3],o=this.invSubMix,l=o[0],d=o[1],c=o[2],h=o[3],u=new Uint32Array(256);let p=0,g=0,m=0;for(m=0;m<256;m++)u[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let i=g^g<<1^g<<2^g<<3^g<<4;i=i>>>8^255&i^99,e[p]=i,t[i]=p;const o=u[p],m=u[o],_=u[m];let f=257*u[i]^16843008*i;s[p]=f<<24|f>>>8,r[p]=f<<16|f>>>16,n[p]=f<<8|f>>>24,a[p]=f,f=16843009*_^65537*m^257*o^16843008*p,l[i]=f<<24|f>>>8,d[i]=f<<16|f>>>16,c[i]=f<<8|f>>>24,h[i]=f,p?(p=o^u[u[u[_^o]]],g^=u[u[g]]):p=g=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let i=!0,s=0;for(;s<t.length&&i;)i=t[s]===this.key[s],s++;if(i)return;this.key=t;const r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const n=this.ksRows=4*(r+6+1);let a,o;const l=this.keySchedule=new Uint32Array(n),d=this.invKeySchedule=new Uint32Array(n),c=this.sBox,h=this.rcon,u=this.invSubMix,p=u[0],g=u[1],m=u[2],_=u[3];let f,v;for(a=0;a<n;a++)a<r?f=l[a]=t[a]:(v=f,a%r==0?(v=v<<8|v>>>24,v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[255&v],v^=h[a/r|0]<<24):r>6&&a%r==4&&(v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[255&v]),l[a]=f=(l[a-r]^v)>>>0);for(o=0;o<n;o++)a=n-o,v=3&o?l[a]:l[a-4],d[o]=o<4||a<=4?v:p[c[v>>>24]]^g[c[v>>>16&255]]^m[c[v>>>8&255]]^_[c[255&v]],d[o]=d[o]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,i){const s=this.keySize+6,r=this.invKeySchedule,n=this.invSBox,a=this.invSubMix,o=a[0],l=a[1],d=a[2],c=a[3],h=this.uint8ArrayToUint32Array_(i);let u=h[0],p=h[1],g=h[2],m=h[3];const _=new Int32Array(e),f=new Int32Array(_.length);let v,y,b,S,E,C,T,w,A,k,I,P,O,x;const R=this.networkToHostOrderSwap;for(;t<_.length;){for(A=R(_[t]),k=R(_[t+1]),I=R(_[t+2]),P=R(_[t+3]),E=A^r[0],C=P^r[1],T=I^r[2],w=k^r[3],O=4,x=1;x<s;x++)v=o[E>>>24]^l[C>>16&255]^d[T>>8&255]^c[255&w]^r[O],y=o[C>>>24]^l[T>>16&255]^d[w>>8&255]^c[255&E]^r[O+1],b=o[T>>>24]^l[w>>16&255]^d[E>>8&255]^c[255&C]^r[O+2],S=o[w>>>24]^l[E>>16&255]^d[C>>8&255]^c[255&T]^r[O+3],E=v,C=y,T=b,w=S,O+=4;v=n[E>>>24]<<24^n[C>>16&255]<<16^n[T>>8&255]<<8^n[255&w]^r[O],y=n[C>>>24]<<24^n[T>>16&255]<<16^n[w>>8&255]<<8^n[255&E]^r[O+1],b=n[T>>>24]<<24^n[w>>16&255]<<16^n[E>>8&255]<<8^n[255&C]^r[O+2],S=n[w>>>24]<<24^n[E>>16&255]<<16^n[C>>8&255]<<8^n[255&T]^r[O+3],f[t]=R(v^u),f[t+1]=R(S^p),f[t+2]=R(b^g),f[t+3]=R(y^m),u=A,p=k,g=I,m=P,t+=4}return f.buffer}constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}}class Uy{destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){const t=e.byteLength,i=t&&new DataView(e.buffer).getUint8(t-1);return i?nf(e,0,t-i):e}(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i){return this.useSoftware?new Promise(((s,r)=>{this.softwareDecrypt(new Uint8Array(e),t,i);const n=this.flush();n?s(n.buffer):r(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,i)}softwareDecrypt(e,t,i){const{currentIV:s,currentResult:r,remainderData:n}=this;this.logOnce("JS AES decrypt"),n&&(e=Bf(n,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;s&&(i=s);let o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new Ny),o.expandKey(t);const l=r;return this.currentResult=o.decrypt(a.buffer,0,i),this.currentIV=nf(a,-16).buffer,l||null}webCryptoDecrypt(e,t,i){const s=this.subtle;return this.key===t&&this.fastAesKey||(this.key=t,this.fastAesKey=new jy(s,t)),this.fastAesKey.expandKey().then((t=>{if(!s)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return new Fy(s,new Uint8Array(i)).decrypt(e.buffer,t)})).catch((s=>(x_.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,i))))}onWebCryptoError(e,t,i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i);const s=this.flush();if(s)return s.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const i=e.length-e.length%16;return i!==e.length&&(t=nf(e,0,i),this.remainderData=nf(e,i)),t}logOnce(e){this.logEnabled&&(x_.log(`[decrypter]: ${e}`),this.logEnabled=!1)}constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(e){}null===this.subtle&&(this.useSoftware=!0)}}const Vy=function(e){let t="";const i=e.length;for(let s=0;s<i;s++)t+=`[${e.start(s).toFixed(3)}-${e.end(s).toFixed(3)}]`;return t},zy="STOPPED",$y="IDLE",Hy="KEY_LOADING",qy="FRAG_LOADING",Gy="FRAG_LOADING_WAITING_RETRY",Ky="WAITING_TRACK",Wy="PARSING",Yy="PARSED",Qy="ENDED",Xy="ERROR",Jy="WAITING_INIT_PTS",Zy="WAITING_LEVEL";class eb extends Iy{doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=zy}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const i=t.partList;if(null!=i&&i.length){const e=i[i.length-1];return Oy.isBuffered(this.media,e.start+e.duration/2)}const s=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(s)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levels[this.levelLastLoaded])?void 0:e.details}onMediaAttached(e,t){const i=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),i.addEventListener("seeking",this.onvseeking),i.addEventListener("ended",this.onvended);const s=this.config;this.levels&&s.autoStartLoad&&this.state===zy&&this.startLoad(s.startPosition)}onMediaDetaching(){const e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:i,mediaBuffer:s,state:r}=this,n=i?i.currentTime:0,a=Oy.bufferInfo(s||i,n,e.maxBufferHole);if(this.log(`media seeking to ${C_(n)?n.toFixed(3):n}, state: ${r}`),this.state===Qy)this.resetLoadingState();else if(t){const i=e.maxFragLookUpTolerance,s=t.start-i,r=t.start+t.duration+i;if(!a.len||r<a.start||s>a.end){const e=n>r;(n<s||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}i&&(this.fragmentTracker.removeFragmentsInRange(n,1/0,this.playlistType,!0),this.lastCurrentTime=n),this.loadedmetadata||a.len||(this.nextLoadPosition=this.startPosition=n),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=zy,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){this._doFragLoad(e,t,i,(t=>{if(this.fragContextChanged(e))return this.warn(`Fragment ${e.sn}${t.part?" p: "+t.part.index:""} of level ${e.level} was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)})).then((t=>{if(!t)return;const i=this.state;this.fragContextChanged(e)?(i===qy||!this.fragCurrent&&i===Wy)&&(this.fragmentTracker.removeFragment(e),this.state=$y):("payload"in t&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(T_.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))})).catch((t=>{this.state!==zy&&this.state!==Xy&&(this.warn(t),this.resetFragmentLoading(e))}))}clearTrackerIfNeeded(e){var t;const{fragmentTracker:i}=this;if(i.getState(e)===_y){const t=e.type,s=this.getFwdBufferInfo(this.mediaBuffer,t),r=Math.max(e.duration,s?s.len:this.config.maxBufferLength);this.reduceMaxBufferLength(r)&&i.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===fy&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,i=null){if(!(e-t))return;const s={startOffset:e,endOffset:t,type:i};this.hls.trigger(T_.BUFFER_FLUSHING,s)}_loadInitSegment(e,t){this._doFragLoad(e,t).then((t=>{if(!t||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t})).then((t=>{const{hls:i}=this,{payload:s}=t,r=e.decryptdata;if(s&&s.byteLength>0&&r&&r.key&&r.iv&&"AES-128"===r.method){const n=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),r.key.buffer,r.iv.buffer).catch((t=>{throw i.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((s=>{const r=self.performance.now();return i.trigger(T_.FRAG_DECRYPTED,{frag:e,payload:s,stats:{tstart:n,tdecrypt:r}}),t.payload=s,t}))}return t})).then((i=>{const{fragCurrent:s,hls:r,levels:n}=this;if(!n)throw new Error("init load aborted, missing levels");const a=e.stats;this.state=$y,t.fragmentError=0,e.data=new Uint8Array(i.payload),a.parsing.start=a.buffering.start=self.performance.now(),a.parsing.end=a.buffering.end=self.performance.now(),i.frag===s&&r.trigger(T_.FRAG_BUFFERED,{stats:a,frag:s,part:null,id:e.type}),this.tick()})).catch((t=>{this.state!==zy&&this.state!==Xy&&(this.warn(t),this.resetFragmentLoading(e))}))}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var i,s,r,n;const a=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===fv?"level":"track"} ${e.level} (frag:[${(null!=(i=e.startPTS)?i:NaN).toFixed(3)}-${(null!=(s=e.endPTS)?s:NaN).toFixed(3)}] > buffer:${a?Vy(Oy.getBuffered(a)):"(detached)"})`),this.state=$y,a&&(!this.loadedmetadata&&e.type==fv&&a.buffered.length&&(null==(r=this.fragCurrent)?void 0:r.sn)===(null==(n=this.fragPrevious)?void 0:n.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:i,part:s,partsLoaded:r}=e,n=!r||0===r.length||r.some((e=>!e)),a=new xy(i.level,i.sn,i.stats.chunkCount+1,0,s?s.index:-1,!n);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,s){var r;const n=null==t?void 0:t.details;if(!this.levels||!n)throw new Error(`frag load aborted, missing level${n?"":" detail"}s`);let a=null;if(!e.encrypted||null!=(r=e.decryptdata)&&r.key?!e.encrypted&&n.encryptedFragments.length&&this.keyLoader.loadClear(e,n.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${n.startSN}-${n.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state=Hy,this.fragCurrent=e,a=this.keyLoader.load(e).then((e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(T_.KEY_LOADED,e),this.state===Hy&&(this.state=$y),e})),this.hls.trigger(T_.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),i=Math.max(e.start,i||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){const r=n.partList;if(r&&s){i>e.end&&n.fragmentHint&&(e=n.fragmentHint);const o=this.getNextPart(r,e,i);if(o>-1){const l=r[o];let d;return this.log(`Loading part sn: ${e.sn} p: ${l.index} cc: ${e.cc} of playlist [${n.startSN}-${n.endSN}] parts [0-${o}-${r.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=qy,d=a?a.then((i=>!i||this.fragContextChanged(i.frag)?null:this.doFragPartsLoad(e,l,t,s))).catch((e=>this.handleFragLoadError(e))):this.doFragPartsLoad(e,l,t,s).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(T_.FRAG_LOADING,{frag:e,part:l,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):d}if(!e.url||this.loadedEndOfParts(r,i))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${n?"of ["+n.startSN+"-"+n.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),C_(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=qy;const o=this.config.progressive;let l;return l=o&&a?a.then((t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,s))).catch((e=>this.handleFragLoadError(e))):Promise.all([this.fragmentLoader.load(e,o?s:void 0),a]).then((([e])=>(!o&&e&&s&&s(e),e))).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(T_.FRAG_LOADING,{frag:e,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,i,s){return new Promise(((r,n)=>{var a;const o=[],l=null==(a=i.details)?void 0:a.partList,d=t=>{this.fragmentLoader.loadPart(e,t,s).then((s=>{o[t.index]=s;const n=s.part;this.hls.trigger(T_.FRAG_LOADED,s);const a=Gv(i,e.sn,t.index+1)||Kv(l,e.sn,t.index+1);if(!a)return r({frag:e,part:n,partsLoaded:o});d(a)})).catch(n)};d(t)}))}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===A_.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(T_.ERROR,t)}else this.hls.trigger(T_.ERROR,{type:w_.OTHER_ERROR,details:A_.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Wy)return void(this.fragCurrent||this.state===zy||this.state===Xy||(this.state=$y));const{frag:i,part:s,level:r}=t,n=self.performance.now();i.stats.parsing.end=n,s&&(s.stats.parsing.end=n),this.updateLevelTiming(i,s,r,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:i}=this,{level:s,sn:r,part:n}=e;if(null==t||!t[s])return this.warn(`Levels object was unset while buffering fragment ${r} of level ${s}. The current chunk will not be buffered.`),null;const a=t[s],o=n>-1?Gv(a,r,n):null,l=o?o.fragment:function(e,t,i){if(null==e||!e.details)return null;const s=e.details;let r=s.fragments[t-s.startSN];return r||(r=s.fragmentHint,r&&r.sn===t?r:t<s.startSN&&i&&i.sn===t?i:null)}(a,r,i);return l?(i&&i!==l&&(l.stats=i.stats),{frag:l,part:o,level:a}):null}bufferFragmentData(e,t,i,s,r){var n;if(!e||this.state!==Wy)return;const{data1:a,data2:o}=e;let l=a;if(a&&o&&(l=Bf(a,o)),null==(n=l)||!n.length)return;const d={type:e.type,frag:t,part:i,chunkMeta:s,parent:t.type,data:l};if(this.hls.trigger(T_.BUFFER_APPENDING,d),e.dropped&&e.independent&&!i){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Oy.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const i=t.currentTime,s=Oy.bufferInfo(t,i,0),r=e.duration,n=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(e.start-n,s.end-n),i+n);e.start-a>n&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const i=this.getLoadPosition();return C_(i)?this.getFwdBufferInfoAtPos(e,i,t):null}getFwdBufferInfoAtPos(e,t,i){const{config:{maxBufferHole:s}}=this,r=Oy.bufferInfo(e,t,s);if(0===r.len&&void 0!==r.nextStart){const n=this.fragmentTracker.getBufferedFrag(t,i);if(n&&r.nextStart<n.end)return Oy.bufferInfo(e,t,Math.max(r.nextStart,s))}return r}getMaxBufferLength(e){const{config:t}=this;let i;return i=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,i=e||t.maxBufferLength;return t.maxMaxBufferLength>=i&&(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0)}getAppendedFrag(e,t=fv){const i=this.fragmentTracker.getAppendedFrag(e,fv);return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const i=t.fragments,s=i.length;if(!s)return null;const{config:r}=this,n=i[0].start;let a;if(t.live){const n=r.initialLiveManifestSize;if(s<n)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${n})`),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(a=this.getInitialLiveFragment(t,i),this.startPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=n&&(a=i[0]);if(!a){const i=r.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,i,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const i=this.fragmentTracker.getState(e);return(i===vy||i===fy&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,s,r){const n=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(null===a)return a;if(e=a,n&&e&&!e.gap&&i.nextStart){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,s);if(null!==t&&i.len+t.len>=r)return this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,i){let s=-1,r=!1,n=!0;for(let a=0,o=e.length;a<o;a++){const o=e[a];if(n=n&&!o.independent,s>-1&&i<o.start)break;const l=o.loaded;l?s=-1:(r||o.independent||n)&&o.fragment===t&&(s=a),r=l}return s}loadedEndOfParts(e,t){const i=e[e.length-1];return i&&t>i.start&&i.loaded}getInitialLiveFragment(e,t){const i=this.fragPrevious;let s=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),s=function(e,t,i){if(null===t||!Array.isArray(e)||!e.length||!C_(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;i=i||0;for(let s=0;s<e.length;++s){const r=e[s];if(iy(t,i,r))return r}return null}(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const r=i.sn+1;if(r>=e.startSN&&r<=e.endSN){const n=t[r-e.startSN];i.cc===n.cc&&(s=n,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=function(e,t){return Zv.search(e,(e=>e.cc<t?1:e.cc>t?-1:0))}(t,i.cc),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(s=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,t,i){const{config:s}=this;let{fragPrevious:r}=this,{fragments:n,endSN:a}=i;const{fragmentHint:o}=i,l=s.maxFragLookUpTolerance,d=i.partList,c=!!(s.lowLatencyMode&&null!=d&&d.length&&o);let h;if(c&&o&&!this.bitrateTest&&(n=n.concat(o),a=o.sn),e<t){h=ey(r,n,e,e>t-l?0:l)}else h=n[n.length-1];if(h){const e=h.sn-i.startSN,t=this.fragmentTracker.getState(h);if((t===vy||t===fy&&h.gap)&&(r=h),r&&h.sn===r.sn&&(!c||d[0].fragment.sn>h.sn)){if(r&&h.level===r.level){const t=n[e+1];h=h.sn<a&&this.fragmentTracker.getState(t)!==vy?t:null}}}return h}synchronizeToLiveEdge(e){const{config:t,media:i}=this;if(!i)return;const s=this.hls.liveSyncPosition,r=i.currentTime,n=e.fragments[0].start,a=e.edge,o=r>=n-t.maxFragLookUpTolerance&&r<=a;if(null!==s&&i.duration>s&&(r<s||!o)){const n=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!o&&i.readyState<4||r<a-n)&&(this.loadedmetadata||(this.nextLoadPosition=s),i.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${s.toFixed(3)}`),i.currentTime=s))}}alignPlaylists(e,t){const{levels:i,levelLastLoaded:s,fragPrevious:r}=this,n=null!==s?i[s]:null,a=e.fragments.length;if(!a)return this.warn("No fragments in live playlist"),0;const o=e.fragments[0].start,l=!t,d=e.alignedSliding&&C_(o);if(l||!d&&!o){My(r,n,e);const i=e.fragments[0].start;return this.log(`Live playlist sliding: ${i.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${r?r.sn:"na"} fragments: ${a}`),i}return o}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let i=this.startPosition;if(i<t&&(i=-1),-1===i||-1===this.lastCurrentTime){const s=null!==this.startTimeOffset,r=s?this.startTimeOffset:e.startTimeOffset;null!==r&&C_(r)?(i=t+r,r<0&&(i+=e.totalduration),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Start time offset ${r} found in ${s?"multivariant":"media"} playlist, adjust startPosition to ${i}`),this.startPosition=i):e.live?i=this.hls.liveSyncPosition||t:this.startPosition=i=0,this.lastCurrentTime=i}this.nextLoadPosition=i}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Gy)||(this.state=$y)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;var s;if(this.fragContextChanged(i))return void this.warn(`Frag load error must match current frag to retry ${i.url} > ${null==(s=this.fragCurrent)?void 0:s.url}`);const r=t.details===A_.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(i,!0);const n=t.errorAction,{action:a,retryCount:o=0,retryConfig:l}=n||{};if(n&&a===ny&&l){var d;this.resetStartWhenNotLoaded(null!=(d=this.levelLastLoaded)?d:i.level);const s=Qv(l,o);this.warn(`Fragment ${i.sn} of ${e} ${i.level} errored with ${t.details}, retrying loading ${o+1}/${l.maxNumRetry} in ${s}ms`),n.resolved=!0,this.retryDate=self.performance.now()+s,this.state=Gy}else l&&n?(this.resetFragmentErrors(e),o<l.maxNumRetry?r||(n.resolved=!0):x_.warn(`${t.details} reached or exceeded max retry (${o})`)):(null==n?void 0:n.action)===ry?this.state=Zy:this.state=Xy;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Wy||this.state===Yy){const t=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,t),s=i&&i.len>.5;s&&this.reduceMaxBufferLength(i.len);const r=!s;return r&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),r}return!1}resetFragmentErrors(e){e===vv&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==zy&&(this.state=$y)}afterBufferFlushed(e,t,i){if(!e)return;const s=Oy.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,s,i),this.state===Qy&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=$y}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){var t;this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(t=this.levelLastLoaded)?t:e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,s){var r;const n=i.details;if(!n)return void this.warn("level.details undefined");if(Object.keys(e.elementaryStreams).reduce(((t,r)=>{const a=e.elementaryStreams[r];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${e.sn} ${r} duration reliably (${o})`),t||!1;const l=s?0:zv(n,e,a.startPTS,a.endPTS,a.startDTS,a.endDTS);return this.hls.trigger(T_.LEVEL_PTS_UPDATED,{details:n,level:i,drift:l,type:r,frag:e,start:a.startPTS,end:a.endPTS}),!0}return t}),!1))i.fragmentError=0;else if(null===(null==(r=this.transmuxer)?void 0:r.error)){const t=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===i.fragmentError&&(i.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(t.message),this.hls.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of level "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Yy,this.hls.trigger(T_.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){var t,i,s;"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(t=null!=(i=this.levelLastLoaded)?i:null==(s=this.fragCurrent)?void 0:s.level)?t:0),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}constructor(e,t,i,s,r){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=zy,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=r,this.logPrefix=s,this.log=x_.log.bind(x_,`${s}:`),this.warn=x_.warn.bind(x_,`${s}:`),this.hls=e,this.fragmentLoader=new Cy(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Uy(e.config),e.on(T_.MANIFEST_LOADED,this.onManifestLoaded,this)}}function tb(){return self.SourceBuffer||self.WebKitSourceBuffer}function ib(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class sb{resetInitSegment(e,t,i,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){this.cachedData&&(e=Bf(this.cachedData,e),this.cachedData=null);let i,s=lf(e,0),r=s?s.length:0;const n=this._audioTrack,a=this._id3Track,o=s?(e=>{const t=pf(e);for(let e=0;e<t.length;e++){const i=t[e];if(hf(i))return vf(i)}})(s):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&C_(o))&&(this.basePTS=rb(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),s&&s.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:kv,duration:Number.POSITIVE_INFINITY});r<l;){if(this.canParse(e,r)){const t=this.appendFrame(n,e,r);t?(this.frameIndex++,this.lastPTS=t.sample.pts,r+=t.length,i=r):r=l}else cf(e,r)?(s=lf(e,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:kv,duration:Number.POSITIVE_INFINITY}),r+=s.length,i=r):r++;if(r===l&&i!==l){const t=nf(e,i);this.cachedData?this.cachedData=Bf(this.cachedData,t):this.cachedData=t}}return{audioTrack:n,videoTrack:ib(),id3Track:a,textTrack:ib()}}demuxSampleAes(e,t,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:ib(),id3Track:this._id3Track,textTrack:ib()}}destroy(){}constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}}const rb=(e,t,i)=>{if(C_(e))return 90*e;return 9e4*t+(i?9e4*i.baseTime/i.timescale:0)};function nb(e,t){return 255===e[t]&&240==(246&e[t+1])}function ab(e,t){return 1&e[t+1]?7:9}function ob(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function lb(e,t){return t+1<e.length&&nb(e,t)}function db(e,t){if(lb(e,t)){const i=ab(e,t);if(t+i>=e.length)return!1;const s=ob(e,t);if(s<=i)return!1;const r=t+s;return r===e.length||lb(e,r)}return!1}function cb(e,t,i,s,r){if(!e.samplerate){const n=function(e,t,i,s){let r,n,a,o;const l=navigator.userAgent.toLowerCase(),d=s,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=1+((192&t[i+2])>>>6);const h=(60&t[i+2])>>>2;if(!(h>c.length-1))return a=(1&t[i+2])<<2,a|=(192&t[i+3])>>>6,x_.log(`manifest codec:${s}, ADTS type:${r}, samplingIndex:${h}`),/firefox/i.test(l)?h>=6?(r=5,o=new Array(4),n=h-3):(r=2,o=new Array(2),n=h):-1!==l.indexOf("android")?(r=2,o=new Array(2),n=h):(r=5,o=new Array(4),s&&(-1!==s.indexOf("mp4a.40.29")||-1!==s.indexOf("mp4a.40.5"))||!s&&h>=6?n=h-3:((s&&-1!==s.indexOf("mp4a.40.2")&&(h>=6&&1===a||/vivaldi/i.test(l))||!s&&1===a)&&(r=2,o=new Array(2)),n=h)),o[0]=r<<3,o[0]|=(14&h)>>1,o[1]|=(1&h)<<7,o[1]|=a<<3,5===r&&(o[1]|=(14&n)>>1,o[2]=(1&n)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:c[h],channelCount:a,codec:"mp4a.40."+r,manifestCodec:d};e.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${h}`})}(t,i,s,r);if(!n)return;e.config=n.config,e.samplerate=n.samplerate,e.channelCount=n.channelCount,e.codec=n.codec,e.manifestCodec=n.manifestCodec,x_.log(`parsed codec:${e.codec}, rate:${n.samplerate}, channels:${n.channelCount}`)}}function hb(e){return 9216e4/e}function ub(e,t,i,s,r){const n=s+r*hb(e.samplerate),a=function(e,t){const i=ab(e,t);if(t+i<=e.length){const s=ob(e,t)-i;if(s>0)return{headerLength:i,frameLength:s}}}(t,i);let o;if(a){const{frameLength:s,headerLength:r}=a,l=r+s,d=Math.max(0,i+l-t.length);d?(o=new Uint8Array(l-r),o.set(t.subarray(i+r,t.length),0)):o=t.subarray(i+r,i+l);const c={unit:o,pts:n};return d||e.samples.push(c),{sample:c,length:l,missing:d}}const l=t.length-i;o=new Uint8Array(l),o.set(t.subarray(i,t.length),0);return{sample:{unit:o,pts:n},length:l,missing:-1}}const pb=/\/emsg[-/]ID3/i;let gb=null;const mb=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],_b=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],fb=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],vb=[0,1,1,4];function yb(e,t,i,s,r){if(i+24>t.length)return;const n=bb(t,i);if(n&&i+n.frameLength<=t.length){const a=s+r*(9e4*n.samplesPerFrame/n.sampleRate),o={unit:t.subarray(i,i+n.frameLength),pts:a,dts:a};return e.config=[],e.channelCount=n.channelCount,e.samplerate=n.sampleRate,e.samples.push(o),{sample:o,length:n.frameLength,missing:0}}}function bb(e,t){const i=e[t+1]>>3&3,s=e[t+1]>>1&3,r=e[t+2]>>4&15,n=e[t+2]>>2&3;if(1!==i&&0!==r&&15!==r&&3!==n){const a=e[t+2]>>1&1,o=e[t+3]>>6,l=1e3*mb[14*(3===i?3-s:3===s?3:4)+r-1],d=_b[3*(3===i?0:2===i?1:2)+n],c=3===o?1:2,h=fb[i][s],u=vb[s],p=8*h*u,g=Math.floor(h*l/d+a)*u;if(null===gb){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);gb=e?parseInt(e[1]):0}return!!gb&&gb<=87&&2===s&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:d,channelCount:c,frameLength:g,samplesPerFrame:p}}}function Sb(e,t){return!(255!==e[t]||224&~e[t+1]||!(6&e[t+1]))}function Eb(e,t){return t+1<e.length&&Sb(e,t)}function Cb(e,t){if(t+1<e.length&&Sb(e,t)){const i=4,s=bb(e,t);let r=i;null!=s&&s.frameLength&&(r=s.frameLength);const n=t+r;return n===e.length||Eb(e,n)}return!1}class Tb{loadWord(){const e=this.data,t=this.bytesAvailable,i=e.byteLength-t,s=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");s.set(e.subarray(i,i+r)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const i=this.word>>>32-t;if(e>32&&x_.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t,i=8,s=8;for(let r=0;r<e;r++)0!==s&&(t=this.readEG(),s=(i+t+256)%256),i=0===s?i:s}readSPS(){let e,t,i,s=0,r=0,n=0,a=0;const o=this.readUByte.bind(this),l=this.readBits.bind(this),d=this.readUEG.bind(this),c=this.readBoolean.bind(this),h=this.skipBits.bind(this),u=this.skipEG.bind(this),p=this.skipUEG.bind(this),g=this.skipScalingList.bind(this);o();const m=o();if(l(5),h(3),o(),p(),100===m||110===m||122===m||244===m||44===m||83===m||86===m||118===m||128===m){const e=d();if(3===e&&h(1),p(),p(),h(1),c())for(t=3!==e?8:12,i=0;i<t;i++)c()&&g(i<6?16:64)}p();const _=d();if(0===_)d();else if(1===_)for(h(1),u(),u(),e=d(),i=0;i<e;i++)u();p(),h(1);const f=d(),v=d(),y=l(1);0===y&&h(1),h(1),c()&&(s=d(),r=d(),n=d(),a=d());let b=[1,1];if(c()&&c()){switch(o()){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:b=[o()<<8|o(),o()<<8|o()]}}return{width:Math.ceil(16*(f+1)-2*s-2*r),height:(2-y)*(v+1)*16-(y?2:4)*(n+a),pixelRatio:b}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}}class wb{decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,i){const s=e[t].unit;if(s.length<=16)return;const r=s.subarray(16,s.length-s.length%16),n=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(n).then((r=>{const n=new Uint8Array(r);s.set(n,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)}))}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t);let s=0;for(let t=32;t<e.length-16;t+=160,s+=16)i.set(e.subarray(t,t+16),s);return i}getAvcDecryptedUnit(e,t){const i=new Uint8Array(t);let s=0;for(let t=32;t<e.length-16;t+=160,s+=16)e.set(i.subarray(s,s+16),t);return e}decryptAvcSample(e,t,i,s,r){const n=Uf(r.data),a=this.getAvcEncryptedData(n);this.decryptBuffer(a.buffer).then((a=>{r.data=this.getAvcDecryptedUnit(n,a),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,s)}))}decryptAvcSamples(e,t,i,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length)return void s();const r=e[t].units;for(;!(i>=r.length);i++){const n=r[i];if(!(n.data.length<=48||1!==n.type&&5!==n.type||(this.decryptAvcSample(e,t,i,s,n),this.decrypter.isSync())))return}}}constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Uy(t,{removePKCS7Padding:!1})}}const Ab=188;class kb{static probe(e){const t=kb.syncOffset(e);return t>0&&x_.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),-1!==t}static syncOffset(e){const t=e.length;let i=Math.min(940,e.length-Ab)+1,s=0;for(;s<i;){let r=!1,n=-1,a=0;for(let o=s;o<t;o+=Ab){if(71!==e[o]){if(a)return-1;break}if(a++,-1===n&&(n=o,0!==n&&(i=Math.min(n+18612,e.length-Ab)+1)),r||(r=0===Pb(e,o)),r&&a>1&&(0===n&&a>2||o+Ab>i))return n}s++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:wf[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,i,s){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=kb.createTrack("video"),this._audioTrack=kb.createTrack("audio",s),this._id3Track=kb.createTrack("id3"),this._txtTrack=kb.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i,this._duration=s}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,i=!1,s=!1){let r;i||(this.sampleAes=null);const n=this._avcTrack,a=this._audioTrack,o=this._id3Track,l=this._txtTrack;let d=n.pid,c=n.pesData,h=a.pid,u=o.pid,p=a.pesData,g=o.pesData,m=null,_=this.pmtParsed,f=this._pmtId,v=e.length;if(this.remainderData&&(v=(e=Bf(this.remainderData,e)).length,this.remainderData=null),v<Ab&&!s)return this.remainderData=e,{audioTrack:a,videoTrack:n,id3Track:o,textTrack:l};const y=Math.max(0,kb.syncOffset(e));v-=(v-y)%Ab,v<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,v,e.buffer.byteLength-v));let b=0;for(let t=y;t<v;t+=Ab)if(71===e[t]){const s=!!(64&e[t+1]),v=Pb(e,t);let b;if((48&e[t+3])>>4>1){if(b=t+5+e[t+4],b===t+Ab)continue}else b=t+4;switch(v){case d:s&&(c&&(r=Rb(c))&&this.parseAVCPES(n,l,r,!1),c={data:[],size:0}),c&&(c.data.push(e.subarray(b,t+Ab)),c.size+=t+Ab-b);break;case h:if(s){if(p&&(r=Rb(p)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,r);break;case"mp3":this.parseMPEGPES(a,r)}p={data:[],size:0}}p&&(p.data.push(e.subarray(b,t+Ab)),p.size+=t+Ab-b);break;case u:s&&(g&&(r=Rb(g))&&this.parseID3PES(o,r),g={data:[],size:0}),g&&(g.data.push(e.subarray(b,t+Ab)),g.size+=t+Ab-b);break;case 0:s&&(b+=e[b]+1),f=this._pmtId=Ob(e,b);break;case f:{s&&(b+=e[b]+1);const r=xb(e,b,this.typeSupported,i);d=r.avc,d>0&&(n.pid=d),h=r.audio,h>0&&(a.pid=h,a.segmentCodec=r.segmentCodec),u=r.id3,u>0&&(o.pid=u),null===m||_||(x_.warn(`MPEG-TS PMT found at ${t} after unknown PID '${m}'. Backtracking to sync byte @${y} to parse all TS packets.`),m=null,t=y-188),_=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=v}}else b++;if(b>0){const e=new Error(`Found ${b} TS packet/s that do not start with 0x47`);this.observer.emit(T_.ERROR,T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message})}n.pesData=c,a.pesData=p,o.pesData=g;const S={audioTrack:a,videoTrack:n,id3Track:o,textTrack:l};return s&&this.extractRemainingSamples(S),S}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:i,id3Track:s,textTrack:r}=e,n=i.pesData,a=t.pesData,o=s.pesData;let l;if(n&&(l=Rb(n))?(this.parseAVCPES(i,r,l,!0),i.pesData=null):i.pesData=n,a&&(l=Rb(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l)}t.pesData=null}else null!=a&&a.size&&x_.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;o&&(l=Rb(o))?(this.parseID3PES(s,l),s.pesData=null):s.pesData=o}demuxSampleAes(e,t,i){const s=this.demux(e,i,!0,!this.config.progressive),r=this.sampleAes=new wb(this.observer,this.config,t);return this.decrypt(s,r)}decrypt(e,t){return new Promise((i=>{const{audioTrack:s,videoTrack:r}=e;s.samples&&"aac"===s.segmentCodec?t.decryptAacSamples(s.samples,0,(()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,(()=>{i(e)})):i(e)})):r.samples&&t.decryptAvcSamples(r.samples,0,0,(()=>{i(e)}))}))}destroy(){this._duration=0}parseAVCPES(e,t,i,s){const r=this.parseAVCNALu(e,i.data);let n,a=this.avcSample,o=!1;i.data=null,a&&r.length&&!e.audFound&&(Db(a,e),a=this.avcSample=Ib(!1,i.pts,i.dts,"")),r.forEach((s=>{var r;switch(s.type){case 1:{let t=!1;n=!0;const r=s.data;if(o&&r.length>4){const e=new Tb(r).readSliceType();2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var l;if(t)null!=(l=a)&&l.frame&&!a.key&&(Db(a,e),a=this.avcSample=null);a||(a=this.avcSample=Ib(!0,i.pts,i.dts,"")),a.frame=!0,a.key=t;break}case 5:n=!0,null!=(r=a)&&r.frame&&!a.key&&(Db(a,e),a=this.avcSample=null),a||(a=this.avcSample=Ib(!0,i.pts,i.dts,"")),a.key=!0,a.frame=!0;break;case 6:n=!0,Nf(s.data,1,i.pts,t.samples);break;case 7:if(n=!0,o=!0,!e.sps){const t=s.data,i=new Tb(t).readSPS();e.width=i.width,e.height=i.height,e.pixelRatio=i.pixelRatio,e.sps=[t],e.duration=this._duration;const r=t.subarray(1,4);let n="avc1.";for(let e=0;e<3;e++){let t=r[e].toString(16);t.length<2&&(t="0"+t),n+=t}e.codec=n}break;case 8:n=!0,e.pps||(e.pps=[s.data]);break;case 9:n=!1,e.audFound=!0,a&&Db(a,e),a=this.avcSample=Ib(!1,i.pts,i.dts,"");break;case 12:n=!0;break;default:n=!1,a&&(a.debug+="unknown NAL "+s.type+" ")}if(a&&n){a.units.push(s)}})),s&&a&&(Db(a,e),this.avcSample=null)}getLastNalUnit(e){var t;let i,s=this.avcSample;if(s&&0!==s.units.length||(s=e[e.length-1]),null!=(t=s)&&t.units){const e=s.units;i=e[e.length-1]}return i}parseAVCNALu(e,t){const i=t.byteLength;let s=e.naluState||0;const r=s,n=[];let a,o,l,d=0,c=-1,h=0;for(-1===s&&(c=0,h=31&t[0],s=0,d=1);d<i;)if(a=t[d++],s)if(1!==s)if(a)if(1===a){if(c>=0){const e={data:t.subarray(c,d-s-1),type:h};n.push(e)}else{const i=this.getLastNalUnit(e.samples);if(i&&(r&&d<=4-r&&i.state&&(i.data=i.data.subarray(0,i.data.byteLength-r)),o=d-s-1,o>0)){const e=new Uint8Array(i.data.byteLength+o);e.set(i.data,0),e.set(t.subarray(0,o),i.data.byteLength),i.data=e,i.state=0}}d<i?(l=31&t[d],c=d,h=l,s=0):s=-1}else s=0;else s=3;else s=a?0:2;else s=a?0:1;if(c>=0&&s>=0){const e={data:t.subarray(c,i),type:h,state:s};n.push(e)}if(0===n.length){const i=this.getLastNalUnit(e.samples);if(i){const e=new Uint8Array(i.data.byteLength+t.byteLength);e.set(i.data,0),e.set(t,i.data.byteLength),i.data=e}}return e.naluState=s,n}parseAACPES(e,t){let i=0;const s=this.aacOverFlow;let r,n,a,o=t.data;if(s){this.aacOverFlow=null;const t=s.missing,r=s.sample.unit.byteLength;if(-1===t){const e=new Uint8Array(r+o.byteLength);e.set(s.sample.unit,0),e.set(o,r),o=e}else{const n=r-t;s.sample.unit.set(o.subarray(0,t),n),e.samples.push(s.sample),i=s.missing}}for(r=i,n=o.length;r<n-1&&!lb(o,r);r++);if(r!==i){let e;const t=r<n-1;e=t?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES";const i=new Error(e);if(x_.warn(`parsing error: ${e}`),this.observer.emit(T_.ERROR,T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:i,reason:e}),!t)return}if(cb(e,this.observer,o,r,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!s)return void x_.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=hb(e.samplerate);a=s.sample.pts+t}}let l,d=0;for(;r<n;){if(l=ub(e,o,r,a,d),r+=l.length,l.missing){this.aacOverFlow=l;break}for(d++;r<n-1&&!lb(o,r);r++);}}parseMPEGPES(e,t){const i=t.data,s=i.length;let r=0,n=0;const a=t.pts;if(void 0!==a)for(;n<s;)if(Eb(i,n)){const t=yb(e,i,n,a,r);if(!t)break;n+=t.length,r++}else n++;else x_.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseID3PES(e,t){if(void 0===t.pts)return void x_.warn("[tsdemuxer]: ID3 PES unknown PTS");const i=E_({},t,{type:this._avcTrack?Pv:kv,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}constructor(e,t,i){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=i}}function Ib(e,t,i,s){return{key:e,frame:!1,pts:t,dts:i,units:[],debug:s,length:0}}function Pb(e,t){return((31&e[t+1])<<8)+e[t+2]}function Ob(e,t){return(31&e[t+10])<<8|e[t+11]}function xb(e,t,i,s){const r={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},n=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<n;){const n=Pb(e,t);switch(e[t]){case 207:if(!s){x_.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===r.audio&&(r.audio=n);break;case 21:-1===r.id3&&(r.id3=n);break;case 219:if(!s){x_.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===r.avc&&(r.avc=n);break;case 3:case 4:!0!==i.mpeg&&!0!==i.mp3?x_.log("MPEG audio found, not supported in this browser"):-1===r.audio&&(r.audio=n,r.segmentCodec="mp3");break;case 36:x_.warn("Unsupported HEVC stream type found")}t+=5+((15&e[t+3])<<8|e[t+4])}return r}function Rb(e){let t,i,s,r,n,a=0;const o=e.data;if(!e||0===e.size)return null;for(;o[0].length<19&&o.length>1;){const e=new Uint8Array(o[0].length+o[1].length);e.set(o[0]),e.set(o[1],o[0].length),o[0]=e,o.splice(1,1)}t=o[0];if(1===(t[0]<<16)+(t[1]<<8)+t[2]){if(i=(t[4]<<8)+t[5],i&&i>e.size-6)return null;const l=t[7];192&l&&(r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?(n=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,r-n>54e5&&(x_.warn(`${Math.round((r-n)/9e4)}s delta between PTS and DTS, align them`),r=n)):n=r),s=t[8];let d=s+9;if(e.size<=d)return null;e.size-=d;const c=new Uint8Array(e.size);for(let e=0,i=o.length;e<i;e++){t=o[e];let i=t.byteLength;if(d){if(d>i){d-=i;continue}t=t.subarray(d),i-=d,d=0}c.set(t,a),a+=i}return i&&(i-=s+3),{data:c,pts:r,dts:n,len:i}}return null}function Db(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const i=t.samples,s=i.length;if(!s)return void t.dropped++;{const t=i[s-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}e.debug.length&&x_.log(e.pts+"/"+e.dts+":"+e.debug)}class Lb{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const Mb=Math.pow(2,32)-1;class Bb{static init(){let e;for(e in Bb.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},Bb.types)Bb.types.hasOwnProperty(e)&&(Bb.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Bb.HDLR_TYPES={video:t,audio:i};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);Bb.STTS=Bb.STSC=Bb.STCO=r,Bb.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Bb.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Bb.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Bb.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const n=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);Bb.FTYP=Bb.box(Bb.types.ftyp,n,o,n,a),Bb.DINF=Bb.box(Bb.types.dinf,Bb.box(Bb.types.dref,s))}static box(e,...t){let i=8,s=t.length;const r=s;for(;s--;)i+=t[s].byteLength;const n=new Uint8Array(i);for(n[0]=i>>24&255,n[1]=i>>16&255,n[2]=i>>8&255,n[3]=255&i,n.set(e,4),s=0,i=8;s<r;s++)n.set(t[s],i),i+=t[s].byteLength;return n}static hdlr(e){return Bb.box(Bb.types.hdlr,Bb.HDLR_TYPES[e])}static mdat(e){return Bb.box(Bb.types.mdat,e)}static mdhd(e,t){t*=e;const i=Math.floor(t/(Mb+1)),s=Math.floor(t%(Mb+1));return Bb.box(Bb.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s,85,196,0,0]))}static mdia(e){return Bb.box(Bb.types.mdia,Bb.mdhd(e.timescale,e.duration),Bb.hdlr(e.type),Bb.minf(e))}static mfhd(e){return Bb.box(Bb.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?Bb.box(Bb.types.minf,Bb.box(Bb.types.smhd,Bb.SMHD),Bb.DINF,Bb.stbl(e)):Bb.box(Bb.types.minf,Bb.box(Bb.types.vmhd,Bb.VMHD),Bb.DINF,Bb.stbl(e))}static moof(e,t,i){return Bb.box(Bb.types.moof,Bb.mfhd(e),Bb.traf(i,t))}static moov(e){let t=e.length;const i=[];for(;t--;)i[t]=Bb.trak(e[t]);return Bb.box.apply(null,[Bb.types.moov,Bb.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(Bb.mvex(e)))}static mvex(e){let t=e.length;const i=[];for(;t--;)i[t]=Bb.trex(e[t]);return Bb.box.apply(null,[Bb.types.mvex,...i])}static mvhd(e,t){t*=e;const i=Math.floor(t/(Mb+1)),s=Math.floor(t%(Mb+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Bb.box(Bb.types.mvhd,r)}static sdtp(e){const t=e.samples||[],i=new Uint8Array(4+t.length);let s,r;for(s=0;s<t.length;s++)r=t[s].flags,i[s+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return Bb.box(Bb.types.sdtp,i)}static stbl(e){return Bb.box(Bb.types.stbl,Bb.stsd(e),Bb.box(Bb.types.stts,Bb.STTS),Bb.box(Bb.types.stsc,Bb.STSC),Bb.box(Bb.types.stsz,Bb.STSZ),Bb.box(Bb.types.stco,Bb.STCO))}static avc1(e){let t,i,s,r=[],n=[];for(t=0;t<e.sps.length;t++)i=e.sps[t],s=i.byteLength,r.push(s>>>8&255),r.push(255&s),r=r.concat(Array.prototype.slice.call(i));for(t=0;t<e.pps.length;t++)i=e.pps[t],s=i.byteLength,n.push(s>>>8&255),n.push(255&s),n=n.concat(Array.prototype.slice.call(i));const a=Bb.box(Bb.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(n))),o=e.width,l=e.height,d=e.pixelRatio[0],c=e.pixelRatio[1];return Bb.box(Bb.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,Bb.box(Bb.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Bb.box(Bb.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,c>>24,c>>16&255,c>>8&255,255&c])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){const t=e.samplerate;return Bb.box(Bb.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),Bb.box(Bb.types.esds,Bb.esds(e)))}static mp3(e){const t=e.samplerate;return Bb.box(Bb.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))}static stsd(e){return"audio"===e.type?"mp3"===e.segmentCodec&&"mp3"===e.codec?Bb.box(Bb.types.stsd,Bb.STSD,Bb.mp3(e)):Bb.box(Bb.types.stsd,Bb.STSD,Bb.mp4a(e)):Bb.box(Bb.types.stsd,Bb.STSD,Bb.avc1(e))}static tkhd(e){const t=e.id,i=e.duration*e.timescale,s=e.width,r=e.height,n=Math.floor(i/(Mb+1)),a=Math.floor(i%(Mb+1));return Bb.box(Bb.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,255&s,0,0,r>>8&255,255&r,0,0]))}static traf(e,t){const i=Bb.sdtp(e),s=e.id,r=Math.floor(t/(Mb+1)),n=Math.floor(t%(Mb+1));return Bb.box(Bb.types.traf,Bb.box(Bb.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s])),Bb.box(Bb.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n])),Bb.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,Bb.box(Bb.types.trak,Bb.tkhd(e),Bb.mdia(e))}static trex(e){const t=e.id;return Bb.box(Bb.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const i=e.samples||[],s=i.length,r=12+16*s,n=new Uint8Array(r);let a,o,l,d,c,h;for(t+=8+r,n.set(["video"===e.type?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,255&s,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),a=0;a<s;a++)o=i[a],l=o.duration,d=o.size,c=o.flags,h=o.cts,n.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,d>>>24&255,d>>>16&255,d>>>8&255,255&d,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*a);return Bb.box(Bb.types.trun,n)}static initSegment(e){Bb.types||Bb.init();const t=Bb.moov(e),i=new Uint8Array(Bb.FTYP.byteLength+t.byteLength);return i.set(Bb.FTYP),i.set(t,Bb.FTYP.byteLength),i}}Bb.types=void 0,Bb.HDLR_TYPES=void 0,Bb.STTS=void 0,Bb.STSC=void 0,Bb.STCO=void 0,Bb.STSZ=void 0,Bb.VMHD=void 0,Bb.SMHD=void 0,Bb.STSD=void 0,Bb.FTYP=void 0,Bb.DINF=void 0;const Fb=9e4;function jb(e,t,i=1,s=!1){const r=e*t*i;return s?Math.round(r):r}function Nb(e,t=!1){return jb(e,1e3,1/Fb,t)}let Ub,Vb=null,zb=null;class $b{destroy(){}resetTimeStamp(e){x_.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){x_.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){x_.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const i=e.reduce(((e,i)=>{const s=i.pts-e;return s<-4294967296?(t=!0,Hb(e,i.pts)):s>0?e:i.pts}),e[0].pts);return t&&x_.debug("PTS rollover detected"),i}remux(e,t,i,s,r,n,a,o){let l,d,c,h,u,p,g=r,m=r;const _=e.pid>-1,f=t.pid>-1,v=t.samples.length,y=e.samples.length>0,b=a&&v>0||v>1;if((!_||y)&&(!f||b)||this.ISGenerated||a){this.ISGenerated||(c=this.generateIS(e,t,r,n));const i=this.isVideoContiguous;let s,a=-1;if(b&&(a=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!i&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,a>0){x_.warn(`[mp4-remuxer]: Dropped ${a} out of ${v} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(a),t.dropped+=a,m+=(t.samples[0].pts-e)/t.inputTimeScale,s=m}else-1===a&&(x_.warn(`[mp4-remuxer]: No keyframe found out of ${v} video samples`),p=!1);if(this.ISGenerated){if(y&&b){const i=this.getVideoStartPts(t.samples),s=(Hb(e.samples[0].pts,i)-i)/t.inputTimeScale;g+=Math.max(0,s),m+=Math.max(0,-s)}if(y){if(e.samplerate||(x_.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,r,n)),d=this.remuxAudio(e,g,this.isAudioContiguous,n,f||b||o===vv?m:void 0),b){const s=d?d.endPTS-d.startPTS:0;t.inputTimeScale||(x_.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,r,n)),l=this.remuxVideo(t,m,i,s)}}else b&&(l=this.remuxVideo(t,m,i,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=s)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(u=qb(i,r,this._initPTS,this._initDTS)),s.samples.length&&(h=Gb(s,r,this._initPTS))),{audio:d,video:l,initSegment:c,independent:p,text:h,id3:u}}generateIS(e,t,i,s){const r=e.samples,n=t.samples,a=this.typeSupported,o={},l=this._initPTS;let d,c,h,u=!l||s,p="audio/mp4";if(u&&(d=c=1/0),e.config&&r.length){if(e.timescale=e.samplerate,"mp3"===e.segmentCodec)a.mpeg?(p="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");o.audio={id:"audio",container:p,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&a.mpeg?new Uint8Array(0):Bb.initSegment([e]),metadata:{channelCount:e.channelCount}},u&&(h=e.inputTimeScale,l&&h===l.timescale?u=!1:d=c=r[0].pts-Math.round(h*i))}if(t.sps&&t.pps&&n.length&&(t.timescale=t.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Bb.initSegment([t]),metadata:{width:t.width,height:t.height}},u))if(h=t.inputTimeScale,l&&h===l.timescale)u=!1;else{const e=this.getVideoStartPts(n),t=Math.round(h*i);c=Math.min(c,Hb(n[0].dts,e)-t),d=Math.min(d,e-t)}if(Object.keys(o).length)return this.ISGenerated=!0,u?(this._initPTS={baseTime:d,timescale:h},this._initDTS={baseTime:c,timescale:h}):d=h=void 0,{tracks:o,initPTS:d,timescale:h}}remuxVideo(e,t,i,s){const r=e.inputTimeScale,n=e.samples,a=[],o=n.length,l=this._initPTS;let d,c,h=this.nextAvcDts,u=8,p=this.videoSampleDuration,g=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,_=!1;if(!i||null===h){h=t*r-(n[0].pts-Hb(n[0].dts,n[0].pts))}const f=l.baseTime*r/l.timescale;for(let e=0;e<o;e++){const t=n[e];t.pts=Hb(t.pts-f,h),t.dts=Hb(t.dts-f,h),t.dts<n[e>0?e-1:e].dts&&(_=!0)}_&&n.sort((function(e,t){const i=e.dts-t.dts,s=e.pts-t.pts;return i||s})),d=n[0].dts,c=n[n.length-1].dts;const v=c-d,y=v?Math.round(v/(o-1)):p||e.inputTimeScale/30;if(i){const e=d-h,t=e>y,i=e<-1;if((t||i)&&(t?x_.warn(`AVC: ${Nb(e,!0)} ms (${e}dts) hole between fragments detected, filling it`):x_.warn(`AVC: ${Nb(-e,!0)} ms (${e}dts) overlapping between fragments detected`),!i||h>=n[0].pts)){d=h;const t=n[0].pts-e;n[0].dts=d,n[0].pts=t,x_.log(`Video: First PTS/DTS adjusted: ${Nb(t,!0)}/${Nb(d,!0)}, delta: ${Nb(e,!0)} ms`)}}d=Math.max(0,d);let b=0,S=0;for(let e=0;e<o;e++){const t=n[e],i=t.units,s=i.length;let r=0;for(let e=0;e<s;e++)r+=i[e].data.length;S+=r,b+=s,t.length=r,t.dts=Math.max(t.dts,d),g=Math.min(t.pts,g),m=Math.max(t.pts,m)}c=n[o-1].dts;const E=S+4*b+8;let C;try{C=new Uint8Array(E)}catch(e){return void this.observer.emit(T_.ERROR,T_.ERROR,{type:w_.MUX_ERROR,details:A_.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:E,reason:`fail allocating video mdat ${E}`})}const T=new DataView(C.buffer);T.setUint32(0,E),C.set(Bb.types.mdat,4);let w=!1,A=Number.POSITIVE_INFINITY,k=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,P=Number.NEGATIVE_INFINITY;for(let e=0;e<o;e++){const t=n[e],i=t.units;let l,d=0;for(let e=0,t=i.length;e<t;e++){const t=i[e],s=t.data,r=t.data.byteLength;T.setUint32(u,r),u+=4,C.set(s,u),u+=r,d+=4+r}if(e<o-1)p=n[e+1].dts-t.dts,l=n[e+1].pts-t.pts;else{const i=this.config,a=e>0?t.dts-n[e-1].dts:y;if(l=e>0?t.pts-n[e-1].pts:y,i.stretchShortVideoTrack&&null!==this.nextAudioPts){const e=Math.floor(i.maxBufferHole*r),n=(s?g+s*r:this.nextAudioPts)-t.pts;n>e?(p=n-a,p<0?p=a:w=!0,x_.log(`[mp4-remuxer]: It is approximately ${n/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=a}else p=a}const c=Math.round(t.pts-t.dts);A=Math.min(A,p),I=Math.max(I,p),k=Math.min(k,l),P=Math.max(P,l),a.push(new Kb(t.key,p,d,c))}if(a.length)if(Vb){if(Vb<70){const e=a[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(zb&&P-k<I-A&&y/I<.025&&0===a[0].cts){x_.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=d;for(let t=0,i=a.length;t<i;t++){const s=e+a[t].duration,r=e+a[t].cts;if(t<i-1){const e=s+a[t+1].cts;a[t].duration=e-r}else a[t].duration=t?a[t-1].duration:y;a[t].cts=0,e=s}}p=w||!p?y:p,this.nextAvcDts=h=c+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;const O={data1:Bb.moof(e.sequenceNumber++,d,E_({},e,{samples:a})),data2:C,startPTS:g/r,endPTS:(m+p)/r,startDTS:d/r,endDTS:h/r,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,O}remuxAudio(e,t,i,s,r){const n=e.inputTimeScale,a=n/(e.samplerate?e.samplerate:n),o="aac"===e.segmentCodec?1024:1152,l=o*a,d=this._initPTS,c="mp3"===e.segmentCodec&&this.typeSupported.mpeg,h=[],u=void 0!==r;let p=e.samples,g=c?0:8,m=this.nextAudioPts||-1;const _=t*n,f=d.baseTime*n/d.timescale;if(this.isAudioContiguous=i=i||p.length&&m>0&&(s&&Math.abs(_-m)<9e3||Math.abs(Hb(p[0].pts-f,_)-m)<20*l),p.forEach((function(e){e.pts=Hb(e.pts-f,_)})),!i||m<0){if(p=p.filter((e=>e.pts>=0)),!p.length)return;m=0===r?0:s&&!u?Math.max(0,_):p[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let i=0,s=m;i<p.length;i++){const r=p[i],a=r.pts,o=a-s,d=Math.abs(1e3*o/n);if(o<=-t*l&&u)0===i&&(x_.warn(`Audio frame @ ${(a/n).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*o/n)} ms.`),this.nextAudioPts=m=s=a);else if(o>=t*l&&d<1e4&&u){let t=Math.round(o/l);s=a-t*l,s<0&&(t--,s+=l),0===i&&(this.nextAudioPts=m=s),x_.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(s/n).toFixed(3)}s due to ${Math.round(1e3*o/n)} ms gap.`);for(let n=0;n<t;n++){const t=Math.max(s,0);let n=Lb.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);n||(x_.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),n=r.unit.subarray()),p.splice(i,0,{unit:n,pts:t}),s+=l,i++}}r.pts=s,s+=l}}let v,y=null,b=null,S=0,E=p.length;for(;E--;)S+=p[E].unit.byteLength;for(let t=0,s=p.length;t<s;t++){const s=p[t],r=s.unit;let n=s.pts;if(null!==b){h[t-1].duration=Math.round((n-b)/a)}else{if(i&&"aac"===e.segmentCodec&&(n=m),y=n,!(S>0))return;S+=g;try{v=new Uint8Array(S)}catch(e){return void this.observer.emit(T_.ERROR,T_.ERROR,{type:w_.MUX_ERROR,details:A_.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:S,reason:`fail allocating audio mdat ${S}`})}if(!c){new DataView(v.buffer).setUint32(0,S),v.set(Bb.types.mdat,4)}}v.set(r,g);const l=r.byteLength;g+=l,h.push(new Kb(!0,o,l,0)),b=n}const C=h.length;if(!C)return;const T=h[h.length-1];this.nextAudioPts=m=b+a*T.duration;const w=c?new Uint8Array(0):Bb.moof(e.sequenceNumber++,y/a,E_({},e,{samples:h}));e.samples=[];const A=y/n,k=m/n,I={data1:w,data2:v,startPTS:A,endPTS:k,startDTS:A,endDTS:k,type:"audio",hasAudio:!0,hasVideo:!1,nb:C};return this.isAudioContiguous=!0,I}remuxEmptyAudio(e,t,i,s){const r=e.inputTimeScale,n=r/(e.samplerate?e.samplerate:r),a=this.nextAudioPts,o=this._initDTS,l=9e4*o.baseTime/o.timescale,d=(null!==a?a:s.startDTS*r)+l,c=s.endDTS*r+l,h=1024*n,u=Math.ceil((c-d)/h),p=Lb.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(x_.warn("[mp4-remuxer]: remux empty Audio"),!p)return void x_.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const g=[];for(let e=0;e<u;e++){const t=d+e*h;g.push({unit:p,pts:t,dts:t})}return e.samples=g,this.remuxAudio(e,t,i,!1)}constructor(e,t,i,s=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,null===Vb){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Vb=e?parseInt(e[1]):0}if(null===zb){const e=navigator.userAgent.match(/Safari\/(\d+)/i);zb=e?parseInt(e[1]):0}}}function Hb(e,t){let i;if(null===t)return e;for(i=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e}function qb(e,t,i,s){const r=e.samples.length;if(!r)return;const n=e.inputTimeScale;for(let a=0;a<r;a++){const r=e.samples[a];r.pts=Hb(r.pts-i.baseTime*n/i.timescale,t*n)/n,r.dts=Hb(r.dts-s.baseTime*n/s.timescale,t*n)/n}const a=e.samples;return e.samples=[],{samples:a}}function Gb(e,t,i){const s=e.samples.length;if(!s)return;const r=e.inputTimeScale;for(let n=0;n<s;n++){const s=e.samples[n];s.pts=Hb(s.pts-i.baseTime*r/i.timescale,t*r)/r}e.samples.sort(((e,t)=>e.pts-t.pts));const n=e.samples;return e.samples=[],{samples:n}}class Kb{constructor(e,t,i,s){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=i,this.cts=s,this.flags=new Wb(e)}}class Wb{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}function Yb(e,t){const i=null==e?void 0:e.codec;return i&&i.length>4?i:"hvc1"===i||"hev1"===i?"hvc1.1.6.L120.90":"av01"===i?"av01.0.04M.08":"avc1"===i||t===N_?"avc1.42e01e":"mp4a.40.5"}try{Ub=self.performance.now.bind(self.performance)}catch(e){x_.debug("Unable to use Performance API on this environment"),Ub="undefined"!=typeof self&&self.Date.now}const Qb=[{demux:class{resetTimeStamp(){}resetInitSegment(e,t,i,s){const r=this.videoTrack=ib("video",1),n=this.audioTrack=ib("audio",1),a=this.txtTrack=ib("text",1);if(this.id3Track=ib("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const o=Df(e);if(o.video){const{id:e,timescale:t,codec:i}=o.video;r.id=e,r.timescale=a.timescale=t,r.codec=i}if(o.audio){const{id:e,timescale:t,codec:i}=o.audio;n.id=e,n.timescale=t,n.codec=i}a.id=wf.text,r.sampleDuration=0,r.duration=n.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return xf(e=e.length>16384?e.subarray(0,16384):e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let i=e;const s=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Bf(this.remainderData,e));const t=function(e){const t={valid:null,remainder:null},i=xf(e,["moof"]);if(!i)return t;if(i.length<2)return t.remainder=e,t;const s=i[i.length-1];return t.valid=nf(e,0,s.byteOffset-8),t.remainder=nf(e,s.byteOffset-8),t}(i);this.remainderData=t.remainder,s.samples=t.valid||new Uint8Array}else s.samples=i;const n=this.extractID3Track(s,t);return r.samples=Ff(t,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:n,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(t,this.timeOffset);return i.samples=Ff(e,t),{videoTrack:t,audioTrack:ib(),id3Track:s,textTrack:ib()}}extractID3Track(e,t){const i=this.id3Track;if(e.samples.length){const s=xf(e.samples,["emsg"]);s&&s.forEach((e=>{const s=function(e){const t=e[0];let i="",s="",r=0,n=0,a=0,o=0,l=0,d=0;if(0===t){for(;"\0"!==Af(e.subarray(d,d+1));)i+=Af(e.subarray(d,d+1)),d+=1;for(i+=Af(e.subarray(d,d+1)),d+=1;"\0"!==Af(e.subarray(d,d+1));)s+=Af(e.subarray(d,d+1)),d+=1;s+=Af(e.subarray(d,d+1)),d+=1,r=If(e,12),n=If(e,16),o=If(e,20),l=If(e,24),d=28}else if(1===t){d+=4,r=If(e,d),d+=4;const t=If(e,d);d+=4;const n=If(e,d);for(d+=4,a=2**32*t+n,Number.isSafeInteger(a)||(a=Number.MAX_SAFE_INTEGER,x_.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=If(e,d),d+=4,l=If(e,d),d+=4;"\0"!==Af(e.subarray(d,d+1));)i+=Af(e.subarray(d,d+1)),d+=1;for(i+=Af(e.subarray(d,d+1)),d+=1;"\0"!==Af(e.subarray(d,d+1));)s+=Af(e.subarray(d,d+1)),d+=1;s+=Af(e.subarray(d,d+1)),d+=1}return{schemeIdUri:i,value:s,timeScale:r,presentationTime:a,presentationTimeDelta:n,eventDuration:o,id:l,payload:e.subarray(d,e.byteLength)}}(e);if(pb.test(s.schemeIdUri)){const e=C_(s.presentationTime)?s.presentationTime/s.timeScale:t+s.presentationTimeDelta/s.timeScale;let r=4294967295===s.eventDuration?Number.POSITIVE_INFINITY:s.eventDuration/s.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const n=s.payload;i.samples.push({data:n,len:n.byteLength,dts:e,pts:e,type:Pv,duration:r})}}))}return i}demuxSampleAes(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}},remux:class{destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,i,s){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(function(e,t){if(!e||!t)return e;const i=t.keyId;i&&t.isCommonEncryption&&xf(e,["moov","trak"]).forEach((e=>{const t=xf(e,["mdia","minf","stbl","stsd"])[0].subarray(8);let s=xf(t,["enca"]);const r=s.length>0;r||(s=xf(t,["encv"])),s.forEach((e=>{xf(r?e.subarray(28):e.subarray(78),["sinf"]).forEach((e=>{const t=Lf(e);if(t){const e=t.subarray(8,24);e.some((e=>0!==e))||(x_.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${Ef(e)} -> ${Ef(i)}`),t.set(i,8))}}))}))}));return e}(e,s)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:i}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const s=this.initData=Df(e);t||(t=Yb(s.audio,j_)),i||(i=Yb(s.video,N_));const r={};s.audio&&s.video?r.audiovideo={container:"video/mp4",codec:t+","+i,initSegment:e,id:"main"}:s.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:s.video?r.video={container:"video/mp4",codec:i,initSegment:e,id:"main"}:x_.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,i,s,r,n){var a,o;let{initPTS:l,lastEndTime:d}=this;const c={audio:void 0,video:void 0,text:s,id3:i,initSegment:void 0};C_(d)||(d=this.lastEndTime=r||0);const h=t.samples;if(null==h||!h.length)return c;const u={initPTS:void 0,timescale:1};let p=this.initData;if(null!=(a=p)&&a.length||(this.generateInitSegment(h),p=this.initData),null==(o=p)||!o.length)return x_.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),c;this.emitInitSegment&&(u.tracks=this.initTracks,this.emitInitSegment=!1);const g=function(e,t){let i=0,s=0,r=0;const n=xf(e,["moof","traf"]);for(let e=0;e<n.length;e++){const a=n[e],o=xf(a,["tfhd"])[0],l=t[If(o,4)];if(!l)continue;const d=l.default,c=If(o,0)|(null==d?void 0:d.flags);let h=null==d?void 0:d.duration;8&c&&(h=If(o,2&c?12:8));const u=l.timescale||9e4,p=xf(a,["trun"]);for(let e=0;e<p.length;e++)i=Mf(p[e]),!i&&h&&(i=h*If(p[e],4)),l.type===N_?s+=i/u:l.type===j_&&(r+=i/u)}if(0===s&&0===r){let t=0;const i=xf(e,["sidx"]);for(let e=0;e<i.length;e++){const s=Rf(i[e]);null!=s&&s.references&&(t+=s.references.reduce(((e,t)=>e+t.info.duration||0),0))}return t}return s||r}(h,p),m=function(e,t){return xf(t,["moof","traf"]).reduce(((t,i)=>{const s=xf(i,["tfdt"])[0],r=s[0],n=xf(i,["tfhd"]).reduce(((t,i)=>{const n=If(i,4),a=e[n];if(a){let e=If(s,4);if(1===r){if(e===Cf)return x_.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;e*=Cf+1,e+=If(s,8)}const i=e/(a.timescale||9e4);if(isFinite(i)&&(null===t||i<t))return i}return t}),null);return null!==n&&isFinite(n)&&(null===t||n<t)?n:t}),null)}(p,h),_=null===m?r:m;(function(e,t,i,s){if(null===e)return!0;const r=Math.max(s,1),n=t-e.baseTime/e.timescale;return Math.abs(n-i)>r}(l,_,r,g)||u.timescale!==l.timescale&&n)&&(u.initPTS=_-r,l&&1===l.timescale&&x_.warn("Adjusting initPTS by "+(u.initPTS-l.baseTime)),this.initPTS=l={baseTime:u.initPTS,timescale:1});const f=e?_-l.baseTime/l.timescale:d,v=f+g;!function(e,t,i){xf(t,["moof","traf"]).forEach((t=>{xf(t,["tfhd"]).forEach((s=>{const r=If(s,4),n=e[r];if(!n)return;const a=n.timescale||9e4;xf(t,["tfdt"]).forEach((e=>{const t=e[0];let s=If(e,4);if(0===t)s-=i*a,s=Math.max(s,0),Of(e,4,s);else{s*=Math.pow(2,32),s+=If(e,8),s-=i*a,s=Math.max(s,0);const t=Math.floor(s/(Cf+1)),r=Math.floor(s%(Cf+1));Of(e,4,t),Of(e,8,r)}}))}))}))}(p,h,l.baseTime/l.timescale),g>0?this.lastEndTime=v:(x_.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const y=!!p.audio,b=!!p.video;let S="";y&&(S+="audio"),b&&(S+="video");const E={data1:h,startPTS:f,startDTS:f,endPTS:v,endDTS:v,type:S,hasAudio:y,hasVideo:b,nb:1,dropped:0};return c.audio="audio"===E.type?E:void 0,c.video="audio"!==E.type?E:void 0,c.initSegment=u,c.id3=qb(i,r,l,l),s.samples.length&&(c.text=Gb(s,r,l)),c}constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}}},{demux:kb,remux:$b},{demux:class extends sb{resetInitSegment(e,t,i,s){super.resetInitSegment(e,t,i,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=(lf(e,0)||[]).length;for(let i=e.length;t<i;t++)if(db(e,t))return x_.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&nb(e,t)&&ob(e,t)<=e.length-t}(e,t)}appendFrame(e,t,i){cb(e,this.observer,t,i,e.manifestCodec);const s=ub(e,t,i,this.basePTS,this.frameIndex);if(s&&0===s.missing)return s}constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}},remux:$b},{demux:class extends sb{resetInitSegment(e,t,i,s){super.resetInitSegment(e,t,i,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=(lf(e,0)||[]).length;for(let i=e.length;t<i;t++)if(Cb(e,t))return x_.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return Sb(e,t)&&4<=e.length-t}(e,t)}appendFrame(e,t,i){if(null!==this.basePTS)return yb(e,t,i,this.basePTS,this.frameIndex)}},remux:$b}];class Xb{configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,s){const r=i.transmuxing;r.executeStart=Ub();let n=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:o}=this;s&&(this.currentTransmuxState=s);const{contiguous:l,discontinuity:d,trackSwitch:c,accurateTimeOffset:h,timeOffset:u,initSegmentChange:p}=s||a,{audioCodec:g,videoCodec:m,defaultInitPts:_,duration:f,initSegmentData:v}=o,y=function(e,t){let i=null;e.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(i=t);return i}(n,t);if(y&&"AES-128"===y.method){const e=this.getDecrypter();if(!e.isSync())return this.decryptionPromise=e.webCryptoDecrypt(n,y.key.buffer,y.iv.buffer).then((e=>{const t=this.push(e,null,i);return this.decryptionPromise=null,t})),this.decryptionPromise;{let t=e.softwareDecrypt(n,y.key.buffer,y.iv.buffer);if(i.part>-1&&(t=e.flush()),!t)return r.executeEnd=Ub(),Jb(i);n=new Uint8Array(t)}}const b=this.needsProbing(d,c);if(b){const e=this.configureTransmuxer(n);if(e)return x_.warn(`[transmuxer] ${e.message}`),this.observer.emit(T_.ERROR,T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),r.executeEnd=Ub(),Jb(i)}(d||c||p||b)&&this.resetInitSegment(v,g,m,f,t),(d||p||b)&&this.resetInitialTimestamp(_),l||this.resetContiguity();const S=this.transmux(n,y,u,h,i),E=this.currentTransmuxState;return E.contiguous=!0,E.discontinuity=!1,E.trackSwitch=!1,r.executeEnd=Ub(),S}flush(e){const t=e.transmuxing;t.executeStart=Ub();const{decrypter:i,currentTransmuxState:s,decryptionPromise:r}=this;if(r)return r.then((()=>this.flush(e)));const n=[],{timeOffset:a}=s;if(i){const t=i.flush();t&&n.push(this.push(t,null,e))}const{demuxer:o,remuxer:l}=this;if(!o||!l)return t.executeEnd=Ub(),[Jb(e)];const d=o.flush(a);return Zb(d)?d.then((t=>(this.flushRemux(n,t,e),n))):(this.flushRemux(n,d,e),n)}flushRemux(e,t,i){const{audioTrack:s,videoTrack:r,id3Track:n,textTrack:a}=t,{accurateTimeOffset:o,timeOffset:l}=this.currentTransmuxState;x_.log(`[transmuxer.ts]: Flushed fragment ${i.sn}${i.part>-1?" p: "+i.part:""} of level ${i.level}`);const d=this.remuxer.remux(s,r,n,a,l,o,!0,this.id);e.push({remuxResult:d,chunkMeta:i}),i.transmuxing.executeEnd=Ub()}resetInitialTimestamp(e){const{demuxer:t,remuxer:i}=this;t&&i&&(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,s,r){const{demuxer:n,remuxer:a}=this;n&&a&&(n.resetInitSegment(e,t,i,s),a.resetInitSegment(e,t,i,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,s,r){let n;return n=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,i,s,r):this.transmuxUnencrypted(e,i,s,r),n}transmuxUnencrypted(e,t,i,s){const{audioTrack:r,videoTrack:n,id3Track:a,textTrack:o}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,n,a,o,t,i,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,t,i,s,r){return this.demuxer.demuxSampleAes(e,t,i).then((e=>({remuxResult:this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,i,s,!1,this.id),chunkMeta:r})))}configureTransmuxer(e){const{config:t,observer:i,typeSupported:s,vendor:r}=this;let n;for(let t=0,i=Qb.length;t<i;t++)if(Qb[t].demux.probe(e)){n=Qb[t];break}if(!n)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,o=this.remuxer,l=n.remux,d=n.demux;o&&o instanceof l||(this.remuxer=new l(i,t,s,r)),a&&a instanceof d||(this.demuxer=new d(i,t,s),this.probe=d.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Uy(this.config)),e}constructor(e,t,i,s,r){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.vendor=s,this.id=r}}const Jb=e=>({remuxResult:{},chunkMeta:e});function Zb(e){return"then"in e&&e.then instanceof Function}class eS{constructor(e,t,i,s,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=s,this.defaultInitPts=r||null}}class tS{constructor(e,t,i,s,r,n){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=s,this.timeOffset=r,this.initSegmentChange=n}}var iS={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,i="~";function s(){}function r(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function n(e,t,s,n,a){if("function"!=typeof s)throw new TypeError("The listener must be a function");var o=new r(s,n||e,a),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new s:delete e._events[t]}function o(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(i=!1)),o.prototype.eventNames=function(){var e,s,r=[];if(0===this._eventsCount)return r;for(s in e=this._events)t.call(e,s)&&r.push(i?s.slice(1):s);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=i?i+e:e,s=this._events[t];if(!s)return[];if(s.fn)return[s.fn];for(var r=0,n=s.length,a=new Array(n);r<n;r++)a[r]=s[r].fn;return a},o.prototype.listenerCount=function(e){var t=i?i+e:e,s=this._events[t];return s?s.fn?1:s.length:0},o.prototype.emit=function(e,t,s,r,n,a){var o=i?i+e:e;if(!this._events[o])return!1;var l,d,c=this._events[o],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,s),!0;case 4:return c.fn.call(c.context,t,s,r),!0;case 5:return c.fn.call(c.context,t,s,r,n),!0;case 6:return c.fn.call(c.context,t,s,r,n,a),!0}for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var u,p=c.length;for(d=0;d<p;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),h){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,s);break;case 4:c[d].fn.call(c[d].context,t,s,r);break;default:if(!l)for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c[d].fn.apply(c[d].context,l)}}return!0},o.prototype.on=function(e,t,i){return n(this,e,t,i,!1)},o.prototype.once=function(e,t,i){return n(this,e,t,i,!0)},o.prototype.removeListener=function(e,t,s,r){var n=i?i+e:e;if(!this._events[n])return this;if(!t)return a(this,n),this;var o=this._events[n];if(o.fn)o.fn!==t||r&&!o.once||s&&o.context!==s||a(this,n);else{for(var l=0,d=[],c=o.length;l<c;l++)(o[l].fn!==t||r&&!o[l].once||s&&o[l].context!==s)&&d.push(o[l]);d.length?this._events[n]=1===d.length?d[0]:d:a(this,n)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&a(this,t)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,e.exports=o}(iS);var sS=__(iS.exports);const rS=Qf()||{isTypeSupported:()=>!1};class nS{resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,i,s,r,n,a,o,l,d){var c,h;l.transmuxing.start=self.performance.now();const{transmuxer:u}=this,p=n?n.start:r.start,g=r.decryptdata,m=this.frag,_=!(m&&r.cc===m.cc),f=!(m&&l.level===m.level),v=m?l.sn-m.sn:-1,y=this.part?l.part-this.part.index:-1,b=0===v&&l.id>1&&l.id===(null==m?void 0:m.stats.chunkCount),S=!f&&(1===v||0===v&&(1===y||b&&y<=0)),E=self.performance.now();(f||v||0===r.stats.parsing.start)&&(r.stats.parsing.start=E),!n||!y&&S||(n.stats.parsing.start=E);const C=!(m&&(null==(c=r.initSegment)?void 0:c.url)===(null==(h=m.initSegment)?void 0:h.url)),T=new tS(_,S,o,f,p,C);if(!S||_||C){x_.log(`[transmuxer-interface, ${r.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${_}\n        trackSwitch: ${f}\n        contiguous: ${S}\n        accurateTimeOffset: ${o}\n        timeOffset: ${p}\n        initSegmentChange: ${C}`);const e=new eS(i,s,t,a,d);this.configureTransmuxer(e)}if(this.frag=r,this.part=n,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:g,chunkMeta:l,state:T},e instanceof ArrayBuffer?[e]:[]);else if(u){const t=u.push(e,g,l,T);Zb(t)?(u.async=!0,t.then((e=>{this.handleTransmuxComplete(e)})).catch((e=>{this.transmuxerError(e,l,"transmuxer-interface push error")}))):(u.async=!1,this.handleTransmuxComplete(t))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let i=t.flush(e);Zb(i)||t.async?(Zb(i)||(i=Promise.resolve(i)),i.then((t=>{this.handleFlushResult(t,e)})).catch((t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}))):this.handleFlushResult(i,e)}}transmuxerError(e,t,i){this.hls&&(this.error=e,this.hls.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach((e=>{this.handleTransmuxComplete(e)})),this.onFlush(t)}onWorkerMessage(e){const t=e.data,i=this.hls;switch(t.event){case"init":{var s;const e=null==(s=this.workerContext)?void 0:s.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":x_[t.data.logType]&&x_[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}constructor(e,t,i,s){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=i,this.onFlush=s;const n=(e,t)=>{(t=t||{}).frag=this.frag,t.id=this.id,e===T_.ERROR&&(this.error=t.error),this.hls.trigger(e,t)};this.observer=new sS,this.observer.on(T_.FRAG_DECRYPTED,n),this.observer.on(T_.ERROR,n);const a={mp4:rS.isTypeSupported("video/mp4"),mpeg:rS.isTypeSupported("audio/mpeg"),mp3:rS.isTypeSupported('audio/mp4; codecs="mp3"')},o=navigator.vendor;if(this.useWorker&&"undefined"!=typeof Worker){if(r.workerPath||"function"==typeof __HLS_WORKER_BUNDLE__){try{r.workerPath?(x_.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=function(e){const t=new self.URL(e,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}(r.workerPath)):(x_.log(`injecting Web Worker for "${t}"`),this.workerContext=function(){const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e);return{worker:new self.Worker(t),objectURL:t}}()),this.onwmsg=e=>this.onWorkerMessage(e);const{worker:e}=this.workerContext;e.addEventListener("message",this.onwmsg),e.onerror=e=>{const i=new Error(`${e.message}  (${e.filename}:${e.lineno})`);r.enableWorker=!1,x_.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(T_.ERROR,{type:w_.OTHER_ERROR,details:A_.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:i})},e.postMessage({cmd:"init",typeSupported:a,vendor:o,id:t,config:JSON.stringify(r)})}catch(e){x_.warn(`Error setting up "${t}" Web Worker, fallback to inline`,e),this.resetWorker(),this.error=null,this.transmuxer=new Xb(this.observer,a,r,o,t)}return}}this.transmuxer=new Xb(this.observer,a,r,o,t)}}class aS{destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:i,media:s,stalled:r}=this;if(null===s)return;const{currentTime:n,seeking:a}=s,o=this.seeking&&!a,l=!this.seeking&&a;if(this.seeking=a,n!==e){if(this.moved=!0,null!==r){if(this.stallReported){const e=self.performance.now()-r;x_.warn(`playback not stuck anymore @${n}, after ${Math.round(e)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(l||o)return void(this.stalled=null);if(s.paused&&!a||s.ended||0===s.playbackRate||!Oy.getBuffered(s).length)return;const d=Oy.bufferInfo(s,n,0),c=d.len>0,h=d.nextStart||0;if(!c&&!h)return;if(a){const e=d.len>2,i=!h||t&&t.start<=n||h-n>2&&!this.fragmentTracker.getPartialFragment(n);if(e||i)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var u;const e=Math.max(h,d.start||0)-n,t=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,i=(null==t||null==(u=t.details)?void 0:u.live)?2*t.details.targetduration:2,s=this.fragmentTracker.getPartialFragment(n);if(e>0&&(e<=i||s))return void this._trySkipBufferHole(s)}const p=self.performance.now();if(null===r)return void(this.stalled=p);const g=p-r;if(!a&&g>=250&&(this._reportStall(d),!this.media))return;const m=Oy.bufferInfo(s,n,i.maxBufferHole);this._tryFixBufferStall(m,g)}_tryFixBufferStall(e,t){const{config:i,fragmentTracker:s,media:r}=this;if(null===r)return;const n=r.currentTime,a=s.getPartialFragment(n);if(a){if(this._trySkipBufferHole(a)||!this.media)return}(e.len>i.maxBufferHole||e.nextStart&&e.nextStart-n<i.maxBufferHole)&&t>1e3*i.highBufferWatchdogPeriod&&(x_.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:i,stallReported:s}=this;if(!s&&i){this.stallReported=!0;const s=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${JSON.stringify(e)})`);x_.warn(s.message),t.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:i,media:s}=this;if(null===s)return 0;const r=s.currentTime,n=Oy.bufferInfo(s,r,0),a=r<n.start?n.start:n.nextStart;if(a){const o=n.len<=t.maxBufferHole,l=n.len>0&&n.len<1&&s.readyState<3,d=a-r;if(d>0&&(o||l)){if(d>t.maxBufferHole){const{fragmentTracker:t}=this;let i=!1;if(0===r){const e=t.getAppendedFrag(0,fv);e&&a<e.end&&(i=!0)}if(!i){const i=e||t.getAppendedFrag(r,fv);if(i){let e=!1,s=i.end;for(;s<a;){const i=t.getPartialFragment(s);if(!i){e=!0;break}s+=i.duration}if(e)return 0}}}const n=Math.max(a+.05,r+.1);if(x_.warn(`skipping hole, adjusting currentTime from ${r} to ${n}`),this.moved=!0,this.stalled=null,s.currentTime=n,e&&!e.gap){const t=new Error(`fragment loaded with buffer holes, seeking from ${r} to ${n}`);i.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})}return n}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:i,nudgeRetry:s}=this;if(null===i)return;const r=i.currentTime;if(this.nudgeRetry++,s<e.nudgeMaxRetry){const n=r+(s+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${r} to ${n}`);x_.warn(a.message),i.currentTime=n,t.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const i=new Error(`Playhead still not moving while enough data buffered @${r} after ${e.nudgeMaxRetry} nudges`);x_.error(i.message),t.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.BUFFER_STALLED_ERROR,error:i,fatal:!0})}}constructor(e,t,i,s){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=i,this.hls=s}}class oS extends eb{_registerListeners(){const{hls:e}=this;e.on(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T_.LEVEL_LOADING,this.onLevelLoading,this),e.on(T_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T_.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(T_.ERROR,this.onError,this),e.on(T_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(T_.BUFFER_CREATED,this.onBufferCreated,this),e.on(T_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T_.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T_.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(T_.ERROR,this.onError,this),e.off(T_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(T_.BUFFER_CREATED,this.onBufferCreated,this),e.off(T_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T_.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:i}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let e=i.startLevel;-1===e&&(i.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=i.nextAutoLevel),this.level=i.nextLoadLevel=e,this.loadedmetadata=!1}t>0&&-1===e&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=$y,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=zy}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Zy:{var e;const{levels:t,level:i}=this,s=null==t||null==(e=t[i])?void 0:e.details;if(s&&(!s.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(s))break;this.state=$y;break}if(this.hls.nextLoadLevel!==this.level){this.state=$y;break}break}case Gy:{var t;const e=self.performance.now(),i=this.retryDate;(!i||e>=i||null!=(t=this.media)&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=$y)}}this.state===$y&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:i,media:s}=this,{config:r,nextLoadLevel:n}=e;if(null===t||!s&&(this.startFragRequested||!r.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;if(null==i||!i[n])return;const a=i[n],o=this.getMainFwdBufferInfo();if(null===o)return;const l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){const e={};return this.altAudio&&(e.type="video"),this.hls.trigger(T_.BUFFER_EOS,e),void(this.state=Qy)}e.loadLevel!==n&&-1===e.manualLevel&&this.log(`Adapting to level ${n} from level ${this.level}`),this.level=e.nextLoadLevel=n;const d=a.details;if(!d||this.state===Zy||d.live&&this.levelLastLoaded!==n)return this.level=n,void(this.state=Zy);const c=o.len,h=this.getMaxBufferLength(a.maxBitrate);if(c>=h)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const u=this.backtrackFragment?this.backtrackFragment.start:o.end;let p=this.getNextFragment(u,d);if(this.couldBacktrack&&!this.fragPrevious&&p&&"initSegment"!==p.sn&&this.fragmentTracker.getState(p)!==vy){var g;const e=(null!=(g=this.backtrackFragment)?g:p).sn-d.startSN,t=d.fragments[e-1];t&&p.cc===t.cc&&(p=t,this.fragmentTracker.removeFragment(t))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(p&&this.isLoopLoading(p,u)){if(!p.gap){const e=this.audioOnly&&!this.altAudio?j_:N_,t=(e===N_?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,fv)}p=this.getNextFragmentLoopLoading(p,d,o,fv,h)}p&&(!p.initSegment||p.initSegment.data||this.bitrateTest||(p=p.initSegment),this.loadFragment(p,a,u))}loadFragment(e,t,i){const s=this.fragmentTracker.getState(e);this.fragCurrent=e,s===my||s===fy?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,i)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,fv)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let i;const s=this.getAppendedFrag(t.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*r.targetduration)return}if(!t.paused&&e){const t=e[this.hls.nextLoadLevel],s=this.fragLastKbps;i=s&&this.fragCurrent?this.fragCurrent.duration*t.maxBitrate/(1e3*s)+1:0}else i=0;const n=this.getBufferedFrag(t.currentTime+i);if(n){const e=this.followingBufferedFrag(n);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,i=e.duration,s=Math.max(n.end,t+Math.min(Math.max(i-this.config.maxFragLookUpTolerance,.5*i),.75*i));this.flushMainBuffer(s,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Hy:case qy:case Gy:case Wy:case Yy:this.state=$y}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const i=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),i.addEventListener("playing",this.onvplaying),i.addEventListener("seeked",this.onvseeked),this.gapController=new aS(this.config,i,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;C_(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const i=this.getMainFwdBufferInfo();null!==i&&0!==i.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${i?i.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(T_.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let i,s=!1,r=!1;t.levels.forEach((e=>{i=e.audioCodec,i&&(-1!==i.indexOf("mp4a.40.2")&&(s=!0),-1!==i.indexOf("mp4a.40.5")&&(r=!0))})),this.audioCodecSwitch=s&&r&&!function(){var e;const t=tb();return"function"==typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:i}=this;if(!i||this.state!==$y)return;const s=i[t.level];(!s.details||s.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(s.details))&&(this.state=Zy)}onLevelLoaded(e,t){var i;const{levels:s}=this,r=t.level,n=t.details,a=n.totalduration;if(!s)return void this.warn(`Levels were reset while loading level ${r}`);this.log(`Level ${r} loaded [${n.startSN},${n.endSN}]${n.lastPartSn?`[part-${n.lastPartSn}-${n.lastPartIndex}]`:""}, cc [${n.startCC}, ${n.endCC}] duration:${a}`);const o=s[r],l=this.fragCurrent;!l||this.state!==qy&&this.state!==Gy||l.level===t.level&&l.urlId===o.urlId||!l.loader||this.abortCurrentFrag();let d=0;if(n.live||null!=(i=o.details)&&i.live){if(this.checkLiveUpdate(n),n.deltaUpdateFailed)return;d=this.alignPlaylists(n,o.details)}if(o.details=n,this.levelLastLoaded=r,this.hls.trigger(T_.LEVEL_UPDATED,{details:n,level:r}),this.state===Zy){if(this.waitForCdnTuneIn(n))return;this.state=$y}this.startFragRequested?n.live&&this.synchronizeToLiveEdge(n):this.setStartPosition(n,d),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:i,part:s,payload:r}=e,{levels:n}=this;if(!n)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const a=n[i.level],o=a.details;if(!o)return this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),void this.fragmentTracker.removeFragment(i);const l=a.videoCodec,d=o.PTSKnown||!o.live,c=null==(t=i.initSegment)?void 0:t.data,h=this._getAudioCodec(a),u=this.transmuxer=this.transmuxer||new nS(this.hls,fv,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=s?s.index:-1,g=-1!==p,m=new xy(i.level,i.sn,i.stats.chunkCount,r.byteLength,p,g),_=this.initPTS[i.cc];u.push(r,c,h,l,i,s,o.totalduration,d,m,_)}onAudioTrackSwitching(e,t){const i=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const e=this.hls;i&&(e.trigger(T_.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),e.trigger(T_.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const i=t.id,s=!!this.hls.audioTracks[i].url;if(s){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=s,this.tick()}onBufferCreated(e,t){const i=t.tracks;let s,r,n=!1;for(const e in i){const t=i[e];if("main"===t.id){if(r=e,s=t,"video"===e){const t=i[e];t&&(this.videoBuffer=t.buffer)}}else n=!0}n&&s?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:i,part:s}=t;if(i&&i.type!==fv)return;if(this.fragContextChanged(i))return this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Yy&&(this.state=$y));const r=s?s.stats:i.stats;this.fragLastKbps=Math.round(8*r.total/(r.buffering.end-r.loading.first)),"initSegment"!==i.sn&&(this.fragPrevious=i),this.fragBufferedComplete(i,s)}onError(e,t){var i;if(t.fatal)this.state=Xy;else switch(t.details){case A_.FRAG_GAP:case A_.FRAG_PARSING_ERROR:case A_.FRAG_DECRYPT_ERROR:case A_.FRAG_LOAD_ERROR:case A_.FRAG_LOAD_TIMEOUT:case A_.KEY_LOAD_ERROR:case A_.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(fv,t);break;case A_.LEVEL_LOAD_ERROR:case A_.LEVEL_LOAD_TIMEOUT:case A_.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Zy||(null==(i=t.context)?void 0:i.type)!==gv||(this.state=$y);break;case A_.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case A_.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}checkBuffer(){const{media:e,gapController:t}=this;if(e&&t&&e.readyState){if(this.loadedmetadata||!Oy.getBuffered(e).length){const e=this.state!==$y?this.fragCurrent:null;t.poll(this.lastCurrentTime,e)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=$y,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==j_||this.audioOnly&&!this.altAudio){const e=(t===N_?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(e,t,fv)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let i=this.startPosition;if(i>=0&&t<i){if(e.seeking)return void this.log(`could not seek to ${i}, already seeking at ${t}`);const s=Oy.getBuffered(e),r=(s.length?s.start(0):0)-i;r>0&&(r<this.config.maxBufferHole||r<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${r} to match buffer start`),i+=r,this.startPosition=i),this.log(`seek to target start position ${i} from current time ${t}`),e.currentTime=i}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then((i=>{const{hls:s}=this;if(!i||this.fragContextChanged(e))return;t.fragmentError=0,this.state=$y,this.startFragRequested=!1,this.bitrateTest=!1;const r=e.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),s.trigger(T_.FRAG_LOADED,i),e.bitrateTest=!1}))}_handleTransmuxComplete(e){var t;const i="main",{hls:s}=this,{remuxResult:r,chunkMeta:n}=e,a=this.getCurrentContext(n);if(!a)return void this.resetWhenMissingContext(n);const{frag:o,part:l,level:d}=a,{video:c,text:h,id3:u,initSegment:p}=r,{details:g}=d,m=this.altAudio?void 0:r.audio;if(this.fragContextChanged(o))this.fragmentTracker.removeFragment(o);else{if(this.state=Wy,p){if(null!=p&&p.tracks){const e=o.initSegment||o;this._bufferInitSegment(d,p.tracks,e,n),s.trigger(T_.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:i,tracks:p.tracks})}const e=p.initPTS,t=p.timescale;C_(e)&&(this.initPTS[o.cc]={baseTime:e,timescale:t},s.trigger(T_.INIT_PTS_FOUND,{frag:o,id:i,initPTS:e,timescale:t}))}if(c&&g&&"initSegment"!==o.sn){const e=g.fragments[o.sn-1-g.startSN],t=o.sn===g.startSN,i=!e||o.cc>e.cc;if(!1!==r.independent){const{startPTS:e,endPTS:s,startDTS:r,endDTS:a}=c;if(l)l.elementaryStreams[c.type]={startPTS:e,endPTS:s,startDTS:r,endDTS:a};else if(c.firstKeyFrame&&c.independent&&1===n.id&&!i&&(this.couldBacktrack=!0),c.dropped&&c.independent){const r=this.getMainFwdBufferInfo(),n=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,l=c.firstKeyFramePTS?c.firstKeyFramePTS:e;if(!t&&n<l-this.config.maxBufferHole&&!i)return void this.backtrack(o);i&&(o.gap=!0),o.setElementaryStreamInfo(c.type,o.start,s,o.start,a,!0)}o.setElementaryStreamInfo(c.type,e,s,r,a),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(c,o,l,n,t||i)}else{if(!t&&!i)return void this.backtrack(o);o.gap=!0}}if(m){const{startPTS:e,endPTS:t,startDTS:i,endDTS:s}=m;l&&(l.elementaryStreams[j_]={startPTS:e,endPTS:t,startDTS:i,endDTS:s}),o.setElementaryStreamInfo(j_,e,t,i,s),this.bufferFragmentData(m,o,l,n)}if(g&&null!=u&&null!=(t=u.samples)&&t.length){const e={id:i,frag:o,details:g,samples:u.samples};s.trigger(T_.FRAG_PARSING_METADATA,e)}if(g&&h){const e={id:i,frag:o,details:g,samples:h.samples};s.trigger(T_.FRAG_PARSING_USERDATA,e)}}}_bufferInitSegment(e,t,i,s){if(this.state!==Wy)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:r,video:n,audiovideo:a}=t;if(r){let t=e.audioCodec;const i=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==r.metadata.channelCount&&-1===i.indexOf("firefox")&&(t="mp4a.40.5")),-1!==i.indexOf("android")&&"audio/mpeg"!==r.container&&(t="mp4a.40.2",this.log(`Android: force audio codec to ${t}`)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),r.levelCodec=t,r.id="main",this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${r.codec}]`)}n&&(n.levelCodec=e.videoCodec,n.id="main",this.log(`Init video buffer, container:${n.container}, codecs[level/parsed]=[${e.videoCodec||""}/${n.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${a.codec}]`),this.hls.trigger(T_.BUFFER_CODECS,t),Object.keys(t).forEach((e=>{const r=t[e].initSegment;null!=r&&r.byteLength&&this.hls.trigger(T_.BUFFER_APPENDING,{type:e,data:r,frag:i,part:null,chunkMeta:s,parent:i.type})})),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,fv)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=$y}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const i=e.currentTime;if(Oy.isBuffered(e,i)?t=this.getAppendedFrag(i):Oy.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,i=t.level;e&&t.sn===e.sn&&e.level===i&&t.urlId===e.urlId||(this.fragPlaying=t,this.hls.trigger(T_.FRAG_CHANGED,{frag:t}),e&&e.level===i||this.hls.trigger(T_.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,i=this.currentFrag;if(i&&C_(t)&&C_(i.programDateTime)){const e=i.programDateTime+1e3*(t-i.start);return new Date(e)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}constructor(e,t,i){super(e,t,i,"[stream-controller]",fv),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}}class lS{sample(e,t){const i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}}class dS{update(e,t){const{slow_:i,fast_:s,ttfb_:r}=this;i.halfLife!==e&&(this.slow_=new lS(e,i.getEstimate(),i.getTotalWeight())),s.halfLife!==t&&(this.fast_=new lS(t,s.getEstimate(),s.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new lS(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){const i=(e=Math.max(e,this.minDelayMs_))/1e3,s=8*t/i;this.fast_.sample(i,s),this.slow_.sample(i,s)}sampleTTFB(e){const t=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}constructor(e,t,i,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new lS(e),this.fast_=new lS(t),this.defaultTTFB_=s,this.ttfb_=new lS(e)}}class cS{push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let i;return e.length?(i=1===e.length?e[0]:function(e,t){const i=new Uint8Array(t);let s=0;for(let t=0;t<e.length;t++){const r=e[t];i.set(r,s),s+=r.length}return i}(e,t),this.reset(),i):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}constructor(){this.chunks=[],this.dataLength=0}}function hS(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!uS(e[i].attrs,t[i].attrs))return!1;return!0}function uS(e,t){const i=e["STABLE-RENDITION-ID"];return i?i===t["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some((i=>e[i]!==t[i]))}class pS{constructor(e){this.buffered=void 0;const t=(t,i,s)=>{if((i>>>=0)>s-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${s})`);return e[i][t]};this.buffered={get length(){return e.length},end:i=>t("end",i,e.length),start:i=>t("start",i,e.length)}}}function gS(e){const t=[];for(let i=0;i<e.length;i++){const s=e[i];"subtitles"!==s.kind&&"captions"!==s.kind||!s.label||t.push(e[i])}return t}class mS{append(e,t){const i=this.queues[t];i.push(e),1===i.length&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const i=new Promise((e=>{t=e})),s={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(s,e),i}executeNext(e){const{buffers:t,queues:i}=this,s=t[e],r=i[e];if(r.length){const t=r[0];try{t.execute()}catch(i){x_.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),t.onError(i),null!=s&&s.updating||(r.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}}const _S=Qf(),fS=/([ha]vc.)(?:\.[^.,]+)+/;const vS={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},yS=function(e){let t=e;return vS.hasOwnProperty(e)&&(t=vS[e]),String.fromCharCode(t)},bS=15,SS=100,ES={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},CS={17:2,18:4,21:6,22:8,23:10,19:13,20:15},TS={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},wS={25:2,26:4,29:6,30:8,31:10,27:13,28:15},AS=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class kS{log(e,t){if(this.verboseLevel>=e){const i="function"==typeof t?t():t;x_.log(`${this.time} [${e}] ${i}`)}}constructor(){this.time=null,this.verboseLevel=0}}const IS=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class PS{reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){const s=t[i];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}constructor(e,t,i,s,r){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=i||!1,this.background=s||"black",this.flash=r||!1}}class OS{reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}constructor(e,t,i,s,r,n){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new PS(t,i,s,r,n)}}class xS{equals(e){let t=!0;for(let i=0;i<SS;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t}copy(e){for(let t=0;t<SS;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<SS;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>SS&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=SS)}moveCursor(e){const t=this.pos+e;if(e>1)for(let e=this.pos+1;e<t+1;e++)this.chars[e].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=yS(e);this.pos>=SS?this.logger.log(0,(()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<SS;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let i=0;i<SS;i++){const s=this.chars[i].uchar;" "!==s&&(t=!1),e.push(s)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e);this.chars[this.pos].setPenState(this.currPenState)}constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let e=0;e<SS;e++)this.chars.push(new OS);this.logger=e,this.pos=0,this.currPenState=new PS}}class RS{reset(){for(let e=0;e<bS;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let i=0;i<bS;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<bS;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<bS;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e);this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,(()=>"pacData = "+JSON.stringify(e)));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let e=0;e<bS;e++)this.rows[e].clear();const e=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){const s=i.rows[e].cueStartTime,r=this.logger.time;if(s&&null!==r&&s<r)for(let s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(i.rows[e+s])}}this.currRow=t;const i=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,s=Math.max(t-1,0);i.setCursor(e.indent),e.color=i.chars[s].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,(()=>"bkgData = "+JSON.stringify(e))),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let i="",s=-1;for(let i=0;i<bS;i++){const r=this.rows[i].getTextString();r&&(s=i+1,e?t.push("Row "+s+": '"+r+"'"):t.push(r.trim()))}return t.length>0&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i}getTextAndFormat(){return this.rows}constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<bS;t++)this.rows.push(new xS(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}}class DS{reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(()=>"MODE="+e)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>t+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{const i=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=s[i]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new RS(i),this.nonDisplayedMemory=new RS(i),this.lastOutputScreen=new RS(i),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}}class LS{getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let i,s,r,n=!1;this.logger.time=e;for(let e=0;e<t.length;e+=2)if(s=127&t[e],r=127&t[e+1],0!==s||0!==r){if(this.logger.log(3,"["+IS([t[e],t[e+1]])+"] -> ("+IS([s,r])+")"),i=this.parseCmd(s,r),i||(i=this.parseMidrow(s,r)),i||(i=this.parsePAC(s,r)),i||(i=this.parseBackgroundAttributes(s,r)),!i&&(n=this.parseChars(s,r),n)){const e=this.currentChannel;if(e&&e>0){this.channels[e].insertChars(n)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}i||n||this.logger.log(2,"Couldn't parse cleaned data "+IS([s,r])+" orig: "+IS([t[e],t[e+1]]))}}parseCmd(e,t){const{cmdHistory:i}=this;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;if(BS(e,t,i))return MS(null,null,i),this.logger.log(3,"Repeated command ("+IS([e,t])+") is dropped"),!0;const s=20===e||21===e||23===e?1:2,r=this.channels[s];return 20===e||21===e||28===e||29===e?32===t?r.ccRCL():33===t?r.ccBS():34===t?r.ccAOF():35===t?r.ccAON():36===t?r.ccDER():37===t?r.ccRU(2):38===t?r.ccRU(3):39===t?r.ccRU(4):40===t?r.ccFON():41===t?r.ccRDC():42===t?r.ccTR():43===t?r.ccRTD():44===t?r.ccEDM():45===t?r.ccCR():46===t?r.ccENM():47===t&&r.ccEOC():r.ccTO(t-32),MS(e,t,i),this.currentChannel=s,!0}parseMidrow(e,t){let i=0;if((17===e||25===e)&&t>=32&&t<=47){if(i=17===e?1:2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[i];return!!s&&(s.ccMIDROW(t),this.logger.log(3,"MIDROW ("+IS([e,t])+")"),!0)}return!1}parsePAC(e,t){let i;const s=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;if(BS(e,t,s))return MS(null,null,s),!0;const r=e<=23?1:2;i=t>=64&&t<=95?1===r?ES[e]:TS[e]:1===r?CS[e]:wS[e];const n=this.channels[r];return!!n&&(n.setPAC(this.interpretPAC(i,t)),MS(e,t,s),this.currentChannel=r,!0)}interpretPAC(e,t){let i;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return i=t>95?t-96:t-64,s.underline=!(1&~i),i<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(s.italics=!0,s.color="white"):s.indent=4*Math.floor((i-16)/2),s}parseChars(e,t){let i,s=null,r=null;if(e>=25?(i=2,r=e-8):(i=1,r=e),r>=17&&r<=19){let e;e=17===r?t+80:18===r?t+112:t+144,this.logger.log(2,"Special char '"+yS(e)+"' in channel "+i),s=[e]}else e>=32&&e<=127&&(s=0===t?[e]:[e,t]);if(s){const i=IS(s);this.logger.log(3,"Char codes =  "+i.join(",")),MS(e,t,this.cmdHistory)}return s}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=45&&t<=47))return!1;let i;const s={};16===e||24===e?(i=Math.floor((t-32)/2),s.background=AS[i],t%2==1&&(s.background=s.background+"_semi")):45===t?s.background="transparent":(s.foreground="black",47===t&&(s.underline=!0));const r=e<=23?1:2;return this.channels[r].setBkgData(s),MS(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const i=this.channels[t];i&&i.cueSplitAtTime(e)}}constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const s=new kS;this.channels=[null,new DS(e,t,s),new DS(e+1,i,s)],this.cmdHistory={a:null,b:null},this.logger=s}}function MS(e,t,i){i.a=e,i.b=t}function BS(e,t,i){return i.a===e&&i.b===t}class FS{dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}}var jS=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function i(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;const i=t.toLowerCase();return!!~e.indexOf(i)&&i}function s(e){return i(t,e)}function r(e,...t){let i=1;for(;i<arguments.length;i++){const t=arguments[i];for(const i in t)e[i]=t[i]}return e}function n(t,n,a){const o=this,l={enumerable:!0};o.hasBeenReset=!1;let d="",c=!1,h=t,u=n,p=a,g=null,m="",_=!0,f="auto",v="start",y=50,b="middle",S=50,E="middle";Object.defineProperty(o,"id",r({},l,{get:function(){return d},set:function(e){d=""+e}})),Object.defineProperty(o,"pauseOnExit",r({},l,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(o,"startTime",r({},l,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",r({},l,{get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",r({},l,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",r({},l,{get:function(){return g},set:function(e){g=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",r({},l,{get:function(){return m},set:function(t){const s=function(t){return i(e,t)}(t);if(!1===s)throw new SyntaxError("An invalid or illegal string was specified.");m=s,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",r({},l,{get:function(){return _},set:function(e){_=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",r({},l,{get:function(){return f},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",r({},l,{get:function(){return v},set:function(e){const t=s(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",r({},l,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",r({},l,{get:function(){return b},set:function(e){const t=s(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",r({},l,{get:function(){return S},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");S=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",r({},l,{get:function(){return E},set:function(e){const t=s(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),o.displayState=void 0}return n.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},n}();class NS{decode(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function US(e){function t(e,t,i,s){return 3600*(0|e)+60*(0|t)+(0|i)+parseFloat(s||0)}const i=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return i?parseFloat(i[2])>59?t(i[2],i[3],0,i[4]):t(i[1],i[2],i[3],i[4]):null}class VS{set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let s=0;s<i.length;++s)if(t===i[s]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}constructor(){this.values=Object.create(null)}}function zS(e,t,i,s){const r=s?e.split(s):[e];for(const e in r){if("string"!=typeof r[e])continue;const s=r[e].split(i);if(2!==s.length)continue;t(s[0],s[1])}}const $S=new jS(0,0,""),HS="middle"===$S.align?"middle":"center";function qS(e,t,i){const s=e;function r(){const t=US(e);if(null===t)throw new Error("Malformed timestamp: "+s);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function n(){e=e.replace(/^\s+/,"")}if(n(),t.startTime=r(),n(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+s);e=e.slice(3),n(),t.endTime=r(),n(),function(e,t){const s=new VS;zS(e,(function(e,t){let r;switch(e){case"region":for(let r=i.length-1;r>=0;r--)if(i[r].id===t){s.set(e,i[r].region);break}break;case"vertical":s.alt(e,t,["rl","lr"]);break;case"line":r=t.split(","),s.integer(e,r[0]),s.percent(e,r[0])&&s.set("snapToLines",!1),s.alt(e,r[0],["auto"]),2===r.length&&s.alt("lineAlign",r[1],["start",HS,"end"]);break;case"position":r=t.split(","),s.percent(e,r[0]),2===r.length&&s.alt("positionAlign",r[1],["start",HS,"end","line-left","line-right","auto"]);break;case"size":s.percent(e,t);break;case"align":s.alt(e,t,["start",HS,"end","left","right"])}}),/:/,/\s/),t.region=s.get("region",null),t.vertical=s.get("vertical","");let r=s.get("line","auto");"auto"===r&&-1===$S.line&&(r=-1),t.line=r,t.lineAlign=s.get("lineAlign","start"),t.snapToLines=s.get("snapToLines",!0),t.size=s.get("size",100),t.align=s.get("align",HS);let n=s.get("position","auto");"auto"===n&&50===$S.position&&(n="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=n}(e,t)}function GS(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class KS{parse(e){const t=this;function i(){let e=t.buffer,i=0;for(e=GS(e);i<e.length&&"\r"!==e[i]&&"\n"!==e[i];)++i;const s=e.slice(0,i);return"\r"===e[i]&&++i,"\n"===e[i]&&++i,t.buffer=e.slice(i),s}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=i();const s=e.match(/^()?WEBVTT([ \t].*)?$/);if(null==s||!s[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let s=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:e=i(),t.state){case"HEADER":/:/.test(e)?zS(e,(function(e,t){}),/:/):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new jS(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{qS(e,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const i=-1!==e.indexOf("--\x3e");if(!e||i&&(s=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}constructor(){this.state="INITIAL",this.buffer="",this.decoder=new NS,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}}const WS=/\r\n|\n\r|\n|\r/g,YS=function(e,t,i=0){return e.slice(i,i+t.length)===t},QS=function(e){let t=5381,i=e.length;for(;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()};function XS(e,t,i){return QS(e.toString())+QS(t.toString())+QS(i)}function JS(e,t,i,s,r,n,a){const o=new KS,l=yf(new Uint8Array(e)).trim().replace(WS,"\n").split("\n"),d=[],c=t?function(e,t=1){return jb(e,Fb,1/t)}(t.baseTime,t.timescale):0;let h,u="00:00.000",p=0,g=0,m=!0;o.oncue=function(e){const n=i[s];let a=i.ccOffset;const o=(p-c)/9e4;if(null!=n&&n.new&&(void 0!==g?a=i.ccOffset=n.start:function(e,t,i){let s=e[t],r=e[s.prevCC];if(!r||!r.new&&s.new)return e.ccOffset=e.presentationOffset=s.start,void(s.new=!1);for(;null!=(n=r)&&n.new;){var n;e.ccOffset+=s.start-r.start,s.new=!1,s=r,r=e[s.prevCC]}e.presentationOffset=i}(i,s,o)),o){if(!t)return void(h=new Error("Missing initPTS for VTT MPEGTS"));a=o-i.presentationOffset}const l=e.endTime-e.startTime,u=Hb(9e4*(e.startTime+a-g),9e4*r)/9e4;e.startTime=Math.max(u,0),e.endTime=Math.max(u+l,0);const m=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(m)),e.id||(e.id=XS(e.startTime,e.endTime,m)),e.endTime>0&&d.push(e)},o.onparsingerror=function(e){h=e},o.onflush=function(){h?a(h):n(d)},l.forEach((e=>{if(m){if(YS(e,"X-TIMESTAMP-MAP=")){m=!1,e.slice(16).split(",").forEach((e=>{YS(e,"LOCAL:")?u=e.slice(6):YS(e,"MPEGTS:")&&(p=parseInt(e.slice(7)))}));try{g=function(e){let t=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(C_(t)&&C_(i)&&C_(s)&&C_(r)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*i,t+=6e4*s,t+=36e5*r,t}(u)/1e3}catch(e){h=e}return}""===e&&(m=!1)}o.parse(e+"\n")})),o.flush()}const ZS="stpp.ttml.im1t",eE=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,tE=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,iE={left:"start",center:"center",right:"end",start:"start",end:"end"};function sE(e,t,i,s){const r=xf(new Uint8Array(e),["mdat"]);if(0===r.length)return void s(new Error("Could not parse IMSC1 mdat"));const n=r.map((e=>yf(e))),a=function(e,t,i=1,s=!1){return jb(e,t,1/i,s)}(t.baseTime,1,t.timescale);try{n.forEach((e=>i(function(e,t){const i=(new DOMParser).parseFromString(e,"text/xml"),s=i.getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},n=Object.keys(r).reduce(((e,t)=>(e[t]=s.getAttribute(`ttp:${t}`)||r[t],e)),{}),a="preserve"!==s.getAttribute("xml:space"),o=nE(rE(s,"styling","style")),l=nE(rE(s,"layout","region")),d=rE(s,"body","[begin]");return[].map.call(d,(e=>{const i=aE(e,a);if(!i||!e.hasAttribute("begin"))return null;const s=dE(e.getAttribute("begin"),n),r=dE(e.getAttribute("dur"),n);let d=dE(e.getAttribute("end"),n);if(null===s)throw lE(e);if(null===d){if(null===r)throw lE(e);d=s+r}const c=new jS(s-t,d-t,i);c.id=XS(c.startTime,c.endTime,c.text);const h=function(e,t,i){const s="http://www.w3.org/ns/ttml#styling";let r=null;const n=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;a&&i.hasOwnProperty(a)&&(r=i[a]);return n.reduce(((i,n)=>{const a=oE(t,s,n)||oE(e,s,n)||oE(r,s,n);return a&&(i[n]=a),i}),{})}(l[e.getAttribute("region")],o[e.getAttribute("style")],o),{textAlign:u}=h;if(u){const e=iE[u];e&&(c.lineAlign=e),c.align=u}return E_(c,h),c})).filter((e=>null!==e))}(e,a))))}catch(e){s(e)}}function rE(e,t,i){const s=e.getElementsByTagName(t)[0];return s?[].slice.call(s.querySelectorAll(i)):[]}function nE(e){return e.reduce(((e,t)=>{const i=t.getAttribute("xml:id");return i&&(e[i]=t),e}),{})}function aE(e,t){return[].slice.call(e.childNodes).reduce(((e,i,s)=>{var r;return"br"===i.nodeName&&s?e+"\n":null!=(r=i.childNodes)&&r.length?aE(i,t):t?e+i.textContent.trim().replace(/\s+/g," "):e+i.textContent}),"")}function oE(e,t,i){return e&&e.hasAttributeNS(t,i)?e.getAttributeNS(t,i):null}function lE(e){return new Error(`Could not parse ttml timestamp ${e}`)}function dE(e,t){if(!e)return null;let i=US(e);return null===i&&(eE.test(e)?i=function(e,t){const i=eE.exec(e),s=(0|i[4])+(0|i[5])/t.subFrameRate;return 3600*(0|i[1])+60*(0|i[2])+(0|i[3])+s/t.frameRate}(e,t):tE.test(e)&&(i=function(e,t){const i=tE.exec(e),s=Number(i[1]);switch(i[2]){case"h":return 3600*s;case"m":return 60*s;case"ms":return 1e3*s;case"f":return s/t.frameRate;case"t":return s/t.tickRate}return s}(e,t))),i}function cE(e,t){return!!e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}class hE{setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(T_.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(T_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T_.BUFFER_CODECS,this.onBufferCodecs,this),e.on(T_.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(T_.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(T_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T_.BUFFER_CODECS,this.onBufferCodecs,this),e.off(T_.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const i=t.filter(((t,i)=>this.isLevelAllowed(t)&&i<=e));return this.clientRect=null,hE.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,t.width||t.height||(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}isLevelAllowed(e){return!this.restrictedLevels.some((t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height))}static getMaxLevelByMediaSize(e,t,i){if(null==e||!e.length)return-1;let s=e.length-1;for(let a=0;a<e.length;a+=1){const o=e[a];if((o.width>=t||o.height>=i)&&(r=o,!(n=e[a+1])||r.width!==n.width||r.height!==n.height)){s=a;break}}var r,n;return s}constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}}const uE="[eme]";class pE{destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(T_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(T_.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(T_.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(T_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(T_.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(T_.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:i}=this.config,s=t[e];if(s)return s.licenseUrl;if(e===W_.WIDEVINE&&i)return i;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,i=t[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,i=(e,t,i)=>!!e&&i.indexOf(e)===t,s=t.map((e=>e.audioCodec)).filter(i),r=t.map((e=>e.videoCodec)).filter(i);return s.length+r.length===0&&r.push("avc1.42e01e"),new Promise(((t,i)=>{const n=e=>{const a=e.shift();this.getMediaKeysPromise(a,s,r).then((e=>t({keySystem:a,mediaKeys:e}))).catch((t=>{e.length?n(e):i(t instanceof gE?t:new gE({type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))};n(e)}))}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:i}=this.config;if("function"!=typeof i){let e=`Configured requestMediaKeySystemAccess is not a function ${i}`;return null===rf&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return i(e,t)}getMediaKeysPromise(e,t,i){const s=function(e,t,i,s){let r;switch(e){case W_.FAIRPLAY:r=["cenc","sinf"];break;case W_.WIDEVINE:case W_.PLAYREADY:r=["cenc"];break;case W_.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return function(e,t,i,s){return[{initDataTypes:e,persistentState:s.persistentState||"not-allowed",distinctiveIdentifier:s.distinctiveIdentifier||"not-allowed",sessionTypes:s.sessionTypes||[s.sessionType||"temporary"],audioCapabilities:t.map((e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:s.audioRobustness||"",encryptionScheme:s.audioEncryptionScheme||null}))),videoCapabilities:i.map((e=>({contentType:`video/mp4; codecs="${e}"`,robustness:s.videoRobustness||"",encryptionScheme:s.videoEncryptionScheme||null})))}]}(r,t,i,s)}(e,t,i,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let n=null==r?void 0:r.keySystemAccess;if(!n){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(s)}`),n=this.requestMediaKeySystemAccess(e,s);const t=this.keySystemAccessPromises[e]={keySystemAccess:n};return n.catch((t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)})),n.then((i=>{this.log(`Access for key-system "${i.keySystem}" obtained`);const s=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=i.createMediaKeys().then((t=>(this.log(`Media-keys created for "${e}"`),s.then((i=>i?this.setMediaKeysServerCertificate(t,e,i):t))))),t.mediaKeys.catch((t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)})),t.mediaKeys}))}return n.then((()=>r.mediaKeys))}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:i}){this.log(`Creating key-system session "${t}" keyId: ${Ef(e.keyId||[])}`);const s=i.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:i,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const i=this.createMediaKeySessionContext(e),s=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(i,r,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return Ef(e.keyId)}updateKeySession(e,t){var i;const s=e.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${Ef((null==(i=e.decryptdata)?void 0:i.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),s.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise(((t,i)=>{const s=sf(this.config),r=e.map(Z_).filter((e=>!!e&&-1!==s.indexOf(e)));return this.getKeySystemSelectionPromise(r).then((({keySystem:e})=>{const s=tf(e);s?t(s):i(new Error(`Unable to find format for key-system "${e}"`))})).catch(i)}))}loadKey(e){const t=e.keyInfo.decryptdata,i=this.getKeyIdString(t),s=`(keyId: ${i} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${s}`);let r=this.keyIdToKeySessionPromise[i];return r||(r=this.keyIdToKeySessionPromise[i]=this.getKeySystemForKeyPromise(t).then((({keySystem:i,mediaKeys:r})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${s}`),this.attemptSetMediaKeys(i,r).then((()=>{this.throwIfDestroyed();const e=this.createMediaKeySessionContext({keySystem:i,mediaKeys:r,decryptdata:t});return this.generateRequestWithPreferredKeySession(e,"cenc",t.pssh,"playlist-key")}))))),r.catch((e=>this.handleError(e)))),r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof gE?this.hls.trigger(T_.ERROR,e.data):this.hls.trigger(T_.ERROR,{type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),i=this.keyIdToKeySessionPromise[t];if(!i){const t=Z_(e.keyFormat),i=t?[t]:sf(this.config);return this.attemptKeySystemAccess(i)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=sf(this.config)),0===e.length)throw new gE({type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:i}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),null===i)return;let s,r;if("sinf"===t&&this.config.drmSystems[W_.FAIRPLAY]){const e=Af(new Uint8Array(i));try{const t=q_(JSON.parse(e).sinf),i=Lf(new Uint8Array(t));if(!i)return;s=i.subarray(8,24),r=W_.FAIRPLAY}catch(e){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{const e=function(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;const t={version:0,systemId:"",kids:null,data:null},i=new DataView(e),s=i.getUint32(0);if(e.byteLength!==s&&s>44)return null;if(1886614376!==i.getUint32(4))return null;if(t.version=i.getUint32(8)>>>24,t.version>1)return null;t.systemId=Ef(new Uint8Array(e,12,16));const r=i.getUint32(28);if(0===t.version){if(s-32<r)return null;t.data=new Uint8Array(e,32,r)}else if(1===t.version){t.kids=[];for(let i=0;i<r;i++)t.kids.push(new Uint8Array(e,32+16*i,16))}return t}(i);if(null===e)return;0===e.version&&e.systemId===ef&&e.data&&(s=e.data.subarray(8,24)),r=function(e){if(e===ef)return W_.WIDEVINE}(e.systemId)}if(!r||!s)return;const n=Ef(s),{keyIdToKeySessionPromise:a,mediaKeySessions:o}=this;let l=a[n];for(let e=0;e<o.length;e++){const r=o[e],d=r.decryptdata;if(d.pssh||!d.keyId)continue;const c=Ef(d.keyId);if(n===c||-1!==d.uri.replace(/-/g,"").indexOf(n)){l=a[c],delete a[c],d.pssh=new Uint8Array(i),d.keyId=s,l=a[n]=l.then((()=>this.generateRequestWithPreferredKeySession(r,t,i,"encrypted-event-key-match")));break}}l||(l=a[n]=this.getKeySystemSelectionPromise([r]).then((({keySystem:e,mediaKeys:r})=>{var a;this.throwIfDestroyed();const o=new $f("ISO-23001-7",n,null!=(a=tf(e))?a:"");return o.pssh=new Uint8Array(i),o.keyId=s,this.attemptSetMediaKeys(e,r).then((()=>{this.throwIfDestroyed();const s=this.createMediaKeySessionContext({decryptdata:o,keySystem:e,mediaKeys:r});return this.generateRequestWithPreferredKeySession(s,t,i,"encrypted-event-no-match")}))}))),l.catch((e=>this.handleError(e)))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(i).then((()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(s),s.then((()=>{this.log(`Media-keys set for "${e}"`),i.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((e=>-1===i.indexOf(e)))}))}generateRequestWithPreferredKeySession(e,t,i,s){var r,n;const a=null==(r=this.config.drmSystems)||null==(n=r[e.keySystem])?void 0:n.generateRequest;if(a)try{const s=a.call(this.hls,t,i,e);if(!s)throw new Error("Invalid response from configured generateRequest filter");t=s.initDataType,i=e.decryptdata.pssh=s.initData?new Uint8Array(s.initData):null}catch(e){var o;if(this.warn(e.message),null!=(o=this.hls)&&o.config.debug)throw e}if(null===i)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${s}": ${l} (init data type: ${t} length: ${i?i.byteLength:null})`);const d=new sS;e.mediaKeysSession.onmessage=t=>{const i=e.mediaKeysSession;if(!i)return void d.emit("error",new Error("invalid state"));const{messageType:s,message:r}=t;this.log(`"${s}" message event for session "${i.sessionId}" message size: ${r.byteLength}`),"license-request"===s||"license-renewal"===s?this.renewLicense(e,r).catch((e=>{this.handleError(e),d.emit("error",e)})):"license-release"===s?e.keySystem===W_.FAIRPLAY&&(this.updateKeySession(e,K_("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${s}"`)},e.mediaKeysSession.onkeystatuseschange=t=>{if(!e.mediaKeysSession)return void d.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const i=e.keyStatus;d.emit("keyStatus",i),"expired"===i&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))};const c=new Promise(((e,t)=>{d.on("error",t),d.on("keyStatus",(i=>{i.startsWith("usable")?e():"output-restricted"===i?t(new gE({type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===i?t(new gE({type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${i}"`)):"expired"===i?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${i}"`)}))}));return e.mediaKeysSession.generateRequest(t,i).then((()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${l}`)})).catch((e=>{throw new gE({type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)})).then((()=>c)).catch((t=>{throw d.removeAllListeners(),this.removeSession(e),t})).then((()=>(d.removeAllListeners(),e)))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach(((t,i)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Ef("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${Ef(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t}))}fetchServerCertificate(e){const t=this.config,i=new(0,t.loader)(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching serverCertificate for "${e}"`),new Promise(((r,n)=>{const a={responseType:"arraybuffer",url:s},o=t.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(e,t,i,s)=>{r(e.data)},onError:(t,i,r,o)=>{n(new gE({type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:b_({url:a.url,data:void 0},t)},`"${e}" certificate request failed (${s}). Status: ${t.code} (${t.text})`))},onTimeout:(t,i,r)=>{n(new gE({type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:a.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(e,t,i)=>{n(new Error("aborted"))}};i.load(a,l,d)}))):Promise.resolve()}setMediaKeysServerCertificate(e,t,i){return new Promise(((s,r)=>{e.setServerCertificate(i).then((r=>{this.log(`setServerCertificate ${r?"success":"not supported by CDM"} (${null==i?void 0:i.byteLength}) on "${t}"`),s(e)})).catch((e=>{r(new gE({type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then((t=>this.updateKeySession(e,new Uint8Array(t)).catch((e=>{throw new gE({type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))))}setupLicenseXHR(e,t,i,s){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then((()=>{if(!i.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,i,s)})).catch((n=>{if(!i.decryptdata)throw n;return e.open("POST",t,!0),r.call(this.hls,e,t,i,s)})).then((i=>{e.readyState||e.open("POST",t,!0);return{xhr:e,licenseChallenge:i||s}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,t){const i=this.config.keyLoadPolicy.default;return new Promise(((s,r)=>{const n=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${n}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let t=a.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const i=this.config.licenseResponseCallback;if(i)try{t=i.call(this.hls,a,n,e)}catch(e){this.error(e)}s(t)}else{const o=i.errorRetry,l=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)r(new gE({type:w_.KEY_SYSTEM_ERROR,details:A_.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:n,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${n}). Status: ${a.status} (${a.statusText})`));else{const i=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${i} attempts left`),this.requestLicense(e,t).then(s,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,n,e,t).then((({xhr:e,licenseChallenge:t})=>{e.send(t)}))}))}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const i=t.media;this.media=i,i.addEventListener("encrypted",this.onMediaEncrypted),i.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},$f.clearKeyUriToKeyIdMap();const i=t.length;pE.CDMCleanupPromise=Promise.all(t.map((e=>this.removeSession(e))).concat(null==e?void 0:e.setMediaKeys(null).catch((t=>{this.log(`Could not clear media keys: ${t}. media.src: ${null==e?void 0:e.src}`)})))).then((()=>{i&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)})).catch((t=>{this.log(`Could not close sessions and clear media keys: ${t}. media.src: ${null==e?void 0:e.src}`)}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce(((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e)),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:i}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(e);return s>-1&&this.mediaKeySessions.splice(s,1),t.remove().catch((e=>{this.log(`Could not remove session: ${e}`)})).then((()=>t.close())).catch((e=>{this.log(`Could not close session: ${e}`)}))}}constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=pE.CDMCleanupPromise?[pE.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=x_.debug.bind(x_,uE),this.log=x_.log.bind(x_,uE),this.warn=x_.warn.bind(x_,uE),this.error=x_.error.bind(x_,uE),this.hls=e,this.config=e.config,this.registerListeners()}}pE.CDMCleanupPromise=void 0;class gE extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var mE="m",_E="a",fE="v",vE="av",yE="i",bE="tt";class SE{registerListeners(){const e=this.hls;e.on(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T_.MEDIA_DETACHED,this.onMediaDetached,this),e.on(T_.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T_.MEDIA_DETACHED,this.onMediaDetached,this),e.off(T_.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,s;this.audioBuffer=null==(i=t.tracks.audio)?void 0:i.buffer,this.videoBuffer=null==(s=t.tracks.video)?void 0:s.buffer}createData(){var e;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){E_(t,this.createData());const i=t.ot===yE||t.ot===fE||t.ot===vE;if(this.starved&&i&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering),this.useHeaders){const i=SE.toHeaders(t);if(!Object.keys(i).length)return;e.headers||(e.headers={}),E_(e.headers,i)}else{const i=SE.toQuery(t);if(!i)return;e.url=SE.appendQueryToUri(e.url,i)}}getObjectType(e){const{type:t}=e;return"subtitle"===t?bE:"initSegment"===e.sn?yE:"audio"===t?_E:"main"===t?this.hls.audioTracks.length?fE:vE:void 0}getTopBandwidth(e){let t,i=0;const s=this.hls;if(e===_E)t=s.audioTracks;else{const e=s.maxAutoLevel,i=e>-1?e+1:s.levels.length;t=s.levels.slice(0,i)}for(const e of t)e.bitrate>i&&(i=e.bitrate);return i>0?i:NaN}getBufferLength(e){const t=this.hls.media,i=e===_E?this.audioBuffer:this.videoBuffer;if(!i||!t)return NaN;return 1e3*Oy.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,i,s){t(e),this.loader.load(e,i,s)}constructor(e){this.loader=void 0,this.loader=new i(e)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,i,s){t(e),this.loader.load(e,i,s)}constructor(e){this.loader=void 0,this.loader=new i(e)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],i=e=>!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e,s=e=>Math.round(e),r=e=>100*s(e/100),n={br:s,d:s,bl:r,dl:r,mtp:r,nor:e=>encodeURIComponent(e),rtp:r,tb:s},a=Object.keys(e||{}).sort();for(const s of a){let r=e[s];if(!i(r))continue;if("v"===s&&1===r)continue;if("pr"==s&&1===r)continue;const a=n[s];a&&(r=a(r));const o=typeof r;let l;l="ot"===s||"sf"===s||"st"===s?`${s}=${r}`:"boolean"===o?s:"number"===o?`${s}=${r}`:`${s}=${JSON.stringify(r)}`,t.push(l)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),i={},s=["Object","Request","Session","Status"],r=[{},{},{},{}],n={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const i of t){r[null!=n[i]?n[i]:1][i]=e[i]}for(let e=0;e<r.length;e++){const t=SE.serialize(r[e]);t&&(i[`CMCD-${s[e]}`]=t)}return i}static toQuery(e){return`CMCD=${encodeURIComponent(SE.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const i=e.includes("?")?"&":"?";return`${e}${i}${t}`}constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:mE,su:!this.initialized})}catch(e){x_.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=e=>{try{const t=e.frag,i=this.hls.levels[t.level],s=this.getObjectType(t),r={d:1e3*t.duration,ot:s};s!==fE&&s!==_E&&s!=vE||(r.br=i.bitrate/1e3,r.tb=this.getTopBandwidth(s)/1e3,r.bl=this.getBufferLength(s)),this.apply(e,r)}catch(e){x_.warn("Could not generate segment CMCD data.",e)}},this.hls=e;const t=this.config=e.config,{cmcd:i}=t;null!=i&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||SE.uuid(),this.cid=i.contentId,this.useHeaders=!0===i.useHeaders,this.registerListeners())}}function EE(e,t,i,s){e&&Object.keys(t).forEach((r=>{const n=e.filter((e=>e.groupId===r)).map((e=>{const n=E_({},e);return n.details=void 0,n.attrs=new L_(n.attrs),n.url=n.attrs.URI=CE(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",i),n.groupId=n.attrs["GROUP-ID"]=t[r],n.attrs["PATHWAY-ID"]=s,n}));e.push(...n)}))}function CE(e,t,i,s){const{HOST:r,PARAMS:n,[i]:a}=s;let o;t&&(o=null==a?void 0:a[t],o&&(e=o));const l=new self.URL(e);return r&&!o&&(l.host=r),n&&Object.keys(n).sort().forEach((e=>{e&&l.searchParams.set(e,n[e])})),l.href}const TE=/^age:\s*[\d.]+\s*$/im;class wE{destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const i=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then((()=>{if(!this.stats.aborted)return r(i,t.url)})).catch((e=>(i.open("GET",t.url,!0),r(i,t.url)))).then((()=>{this.stats.aborted||this.openAndSendXhr(i,t,e)})).catch((e=>{this.callbacks.onError({code:i.status,text:e.message},t,i,s)})):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);const s=this.context.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:n}=i.loadPolicy;if(s)for(const t in s)e.setRequestHeader(t,s[t]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=r&&C_(r)?r:n,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:i}=this;if(!e||!t)return;const s=t.readyState,r=this.config;if(!i.aborted&&s>=2&&(0===i.loading.first&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),4===s)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const s=t.status,n="text"!==t.responseType;if(s>=200&&s<300&&(n&&t.response||null!==t.responseText)){i.loading.end=Math.max(self.performance.now(),i.loading.first);const r=n?t.response:t.responseText,a="arraybuffer"===t.responseType?r.byteLength:r.length;if(i.loaded=i.total=a,i.bwEstimate=8e3*i.total/(i.loading.end-i.loading.first),!this.callbacks)return;const o=this.callbacks.onProgress;if(o&&o(i,e,r,t),!this.callbacks)return;const l={url:t.responseURL,data:r,code:s};this.callbacks.onSuccess(l,i,e,t)}else{const n=r.loadPolicy.errorRetry;Jv(n,i.retry,!1,s)?this.retry(n):(x_.error(`${s} while loading ${e.url}`),this.callbacks.onError({code:s,text:t.statusText},e,t,i))}}}loadtimeout(){var e;const t=null==(e=this.config)?void 0:e.loadPolicy.timeoutRetry;if(Jv(t,this.stats.retry,!0))this.retry(t);else{x_.warn(`timeout while loading ${this.context.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:i}=this;this.retryDelay=Qv(e,i.retry),i.retry++,x_.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&TE.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new F_,this.retryDelay=0}}const AE=/(\d+)-(\d+)\/(\d+)/;class kE{destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;null!=e&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const r=function(e,t){const i={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(E_({},e.headers))};e.rangeEnd&&i.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1));return i}(e,this.controller.signal),n=i.onProgress,a="arraybuffer"===e.responseType,o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=l&&C_(l)?l:d,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),i.onTimeout(s,e,this.response)}),t.timeout),self.fetch(this.request).then((r=>{this.response=this.loader=r;const o=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),i.onTimeout(s,e,this.response)}),d-(o-s.loading.start)),!r.ok){const{status:e,statusText:t}=r;throw new PE(t||"fetch, bad network response",e,r)}return s.loading.first=o,s.total=function(e){const t=e.get("Content-Range");if(t){const e=function(e){const t=AE.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(C_(e))return e}const i=e.get("Content-Length");if(i)return parseInt(i)}(r.headers)||s.total,n&&C_(t.highWaterMark)?this.loadProgressively(r,s,e,t.highWaterMark,n):a?r.arrayBuffer():"json"===e.responseType?r.json():r.text()})).then((r=>{const{response:a}=this;self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const l=r[o];l&&(s.loaded=s.total=l);const d={url:a.url,data:r,code:a.status};n&&!C_(t.highWaterMark)&&n(s,e,r,a),i.onSuccess(d,s,e,a)})).catch((t=>{if(self.clearTimeout(this.requestTimeout),s.aborted)return;const r=t&&t.code||0,n=t?t.message:null;i.onError({code:r,text:n},e,t?t.details:null,s)}))}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,s=0,r){const n=new cS,a=e.body.getReader(),o=()=>a.read().then((a=>{if(a.done)return n.dataLength&&r(t,i,n.flush(),e),Promise.resolve(new ArrayBuffer(0));const l=a.value,d=l.length;return t.loaded+=d,d<s||n.dataLength?(n.push(l),n.dataLength>=s&&r(t,i,n.flush(),e)):r(t,i,l,e),o()})).catch((()=>Promise.reject()));return o()}constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||IE,this.controller=new self.AbortController,this.stats=new F_}}function IE(e,t){return new self.Request(e.url,t)}class PE extends Error{constructor(e,t,i){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=i}}const OE=/\s/,xE={newCue(e,t,i,s){const r=[];let n,a,o,l,d;const c=self.VTTCue||self.TextTrackCue;for(let u=0;u<s.rows.length;u++)if(n=s.rows[u],o=!0,l=0,d="",!n.isEmpty()){var h;for(let e=0;e<n.chars.length;e++)OE.test(n.chars[e].uchar)&&o?l++:(d+=n.chars[e].uchar,o=!1);n.cueStartTime=t,t===i&&(i+=1e-4),l>=16?l--:l++;const s=GS(d.trim()),p=XS(t,i,s);null!=e&&null!=(h=e.cues)&&h.getCueById(p)||(a=new c(t,i,s),a.id=p,a.line=u+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(a))}return e&&r.length&&(r.sort(((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line)),r.forEach((t=>Tv(e,t)))),r}},RE=b_(b_({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:wE,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class{registerListeners(){const{hls:e}=this;e.on(T_.FRAG_LOADING,this.onFragLoading,this),e.on(T_.FRAG_LOADED,this.onFragLoaded,this),e.on(T_.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T_.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(T_.FRAG_LOADING,this.onFragLoading,this),e.off(T_.FRAG_LOADED,this.onFragLoaded,this),e.off(T_.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T_.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var i;const s=t.frag;this.ignoreFragment(s)||(this.fragCurrent=s,this.partCurrent=null!=(i=t.part)?i:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,i,s){return e+i/t+(s?this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const i=this.hls.config,{total:s,bwEstimate:r}=t.stats;C_(s)&&C_(r)&&(this.lastLevelLoadSec=8*s/r),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:i}=this,{autoLevelEnabled:s,media:r}=i;if(!e||!r)return;const n=performance.now(),a=t?t.stats:e.stats,o=t?t.duration:e.duration,l=n-a.loading.start;if(a.aborted||a.loaded&&a.loaded===a.total||0===e.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!s||r.paused||!r.playbackRate||!r.readyState)return;const d=i.mainForwardBufferInfo;if(null===d)return;const c=this.bwEstimator.getEstimateTTFB(),h=Math.abs(r.playbackRate);if(l<=Math.max(c,o/(2*h)*1e3))return;const u=d.len/h;if(u>=2*o/h)return;const p=a.loading.first?a.loading.first-a.loading.start:-1,g=a.loaded&&p>-1,m=this.bwEstimator.getEstimate(),{levels:_,minAutoLevel:f}=i,v=_[e.level],y=a.total||Math.max(a.loaded,Math.round(o*v.maxBitrate/8));let b=l-p;b<1&&g&&(b=Math.min(l,8*a.loaded/m));const S=g?1e3*a.loaded/b:0,E=S?(y-a.loaded)/S:8*y/m+c/1e3;if(E<=u)return;const C=S?8*S:m;let T,w=Number.POSITIVE_INFINITY;for(T=e.level-1;T>f;T--){const e=_[T].maxBitrate;if(w=this.getTimeToLoadFrag(c/1e3,C,o*e,!_[T].details),w<u)break}w>=E||w>10*o||(i.nextLoadLevel=T,g?this.bwEstimator.sample(l-Math.min(c,p),a.loaded):this.bwEstimator.sampleTTFB(l),this.clearTimer(),x_.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;\n      Time to underbuffer: ${u.toFixed(3)} s\n      Estimated load time for current fragment: ${E.toFixed(3)} s\n      Estimated load time for down switch fragment: ${w.toFixed(3)} s\n      TTFB estimate: ${p}\n      Current BW estimate: ${C_(m)?(m/1024).toFixed(3):"Unknown"} Kb/s\n      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s\n      Aborting and switching to level ${T}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),i.trigger(T_.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:a}))}onFragLoaded(e,{frag:t,part:i}){const s=i?i.stats:t.stats;if(t.type===fv&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const e=i?i.duration:t.duration,r=this.hls.levels[t.level],n=(r.loaded?r.loaded.bytes:0)+s.loaded,a=(r.loaded?r.loaded.duration:0)+e;r.loaded={bytes:n,duration:a},r.realBitrate=Math.round(8*n/a)}if(t.bitrateTest){const e={stats:s,frag:t,part:i,id:t.type};this.onFragBuffered(T_.FRAG_BUFFERED,e),t.bitrateTest=!1}}}onFragBuffered(e,t){const{frag:i,part:s}=t,r=null!=s&&s.stats.loaded?s.stats:i.stats;if(r.aborted)return;if(this.ignoreFragment(i))return;const n=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(n,r.loaded),r.bwEstimate=this.bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==fv||"initSegment"===e.sn}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel,t=this.bwEstimator;if(-1!==e&&!t.canEstimate())return e;let i=this.getNextABRAutoLevel();if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,i)&&t[e].loadError<=t[i].loadError)return e}return-1!==e&&(i=Math.min(e,i)),i}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:i}=this,{maxAutoLevel:s,config:r,minAutoLevel:n,media:a}=i,o=t?t.duration:e?e.duration:0,l=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,d=this.bwEstimator?this.bwEstimator.getEstimate():r.abrEwmaDefaultEstimate,c=i.mainForwardBufferInfo,h=(c?c.len:0)/l;let u=this.findBestLevel(d,n,s,h,r.abrBandWidthFactor,r.abrBandWidthUpFactor);if(u>=0)return u;x_.trace(`[abr] ${h?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let p=o?Math.min(o,r.maxStarvationDelay):r.maxStarvationDelay,g=r.abrBandWidthFactor,m=r.abrBandWidthUpFactor;if(!h){const e=this.bitrateTestDelay;if(e){p=(o?Math.min(o,r.maxLoadingDelay):r.maxLoadingDelay)-e,x_.trace(`[abr] bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),g=m=1}}return u=this.findBestLevel(d,n,s,h+p,g,m),Math.max(u,0)}findBestLevel(e,t,i,s,r,n){var a;const{fragCurrent:o,partCurrent:l,lastLoadedFragLevel:d}=this,{levels:c}=this.hls,h=c[d],u=!(null==h||null==(a=h.details)||!a.live),p=null==h?void 0:h.codecSet,g=l?l.duration:o?o.duration:0,m=this.bwEstimator.getEstimateTTFB()/1e3;let _=t,f=-1;for(let a=i;a>=t;a--){const t=c[a];if(!t||p&&t.codecSet!==p){t&&(_=Math.min(a,_),f=Math.max(a,f));continue}-1!==f&&x_.trace(`[abr] Skipped level(s) ${_}-${f} with CODECS:"${c[f].attrs.CODECS}"; not compatible with "${h.attrs.CODECS}"`);const i=t.details,o=(l?null==i?void 0:i.partTarget:null==i?void 0:i.averagetargetduration)||g;let v;v=a<=d?r*e:n*e;const y=c[a].maxBitrate,b=this.getTimeToLoadFrag(m,v,y*o,void 0===i);if(x_.trace(`[abr] level:${a} adjustedbw-bitrate:${Math.round(v-y)} avgDuration:${o.toFixed(1)} maxFetchDuration:${s.toFixed(1)} fetchDuration:${b.toFixed(1)}`),v>y&&(0===b||!C_(b)||u&&!this.bitrateTestDelay||b<s))return a}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new dS(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}},bufferController:class{hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(T_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T_.BUFFER_RESET,this.onBufferReset,this),e.on(T_.BUFFER_APPENDING,this.onBufferAppending,this),e.on(T_.BUFFER_CODECS,this.onBufferCodecs,this),e.on(T_.BUFFER_EOS,this.onBufferEos,this),e.on(T_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T_.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(T_.FRAG_PARSED,this.onFragParsed,this),e.on(T_.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(T_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T_.BUFFER_RESET,this.onBufferReset,this),e.off(T_.BUFFER_APPENDING,this.onBufferAppending,this),e.off(T_.BUFFER_CODECS,this.onBufferCodecs,this),e.off(T_.BUFFER_EOS,this.onBufferEos,this),e.off(T_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T_.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(T_.FRAG_PARSED,this.onFragParsed,this),e.off(T_.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new mS(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i,x_.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const i=this.media=t.media;if(i&&_S){const e=this.mediaSource=new _S;e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),i.src=self.URL.createObjectURL(e),this._objectUrl=i.src,i.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:i}=this;if(t){if(x_.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){x_.warn(`[buffer-controller]: onMediaDetaching: ${e.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),i&&self.URL.revokeObjectURL(i),e.src===i?(e.removeAttribute("src"),e.load()):x_.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(T_.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach((e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(t){x_.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,t)}})),this._initSourceBuffer()}onBufferCodecs(e,t){const i=this.getSourceBufferTypes().length;Object.keys(t).forEach((e=>{if(i){const i=this.tracks[e];if(i&&"function"==typeof i.buffer.changeType){const{id:s,codec:r,levelCodec:n,container:a,metadata:o}=t[e],l=(i.levelCodec||i.codec).replace(fS,"$1"),d=(n||r).replace(fS,"$1");if(l!==d){const t=`${a};codecs=${n||r}`;this.appendChangeType(e,t),x_.log(`[buffer-controller]: switching codec ${l} to ${d}`),this.tracks[e]={buffer:i.buffer,codec:r,container:a,levelCodec:n,metadata:o,id:s}}}}else this.pendingTracks[e]=t[e]})),i||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:i}=this,s={execute:()=>{const s=this.sourceBuffer[e];s&&(x_.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),i.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{x_.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,t)}};i.append(s,e)}onBufferAppending(e,t){const{hls:i,operationQueue:s,tracks:r}=this,{data:n,type:a,frag:o,part:l,chunkMeta:d}=t,c=d.buffering[a],h=self.performance.now();c.start=h;const u=o.stats.buffering,p=l?l.stats.buffering:null;0===u.start&&(u.start=h),p&&0===p.start&&(p.start=h);const g=r.audio;let m=!1;"audio"===a&&"audio/mpeg"===(null==g?void 0:g.container)&&(m=!this.lastMpegAudioChunk||1===d.id||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const _=o.start,f={execute:()=>{if(c.executeStart=self.performance.now(),m){const e=this.sourceBuffer[a];if(e){const t=_-e.timestampOffset;Math.abs(t)>=.1&&(x_.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${_} (delta: ${t}) sn: ${o.sn})`),e.timestampOffset=_)}}this.appendExecutor(n,a)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();c.executeEnd=c.end=e,0===u.first&&(u.first=e),p&&0===p.first&&(p.first=e);const{sourceBuffer:t}=this,i={};for(const e in t)i[e]=Oy.getBuffered(t[e]);this.appendError=0,this.hls.trigger(T_.BUFFER_APPENDED,{type:a,frag:o,part:l,chunkMeta:d,parent:o.type,timeRanges:i})},onError:e=>{x_.error(`[buffer-controller]: Error encountered while trying to append to the ${a} SourceBuffer`,e);const t={type:w_.MEDIA_ERROR,parent:o.type,details:A_.BUFFER_APPEND_ERROR,frag:o,part:l,chunkMeta:d,error:e,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=A_.BUFFER_FULL_ERROR:(this.appendError++,t.details=A_.BUFFER_APPEND_ERROR,this.appendError>i.config.appendErrorMaxRetry&&(x_.error(`[buffer-controller]: Failed ${i.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),t.fatal=!0)),i.trigger(T_.ERROR,t)}};s.append(f,a)}onBufferFlushing(e,t){const{operationQueue:i}=this,s=e=>({execute:this.removeExecutor.bind(this,e,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(T_.BUFFER_FLUSHED,{type:e})},onError:t=>{x_.warn(`[buffer-controller]: Failed to remove from ${e} SourceBuffer`,t)}});t.type?i.append(s(t.type),t.type):this.getSourceBufferTypes().forEach((e=>{i.append(s(e),e)}))}onFragParsed(e,t){const{frag:i,part:s}=t,r=[],n=s?s.elementaryStreams:i.elementaryStreams;n[U_]?r.push("audiovideo"):(n[j_]&&r.push("audio"),n[N_]&&r.push("video"));0===r.length&&x_.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers((()=>{const e=self.performance.now();i.stats.buffering.end=e,s&&(s.stats.buffering.end=e);const t=s?s.stats:i.stats;this.hls.trigger(T_.FRAG_BUFFERED,{frag:i,part:s,stats:t,id:i.type})}),r)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce(((e,i)=>{const s=this.sourceBuffer[i];return!s||t.type&&t.type!==i||(s.ending=!0,s.ended||(s.ended=!0,x_.log(`[buffer-controller]: ${i} sourceBuffer now EOS`))),e&&!(s&&!s.ended)}),!0)&&(x_.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers((()=>{this.getSourceBufferTypes().forEach((e=>{const t=this.sourceBuffer[e];t&&(t.ending=!1)}));const{mediaSource:e}=this;e&&"open"===e.readyState?(x_.log("[buffer-controller]: Calling mediaSource.endOfStream()"),e.endOfStream()):e&&x_.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)})))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:i,sourceBuffer:s}=this;if(!i||null===t)return;const r=this.getSourceBufferTypes();if(!r.length)return;const n=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(!C_(n)||n<0)return;const a=i.currentTime,o=t.levelTargetDuration,l=Math.max(n,o),d=Math.floor(a/o)*o-l;r.forEach((i=>{const r=s[i];if(r){const s=Oy.getBuffered(r);if(s.length>0&&d>s.start(0)){if(e.trigger(T_.BACK_BUFFER_REACHED,{bufferEnd:d}),t.live)e.trigger(T_.LIVE_BACK_BUFFER_REACHED,{bufferEnd:d});else if(r.ended&&s.end(s.length-1)-a<2*o)return void x_.info(`[buffer-controller]: Cannot flush ${i} back buffer while SourceBuffer is in ended state`);e.trigger(T_.BUFFER_FLUSHING,{startOffset:0,endOffset:d,type:i})}}}))}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:e,hls:t,media:i,mediaSource:s}=this,r=e.fragments[0].start+e.totalduration,n=i.duration,a=C_(s.duration)?s.duration:0;e.live&&t.config.liveDurationInfinity?(x_.log("[buffer-controller]: Media Source duration is set to Infinity"),s.duration=1/0,this.updateSeekableRange(e)):(r>a&&r>n||!C_(n))&&(x_.log(`[buffer-controller]: Updating Media Source duration to ${r.toFixed(3)}`),s.duration=r)}updateSeekableRange(e){const t=this.mediaSource,i=e.fragments;if(i.length&&e.live&&null!=t&&t.setLiveSeekableRange){const s=Math.max(0,i[0].start),r=Math.max(s,s+e.totalduration);t.setLiveSeekableRange(s,r)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:i}=this,s=Object.keys(i).length;if(s&&!e||2===s){this.createSourceBuffers(i),this.pendingTracks={};const e=this.getSourceBufferTypes();if(e.length)this.hls.trigger(T_.BUFFER_CREATED,{tracks:this.tracks}),e.forEach((e=>{t.executeNext(e)}));else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:i}=this;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(const s in e)if(!t[s]){const r=e[s];if(!r)throw Error(`source buffer exists for track ${s}, however track does not`);const n=r.levelCodec||r.codec,a=`${r.container};codecs=${n}`;x_.log(`[buffer-controller]: creating sourceBuffer(${a})`);try{const e=t[s]=i.addSourceBuffer(a),o=s;this.addBufferListener(o,"updatestart",this._onSBUpdateStart),this.addBufferListener(o,"updateend",this._onSBUpdateEnd),this.addBufferListener(o,"error",this._onSBUpdateError),this.tracks[s]={buffer:e,codec:n,container:r.container,levelCodec:r.levelCodec,metadata:r.metadata,id:r.id}}catch(e){x_.error(`[buffer-controller]: error while trying to add sourceBuffer: ${e.message}`),this.hls.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:a})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const i=new Error(`${e} SourceBuffer error`);x_.error(`[buffer-controller]: ${i}`,t),this.hls.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.BUFFER_APPENDING_ERROR,error:i,fatal:!1});const s=this.operationQueue.current(e);s&&s.onError(t)}removeExecutor(e,t,i){const{media:s,mediaSource:r,operationQueue:n,sourceBuffer:a}=this,o=a[e];if(!s||!r||!o)return x_.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void n.shiftAndExecuteNext(e);const l=C_(s.duration)?s.duration:1/0,d=C_(r.duration)?r.duration:1/0,c=Math.max(0,t),h=Math.min(i,l,d);h>c&&!o.ending?(o.ended=!1,x_.log(`[buffer-controller]: Removing [${c},${h}] from the ${e} SourceBuffer`),o.remove(c,h)):n.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:i,sourceBuffer:s}=this,r=s[t];if(!r)return x_.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),void i.shiftAndExecuteNext(t);r.ended=!1,r.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length)return x_.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);const{operationQueue:i}=this,s=t.map((e=>i.appendBlocker(e)));Promise.all(s).then((()=>{e(),t.forEach((e=>{const t=this.sourceBuffer[e];null!=t&&t.updating||i.shiftAndExecuteNext(e)}))}))}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,i){const s=this.sourceBuffer[e];if(!s)return;const r=i.bind(this,e);this.listeners[e].push({event:t,listener:r}),s.addEventListener(t,r)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach((e=>{t.removeEventListener(e.event,e.listener)}))}constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:e,mediaSource:t}=this;x_.log("[buffer-controller]: Media source opened"),e&&(e.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(T_.MEDIA_ATTACHED,{media:e})),t&&t.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{x_.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{x_.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:e,_objectUrl:t}=this;e&&e.src!==t&&x_.error(`Media element src was set while attaching MediaSource (${t} > ${e.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}},capLevelController:hE,errorController:class{registerListeners(){const e=this.hls;e.on(T_.ERROR,this.onError,this),e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(T_.ERROR,this.onError,this),e.off(T_.ERROR,this.onErrorOut,this),e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(null==e?void 0:e.type)===fv?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var i,s;if(t.fatal)return;const r=this.hls,n=t.context;switch(t.details){case A_.FRAG_LOAD_ERROR:case A_.FRAG_LOAD_TIMEOUT:case A_.KEY_LOAD_ERROR:case A_.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case A_.FRAG_PARSING_ERROR:if(null!=(i=t.frag)&&i.gap)return void(t.errorAction={action:sy,flags:ay});case A_.FRAG_GAP:case A_.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=ry);case A_.LEVEL_EMPTY_ERROR:case A_.LEVEL_PARSING_ERROR:{var a,o;const e=t.parent===fv?t.level:r.loadLevel;t.details===A_.LEVEL_EMPTY_ERROR&&null!=(a=t.context)&&null!=(o=a.levelDetails)&&o.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case A_.LEVEL_LOAD_ERROR:case A_.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==n?void 0:n.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,n.level)));case A_.AUDIO_TRACK_LOAD_ERROR:case A_.AUDIO_TRACK_LOAD_TIMEOUT:case A_.SUBTITLE_LOAD_ERROR:case A_.SUBTITLE_TRACK_LOAD_TIMEOUT:if(n){const e=r.levels[r.loadLevel];if(e&&(n.type===mv&&n.groupId===e.audioGroupId||n.type===_v&&n.groupId===e.textGroupId))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=ry,void(t.errorAction.flags=oy)}return;case A_.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=r.levels[r.loadLevel],i=null==e?void 0:e.attrs["HDCP-LEVEL"];i&&(t.errorAction={action:ry,flags:ly,hdcpLevel:i})}return;case A_.BUFFER_ADD_CODEC_ERROR:case A_.REMUX_ALLOC_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(s=t.level)?s:r.loadLevel));case A_.INTERNAL_EXCEPTION:case A_.BUFFER_APPENDING_ERROR:case A_.BUFFER_APPEND_ERROR:case A_.BUFFER_FULL_ERROR:case A_.LEVEL_SWITCH_ERROR:case A_.BUFFER_STALLED_ERROR:case A_.BUFFER_SEEK_OVER_HOLE:case A_.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:sy,flags:ay})}if(t.type===w_.KEY_SYSTEM_ERROR){const e=this.getVariantLevelIndex(t.frag);return t.levelRetry=!1,void(t.errorAction=this.getLevelSwitchAction(t,e))}}getPlaylistRetryOrSwitchAction(e,t){var i;const s=Yv(this.hls.config.playlistLoadPolicy,e),r=this.playlistError++,n=null==(i=e.response)?void 0:i.code;if(Jv(s,r,Wv(e),n))return{action:ny,flags:ay,retryConfig:s,retryCount:r};const a=this.getLevelSwitchAction(e,t);return s&&(a.retryConfig=s,a.retryCount=r),a}getFragRetryOrSwitchAction(e){const t=this.hls,i=this.getVariantLevelIndex(e.frag),s=t.levels[i],{fragLoadPolicy:r,keyLoadPolicy:n}=t.config,a=Yv(e.details.startsWith("key")?n:r,e),o=t.levels.reduce(((e,t)=>e+t.fragmentError),0);if(s){var l;e.details!==A_.FRAG_GAP&&s.fragmentError++;const t=null==(l=e.response)?void 0:l.code;if(Jv(a,o,Wv(e),t))return{action:ny,flags:ay,retryConfig:a,retryCount:o}}const d=this.getLevelSwitchAction(e,i);return a&&(d.retryConfig=a,d.retryCount=o),d}getLevelSwitchAction(e,t){const i=this.hls;null==t&&(t=i.loadLevel);const s=this.hls.levels[t];if(s&&(s.loadError++,i.autoLevelEnabled)){var r,n;let t=-1;const{levels:a,loadLevel:o,minAutoLevel:l,maxAutoLevel:d}=i,c=null==(r=e.frag)?void 0:r.type,{type:h,groupId:u}=null!=(n=e.context)?n:{};for(let i=a.length;i--;){const r=(i+o)%a.length;if(r!==o&&r>=l&&r<=d&&0===a[r].loadError){const i=a[r];if(e.details===A_.FRAG_GAP&&e.frag){const t=a[r].details;if(t){const i=ey(e.frag,t.fragments,e.frag.start);if(null!=i&&i.gap)continue}}else{if(h===mv&&u===i.audioGroupId||h===_v&&u===i.textGroupId)continue;if(c===vv&&s.audioGroupId===i.audioGroupId||c===yv&&s.textGroupId===i.textGroupId)continue}t=r;break}}if(t>-1&&i.loadLevel!==t)return e.levelRetry=!0,this.playlistError=0,{action:ry,flags:ay,nextAutoLevel:t}}return{action:ry,flags:oy}}onErrorOut(e,t){var i;switch(null==(i=t.errorAction)?void 0:i.action){case sy:break;case ry:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===A_.FRAG_GAP||(t.fatal=!0)}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,i=e.errorAction;if(!i)return;const{flags:s,hdcpLevel:r,nextAutoLevel:n}=i;switch(s){case ay:this.switchLevel(e,n);break;case oy:i.resolved||(i.resolved=this.redundantFailover(e));break;case ly:r&&(t.maxHdcpLevel=Mv[Mv.indexOf(r)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`)}i.resolved||this.switchLevel(e,n)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:i}=this,s=e.parent===fv?e.level:t.loadLevel,r=t.levels[s],n=r.url.length,a=e.frag?e.frag.urlId:r.urlId;r.urlId!==a||e.frag&&!r.details||this.penalizeRendition(r,e);for(let o=1;o<n;o++){const l=(a+o)%n,d=i[l];if(!d||dy(d,e,i[a]))return this.warn(`Switching to Redundant Stream ${l+1}/${n}: "${r.url[l]}" after ${e.details}`),this.playlistError=0,t.levels.forEach((e=>{e.urlId=l})),t.nextLoadLevel=s,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:i}=this,s=i[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};s.lastErrorPerfMs=performance.now(),s.errors.push(t),s.details=e.details,i[e.urlId]=s}constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=x_.log.bind(x_,"[info]:"),this.warn=x_.warn.bind(x_,"[warning]:"),this.error=x_.error.bind(x_,"[error]:"),this.registerListeners()}},fpsController:class{setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(T_.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(T_.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const i=this.hls.config;if(i.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"==typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,i){const s=performance.now();if(t){if(this.lastTime){const e=s-this.lastTime,r=i-this.lastDroppedFrames,n=t-this.lastDecodedFrames,a=1e3*r/e,o=this.hls;if(o.trigger(T_.FPS_DROP,{currentDropped:r,currentDecoded:n,totalDroppedFrames:i}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*n){let e=o.currentLevel;x_.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=e)&&(e-=1,o.trigger(T_.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:o.currentLevel}),o.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:rf,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:xE,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends eb{onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T_.ERROR,this.onError,this),e.on(T_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(T_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(T_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(T_.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(T_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T_.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T_.ERROR,this.onError,this),e.off(T_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(T_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(T_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(T_.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(T_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T_.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=$y,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:i,success:s}=t;if(this.fragPrevious=i,this.state=$y,!s)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let n;const a=i.start;for(let e=0;e<r.length;e++)if(a>=r[e].start&&a<=r[e].end){n=r[e];break}const o=i.start+i.duration;n?n.end=o:(n={start:a,end:o},r.push(n)),this.fragmentTracker.fragBuffered(i)}onBufferFlushing(e,t){const{startOffset:i,endOffset:s}=t;if(0===i&&s!==Number.POSITIVE_INFINITY){const e=s-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach((t=>{for(let i=0;i<t.length;)if(t[i].end<=e)t.shift();else{if(!(t[i].start<e))break;t[i].start=e,i++}})),this.fragmentTracker.removeFragmentsInRange(i,e,yv)}}onFragBuffered(e,t){var i;this.loadedmetadata||t.frag.type!==fv||null!=(i=this.media)&&i.buffered.length&&(this.loadedmetadata=!0)}onError(e,t){const i=t.frag;(null==i?void 0:i.type)===yv&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==zy&&(this.state=$y))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){hS(this.levels,t)?this.levels=t.map((e=>new Uv(e))):(this.tracksBuffered=[],this.levels=t.map((e=>{const t=new Uv(e);return this.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,yv),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||-1===this.currentTrackId)return void this.clearInterval();const i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var i;const{details:s,id:r}=t,{currentTrackId:n,levels:a}=this;if(!a.length)return;const o=a[n];if(r>=a.length||r!==n||!o)return;this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(s.live||null!=(i=o.details)&&i.live){const e=this.mainDetails;if(s.deltaUpdateFailed||!e)return;const t=e.fragments[0];o.details?(l=this.alignPlaylists(s,o.details),0===l&&t&&(l=t.start,qv(s,l))):s.hasProgramDateTime&&e.hasProgramDateTime?(By(s,e),l=s.fragments[0].start):t&&(l=t.start,qv(s,l))}if(o.details=s,this.levelLastLoaded=r,this.startFragRequested||!this.mainDetails&&s.live||this.setStartPosition(o.details,l),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===$y){ey(null,s.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)}}_handleFragmentLoadComplete(e){const{frag:t,payload:i}=e,s=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&s&&s.key&&s.iv&&"AES-128"===s.method){const e=performance.now();this.decrypter.decrypt(new Uint8Array(i),s.key.buffer,s.iv.buffer).catch((e=>{throw r.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e})).then((i=>{const s=performance.now();r.trigger(T_.FRAG_DECRYPTED,{frag:t,payload:i,stats:{tstart:e,tdecrypt:s}})})).catch((e=>{this.warn(`${e.name}: ${e.message}`),this.state=$y}))}}doTick(){if(this.media){if(this.state===$y){const{currentTrackId:e,levels:t}=this,i=t[e];if(!t.length||!i||!i.details)return;const{config:s}=this,r=this.getLoadPosition(),n=Oy.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,s.maxBufferHole),{end:a,len:o}=n,l=this.getFwdBufferInfo(this.media,fv),d=i.details;if(o>this.getMaxBufferLength(null==l?void 0:l.len)+d.levelTargetDuration)return;const c=d.fragments,h=c.length,u=d.edge;let p=null;const g=this.fragPrevious;if(a<u){const e=s.maxFragLookUpTolerance,t=a>u-e?0:e;p=ey(g,c,Math.max(c[0].start,a),t),!p&&g&&g.start<c[0].start&&(p=c[0])}else p=c[h-1];if(!p)return;if(p=this.mapToInitFragWhenRequired(p),"initSegment"!==p.sn){const e=c[p.sn-d.startSN-1];e&&e.cc===p.cc&&this.fragmentTracker.getState(e)===my&&(p=e)}this.fragmentTracker.getState(p)===my&&this.loadFragment(p,i,a)}}else this.state=$y}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,i){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,i))}get mediaBufferTimeRanges(){return new pS(this.tracksBuffered[this.currentTrackId]||[])}constructor(e,t,i){super(e,t,i,"[subtitle-stream-controller]",yv),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}},subtitleTrackController:class extends cy{destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T_.LEVEL_LOADING,this.onLevelLoading,this),e.on(T_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(T_.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T_.LEVEL_LOADING,this.onLevelLoading,this),e.off(T_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(T_.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);gS(this.media.textTracks).forEach((e=>{wv(e)})),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:i,details:s}=t,{trackId:r}=this,n=this.tracksInGroup[r];if(!n)return void this.warn(`Invalid subtitle track id ${i}`);const a=n.details;n.details=t.details,this.log(`subtitle track ${i} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.textGroupIds)return;const i=t.textGroupIds[t.urlId],s=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==i){const e=this.tracks.filter((e=>!i||e.groupId===i));this.tracksInGroup=e;const t=this.findTrackId(null==s?void 0:s.name)||this.findTrackId();this.groupId=i||null;const r={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${i}" group-id`),this.hls.trigger(T_.SUBTITLE_TRACKS_UPDATED,r),-1!==t&&this.setSubtitleTrack(t,s)}else this.shouldReloadPlaylist(s)&&this.setSubtitleTrack(this.trackId,s)}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const s=t[i];if((!this.selectDefaultTrack||s.default)&&(!e||e===s.name))return s.id}return-1}onError(e,t){!t.fatal&&t.context&&t.context.type===_v&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;const t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const i=t.id,s=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`Loading subtitle playlist for id ${i}`),this.hls.trigger(T_.SUBTITLE_TRACK_LOADING,{url:r,id:i,groupId:s,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:i}=this;if(!t)return;const s=gS(t.textTracks),r=s.filter((e=>e.groupId===this.groupId));if(-1===e)[].slice.call(s).forEach((e=>{e.mode="disabled"}));else{const e=r[i];e&&(e.mode="disabled")}const n=r[e];n&&(n.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var i;const s=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(-1===e||null!=(i=s[e])&&i.details)||e<-1||e>=s.length)return;this.clearTimer();const r=s[e];if(this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:"")),this.trackId=e,r){const{id:e,groupId:i="",name:s,type:n,url:a}=r;this.hls.trigger(T_.SUBTITLE_TRACK_SWITCH,{id:e,groupId:i,name:s,type:n,url:a});const o=this.switchParams(r.url,null==t?void 0:t.details);this.loadPlaylist(o)}else this.hls.trigger(T_.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=gS(this.media.textTracks);for(let i=0;i<t.length;i++)if("hidden"===t[i].mode)e=i;else if("showing"===t[i].mode){e=i;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}},timelineController:class{destroy(){const{hls:e}=this;e.off(T_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(T_.FRAG_LOADING,this.onFragLoading,this),e.off(T_.FRAG_LOADED,this.onFragLoaded,this),e.off(T_.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(T_.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(T_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(T_.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(T_.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,i,s,r){let n=!1;for(let e=r.length;e--;){const s=r[e],c=(a=s[0],o=s[1],l=t,d=i,Math.min(o,d)-Math.max(a,l));if(c>=0&&(s[0]=Math.min(s[0],t),s[1]=Math.max(s[1],i),n=!0,c/(i-t)>.5))return}var a,o,l,d;if(n||r.push([t,i]),this.config.renderTextTracksNatively){const r=this.captionsTracks[e];this.Cues.newCue(r,t,i,s)}else{const r=this.Cues.newCue(null,t,i,s);this.hls.trigger(T_.CUES_PARSED,{type:"captions",cues:r,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:s,timescale:r}){const{unparsedVttFrags:n}=this;"main"===i&&(this.initPTS[t.cc]={baseTime:s,timescale:r}),n.length&&(this.unparsedVttFrags=[],n.forEach((e=>{this.onFragLoaded(T_.FRAG_LOADED,e)})))}getExistingTrack(e){const{media:t}=this;if(t)for(let i=0;i<t.textTracks.length;i++){const s=t.textTracks[i];if(s[e])return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:i,media:s}=this,{label:r,languageCode:n}=t[e],a=this.getExistingTrack(e);if(a)i[e]=a,wv(i[e]),Cv(i[e],s);else{const t=this.createTextTrack("captions",r,n);t&&(t[e]=!0,i[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const i={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(T_.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,i){const s=this.media;if(s)return s.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach((t=>{wv(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let e=0;e<t.length;e++)wv(t[e])}onSubtitleTracksUpdated(e,t){const i=t.subtitleTracks||[],s=i.some((e=>e.textCodec===ZS));if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(hS(this.tracks,i))return void(this.tracks=i);if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const e=this.media?this.media.textTracks:null;this.tracks.forEach(((t,i)=>{let s;if(e&&i<e.length){let i=null;for(let s=0;s<e.length;s++)if(cE(e[s],t)){i=e[s];break}i&&(s=i)}if(s)wv(s);else{const e=this._captionsOrSubtitlesFromCharacteristics(t);s=this.createTextTrack(e,t.name,t.lang),s&&(s.mode="disabled")}s&&(s.groupId=t.groupId,this.textTracks.push(s))}))}else if(this.tracks.length){const e=this.tracks.map((e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e})));this.hls.trigger(T_.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),i=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&i)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const i=`textTrack${t[1]}`,s=this.captionsProperties[i];s&&(s.label=e.name,e.lang&&(s.languageCode=e.lang),s.media=e)}))}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:i,cea608Parser2:s,lastSn:r,lastPartIndex:n}=this;if(this.enabled&&i&&s&&t.frag.type===fv){var a,o;const e=t.frag.sn,l=null!=(a=null==t||null==(o=t.part)?void 0:o.index)?a:-1;e===r+1||e===r&&l===n+1||(i.reset(),s.reset()),this.lastSn=e,this.lastPartIndex=l}}onFragLoaded(e,t){const{frag:i,payload:s}=t;if(i.type===yv)if(s.byteLength){const e=i.decryptdata,r="stats"in t;if(null==e||!e.encrypted||r){const e=this.tracks[i.level],r=this.vttCCs;r[i.cc]||(r[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),e&&e.textCodec===ZS?this._parseIMSC1(i,s):this._parseVTTs(t)}}else this.hls.trigger(T_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const i=this.hls;sE(t,this.initPTS[e.cc],(t=>{this._appendCues(t,e.level),i.trigger(T_.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(t=>{x_.log(`Failed to parse IMSC1: ${t}`),i.trigger(T_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))}_parseVTTs(e){var t;const{frag:i,payload:s}=e,{initPTS:r,unparsedVttFrags:n}=this,a=r.length-1;if(!r[i.cc]&&-1===a)return void n.push(e);const o=this.hls;JS(null!=(t=i.initSegment)&&t.data?Bf(i.initSegment.data,new Uint8Array(s)):s,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,(e=>{this._appendCues(e,i.level),o.trigger(T_.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})}),(t=>{const r="Missing initPTS for VTT MPEGTS"===t.message;r?n.push(e):this._fallbackToIMSC1(i,s),x_.log(`Failed to parse VTT cue: ${t}`),r&&a>i.cc||o.trigger(T_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:t})}))}_fallbackToIMSC1(e,t){const i=this.tracks[e.level];i.textCodec||sE(t,this.initPTS[e.cc],(()=>{i.textCodec=ZS,this._parseIMSC1(e,t)}),(()=>{i.textCodec="wvtt"}))}_appendCues(e,t){const i=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||"disabled"===i.mode)return;e.forEach((e=>Tv(i,e)))}else{const s=this.tracks[t];if(!s)return;const r=s.default?"default":"subtitles"+t;i.trigger(T_.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:i}=t;i.type===yv&&this.onFragLoaded(T_.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:i,cea608Parser2:s}=this;if(!this.enabled||!i||!s)return;const{frag:r,samples:n}=t;if(r.type!==fv||"NONE"!==this.closedCaptionsForLevel(r))for(let e=0;e<n.length;e++){const t=n[e].bytes;if(t){const r=this.extractCea608Data(t);i.addData(n[e].pts,r[0]),s.addData(n[e].pts,r[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:s,type:r}){const{media:n}=this;if(n&&!(n.currentTime<i)){if(!r||"video"===r){const{captionsTracks:e}=this;Object.keys(e).forEach((s=>Av(e[s],t,i)))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==s){const{textTracks:e}=this;Object.keys(e).forEach((i=>Av(e[i],t,s)))}}}extractCea608Data(e){const t=[[],[]],i=31&e[0];let s=2;for(let r=0;r<i;r++){const i=e[s++],r=127&e[s++],n=127&e[s++];if(0===r&&0===n)continue;if(!!(4&i)){const e=3&i;0!==e&&1!==e||(t[e].push(r),t[e].push(n))}}return t}constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const e=new FS(this,"textTrack1"),t=new FS(this,"textTrack2"),i=new FS(this,"textTrack3"),s=new FS(this,"textTrack4");this.cea608Parser1=new LS(1,e,t),this.cea608Parser2=new LS(3,i,s)}e.on(T_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(T_.FRAG_LOADING,this.onFragLoading,this),e.on(T_.FRAG_LOADED,this.onFragLoaded,this),e.on(T_.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(T_.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(T_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(T_.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(T_.BUFFER_FLUSHING,this.onBufferFlushing,this)}},audioStreamController:class extends eb{onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T_.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(T_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(T_.ERROR,this.onError,this),e.on(T_.BUFFER_RESET,this.onBufferReset,this),e.on(T_.BUFFER_CREATED,this.onBufferCreated,this),e.on(T_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(T_.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(T_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T_.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(T_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(T_.ERROR,this.onError,this),e.off(T_.BUFFER_RESET,this.onBufferReset,this),e.off(T_.BUFFER_CREATED,this.onBufferCreated,this),e.off(T_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(T_.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:i,initPTS:s,timescale:r}){if("main"===i){const e=t.cc;this.initPTS[t.cc]={baseTime:s,timescale:r},this.log(`InitPTS for cc: ${e} found from main: ${s}`),this.videoTrackCC=e,this.state===Jy&&this.tick()}}startLoad(e){if(!this.levels)return this.startPosition=e,void(this.state=zy);const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=$y):(this.loadedmetadata=!1,this.state=Ky),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case $y:this.doTickIdle();break;case Ky:{var e;const{levels:t,trackId:i}=this,s=null==t||null==(e=t[i])?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=Jy}break}case Gy:{var t;const e=performance.now(),i=this.retryDate;(!i||e>=i||null!=(t=this.media)&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=$y);break}case Jy:{const e=this.waitingData;if(e){const{frag:t,part:i,cache:s,complete:r}=e;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=qy;const e={frag:t,part:i,payload:s.flush(),networkDetails:null};this._handleFragmentLoadProgress(e),r&&super._handleFragmentLoadComplete(e)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const e=this.getLoadPosition(),i=Oy.bufferInfo(this.mediaBuffer,e,this.config.maxBufferHole);ty(i.end,this.config.maxFragLookUpTolerance,t)<0&&(this.log(`Waiting fragment cc (${t.cc}) @ ${t.start} cancelled because another fragment at ${i.end} is needed`),this.clearWaitingFragment())}}else this.state=$y}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=$y)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:i,trackId:s}=this,r=e.config;if(null==t||!t[s])return;if(!i&&(this.startFragRequested||!r.startFragPrefetch))return;const n=t[s],a=n.details;if(!a||a.live&&this.levelLastLoaded!==s||this.waitForCdnTuneIn(a))return void(this.state=Ky);const o=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&o&&(this.bufferFlushed=!1,this.afterBufferFlushed(o,j_,vv));const l=this.getFwdBufferInfo(o,vv);if(null===l)return;const{bufferedTrack:d,switchingTrack:c}=this;if(!c&&this._streamEnded(l,a))return e.trigger(T_.BUFFER_EOS,{type:"audio"}),void(this.state=Qy);const h=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,fv),u=l.len,p=this.getMaxBufferLength(null==h?void 0:h.len);if(u>=p&&!c)return;const g=a.fragments[0].start;let m=l.end;if(c&&i){const e=this.getLoadPosition();d&&c.attrs!==d.attrs&&(m=e),a.PTSKnown&&e<g&&(l.end>g||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=g+.05)}let _=this.getNextFragment(m,a),f=!1;if(_&&this.isLoopLoading(_,m)&&(f=!!_.gap,_=this.getNextFragmentLoopLoading(_,a,l,fv,p)),!_)return void(this.bufferFlushed=!0);const v=h&&_.start>h.end+a.targetduration;if(v||(null==h||!h.len)&&l.len){const e=this.getAppendedFrag(_.start,fv);if(null===e)return;if(f||(f=!!e.gap||!!v&&0===h.len),v&&!f||f&&l.nextStart&&l.nextStart<e.end)return}this.loadFragment(_,n,m)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map((e=>new Uv(e)))}onAudioTrackSwitching(e,t){const i=!!t.url;this.trackId=t.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),i?this.setInterval(100):this.resetTransmuxer(),i?(this.switchingTrack=t,this.state=$y):(this.switchingTrack=null,this.bufferedTrack=t,this.state=zy),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(T_.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var i;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=t);const{levels:s}=this,{details:r,id:n}=t;if(!s)return void this.warn(`Audio tracks were reset while loading level ${n}`);this.log(`Track ${n} loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const a=s[n];let o=0;if(r.live||null!=(i=a.details)&&i.live){this.checkLiveUpdate(r);const e=this.mainDetails;if(r.deltaUpdateFailed||!e)return;!a.details&&r.hasProgramDateTime&&e.hasProgramDateTime?(By(r,e),o=r.fragments[0].start):o=this.alignPlaylists(r,a.details)}a.details=r,this.levelLastLoaded=n,this.startFragRequested||!this.mainDetails&&r.live||this.setStartPosition(a.details,o),this.state!==Ky||this.waitForCdnTuneIn(r)||(this.state=$y),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:i,part:s,payload:r}=e,{config:n,trackId:a,levels:o}=this;if(!o)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const l=o[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const d=l.details;if(!d)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(i.start);const c=n.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new nS(this.hls,vv,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const u=this.initPTS[i.cc],p=null==(t=i.initSegment)?void 0:t.data;if(void 0!==u){const e=!1,t=s?s.index:-1,n=-1!==t,a=new xy(i.level,i.sn,i.stats.chunkCount,r.byteLength,t,n);h.push(r,p,c,"",i,s,d.totalduration,e,a,u)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${d.startSN} ,${d.endSN}],track ${a}`);const{cache:e}=this.waitingData=this.waitingData||{frag:i,part:s,cache:new cS,complete:!1};e.push(new Uint8Array(r)),this.waitingVideoCC=this.videoTrackCC,this.state=Jy}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:i,part:s}=t;if(i.type===vv)if(this.fragContextChanged(i))this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==i.sn){this.fragPrevious=i;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(T_.AUDIO_TRACK_SWITCHED,b_({},e)))}this.fragBufferedComplete(i,s)}else if(!this.loadedmetadata&&i.type===fv){const e=this.videoBuffer||this.media;if(e){Oy.getBuffered(e).length&&(this.loadedmetadata=!0)}}}onError(e,t){var i;if(t.fatal)this.state=Xy;else switch(t.details){case A_.FRAG_GAP:case A_.FRAG_PARSING_ERROR:case A_.FRAG_DECRYPT_ERROR:case A_.FRAG_LOAD_ERROR:case A_.FRAG_LOAD_TIMEOUT:case A_.KEY_LOAD_ERROR:case A_.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(vv,t);break;case A_.AUDIO_TRACK_LOAD_ERROR:case A_.AUDIO_TRACK_LOAD_TIMEOUT:case A_.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Ky||(null==(i=t.context)?void 0:i.type)!==mv||(this.state=$y);break;case A_.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case A_.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushed(e,{type:t}){t===j_&&(this.bufferFlushed=!0,this.state===Qy&&(this.state=$y))}_handleTransmuxComplete(e){var t;const i="audio",{hls:s}=this,{remuxResult:r,chunkMeta:n}=e,a=this.getCurrentContext(n);if(!a)return void this.resetWhenMissingContext(n);const{frag:o,part:l,level:d}=a,{details:c}=d,{audio:h,text:u,id3:p,initSegment:g}=r;if(!this.fragContextChanged(o)&&c){if(this.state=Wy,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),null!=g&&g.tracks){const e=o.initSegment||o;this._bufferInitSegment(g.tracks,e,n),s.trigger(T_.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:i,tracks:g.tracks})}if(h){const{startPTS:e,endPTS:t,startDTS:i,endDTS:s}=h;l&&(l.elementaryStreams[j_]={startPTS:e,endPTS:t,startDTS:i,endDTS:s}),o.setElementaryStreamInfo(j_,e,t,i,s),this.bufferFragmentData(h,o,l,n)}if(null!=p&&null!=(t=p.samples)&&t.length){const e=E_({id:i,frag:o,details:c},p);s.trigger(T_.FRAG_PARSING_METADATA,e)}if(u){const e=E_({id:i,frag:o,details:c},u);s.trigger(T_.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(e,t,i){if(this.state!==Wy)return;e.video&&delete e.video;const s=e.audio;if(!s)return;s.levelCodec=s.codec,s.id="audio",this.log(`Init audio buffer, container:${s.container}, codecs[parsed]=[${s.codec}]`),this.hls.trigger(T_.BUFFER_CODECS,e);const r=s.initSegment;if(null!=r&&r.byteLength){const e={type:"audio",frag:t,part:null,chunkMeta:i,parent:t.type,data:r};this.hls.trigger(T_.BUFFER_APPENDING,e)}this.tick()}loadFragment(e,t,i){const s=this.fragmentTracker.getState(e);var r;(this.fragCurrent=e,this.switchingTrack||s===my||s===fy)?"initSegment"===e.sn?this._loadInitSegment(e,t):null!=(r=t.details)&&r.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Jy):(this.startFragRequested=!0,super.loadFragment(e,t,i)):this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:i,bufferedTrack:s}=this,r=null==s?void 0:s.attrs,n=e.attrs;i&&r&&(r.CHANNELS!==n.CHANNELS||r.NAME!==n.NAME||r.LANGUAGE!==n.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(T_.AUDIO_TRACK_SWITCHED,b_({},e))}constructor(e,t,i){super(e,t,i,"[audio-stream-controller]",vv),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}},audioTrackController:class extends cy{registerListeners(){const{hls:e}=this;e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T_.LEVEL_LOADING,this.onLevelLoading,this),e.on(T_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(T_.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T_.LEVEL_LOADING,this.onLevelLoading,this),e.off(T_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(T_.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:i,groupId:s,details:r}=t,n=this.tracksInGroup[i];if(!n||n.groupId!==s)return void this.warn(`Track with id:${i} and group:${s} not found in active group ${n.groupId}`);const a=n.details;n.details=t.details,this.log(`audio-track ${i} "${n.name}" lang:${n.lang} group:${s} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.audioGroupIds)return;const i=t.audioGroupIds[t.urlId];if(this.groupId!==i){this.groupId=i||null;const e=this.tracks.filter((e=>!i||e.groupId===i));this.selectDefaultTrack&&!e.some((e=>e.default))&&(this.selectDefaultTrack=!1),this.tracksInGroup=e;const t={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group:${i}`),this.hls.trigger(T_.AUDIO_TRACKS_UPDATED,t),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){!t.fatal&&t.context&&t.context.type===mv&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn("Invalid id passed to audio-track controller");this.clearTimer();const i=this.currentTrack;t[this.trackId];const s=t[e],{groupId:r,name:n}=s;if(this.log(`Switching to audio-track ${e} "${n}" lang:${s.lang} group:${r}`),this.trackId=e,this.currentTrack=s,this.selectDefaultTrack=!1,this.hls.trigger(T_.AUDIO_TRACK_SWITCHING,b_({},s)),s.details&&!s.details.live)return;const a=this.switchParams(s.url,null==i?void 0:i.details);this.loadPlaylist(a)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(-1!==t)this.setAudioTrack(t);else{const t=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(T_.ERROR,{type:w_.MEDIA_ERROR,details:A_.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const s=t[i];if(!this.selectDefaultTrack||s.default){if(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===s.attrs["STABLE-RENDITION-ID"])return s.id;if(e.name===s.name&&e.lang===s.lang)return s.id}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const i=t.id,s=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`loading audio-track playlist ${i} "${t.name}" lang:${t.lang} group:${s}`),this.clearTimer(),this.hls.trigger(T_.AUDIO_TRACK_LOADING,{url:r,id:i,groupId:s,deliveryDirectives:e||null})}}constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}},emeController:pE,cmcdController:SE,contentSteeringController:class{registerListeners(){const e=this.hls;e.on(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T_.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T_.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(T_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T_.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T_.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter((t=>t!==e)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:i}=t;null!==i&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:i}=t;if((null==i?void 0:i.action)===ry&&i.flags===oy){let e=this.pathwayPriority;const t=this.pathwayId;this.penalizedPathways[t]||(this.penalizedPathways[t]=performance.now()),!e&&this.levels&&(e=this.levels.reduce(((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e)),[])),e&&e.length>1&&(this.updatePathwayPriority(e),i.resolved=this.pathwayId!==t)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter((t=>e===t.pathwayId))}updatePathwayPriority(e){let t;this.pathwayPriority=e;const i=this.penalizedPathways,s=performance.now();Object.keys(i).forEach((e=>{s-i[e]>3e5&&delete i[e]}));for(let s=0;s<e.length;s++){const r=e[s];if(i[r])continue;if(r===this.pathwayId)return;const n=this.hls.nextLoadLevel,a=this.hls.levels[n];if(t=this.getLevelsForPathway(r),t.length>0){this.log(`Setting Pathway to "${r}"`),this.pathwayId=r,this.hls.trigger(T_.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[n];a&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=n);break}}}clonePathways(e){const t=this.levels;if(!t)return;const i={},s={};e.forEach((e=>{const{ID:r,"BASE-ID":n,"URI-REPLACEMENT":a}=e;if(t.some((e=>e.pathwayId===r)))return;const o=this.getLevelsForPathway(n).map((e=>{const t=E_({},e);t.details=void 0,t.url=CE(e.uri,e.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a);const n=new L_(e.attrs);n["PATHWAY-ID"]=r;const o=n.AUDIO&&`${n.AUDIO}_clone_${r}`,l=n.SUBTITLES&&`${n.SUBTITLES}_clone_${r}`;o&&(i[n.AUDIO]=o,n.AUDIO=o),l&&(s[n.SUBTITLES]=l,n.SUBTITLES=l),t.attrs=n;const d=new Uv(t);return py(d,"audio",o),py(d,"text",l),d}));t.push(...o),EE(this.audioTracks,i,a,r),EE(this.subtitleTracks,s,a,r)}))}loadSteeringManifest(e){const t=this.hls.config,i=t.loader;let s;this.loader&&this.loader.destroy(),this.loader=new i(t);try{s=new self.URL(e)}catch(t){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==s.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+e)}const r={responseType:"json",url:s.href},n=t.steeringManifestLoadPolicy.default,a=n.errorRetry||n.timeoutRetry||{},o={loadPolicy:n,timeout:n.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(e,t,i,r)=>{this.log(`Loaded steering manifest: "${s}"`);const n=e.data;if(1!==n.VERSION)return void this.log(`Steering VERSION ${n.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=n.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=n;if(a)try{this.uri=new self.URL(a,s).href}catch(e){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${a}`)}this.scheduleRefresh(this.uri||i.url),o&&this.clonePathways(o),l&&this.updatePathwayPriority(l)},onError:(e,t,i,s)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let r=1e3*this.timeToLoad;if(429!==e.code)this.scheduleRefresh(this.uri||t.url,r);else{const e=this.loader;if("function"==typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(r=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`)}},onTimeout:(e,t,i)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(r,o,l)}scheduleRefresh(e,t=1e3*this.timeToLoad){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout((()=>{this.loadSteeringManifest(e)}),t)}constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=x_.log.bind(x_,"[content-steering]:"),this.registerListeners()}}});function DE(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(DE):Object.keys(e).reduce(((t,i)=>(t[i]=DE(e[i]),t)),{}):e}function LE(e){const t=e.loader;if(t!==kE&&t!==wE)x_.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1;else{(function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1})()&&(e.loader=kE,e.progressive=!0,e.enableSoftwareAES=!0,x_.log("[config]: Progressive streaming enabled, using FetchLoader"))}}class ME{static get version(){return"1.4.12"}static isSupported(){return function(){const e=Qf();if(!e)return!1;const t=tb(),i=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),s=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!i&&!!s}()}static get Events(){return T_}static get ErrorTypes(){return w_}static get ErrorDetails(){return A_}static get DefaultConfig(){return ME.defaultConfig?ME.defaultConfig:RE}static set DefaultConfig(e){ME.defaultConfig=e}createController(e,t){if(e){const i=new e(this);return t&&t.push(i),i}return null}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,s){this._emitter.off(e,t,i,s)}listeners(e){return this._emitter.listeners(e)}emit(e,t,i){return this._emitter.emit(e,t,i)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){x_.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger(T_.ERROR,{type:w_.OTHER_ERROR,details:A_.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){x_.log("destroy"),this.trigger(T_.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((e=>e.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((e=>e.destroy())),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){x_.log("attachMedia"),this._media=e,this.trigger(T_.MEDIA_ATTACHING,{media:e})}detachMedia(){x_.log("detachMedia"),this.trigger(T_.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,i=this.url,s=this.url=v_.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});x_.log(`loadSource:${s}`),t&&i&&(i!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(T_.MANIFEST_LOADING,{url:e})}startLoad(e=-1){x_.log(`startLoad(${e})`),this.networkControllers.forEach((t=>{t.startLoad(e)}))}stopLoad(){x_.log("stopLoad"),this.networkControllers.forEach((e=>{e.stopLoad()}))}swapAudioCodec(){x_.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){x_.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){x_.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){x_.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){x_.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){x_.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){x_.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(x_.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Mv.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const i=e.length;for(let s=0;s<i;s++)if(e[s].maxBitrate>=t)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:i}=this;let s;if(s=-1===t&&e&&e.length?e.length-1:t,i)for(let t=s;t--;){const s=e[t].attrs["HDCP-LEVEL"];if(s&&s<=i)return t}return s}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new sS,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,function(e,t){if(self.console&&!0===e||"object"==typeof e){O_(e,"debug","log","info","warn","error");try{P_.log(`Debug logs enabled for "${t}" in hls.js version 1.4.12`)}catch(e){P_=I_}}else P_=I_}(e.debug||!1,"Hls instance");const t=this.config=function(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=DE(e),s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((e=>{const r=`${"level"===e?"playlist":e}LoadPolicy`,n=void 0===t[r],a=[];s.forEach((s=>{const o=`${e}Loading${s}`,l=t[o];if(void 0!==l&&n){a.push(o);const e=i[r].default;switch(t[r]={default:e},s){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l}}})),a.length&&x_.warn(`hls.js config: "${a.join('", "')}" setting(s) are deprecated, use "${r}": ${JSON.stringify(t[r])}`)})),b_(b_({},i),t)}(ME.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&LE(t);const{abrController:i,bufferController:s,capLevelController:r,errorController:n,fpsController:a}=t,o=new n(this),l=this.abrController=new i(this),d=this.bufferController=new s(this),c=this.capLevelController=new r(this),h=new a(this),u=new Ev(this),p=new Dv(this),g=t.contentSteeringController,m=g?new g(this):null,_=this.levelController=new uy(this,m),f=new yy(this),v=new ky(this.config),y=this.streamController=new oS(this,f,v);c.setStreamController(y),h.setStreamController(y);const b=[u,_,y];m&&b.splice(1,0,m),this.networkControllers=b;const S=[l,d,c,h,p,f];this.audioTrackController=this.createController(t.audioTrackController,b);const E=t.audioStreamController;E&&b.push(new E(this,f,v)),this.subtitleTrackController=this.createController(t.subtitleTrackController,b);const C=t.subtitleStreamController;C&&b.push(new C(this,f,v)),this.createController(t.timelineController,S),v.emeController=this.emeController=this.createController(t.emeController,S),this.cmcdController=this.createController(t.cmcdController,S),this.latencyController=this.createController(Lv,S),this.coreComponents=S,b.push(o);const T=o.onErrorOut;"function"==typeof T&&this.on(T_.ERROR,T,o)}}ME.defaultConfig=void 0;class BE{_createSpinner(){const e=document.createElement("DIV");return e.className="adthrive-loading-spinner",e}get el(){return this._container}show(){this._container.style.display="inline-flex"}hide(){this._container.style.display="none"}constructor(e){this._container=document.createElement("DIV"),this._container.className="adthrive-loading-spinner-container",this._container.style.display="none",this._container.appendChild(this._createSpinner()),e.appendChild(this._container)}}class FE{get canStartAdCountDown(){return this._canStartAdCountDown}addAdTimer(e){this._adCountDownElement.classList.add(this._hiddenClassElement),e.appendChild(this._adCountDownElement)}displayAdTimer(){this._adCountDownElement.classList.remove(this._hiddenClassElement)}hideAdTimer(){this._adCountDownElement.classList.add(this._hiddenClassElement),this._canStartAdCountDown=!1}setAdTimer(e){const{uiElements:t}=null==e?void 0:e.ad,i=(null==t?void 0:t.length)&&this._hasBuiltInCountdownElements(t);this._canStartAdCountDown=!i}updateAdCountdown(e,t){const i=Math.round(e-t);i!==this._count&&i>=0?(this._count=i,this._adCountDownElement.innerHTML=`Ad ends in ${i}`):i<=0&&this.hideAdTimer()}_hasBuiltInCountdownElements(e){return e.includes(this._builtInCountdownElements[0])&&e.includes(this._builtInCountdownElements[1])}constructor(){this._adCountDownElement=document.createElement("div"),this._canStartAdCountDown=!1,this._count=0,this._builtInCountdownElements=["adAttribution","countdown"],this._hiddenClassElement="adthrive-hidden",this._adCountDownElement.classList.add("adthrive-count-down")}}var jE;FE=B([hs("AdCountDownTimer"),j("design:type",Function),j("design:paramtypes",[])],FE),function(e){e[e.AWAITING_FETCH_AD=0]="AWAITING_FETCH_AD",e[e.AWAITING_SHOW_BUTTONS=1]="AWAITING_SHOW_BUTTONS",e[e.AWAITING_NEXT_VIDEO=2]="AWAITING_NEXT_VIDEO",e[e.COMPLETE=3]="COMPLETE"}(jE||(jE={}));class NE{start(e){this._intervalId||(this.reset(),this._startTime=Date.now(),this._precomputeThresholds(e),this._intervalId=window.setInterval((()=>this._handleTimeInterval()),200))}show(){this._buttons&&(this._buttons.style.display="flex",this._isVisible=!0)}reset(){this._clearInterval(),this._hide(),this._state=jE.AWAITING_FETCH_AD,this._elapsedTime=0}destroy(){var e,t;null==(t=this._buttons)||null==(e=t.parentNode)||e.removeChild(this._buttons),this._buttons=void 0}_handleTimeInterval(){switch(this._updateElapsedTime(),this._state){case jE.AWAITING_FETCH_AD:this._handleAwaitingFetchAd();break;case jE.AWAITING_SHOW_BUTTONS:this._handleAwaitingShowButtons();break;case jE.AWAITING_NEXT_VIDEO:this._handleAwaitingNextVideo();break;case jE.COMPLETE:this._handleComplete()}}_handleAwaitingFetchAd(){this._shouldFetchAd()&&(this._fetchAd(),this._state=jE.AWAITING_SHOW_BUTTONS)}_handleAwaitingShowButtons(){this._shouldShowButtons()&&(this._showButtons(),this._state=jE.AWAITING_NEXT_VIDEO)}_handleAwaitingNextVideo(){this._shouldNextVideo()&&(this._nextVideo(),this._state=jE.COMPLETE)}_handleComplete(){this.reset()}_precomputeThresholds(e){const t=e<30;this._fetchAdThreshold=t?e-10:20,this._showButtonsThreshold=t?e-5:25,this._nextVideoThreshold=t?e:30}_thresholdReached(e){return this._elapsedTime>=e&&this._elapsedTime<=e+.5}_shouldFetchAd(){return this._thresholdReached(this._fetchAdThreshold)&&!this._isVisible&&!this._wasAdFetched()}_shouldShowButtons(){return this._thresholdReached(this._showButtonsThreshold)&&!this._isVisible}_shouldNextVideo(){return this._thresholdReached(this._nextVideoThreshold)&&this._isVisible}_updateElapsedTime(){const e=Date.now();this._elapsedTime=(e-this._startTime)/1e3}_clearInterval(){this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0)}_createButtons(){const e=document.createElement("div");e.id="next-stay-container",e.style.display="none";const t=this._createButton("next",this._nextVideo.bind(this)),i=this._createButton("stay",this.reset.bind(this));return e.appendChild(t),e.appendChild(i),e}_createButton(e,t){const i=document.createElement("div"),s=document.createElement("span");return i.id=`${e}-video`,s.textContent=e,i.appendChild(s),i.onclick=t,i.onkeydown=e=>this._throttledKeydownHandler(e,t),i}_hide(){this._buttons&&(this._buttons.style.display="none",this._isVisible=!1)}constructor(e,t,i,s,r){this._parentElement=e,this._wasAdFetched=t,this._fetchAd=i,this._showButtons=s,this._nextVideo=r,this._isVisible=!1,this._state=jE.AWAITING_FETCH_AD,this._startTime=0,this._elapsedTime=0,this._fetchAdThreshold=0,this._showButtonsThreshold=0,this._nextVideoThreshold=0,this._throttledKeydownHandler=kl(((e,t)=>{["Space","Enter"].includes(e.code)&&(e.preventDefault(),t())}),100),this._buttons=this._createButtons(),this._parentElement.appendChild(this._buttons)}}class UE extends du{_isEmbeddedStationary(){return this._playerType===au.EmbeddedStationary}_getHLSConfig(){const e=this._config.video;return{backBufferLength:e.backBufferLength,maxMaxBufferLength:e.maxMaxBufferLength,maxBufferSize:e.maxBufferSize,maxBufferLength:e.maxBufferLength,frontBufferFlushThreshold:e.frontBufferThreshold}}async _handlePlayerReady(){await this.getPlayerContent(),this._logRaptivePlayerEvent("Embed"),this._removeCLSMinHeight(),"auto-injected"!==this._playerType&&this._setupAllowSkip();const e=this._config.gdpr;!e.consentCaptured&&e.enabled&&await this.waitForConsent(),this._startTearDownTimer(),this._autoplay&&this._loadingSpinner.show(),await this._fetchLinearAd(),this.triggerPlayInView(),this._checkVideoClose()&&(this._state=Se.Closed)}_setupPlayer(){this._setupCollapseListeners(),this._setupContentSpecificPlaylists(),this._setupMatchMedia(),this._handleLoadedMetaData(),this._setupCollapse(),this._setupAdvancePlaylist(),this._adCountDown.addAdTimer(this._playerContainer),this._setupTearDown()}_removeCLSMinHeight(){var e;null==(e=this._pageElement.parentElement)||e.style.removeProperty("min-height")}_setupTearDown(){var e;("related"===this._playerType&&this._config.video.advancePlaylist||this._isCollapsible)&&(this._tearDownPlayerTimeout=null!=(e=R.resolve(yo).result)?e:0,this._canTearDown=this._tearDownPlayerTimeout>0)}_setupCollapse(){if(this._collapseSettings){this._handleTitleContainerOnCollapseAndUnCollapse(),this._collapsePlayerLogic();const e=this._collapseSettings.title;if(e){const t=document.createElement("h3");t.innerText=e,t.className="adthrive-player-title",t.id="adthrive-collapse-title";const i=this._container.firstChild;i?this._container.insertBefore(t,i):this._container.appendChild(t)}}}_setupMatchMedia(){if(window.matchMedia){const e=window.matchMedia(`only screen and (max-width: ${this._config.site.breakpoints.desktop-1}px)`);e.addListener(this._handleWidthBreak.bind(this)),this._handleWidthBreak(e)}}_setupAdvancePlaylist(){const{playlistPlayer:e,relatedPlayer:t}=this._config.video.advancePlaylist;this._isAdvancePlaylistEnabled=this._playerType===au.AutoInjected?e.enabled:t.enabled,this._isAdvancePlaylistEnabled&&(this._advancePlaylist=new NE(this._playerContainer,(()=>this._adFetched),this._handleAdvancePlaylistFetchAd.bind(this),this._handleAdvancePlaylistShowButtons.bind(this),this._handleAdvancePlaylistNextVideo.bind(this)))}_setupContentSpecificPlaylists(){const e=this._config.video.contentSpecificPlaylists,t=e&&fl(e);t&&t.playlistId&&(this._contentSpecificPlaylistId=t.playlistId)}_handleTitleContainerOnCollapseAndUnCollapse(){this._videoEventBus.videoCollapsed.on((e=>{var t;e.playerContainer===(null==(t=this.collapseCollection)?void 0:t.playerContainer)&&(this._videoDescriptionDiv.classList.add("adthrive-display-none"),this._videoTitleDiv.classList.add("adthrive-small-text"))})),this._videoEventBus.videoUnCollapsed.on((()=>{this._videoDescriptionDiv.classList.remove("adthrive-display-none"),this._videoTitleDiv.classList.remove("adthrive-small-text")}))}_handleLoadedMetaData(){this.loadedMetaData.once((()=>{this._createVideoContentTitle(),this._collapseSettings&&this._createCollapsibleCollection()}))}_handleAdvancePlaylistFetchAd(){this.prerollNum++,this._reInitAttempts=0,this._fetchLinearAd()}_handleAdvancePlaylistShowButtons(){this._advancePlaylist.show()}_handleAdvancePlaylistNextVideo(){this._loadingSpinner.show(),this._programmaticPauseVideo(!0),this._adReady.emit()}_setWrapperBar(){this._wrapperBar=this._playerPosition.querySelector(".adthrive-wrapper-bar")}_setupAllowSkip(){const e=this._config.video.advancePlaylist.relatedPlayer.applyToFirst;(this.isFirstPlay&&e||!this.isFirstPlay&&this._isAdvancePlaylistEnabled)&&(this._canSkipContent=!0)}_createVideoContentTitle(){this._config.video.removeVideoTitleWrapper&&!this._isEmbeddedStationary()?this._addCloseWithoutWrapper():this._isTopCenterCollapse()?this._addTopCenterWrapper():this._addPlayerWithoutWrapper()}_checkVideoClose(){return this._collapseSettings&&this._collapseSettings.saveVideoCloseState&&this._config.video.videoWasClosed}_handleVideoPlayingEvent({playerId:e}){e!==this._id&&(this.collapseCollection?wm.handleOtherVideoPlaying(this.collapseCollection):this._programmaticPauseVideo())}triggerPlayInView(){this.loadedMetaData.once((()=>{this.collapseCollection&&wm.handleScroll(this.collapseCollection)})),this.loadedMetaData.emitted&&this.collapseCollection&&wm.handleScroll(this.collapseCollection)}_collapsePlayerLogic(){this.collapsible&&(this._setWrapperBar(),this._wrapperBar&&this._wrapperBar.style.setProperty("display","flex"),this._isTopCenterCollapse()&&this._createTopCenterBackground(this._playerPosition),this._stickyElement=null)}_shouldShufflePlaylist(){const{hasContentSpecificPlaylist:e,shuffle:t}=this._config.video.jwPlaylistObj;return this._shuffle||e&&t}_shuffleKeepingFirstItem(e){const[t,...i]=e;return[t,...ml.shufflePlaylist(i)]}_updatePlaylistItemsWithShuffle(){if(!this._videoContentObject||!this._videoContentObject.playlist||this._videoContentObject.playlist.length<2)return;let e=this._videoContentObject.playlist;e=e.filter((e=>e.mediaid!==this.mediaOrPlaylistId)),this._shouldShufflePlaylist()&&(this._videoContentObject.playlist=this._isEmbeddedStationary()?this._shuffleKeepingFirstItem(e):ml.shufflePlaylist(e))}async getPlayerContent(){this._videoContentObject=await this._getVideoContent(),this._updatePlaylistItemsWithShuffle(),this._setVideoElementAttributesAndSource()}_setupHlsConfigAndErrorHandling(){this._hlsSetupComplete||(this._config.video.maxMaxBufferReset||(this._hls.config.maxMaxBufferLength=1),this._hls.on(ME.Events.ERROR,((e,t)=>{t.fatal&&this._handleFatalHLSError(e,t)})),this._hlsSetupComplete=!0)}_initializeHlsOrMp4(e){var t;const i=null==(t=e.find((e=>"application/vnd.apple.mpegurl"===e.type)))?void 0:t.file;i&&ME.isSupported()?(this._hls.loadSource(i),this._hls.attachMedia(this._videoElement),this._setupHlsConfigAndErrorHandling()):i&&this._videoElement.canPlayType("application/vnd.apple.mpegurl")?this._videoElement.src=i:(te.event(this._logPrefix,"_initializeHlsOrMp4",{message:"Hls is not supported, falling back to mp4"}),this._setMp4Source(e))}_setMp4Source(e){const t=this._getLowestBitrateMp4Rendition(e);t?this._videoElement.src=t:te.error(this._logPrefix,"_setMp4Source",{message:"No mp4 sources found"})}_getLowestBitrateMp4Rendition(e){let t;for(const i of e)"video/mp4"===i.type&&(!t||i.bitrate&&t.bitrate&&i.bitrate<t.bitrate)&&(t=i);return null==t?void 0:t.file}_handleFatalHLSError(e,t){switch(te.error(this._logPrefix,"_handleFatalHLSError",{event:e,data:t}),t.type){case ME.ErrorTypes.MEDIA_ERROR:this._hls.recoverMediaError();break;case ME.ErrorTypes.NETWORK_ERROR:default:this._handleNetworkOrDefaultFatalHLSError()}}_handleNetworkOrDefaultFatalHLSError(){const e=this._getVideoUsingIndex();if(!e)return;const t=e.sources.filter((e=>"video/mp4"===e.type)),i=this._videoElement.currentTime;this._resetHls(),t.length>0&&this._switchToMp4Source(i,t)}_switchToMp4Source(e,t){this._setMp4Source(t),this._videoElement.currentTime=e,this._videoElement.load(),this._advancePlaylist.reset(),this._programmaticPlayVideo().then((()=>{(this._isMobile||this._isTablet)&&this._videoPlayerControls.hideControls(),this._canSkipContent&&this._advancePlaylist.start(this._videoElement.duration),this._toggleTitle(!0),this._videoPlayerControls.toggleProgressBar(!0)})).catch((()=>{}))}_getVideoUsingIndex(e=this._playlistIndex){const t=this._videoContentObject;if(t)return t?t.playlist[e]:void 0}_getNextIndex(){const e=this._videoContentObject;if(!e)return;return e.playlist.length-1===this._playlistIndex||this.isFirstPlay?0:this._playlistIndex+1}_incrementPlaylistIndex(){const e=this._getNextIndex();void 0!==e&&(this._playlistIndex=e)}setNextVideo(){this._videoContentObject&&(this._playerType===au.AutoInjected||this._canSkipContent||this._setupAllowSkip(),this._incrementPlaylistIndex(),this._setVideoElementAttributesAndSource())}_setVideoElementAttributesAndSource(){if(!this._videoContentObject)return;const e=this._getVideoUsingIndex(),t=e.sources;this._config.video.removeVideoTitleWrapper||this._setVideoTitle(e),this._videoElement.poster=this.isFirstPlay?e.image:"",this._videoElement.controls=!1,this._videoElement.preload="metadata",this._initializeHlsOrMp4(t)}_setVideoTitle(e){const{title:t,link:i}=e;this._videoTitle=t,this._videoLink=i,this._topCollapseVideoTitleElement&&(this._topCollapseVideoTitleElement.innerHTML=this._videoTitle),this._videoTitleDiv.innerHTML=`<span class='adthrive-video-text-cutoff'>${t}</span>`,this._videoDescriptionDiv.innerHTML=`<span class='adthrive-video-text-cutoff'>${e.description}</span>`;const s=this._linkProvidedByPublisher(this._videoLink);if(this._toggleLearnMoreLink(s),s&&this._wrapperTitleWrapperElement){var r,n;null==(n=this._wrapperTitleWrapperElement)||null==(r=n.querySelector("svg"))||r.remove();const e=this._createLinkIcon(this._playlistId);this._wrapperTitleWrapperElement.appendChild(e),this._wrapperTitleWrapperElement.href=i,this._wrapperTitleWrapperElement.target="_blank",this._wrapperTitleWrapperElement.onclick=this._handleTitleClick.bind(this),this._videoTitleOverlayContainer.prepend(this._wrapperTitleWrapperElement),this._wrapperTitleWrapperElement.classList.remove("adthrive-no-pointer-events")}else if(this._wrapperTitleWrapperElement){var a,o;null==(o=this._wrapperTitleWrapperElement)||null==(a=o.querySelector("svg"))||a.remove(),this._wrapperTitleWrapperElement.classList.add("adthrive-no-pointer-events")}}_toggleLearnMoreLink(e){const t=document.getElementById(`${this._playlistId}-learn-more-link`);if(!t)return;const i="raptive-player-learn-more-link-active";e?t.classList.add(i):t.classList.remove(i)}_updateAdUnitMediaId(e){var t,i,s;const r={playerID:this._playerId,mediaID:this.nextMediaId};e.ortb2Imp={...e.ortb2Imp,ext:{...null==(t=e.ortb2Imp)?void 0:t.ext,data:{...null==(s=e.ortb2Imp)||null==(i=s.ext)?void 0:i.data,jwTargeting:r}}},this._prebidMethods.updateAdUnit(e.code,e)}_onBeforeRequestBids(){this._prebidEventBus.beforeRequestBids.on((e=>{e.forEach((e=>{const t=e.code===this.name;if(!t)return;const i=[...this._userIdComponent.getTargetingData(),...this._sspUserSyncComponent.getTargetingData()];var s;i&&(this.userIdTargetingData=i);const r=null!=(s=e.ortb2Imp&&e.ortb2Imp.ext&&e.ortb2Imp.ext.tid)?s:"";t&&r&&(this.transactionId=r)}))}))}_setupCollapseListeners(){this._collapseSettings&&(wm.classesToggled.on((()=>{this._handleResizeAd()})),wm.collapseEvent.on((()=>{this._handleResizeAd()})),wm.uncollapseEvent.on((()=>{this._handleResizeAd()})))}_setupListeners(){if(this.collapsible&&this._collapseSettings.collapseType===ve.Mobile){R.resolve(Ds).footerRefreshed.on(this._handleFooterRefreshedEvent.bind(this))}this.adLoaded.on(this._handleAdLoaded.bind(this)),this.adStarted.on(this._handleAdStart.bind(this)),this.adProgress.on(this._handleAdProgress.bind(this)),this.adPause.on(this._handleAdPause.bind(this)),this.adPlay.on(this._handleAdPlay.bind(this)),this.adError.on(this._handleAdError.bind(this)),this.adSkipped.on(this._handleCompleteAndSkip.bind(this)),this.adCompleted.on(this._handleCompleteAndSkip.bind(this)),this.adImpression.on(this._handleAdImpression.bind(this)),this.interact.on(this._handlePlayerInteraction.bind(this)),this.play.on(this._handleVideoElementPlay.bind(this)),this.pause.on(this._handleVideoElementPause.bind(this)),this.seeked.on(this._handleVideoElementSeeked.bind(this)),this.seeking.on(this._handleVideoElementSeeking.bind(this)),this.timeupdate.on(this._handleVideoElementTimeUpdate.bind(this)),this.ended.on(this._handleVideoElementEnded.bind(this)),this._spaListeners.push(this._eventProxy.resize.on(this._handleResizeAd.bind(this))),this._collapseSettings&&this._spaListeners.push(this._eventProxy.scroll.on(this._handleScroll.bind(this))),this.userInteraction.on((e=>this._listenForPlayerEventsToLog(e))),this._spaListeners.push(this._eventProxy.pageVisibility.on(this._handlePageVisibilityChange.bind(this))),this.allAdsCompleted.on(this._handleAllAdsComplete.bind(this)),this._spaListeners.push(this._eventProxy.videoPlaying.on(this._handleVideoPlayingEvent.bind(this))),this._listenForLargeVastError()}_listenForLargeVastError(){this._prebidEventBus.vastExceededLimit.on((e=>{var t;const i=null==(t=e.bids)?void 0:t[0];if(!i)return;const{adId:s,bidder:r,creativeId:n,meta:a}=i,{maxSizeAllowed:o,responseSize:l}=e,d={meta:a,bidder:r,adId:s,creativeId:n,responseSize:l,maxSizeAllowed:o};te.error(this._logPrefix,"listenForLargeVastError",d)}))}_listenForPlayerEventsToLog(e){const{action:t,context:i,details:s}=e,r={mediaId:this._playlistId,siteId:this._config.site.id,playerId:this._playerId,mediaIdCount:`${this._mediaIdCount||0}`,context:i,...s};this._eventsToSkipLogging.includes(t)||te.event(this._logPrefix,t,r)}get collapsible(){return this._isCollapsible}get isPlayerType(){return this._playerType}get transactionId(){return this._transactionId}set transactionId(e){this._transactionId=e}get vp(){return this.prerollNum<=1?this.prerollNum:this.prerollNum<=9?2:3}get retryAttempts(){return this._retryAttempts}set userIdTargetingData(e){this._userIdTargetingData=e}get userIdTargetingData(){return this._userIdTargetingData}set videoAdUnit(e){this._videoAdUnit=e}get videoAdUnit(){return this._videoAdUnit}get mediaOrPlaylistId(){return this._mediaOrPlaylistId}fetchVideoContent(e,t){return ti(ml.addMaxResolutionQueryParam(`https://cdn.jwplayer.com/v2/${e}/${t}`))}async _prependEmbeddedMedia(e){const t=await this.fetchVideoContent("media",this._mediaOrPlaylistId);e.playlist.unshift(t.playlist[0])}async _handleAdvancedPlaylist(e){const t=await this._config.video.jwPlaylistObj.playlist;this._isAdvancePlaylistEnabled&&(e.playlist=e.playlist.concat(t.playlist))}async _getVideoContent(){try{const e=this._isEmbeddedStationary()&&!this._contentSpecificPlaylistId?"media":"playlists",t=this._contentSpecificPlaylistId||this._mediaOrPlaylistId,i=await this.fetchVideoContent(e,t);return this._isEmbeddedStationary()?(this._contentSpecificPlaylistId?await this._prependEmbeddedMedia(i):await this._handleAdvancedPlaylist(i),i):i}catch(e){}}_getSegmentsForNextContent(){var e,t,i;const s=this._getNextIndex();var r;return null!=(r=null==(i=this._videoContentObject)||null==(t=i.playlist)||null==(e=t[s])?void 0:e.jwpseg)?r:[]}_enrichBidsWithJwTargeting(){var e;this._jwBoostExperiment.result&&((null==(e=this._videoAdUnit)?void 0:e.bids)?(this.jwPlayerSegments=this._getSegmentsForNextContent(),this._videoAdUnit.bids.forEach((e=>this._applyJwTargetingToBid(e,this.jwPlayerSegments)))):this._videoEventBus.videoAdUnitAdded.once((()=>{this._enrichBidsWithJwTargeting()})))}_applyJwTargetingToBid(e,t){const i=e.rtd||{},s={jwplayer:{...i.jwplayer,targeting:{content:{id:`jw_${this.nextMediaId}`},segments:t}}};e.rtd={...i,...s}}_getFormattedAdDetails(e){const t=this._getAdDetailsFromAd(e);return t?{...this._additionalAdFields,wrapperIds:t.adWrapperIds,gamCreativeId:t.adWrapperCreativeIds[t.adWrapperCreativeIds.length-1],gamLineItemId:t.adWrapperIds[t.adWrapperIds.length-1],wrapperCreativeIds:t.adWrapperCreativeIds,vastCreativeId:t.creativeId,mediaFileURL:t.mediaUrl,adUnitName:this.name,tag:this._prerollAdUrl,isEmpty:!1,wrapperSystems:t.adWrapperSystems,duration:t.duration}:null}async _handleAdLoaded(e){if(this._config.video.logAdLifeCycle&&te.event(this._logPrefix,"_handleAdLoaded",this._playerType,this._getEventInfo(e)),this._addAdDetailFields(),this._adDetails=this._getFormattedAdDetails(e),this._adPlayReady||await this._awaitAdReady(),this._videoPlayerControls.toggleProgressBar(!1),this._toggleAdContainer(!0),this._prematureAdPlay)return this._prematureAdPlay=!1,void this._handleAllAdsComplete(e);this.playAdInStream(),this._setStaleAdDetection("adLoaded")}_handleAdStart(e){this._adPlayReady||te.event(this._logPrefix,"_handleAdStart","PrematureStart",this._getEventInfo(e)),this._videoPlayerControls.setPlayButtonState("pause"),this._lastAdSuccessful=!0,this._retryAttempts=0,this._clearStaleTimers(),this._handleResizeAd(),this._programmaticPauseVideo(!0),this._toggleTitle(!1),this._loadingSpinner.hide(),this._adCountDown.setAdTimer(e),this._adCountDown.canStartAdCountDown&&this._adCountDown.displayAdTimer(),this.collapseCollection&&(this.collapseCollection.playbackStarted=!0,this._handleScroll()),this._videoPlayerControls.mediaStarted=!0,(this._isMobile||this._isTablet)&&this._videoPlayerControls.showControls(),this._videoPlayerControls.toggleControlsFullWidth(!1),this._addAdDetailFields(),this._adDetails=this._getFormattedAdDetails(e);const t=this._adDetails&&this._adDetails.duration||e.duration||this._defaultAdDuration;this._currentAdDurationWithBuffer=t+this._stalePlayerTimeoutBuffer,this._setStaleAdDetection("adStart");const i=this._adDetails||{};this._eventProxy.emitVideoSlotRenderedEvent(i),this._eventProxy.emitVideoPlayingEvent(this._id,this._mediaIdCount),this._checkRenderedAdDetails(),this._adPlaying=!0}_handleAdProgress(e){const{duration:t,position:i}=e;if(this._adCountDown.canStartAdCountDown&&this._adCountDown.updateAdCountdown(t,i),this._currentAdTime=i,this._config.video.logAdDuration&&!this._adDurationLogged){const e={adDuration:t,roundedAdDuration:Math.round(t)};te.event(this._logPrefix,"_handleAdProgress","VideoAdDuration",e),this._adDurationLogged=!0}}_handleAdImpression(e){this._config.video.logAdLifeCycle&&te.event(this._logPrefix,"_handleAdImpression",this._playerType,this._getEventInfo(e))}_handleAdPause(){if(this._clearStaleTimers(),this.adPlay.once((e=>{if(0!==this._currentAdTime){var t;const i=(null==(t=this._getFormattedAdDetails(e))?void 0:t.duration)||this._defaultAdDuration;this._currentAdDurationWithBuffer=i+this._stalePlayerTimeoutBuffer,this._setStaleAdDetection()}})),this.collapseCollection)if(this._isProgrammaticPause)this._isProgrammaticPause=!1;else if(this.collapseCollection){var e;if((null==(e=this.collapseCollection)?void 0:e.playerState)===Se.Closed)return;this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?Se.UserPauseCollapsed:Se.UserPauseUncollapsed}}_handleAdPlay(){if(this._isProgrammaticPlay)this._isProgrammaticPlay=!1;else if(this.collapseCollection){var e;if((null==(e=this.collapseCollection)?void 0:e.playerState)===Se.Closed)return;this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?Se.CollapsedPlay:Se.UncollapsedPlay}}async _adFailedLogic(){const e="vpr"===this._raptiveInstreamRerequestOnErrorResult&&this.prerollNum>5,t="vpr2"===this._raptiveInstreamRerequestOnErrorResult&&this._retryAttempts>=2;e||t||"off"===this._raptiveInstreamRerequestOnErrorResult||this._retryAttempts>=this._maxRetries?this._continuePlayingNextContent():(this._retryAttempts+=1,this._prebidMethods.getHighestCpmBids(this.name).length||await this.requestVideoBids([this]),this._reInitAttempts=0,this._remove(),this.reInitIMA(),this._makeGamCall(),this._loadingSpinner.show())}async _awaitAdReady(){return new Promise((e=>{this._adReady.once((()=>{e()}))}))}async _handleAllAdsComplete(e){this._adPlayReady||(te.event(this._logPrefix,"_handleAllAdsComplete","PrematureComplete",this._getEventInfo(e)),await this._awaitAdReady()),this._lastAdSuccessful||this._retryAttempts>this._maxRetries?this._continuePlayingNextContent():this._adFailedLogic()}_disableErroredOutCreativeIds(){const e=this._config.video.creativeFailureThreshold;if(this.name&&e){this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids.forEach((t=>{var i;if("rendered"===t.status)return;const s=null==(i=t.creativeId)?void 0:i.toString(),r=s&&this._erroredOutCreativeIds.get(s);r&&r>=e&&this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:t.adId})}))}}async _handleAdError(e){this._adPlayReady||await this._awaitAdReady(),this._clearStaleTimers(),te.error(this._logPrefix,"_handleAdError",e.type,e);const t=this._prerollAdUrl;this._bidMarkedOnCurrentAd=!1,this._adDetails||(this._addAdDetailFields(),this._adDetails={...this._additionalAdFields,adUnitName:this.name,tag:t,isEmpty:!0}),this._checkRenderedAdDetails(!0);const i={...e,...this._getPlayerVersions(),...this._getErrorLogAdDetails()};900===e.code&&this._eventProxy.emitVideoSlotRenderedEvent(this._adDetails),te.error(this._logPrefix,"vastError",this._playerType,i),e.type===ou.AD_LOAD&&await this._handleAllAdsComplete(e),this._adCountDown.hideAdTimer()}_handleCompleteAndSkip(){this._config.video.maxMaxBufferReset||1!==this._hls.config.maxMaxBufferLength||(this._hls.config.maxMaxBufferLength=600),this._tearDownAfterNextAd&&(this._incrementPlaylistIndex(),this._tearDownPlayer()),this._adCountDown.hideAdTimer()}_programmaticPlayVideo(){return new Promise(((e,t)=>{if(this._adPlaying)try{this._playAd(),e()}catch(e){t(e)}else this._isProgrammaticPlay=!0,this._videoElement.play().then(e).catch(t)}))}_handlePlayerInteraction(){this._advancePlaylist.reset()}_handleVideoElementPlay(){if(this._videoPlayerControls.mediaStarted=!0,this._wasSeeking&&(this._isVideoEnded||0===this._videoElement.currentTime))return this._videoPlayerControls.toggleProgressBar(!1),this._toggleAdContainer(!0),this._adCountDown.hideAdTimer(),void this._programmaticPauseVideo(!0);if(this._videoPlayerControls.toggleControlsFullWidth(!0),this._eventProxy.emitVideoPlayingEvent(this._id,this._mediaIdCount),this.isFirstPlay&&(this._programmaticPauseVideo(!0),this._videoPlayerControls.toggleProgressBar(!1),this._toggleAdContainer(!0),this._adReady.emit()),this._isProgrammaticPlay)this._isProgrammaticPlay=!1;else if(this.collapseCollection){var e;if((null==(e=this.collapseCollection)?void 0:e.playerState)===Se.Closed)return;this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?Se.CollapsedPlay:Se.UncollapsedPlay}}_programmaticPauseVideo(e){this._isProgrammaticPause=!0,!this._adPlaying||e?this._videoElement.pause():this._pauseAd()}_handleVideoElementPause(){if(this._adPlaying||(this._toggleTitle(!0),this._adCountDown.hideAdTimer()),this.collapseCollection)if(this._isProgrammaticPause)this._isProgrammaticPause=!1;else if(this.collapseCollection){var e;if((null==(e=this.collapseCollection)?void 0:e.playerState)===Se.Closed)return;this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?Se.UserPauseCollapsed:Se.UserPauseUncollapsed}}_handleVideoElementSeeking(e){"seeking"===e.type&&(this._wasSeeking=!0)}_handleVideoElementSeeked(e){"seeked"===e.type&&(this._wasSeeking=!1)}_handleVideoElementTimeUpdate(){const e=this._videoElement,t=e.currentTime,i=e.duration-t;t>1&&!this._videoStarted&&(this._videoStarted=!0,this._isVideoEnded=!1,this._loadingSpinner.hide(),this.collapseCollection&&(this.collapseCollection.playbackStarted=!0,this._handleScroll()),this._eventProxy.emitVideoPlayingEvent(this._id,this._mediaIdCount)),!this._config.video.removeVideoTitleWrapper&&t>3&&this._videoTitleOverlayContainer.classList.contains("active")&&!this._wasSeeking&&this._toggleTitle(!1),i<10&&!this._adFetched&&(this.prerollNum++,this._reInitAttempts=0,this._fetchLinearAd())}_setNextMediaId(){const e=this._getVideoUsingIndex(this._getNextIndex());var t;this.nextMediaId=null!=(t=null==e?void 0:e.mediaid)?t:"nf"}async _fetchLinearAd(){this._setNextMediaId(),this._jwBoostExperiment.result&&this.videoAdUnit&&this._updateAdUnitMediaId(this.videoAdUnit),this._config.ccpa.userOptedOut||this._enrichBidsWithJwTargeting(),this._adFetched=!0,await this.requestVideoBids([this]),await this.requestVideoBids([this]),this._makeGamCall()}_handleVideoElementEnded(){this._isVideoEnded=!0,this._videoStarted=!1,this._advancePlaylist.reset(),this._videoPlayerControls.toggleProgressBar(!1),this._toggleTitle(!1),this._adReady.emit()}_handleResizeAd(){if(!this._adsManager)return;const e=this._ima;this._adsManager.resize(this._adContainer.clientWidth,this._adContainer.clientHeight,e.ViewMode.NORMAL)}_addAdDetailFields(){const e=this._prerollAdUrl,t=e&&this._getCustParamsFromQueryString(e),{hb_adid:i,hb_adomain:s,hb_bidder:r,amznp:n,hb_pb:a,amznbid:o,hb_deal:l}=t||{};this._additionalAdFields={adId:`${i}`,adomain:`${s}`,hb_bidder:`${r}`,amznp:`${n}`,hb_pb:`${a}`,amznbid:`${o}`,hb_deal:`${l}`}}_checkRenderedAdDetails(e=!1){const t=this._prebidAuctionManager,i=this._adDetails;if(!t||!i||this._bidMarkedOnCurrentAd)return;const s=i.gamCreativeId,r=i.wrapperSystems;this._markPrebidBidAsUsed(s,t,r,e)}_clearStaleTimers(){this._stalePlayerTimeoutId&&(clearTimeout(this._stalePlayerTimeoutId),this._stalePlayerTimeoutId=null)}_continuePlayingNextContent(){this._adPlaying=!1,this._config.video.maxMaxBufferReset||1!==this._hls.config.maxMaxBufferLength||(this._hls.config.maxMaxBufferLength=600),this.isFirstPlay||this.setNextVideo(),this.isFirstPlay=!1,this._reInitAttempts<1&&(this._remove(),this.reInitIMA(),this._reInitAttempts++),this._resetAdVars(),this._programmaticPlayVideo().then((()=>{(this._isMobile||this._isTablet)&&this._videoPlayerControls.hideControls(),this._toggleTitle(!0),this._toggleAdContainer(!1),this._videoPlayerControls.toggleProgressBar(!0),this._logRaptivePlayerEvent("Play"),this._adCountDown.hideAdTimer(),this._canSkipContent&&this._advancePlaylist.start(this._videoElement.duration),vs(1),this._adsLoader.contentComplete()})).catch((()=>{}))}_enableRemoveRaptivePLayer(){this._tearDownAfterNextAd=!0}_getAdDetailsFromAd(e){return e&&Object.keys(e).length>0?e[Object.keys(e)[0]]:null}_getCustParamsFromQueryString(e){const t=e&&Rt(e.split("?")[1]),i=t&&t.get("cust_params");return i&&Dt(this._getDecodedURI(i))}_getDecodedURI(e){try{return decodeURIComponent(e)}catch(e){return""}}_getErrorLogAdDetails(){return(({wrapperIds:e,wrapperCreativeIds:t,wrapperSystems:i,vastCreativeId:s,mediaFileURL:r,adId:n,adUnitName:a,adomain:o,hb_bidder:l,amznp:d,hb_pb:c,amznbid:h,hb_deal:u})=>({wrapperIds:e,wrapperCreativeIds:t,wrapperSystems:i,vastCreativeId:s,mediaFileURL:r,adId:n,adUnitName:a,adomain:o&&encodeURIComponent(o),hb_bidder:l,amznp:d,hb_pb:c,amznbid:h,hb_deal:u}))(this._adDetails||{})}_getEventInfo(e){const{adId:t,adSystem:i,adWrapperIds:s,mediaurl:r,adWrapperSystems:n,apiFramework:a,duration:o,height:l,title:d,vpaid:c}=e.ad;return{vprenum:this.prerollNum,playerName:this.name,adId:t,adSystem:i,adWrapperIds:s,mediaurl:r,adWrapperSystems:n,apiFramework:a,duration:o,height:l,title:d,vpaid:c}}_getPlayerVersions(){return{imaSDKVersion:this._ima&&this._ima.VERSION}}_markPrebidBidAsUsed(e="",t,i=[],s=!1){const r=e&&t.videoCreativeIdMapping.get(e);let n=!1,a=!1,o=!1;if(i.forEach((e=>{const t=e.toLowerCase();"gdfp"===t&&(a=!0),"prebid.org wrapper"===t?n=!0:"amazon"===t&&(o=!0)})),r){const e=this._adDetails,t=(e&&e.tag&&this._getCustParamsFromQueryString(e.tag)||{})[`hb_adid_${r}`.substring(0,20)];t&&(this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:t}),this._bidMarkedOnCurrentAd=!0,s&&this._creativeFailureDetection(t),!s&&this._logCreativeIdWithPreviousError(t))}else e?te.event(this._logPrefix,"_markPrebidBidAsUsed",{message:"Creative Id Not Found",gamCreativeId:e}):((n||a&&!o||!i.length)&&(this._bidMarkedOnCurrentAd=!0,this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name})),te.event(this._logPrefix,"_markPrebidBidAsUsed",{message:"Missing Creative Id"}))}_creativeFailureDetection(e){const t=this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids||[];for(const i of t)if(i.adId===e&&i.creativeId){let e=this._erroredOutCreativeIds.get(i.creativeId.toString())||0;e++,this._erroredOutCreativeIds.set(i.creativeId.toString(),e);break}}_logCreativeIdWithPreviousError(e){const t=this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids||[];for(const i of t)if(i.adId===e&&i.creativeId){(this._erroredOutCreativeIds.get(i.creativeId.toString())||0)&&te.event(this._logPrefix,"_logCreativeIdWithPreviousError",{creativeId:i.creativeId});break}}_resetAdVars(){this._bidMarkedOnCurrentAd=!1,this._adDetails=null,this._adFetched=!1,this._adDurationLogged=!1,this._currentAdTime=0,this._currentAdDurationWithBuffer=0,this._clearStaleTimers(),this._adPlayReady=!1,this._retryAttempts=0,this._lastAdSuccessful=!1,this._prematureAdPlay=!1}_resetHls(){this._hls.destroy(),this._hls=new ME,this._hlsSetupComplete=!1}_resetPlayerProperties(){this._adPlayMap=new Map,this._adPlaying=!1,this._canTearDown=!1,this._isProgrammaticPause=!0,this._isProgrammaticPlay=!0,this._isVideoEnded=!1,this._playerState=Se.Unstarted,this._tearDownAfterNextAd=!1,this._videoStarted=!1,this._videoPlayerControls.toggleProgressBar(!0)}_setStaleAdDetection(e="adPlay"){const t="adLoaded"===e,i="adStart"===e?0:this._currentAdTime,s=t?this._config.video.staleLoadThreshold:this._currentAdDurationWithBuffer-i,r="RaptivePlayer encountered an unknown error "+(t?"attempting to play the ad":"during ad play");this._stalePlayerTimeoutId||(this._stalePlayerTimeoutId=window.setTimeout((()=>{te.error(this._logPrefix,"stalePlayer",{message:r,...this._getPlayerVersions(),...this._getErrorLogAdDetails()}),-1===this._tearDownPlayerTimeout?(this._enableRemoveRaptivePLayer(),this._tearDownPlayer()):this._continuePlayingNextContent()}),1e3*s))}_startTearDownTimer(){const e=this._tearDownPlayerTimeout;this._canTearDown&&(this._tearDownTimer=window.setTimeout(this._enableRemoveRaptivePLayer.bind(this),e))}_tearDownPlayer(){var e,t;const i={adUnit:null==(e=this._videoAdUnit)?void 0:e.code,playerType:this._playerType,playerId:this._playerId,playlistId:this._playlistId,mediaId:this.mediaOrPlaylistId,state:this._state,collapseState:null==(t=this.collapseCollection)?void 0:t.playerState,vp:this.prerollNum};te.event(this._logPrefix,"_tearDownPlayer",i),this._tearDownTimer&&clearTimeout(this._tearDownTimer),this._remove(!0),this._advancePlaylist.destroy(),this._resetHls(),this.injectPlayer(),this._setupPlayer(),this.reInitIMA(),this._resetAdVars(),this._resetPlayerProperties(),this._handleScroll()}_toggleAdContainer(e){const t=document.getElementById(`adthrive-${this._playerType}-ad-container`);t&&(e?(t.classList.add("adthrive-player-ad-container-loading"),t.classList.remove("raptive-player-ad-container-idle")):(t.classList.remove("adthrive-player-ad-container-loading"),t.classList.add("raptive-player-ad-container-idle")))}_toggleTitle(e){this._config.video.removeVideoTitleWrapper||this._adPlaying||(e?this._videoTitleOverlayContainer.classList.add("active"):this._videoTitleOverlayContainer.classList.remove("active"))}_logRaptivePlayerEvent(e){var t,i,s;const r=this._playerId,n=this._playlistId,a=null==(s=this._videoContentObject)||null==(i=s.playlist)||null==(t=i[this._playlistIndex])?void 0:t.mediaid;te.event(this._logPrefix,e,{playerId:r,playlistId:n,mediaId:a})}_preventCollapse(){wm.disableCollapse=!0,this.collapseCollection&&wm.uncollapse(this.collapseCollection)}_createCollapsibleCollection(){this.collapseCollection={adContainer:this._adContainer,closeButton:this._closeButton,collapseMobileSizeType:this._collapseSettings.collapseMobileSizeType,collapseMobileSubType:this._getCollapseMobileSubType(),collapseSubType:be.BottomRight,collapseTimer:{timeCollapsed:0,isRunning:!1},collapseType:this._collapseSettings.collapseType,desktopCollapseOnScrollUp:this._collapseSettings.desktopCollapseOnScrollUp,footerElement:this._config.video.footerSelector?document.querySelector(this._config.video.footerSelector):null,forceMobile:"desktop"!==this._context.device,hasPreviouslyCollapsed:!1,playbackStarted:!1,mobileCollapseOnScrollUp:this._collapseSettings.mobileCollapseOnScrollUp,mobileHeaderSelector:this._collapseSettings.mobileHeaderSelector,playerCollapsed:!1,playerContainer:this._playerContainer,playerPosition:this._playerPosition,playerState:this._playerState,playerType:this._playerType,programmaticPause:this._programmaticPauseVideo.bind(this),programmaticPlay:this._programmaticPlayVideo.bind(this),saveVideoCloseState:this._collapseSettings.saveVideoCloseState,stickyElement:this._stickyElement,title:this._collapseSettings.title,topBackgroundElement:this._topBackgroundElement}}_getCollapseMobileSubType(){var e;return this._mobileStickyPlayerPositionSiteExperiment.enabled&&"control"!==this._mobileStickyPlayerPositionSiteExperiment.result?ml.setMobileLocation(this._mobileStickyPlayerPositionSiteExperiment.result):this._mobileStickyPlayerPositionCoreExperiment.mobileLocation?ml.setMobileLocation(this._mobileStickyPlayerPositionCoreExperiment.mobileLocation):null==(e=this._collapseSettings)?void 0:e.mobileLocation}async _handleScroll(){const e=this._config.gdpr;!e.consentCaptured&&e.enabled&&await this.waitForConsent(),this.collapseCollection&&wm.handleScroll(this.collapseCollection)}_handleResize(){this.collapseCollection&&wm.handleResize(this.collapseCollection)}_handlePageVisibilityChange(e){this.collapseCollection&&wm.handlePageVisibilityChange(e,this.collapseCollection)}_displayCloseButton(){this.collapseCollection&&wm.displayCloseButton(this.collapseCollection)}_linkProvidedByPublisher(e){return!e.startsWith("https://cdn.jwplayer.com")}_handleClose(){this.collapseCollection&&(this._collapseSettings.saveVideoCloseState&&K.setLocalStorageValue("video_closed",!0),this._isAdvancePlaylistEnabled&&this._advancePlaylist.reset(),wm.handleClose(this.collapseCollection,this.prerollNum))}_handleUserClick(){this.collapseCollection&&wm.handleUserClick(this.collapseCollection)}_handleWidthBreak(e){this.collapseCollection&&wm.handleWidthBreak(e,this.collapseCollection)}_handleTitleClick(e){var t;(null==(t=this.collapseCollection)?void 0:t.collapseTimer.firstInView)&&te.event(this._logPrefix,"_handleTitleClick",{timeElapsed:Date.now()-this.collapseCollection.collapseTimer.firstInView.valueOf(),link:e.currentTarget.getAttribute("href")})}_handleFooterRefreshedEvent(){this.collapseCollection&&this.collapseCollection.playerCollapsed&&wm.repositionCollapseMobileBottom(this.collapseCollection)}get _isTopCollapse(){return"adthrive-collapse-top-center"===this._getCollapseMobileSubType()}_createTopCenterBackground(e){this._topBackgroundElement=this._createPlayerCollapseBackgroundElement();const t=this._config.adOptions.bgColor;t&&(this._topBackgroundElement.style.backgroundColor=t),e.appendChild(this._topBackgroundElement)}_createLinkIcon(e){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","24"),t.setAttribute("height","24"),t.setAttribute("style","vertical-align:top;margin-right:10px");const i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d","M 16 1 H 23 V 8 Z M 19.5 12.5 V 23 H 1 V 4.5 H 12 l 1 1 H 2 V 22 H 18.5 V 11.5 l 1 1 v 1 M 19 4 L 11.5 11.5 l 1 1 L 20 5"),i.setAttribute("stroke","white"),i.setAttribute("stroke-width","2"),i.setAttribute("stroke-linejoin","round"),t.appendChild(i),t.id=`${e}-svg-link`,t}_addCloseWithoutWrapper(){this._playerContainer.appendChild(this._createPlayerCloseButton()),this._playerContainer.classList.add("adthrive-player-without-wrapper-text")}_addTopCenterWrapper(){this._playerContainer.appendChild(this._createPlayerWrapper()),this._playerContainer.appendChild(this._createTopCollapseWrapper()),this._playerContainer.classList.add("adthrive-player-with-wrapper-text")}_addPlayerWithoutWrapper(){this._playerContainer.appendChild(this._createPlayerWrapper()),this._playerContainer.classList.add("adthrive-player-without-wrapper-text")}_createPlayerWrapper(){const e=this._videoTitleOverlayContainer;return this._videoTitleElement=document.createElement("span"),this._videoTitleElement.classList.add("adthrive-video-text-cutoff","adthrive-video-title"),this._closeButton=this._createPlayerCloseButton(),e.classList.add("adthrive-wrapper-bar"),e.appendChild(this._closeButton),e}_createLearnMoreLink(e,t){const i=document.createElement("a"),s=["raptive-player-learn-more-link","adthrive-learn-more-link",...t?["raptive-player-learn-more-link-active"]:[]];return i.classList.add(...s),i.innerText="Tap here to learn more.",i.id=`${e}-learn-more-link`,i}_createTopCollapseWrapper(){const e=this._playerType===au.AutoInjected,t=document.createElement("div");t.className="adthrive-top-collapse-wrapper-bar",this._closeButton=this._createPlayerCloseButton();const i=document.createElement("div");i.className="adthrive-top-collapse-close-spacer",i.appendChild(this._closeButton),t.appendChild(i),this._wrapperText=document.createElement("a");const s=this._linkProvidedByPublisher(this._videoLink);s&&(this._wrapperText.href=this._videoLink),this._topCollapseVideoTitleElement=document.createElement("span"),this._topCollapseVideoTitleElement.classList.add("adthrive-top-collapse-wrapper-video-title");const r=this._config.adOptions.secColor;if(r&&(this._topCollapseVideoTitleElement.style.color=r,this._topCollapseVideoTitleElement.innerHTML=this._videoTitle),this._wrapperText.appendChild(this._topCollapseVideoTitleElement),e){const e=this._createLearnMoreLink(this._playlistId,s);this._wrapperText.appendChild(e),this._wrapperText.onclick=this._handleTitleClick.bind(this)}return t.appendChild(this._wrapperText),t}_isTopCenterCollapse(){var e;return(null==(e=this._collapseSettings)?void 0:e.collapseType)===ve.Mobile&&this._isTopCollapse}_createPlayerCloseButton(){const e=this._wrapperTitleWrapperElement||this._videoTitleElement;return this._closeButton=this._videoCloseButtonComponent.createPlayerCloseButton(this._handleClose.bind(this),"instream","adthrive-collapse-close",!!e,this._isTopCollapse),this._closeButton}_createPlayerCollapseBackgroundElement(){const e=document.createElement("div");return e.classList.add("adthrive-collapse-mobile-background"),e.style.width=`${window.innerWidth}px`,e.style.display="inline",e.style.height="0",e}constructor(e,t,i=1,s,r,n,a,o,l,d,c,h,u,p,g,m,_,f,v){super(t,s,r,n,a,o,d,c),this._id=e,this._mediaIdCount=i,this._mediaOrPlaylistId=s,this._context=l,this.name=h,this._isCollapsible=u,this._prebidMethods=p,this._auctionManagers=g,this._prebidEventBus=m,this._videoEventBus=_,this._collapseSettings=f,this._shuffle=v,this.type="RaptivePlayer",this.prerollNum=0,this.collapseCollection=null,this._logPrefix="RaptivePlayer",this._additionalAdFields=null,this._adDurationLogged=!1,this._adFetched=!1,this._adPlayMap=new Map,this._adDetails=null,this._adPlaying=!1,this._bidMarkedOnCurrentAd=!1,this._canSkipContent=this._playerType===au.AutoInjected,this._canTearDown=!1,this._contentSpecificPlaylistId=null,this._currentAdDurationWithBuffer=0,this._currentAdTime=0,this._defaultAdDuration=30,this._eventsToSkipLogging=["volume"],this._isAdvancePlaylistEnabled=!1,this._isProgrammaticPause=!0,this._isProgrammaticPlay=!0,this._isVideoEnded=!1,this._playerState=Se.Unstarted,this._playlistIndex=0,this._prerollAdUrl="",this._reInitAttempts=0,this._spaListeners=[],this._state=Se.Unstarted,this._stalePlayerTimeoutId=null,this._tearDownAfterNextAd=!1,this._tearDownPlayerTimeout=0,this._tearDownTimer=null,this._topBackgroundElement=null,this._transactionId="",this._userIdTargetingData=[],this._videoLink="",this._videoStarted=!1,this._videoTitle="",this._wasSeeking=!1,this._retryAttempts=0,this._playlistMaxRetries=4,this._relatedPlayerMaxRetries=2,this._lastAdSuccessful=!1,this._erroredOutCreativeIds=new Map,this._hlsSetupComplete=!1,this._makeGamCall=async()=>{await this._videoEventBus.auctionsCompleted.legacyEmit([this]),this._disableErroredOutCreativeIds(),this._prerollAdUrl=this.buildVideoUrl(this),this.requestAd({adTagUrl:this._prerollAdUrl}),this._adPlayMap.set(this.prerollNum,!0)},this._isEmbeddedStationary()&&this._config.video.setupAdvanceRelatedExperiment(!1),this._stalePlayerBufferTimeExperiment=R.resolve(Co),this._stalePlayerTimeoutBuffer=bt(this._stalePlayerBufferTimeExperiment.result,10),this._raptiveInstreamRerequestOnErrorResult=R.resolve(fo).result,this._maxRetries="auto-injected"===this._playerType?this._playlistMaxRetries:this._relatedPlayerMaxRetries,this._userIdComponent=R.resolve(qh),this._sspUserSyncComponent=R.resolve(Jp),this._videoCloseButtonComponent=R.resolve(bm),this._mobileStickyPlayerPositionSiteExperiment=R.resolve(ho),this._mobileStickyPlayerPositionCoreExperiment=R.resolve(co),this._jwBoostExperiment=R.resolve(Ja),this._prebidAuctionManager=this._auctionManagers.getPrebidAuctionManager(),this._adCountDown=R.resolve(FE),this._hls=new ME(this._getHLSConfig()),this._onBeforeRequestBids(),this._setupPlayer(),this._setupListeners(),this._loadingSpinner=new BE(this._playerContainer),this.ready.on((()=>this._handlePlayerReady()))}}class VE{_addAPStagSlotBidResponse(e,t,i){this._apstagSlotBids.set(e,{bid:t,discounts:i})}_addPrebidSlotTargeting(e,t){this._prebidSlotTargetingMap.set(e,t)}getVideoTargeting(e,t){const i=this._irisTvTracker.enabled?this._irisTvTracker.irisContextualData:void 0,s={},r="rvadv_ab1";if(Object.keys(t).forEach((e=>{const i=t[e],n=this._abgroup.get(r);"abgroup"===e&&n&&i.push(`${r}:${n}`),s[e]=encodeURIComponent(i.toString())})),s.mcmp=this._getMcmpValues(),s.vprenum=String(e.prerollNum),Jc(e)&&(s.jwv=e.jwVersion||""),s.imav=e.imaVersion||"",s.voba=this._config.videoOpenBidding.bidders.toString(),i){s["iris_context"]=i.toString()}return s}_getMcmpValues(){const e=this._getTrackScrollTargeting(),t=[...this._config.marmalade.mcmpTargeting];return e&&t.push(e),t.toString()}_getTrackScrollTargeting(){const e=this._config.trackScroll;return e.trackScrollEnabled&&e.getTargetingValue()}_getVideoBid(e){const t=this._apstagSlotBids.get(e),i=null==t?void 0:t.bid,s=null==t?void 0:t.discounts;return i?(this._apstagSlotBids.delete(e),{bid:i,discounts:s}):{}}getPrebidNoBidTargeting(e){const t=this.getPrebidSlotTargeting(e).noBid;if(t)return{hb_bidder:t}}getPrebidSlotTargeting(e){return this._prebidSlotTargetingMap.get(e)||{}}_convertFlagSlotValues(e){const t=[];return Object.keys(e).forEach((i=>{const s=e[i];"string"==typeof s?t.push(`${i}%3A${s}`):Array.isArray(s)&&s.length>0&&t.push(s.map((e=>`${i}%3A${e}`)).join(","))})),t.join(",")}_addAmazonDiscountTargeting(e,t){const{standard:i,pmp:s}=e,r=(e,i)=>{this._floors.setVideoFlagSlot(t,{[e]:[i.toFixed(6).toString()]})};i.originalCpm&&r("aop",i.originalCpm),i.discount&&r("apd",i.discount),s.originalCpm&&r("aopp",s.originalCpm),s.discount&&r("appd",s.discount)}_removeSpecificAmazonTargetingKey(e){this._amazonTargetingKeysToRemove.forEach((t=>{delete e[t]}))}_getAmazonBidTargeting(e,t){const{bid:i,discounts:s}=this._getVideoBid(e);if(i){let e={};for(const t in i)if("targeting"===t)e={...e,...i[t]};else if(this._config.amazon.amznTargetingKeys.includes(t)){const s=i[t];e[t]=s}return this._removeSpecificAmazonTargetingKey(e),s&&this._addAmazonDiscountTargeting(s,t),e}return{}}_setPrebidDiscountTargeting(e){const{cpm:t,responseCpm:i}=this._prebidMethods.getHighestCpmBids(e)[0]||{},s=(i||0)-(t||0);i&&s&&this._floors.setVideoFlagSlot(e,{pbop:[t.toFixed(6).toString()],pbpd:[s.toFixed(6).toString()]})}_getFloorsTargeting(e){const t=this._floors.getVideoFlagSlot(e);return t&&this._floors.clearVideoFlagSlot(e),t}_getCustParams(e,t=!0){const i=this._gam.getTargetingMap(),s=this._getAmazonBidTargeting(e._playlistId,e.name),r=t&&this._getActiveBidsInPool(e);var n;const a={...(e.isPlayerType===au.Playlist||e.isPlayerType===au.AutoInjected)&&{plid:e._playlistId},...e instanceof UE?{jwpid:null!=(n=e._playerId)?n:""}:{},jwmid:e.nextMediaId||e.mediaOrPlaylistId,...this._getFloorsTargeting(e.name),tid:"transactionId"in e?e.transactionId:"",iroe:"retryAttempts"in e?e.retryAttempts.toString():"0",...r&&{bic:r.length.toString()},player:Jc(e)?"j":"r"};return{...a&&{flag_slot:this._convertFlagSlotValues(a)},...this.getVideoTargeting(e,i),...this.getPrebidNoBidTargeting(e.name),...s,idp:e.userIdTargetingData.join(",")}}_getActiveBidsInPool(e){const t=(this._prebidMethods.getBidResponsesForAdUnitCode(e.name)||{}).bids;return t&&t.filter((e=>{const t=e.ttl||300,i=e.responseTimestamp+1e3*t>(new Date).getTime(),s=e&&"rendered"!==e.status;return i&&s}))}handleGdprConsent(){const e={gdpr:1,gdpr_consent:"tcunavailable"};return"function"==typeof window.__tcfapi&&window.__tcfapi("getTCData",2,(t=>{t&&t.tcString&&t.tcString.length&&(e.gdpr_consent=t.tcString),t&&t.addtlConsent&&t.addtlConsent.length&&(e.addtl_consent=t.addtl_consent)})),e}getConsentParams(){if(this._config.gdpr.enabled)this.handleGdprConsent();else if(this._config.ccpa.privacyString)return{us_privacy:this._config.ccpa.privacyString}}getDefaultVideoUrlParams(e){var t;const i=window.location.origin;return{iu:`/${this._config.gam.account}/${this._config.gam.prefix}_${e.name}/${this._config.site.id}`,sz:e.size.join("x"),hl:"en",output:"vast",url:"__page-url__",vad_type:"linear",description_url:`${encodeURIComponent(encodeURIComponent(i))}`,pp:"10_VAST%20redirects_video%2Fmp4_VPAID%20JavaScript",vpos:"preroll",vpmute:this._getVpmute(e.name),wta:1,tfcd:Gi()?1:0,...(null==(t=this._config.video.plcmtUnits)?void 0:t.get(e.name))&&{plcmt:this._config.video.plcmtUnits.get(e.name)}}}buildGAMVideoUrl(e){const t=this.getConsentParams(),i=ml.createQueryString(this._getCustParams(e,!1)),s=ml.createEncodedQueryString({cust_params:i}),r=this.getDefaultVideoUrlParams(e),n={env:"vp",gdfp_req:"1",unviewed_position_start:"1",correlator:Date.now(),...r,...t};return`https://securepubads.g.doubleclick.net/gampad/ads?${ml.createQueryString(n)}&${s}`}buildGAMVideoUrlPrebid(e){const t=e.videoAdUnit||{};this._setPrebidDiscountTargeting(e.name);const i=this._getCustParams(e),s=this.getDefaultVideoUrlParams(e);return window.pbjs.adServers.dfp.buildVideoUrl({adUnit:t,params:{...s,cust_params:i}})}buildVideoUrl(e){return this.shouldPrebidRun?this.buildGAMVideoUrlPrebid(e):this.buildGAMVideoUrl(e)}_getVpmute(e){return e===_e.Video_In_Post_ClicktoPlay_SoundOn?0:1}constructor(e,t,i,s,r,n,a,o){this._abgroup=e,this._config=t,this._gam=i,this._irisTvTracker=s,this._floors=r,this._videoEventBus=n,this._slotEventBus=a,this._prebidMethods=o,this._apstagSlotBids=new Map,this._prebidSlotTargetingMap=new Map,this._amazonTargetingKeysToRemove=["amznp","amznp_sp"],this.shouldPrebidRun=!1,this._videoEventBus.addAPStagSlotBidResponse.on((({playlistId:e,bid:t,discounts:i})=>this._addAPStagSlotBidResponse(e,t,i))),this._slotEventBus.addPrebidSlotTargeting.on((({adUnitCode:e,slotTargeting:t})=>this._addPrebidSlotTargeting(e,t)))}}VE=B([hs("VideoUrlBuilder"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Qs?Object:Qs,void 0===Ol?Object:Ol,void 0===Vl?Object:Vl,void 0===rd?Object:rd,void 0===zl?Object:zl,void 0===zs?Object:zs,void 0===Es?Object:Es,void 0===Ss?Object:Ss])],VE);const zE=()=>{var e,t,i;return(e="generator",(null!=(i=null==(t=document.querySelector(`meta[name=${e}]`))?void 0:t.content)?i:null)||"").includes("Wix")||!!window.wixPerformanceMeasurements||!!window["wix-perf-measure"]||!!window.wixDevelopersAnalytics},$E=(e=>{let t=!1;return async()=>{if(!t){try{await ys(e)}catch(e){}t=!0}}})({condition:()=>!1,delay:500,maxAttempts:8});class HE extends p_{setup(){this._isCollapsible&&(this._playerConfig.playlist=ml.addMaxResolutionQueryParam(this._playerConfig.playlist),this._playlistFixExperiment&&this._createCollapsibleCollection(this._playerData),this.collapseCollection.closeButton=this._closeButton),this._isFirstPlay&&this._appendPlayer(),this.playerInstance=window.jwplayer(this._playlistId),this.collapseCollection&&(this.collapseCollection.playerInstance=this.playerInstance,this.collapseCollection.playerContainer=this._playerContainer,this.collapseCollection.playerElement=this._playerElement,this.collapseCollection.topBackgroundElement=this._topBackgroundElement),this._jwSetup(this._playerConfig),this._config.video.playlistPlayerAdded=!0}_appendPlayer(){const e=document.createElement("div");this._playerContainer.classList.add("adthrive-player-container"),this._playerContainer.classList.add("adthrive-collapse-player"),this._playerContainer.id="adthrive-collapse-container",this._playerElement.className="adthrive-player-position",this._playerElement.id="adthrive-collapse-position",e.id=this._playlistId;const t=this._getTitle();if(t){const e=document.createElement("h3");e.innerText=t,e.className="adthrive-player-title",e.id="adthrive-collapse-title",this._playerElement.appendChild(e)}this._config.video.removeVideoTitleWrapper?(this._playerElement.appendChild(this._createPlayerCloseButton()),this._playerElement.classList.add("adthrive-player-without-wrapper-text")):this._collapseType===ve.Mobile&&this._isTopCollapse?(this._playerElement.appendChild(this._createPlayerWrapper(!0)),this._playerElement.appendChild(this._createTopCollapseWrapper()),this._playerElement.classList.add("adthrive-player-with-wrapper-text")):(this._playerElement.appendChild(this._createPlayerWrapper(!0)),this._playerElement.classList.add("adthrive-player-without-wrapper-text")),this.collapseCollection.closeButton=this._closeButton,this._playerElement.appendChild(e),this.isTopCenterCollapse()&&this._createTopCenterBackground(this._playerContainer),this._playerContainer.appendChild(this._playerElement),this._clsPlayerContainer||this._pageElement.insertAdjacentElement(this._sharedVideoSettings.position,this._playerContainer)}_linkProvidedByPublisher(e){return!e.startsWith("https://cdn.jwplayer.com")}_playerReady(e){var t;super._playerReady(e),null==(t=this._playerElement.querySelector(".adthrive-wrapper-bar"))||t.style.setProperty("display","flex");if(this._getShuffle()||this._hasContentSpecificPlaylist&&this._shuffleContentSpecificPlaylist){const e=this.playerInstance.getPlaylist();this.playerInstance.load(ml.shufflePlaylist(e))}this._config.video.advancePlaylist.playlistPlayer.enabled&&(this.playerInstance.on("firstFrame",(()=>this._handleFirstFrame())),this.playerInstance.getContainer().addEventListener("click",(()=>this._handleVideoPlayerClicked())),this._initSkipContainer()),this._handleResize(),this._playlistFixExperiment&&this._handleScroll().catch((()=>!1)),e.viewable&&this._inViewPlayAd()}_getShuffle(){return!!this._shuffle&&this._shuffle}_getTitle(){return this._title?this._title:""}_checkVideoClose(){return this._saveVideoCloseState&&this._config.video.videoWasClosed}constructor(e,t,i,s,r,n,a,o,l,d=ve.Float,c,h,u,p,g,m,_,f,v,y,b){super(e,1,t,i,s,n,a,o,l,d,c,h,u,p,au.Playlist,!0,g,m,v,_),this._sharedVideoSettings=r,this._title=y,this._shuffle=b,this._topBackgroundElement=null,this._isCollapsible=!0,this._playerData=null,this._playerConfig={repeat:!0,playlist:`https://cdn.jwplayer.com/v2/playlists/${this._playlistId}`,related:{autoplaytimer:0}},this._shuffleContentSpecificPlaylist=!1,this._clsPlayerContainer=document.querySelector(`#cls-video-container-${this.playerContainerId} > div`)||document.querySelector(`#cls-video-container-${this.playerContainerId.split("_")[0]} > div`),this._playerContainer=this._clsPlayerContainer?this._clsPlayerContainer:document.createElement("div"),this._playerElement=document.createElement("div");const S=this._config.video.jwPlaylistObj;this._hasContentSpecificPlaylist=S.hasContentSpecificPlaylist,this._shuffleContentSpecificPlaylist=S.shuffle,S&&S.playlistId&&(this._playlistId=S.playlistId,this._playerConfig.playlist=`https://cdn.jwplayer.com/v2/playlists/${this._playlistId}`),this._playerConfig={...this._playerConfig,...this._autoplayBehaviorConfig},this.initialAuctionPlayer=!0,this._stickyElement=null,this._checkVideoClose()&&(this._state=Se.Closed),this._config.video.footerSelector?this._footerElement=document.querySelector(this._config.video.footerSelector):this._footerElement=null,this._playerData={playerElement:this._playerElement,playerContainer:this._playerContainer,footerElement:this._footerElement,stickyElement:this._stickyElement,mobileHeaderSelector:f||null},this._playlistFixExperiment=R.resolve(go).result,this._playlistFixExperiment||this._createCollapsibleCollection(this._playerData)}}HE=B([hs("PlaylistPlayer"),j("design:type",Function),j("design:paramtypes",[String,String,void 0===_e?Object:_e,Array,"undefined"==typeof SharedVideoSettings?Object:SharedVideoSettings,"undefined"==typeof HTMLElement?Object:HTMLElement,void 0===tu?Object:tu,void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===ve?Object:ve,void 0===ye?Object:ye,void 0===Ms?Object:Ms,void 0===Ss?Object:Ss,void 0===ag?Object:ag,Boolean,"undefined"==typeof VideoCollapseScrollUpTopCenterExperimentVariant?Object:VideoCollapseScrollUpTopCenterExperimentVariant,"undefined"==typeof CollapseMobileSubType?Object:CollapseMobileSubType,Object,Boolean,String,Boolean])],HE);class qE extends m_{async init(){zE()&&await $E(),this._setupSpaListeners(),this._handleCollapsibleVideoLogging(),this._initializePlayers(),this._mediaType.runOneStreamExperiment()}_setupSpaListeners(){this._spaEventBus.routeChanged.on((()=>{this._removeExistingSpaListeners(),this._removePlayers(),this._stickyRelatedOnPage=!1,this._relatedMediaIds=[],this.setPotentialPlayersMap()})),this._spaEventBus.resetCompleted.on((()=>{this._handleCollapsibleVideoLogging(),this._initializePlayers()}))}_removeExistingSpaListeners(){this._spaListeners.forEach((e=>e())),this._spaListeners.length=0}_removePlayers(){this._jwPlayers.forEach((e=>e.playerInstance.remove())),this._jwPlayers.length=0}_initializePlayers(){const e=document.querySelectorAll(this._IN_POST_SELECTOR);if(e.length&&this._initializeRelatedPlayers(e),this._shouldRunAutoplayPlayers()){this._determineAutoplayPlayers();try{this._importScripts(),this._initHtml5Players()}catch(e){te.error("VideoManagerComponent","initializePlayers",e)}}else try{this._importScripts()}catch(e){te.error("VideoManagerComponent","initializePlayers",e)}}_createStationaryRelatedPlayer(e,t,i){const s="mobile"===this._device?[400,225]:[640,360],r=_e.Video_In_Post_ClicktoPlay_SoundOn,n=this._config,a=this._prebidMethods,o=this._prebidEventBus,l=this._context;if(this._desktopRaptivePlayerEnabled||this._mobileRaptivePlayerEnabled){const d=new UE(e.id.toString(),e.playerId,i||1,e.mediaOrPlaylistId,au.EmbeddedStationary,t,s,n,l,this._eventProxy,!1,r,!1,a,this._auctionManagers,o,this._videoEventBus);this._html5Players.push(d)}else{const n=new g_(e.playerId,i||1,e.mediaOrPlaylistId,r,s,t,this._eventProxy,this._config,l,false,ve.Mobile,ye.Medium,o,a,this._auctionManagers,this._desktopCollapseOnScrollUp,this._mobileCollapseOnScrollUp);this._jwPlayers.push(n)}}_createStickyRelatedPlayer(e,t){const i="mobile"===this._device?[400,225]:[640,360],s=_e.Video_Individual_Autoplay_SOff,r=this._getCollapseType();this._collapsibleVideoLoggingStore.playerName=s,this._stickyRelatedOnPage=!0,this._config.video.mobileStickyPlayerOnPage="mobile"===this._device;const n=new g_(e.playerId,1,e.mediaId,s,i,t,this._eventProxy,this._config,this._context,!0,r,ye.Medium,this._prebidEventBus,this._prebidMethods,this._auctionManagers,this._desktopCollapseOnScrollUp,this._mobileCollapseOnScrollUp,e.mobileLocation,e.mobileHeaderSelector);this._jwPlayers.push(n)}_createPlaylistPlayer(e,t){const i=e.playerId,s=e.playlistId,r=this._getCollapseType(),n=r===ve.Mobile?[400,225]:[640,360],a=this._config,o=this._context,l="mobile"===this._device?_e.Video_Coll_SOff_Smartphone:_e.Video_Collapse_Autoplay_SoundOff,d=this._prebidMethods,c=this._prebidEventBus;if(this._desktopRaptivePlayerEnabled||this._mobileRaptivePlayerEnabled){const h=document.querySelector(`#cls-video-container-${s} > div`);t=h||t;const u={classNames:[],collapseMobileSizeType:ye.Medium,collapseType:r,desktopCollapseOnScrollUp:this._desktopCollapseOnScrollUp,elementSelector:e.elementSelector,enabled:!0,mobileCollapseOnScrollUp:this._mobileCollapseOnScrollUp,mobileHeaderSelector:e.mobileHeaderSelector,mobileLocation:e.mobileLocation,pageSelector:e.pageSelector,position:e.position,saveVideoCloseState:e.saveVideoCloseState,shuffle:e.shuffle,skip:e.skip,title:e.title};this._config.video.mobileStickyPlayerOnPage=!0;const p=new UE(e.id.toString(),i,1,s,au.AutoInjected,t,n,a,o,this._eventProxy,true,l,true,d,this._auctionManagers,c,this._videoEventBus,u,e.shuffle);this._collapsibleVideoLoggingStore.playerName=l,this._html5Players.push(p)}else{const a={classNames:[],enabled:!0,pageSelector:e.pageSelector,elementSelector:e.elementSelector,position:e.position,skip:e.skip},o=new HE(i,s,l,n,a,t,this._eventProxy,this._config,this._context,r,ye.Medium,c,d,this._auctionManagers,this._desktopCollapseOnScrollUp,this._mobileCollapseOnScrollUp,e.mobileLocation,e.mobileHeaderSelector,e.saveVideoCloseState,e.title,e.shuffle);this._collapsibleVideoLoggingStore.playerName=l,this._jwPlayers.push(o)}}_initJwBoost(){this._prebidMethods.setConfig({...this._jwBoostExperiment.result&&this._jwPlayers.length&&{realTimeData:{dataProviders:[{name:"jwplayer",params:{mediaIDs:this._relatedMediaIds}}]}}})}_setPlayerInstance(e){this._resetPlayer(e)}_resetPlayer(e){e.init()}async _initializePlayer(e,t){const i=this._videoRequestManager;e.setDefaults(window.jwplayer.defaults),window.jwplayer.defaults={},await this._bootstrapConfig.bootstrapLoaders[oe.Prebid].then((()=>{this._videoUrlBuilder.shouldPrebidRun=!0})).catch((()=>{})),t&&this._relatedMediaIds[0]&&this._irisTvTracker.enabled&&(await this._irisTvTracker.setContextualData(this._relatedMediaIds[0]),this._ortb2.updateOrtb2WithIris(this._irisTvTracker)),i.addVideoSlots([e]),e.setPlayerInstance=this._setPlayerInstance.bind(this),e.requestVideoBids=async e=>await i.requestVideoBids(e),e.waitForConsent=this.gdprConsentWait.bind(this),Vl.pushToQueue((()=>{e.buildVideoUrl=this._videoUrlBuilder.buildVideoUrl.bind(this._videoUrlBuilder),e.init()}))}async gdprConsentWait(){return new Promise((e=>{this._events.consentCaptured.on((t=>{t&&e(!0)}))}))}async _initHtml5Players(){const e=this._videoRequestManager;for(const t of this._html5Players){const i=t.isPlayerType===au.EmbeddedStationary;await this._bootstrapConfig.bootstrapLoaders[oe.Prebid].then((()=>{this._videoUrlBuilder.shouldPrebidRun=!0})).catch((()=>{})),i&&this._relatedMediaIds[0]&&await this._irisTvTracker.setContextualData(this._relatedMediaIds[0]),e.addVideoSlots([t]),t.requestVideoBids=async t=>await e.requestVideoBids(t),t.waitForConsent=this.gdprConsentWait.bind(this),Vl.pushToQueue((()=>{t.buildVideoUrl=this._videoUrlBuilder.buildVideoUrl.bind(this._videoUrlBuilder),t.init()}))}}_importScripts(){this._config.video.preventStickyOutstream=this._disableStickyOutstreamInPresenceOfCollapsiblePlayer(),this._jwPlayers.length&&(this._config.ccpa.userOptedOut||this._initJwBoost(),this._config.video.hasJwPlayer=!0,this._jwPlayers.forEach((e=>{const t=e.isPlayerType===au.Related;t&&this._config.video.setupAdvanceRelatedExperiment(e.collapsible);const i=this._config.video.jwpVersion?`?version_override=${this._config.video.jwpVersion}`:"";vi(`https://content.jwplatform.com/libraries/${e._playerId}.js${i}`).then((async()=>this._initializePlayer(e,t))).catch((e=>te.error("VideoManagerComponent","importScripts",e)))})))}_hasCollapsiblePlayer(e){return!!e.length&&e.some((e=>e.collapsible))}_disableStickyOutstreamInPresenceOfCollapsiblePlayer(){return!!this._hasCollapsiblePlayer([...this._jwPlayers,...this._html5Players])&&!this._config.video.stickyOutstreamSettings.allowForPageWithStickyPlayer.enabled}_isVideoAllowedOnPage(){return!this._config.disableAds.video||(this._config.disableAds.reasons.has("video_tag")?te.error("VideoManagerComponent","isVideoAllowedOnPage",new Error("DBP: Disabled by publisher via video tag")):this._config.disableAds.reasons.has("video_plugin")?te.error("VideoManagerComponent","isVideoAllowedOnPage",new Error("DBP: Disabled by publisher via video plugin")):this._config.disableAds.reasons.has("video_page")?te.error("VideoManagerComponent","isVideoAllowedOnPage",new Error("DBP: Disabled by publisher via command queue")):te.error("VideoManagerComponent","isVideoAllowedOnPage",new Error("DBP: Disabled by publisher via other")),!1)}_getCollapseType(){return"mobile"===this._device?ve.Mobile:ve.Float}_handleCollapsibleVideoLogging(){this._spaListeners.push(wm.collapseEvent.on((()=>{this._collapsibleVideoLoggingStore.startedCollapsedTime=ls()})),Pm.collapseEvent.on((()=>{this._collapsibleVideoLoggingStore.startedCollapsedTime=ls()}))),this._spaListeners.push(wm.uncollapseEvent.on((()=>{this._collapsibleVideoLoggingStore.totalTimeCollapsed+=this._collapsibleVideoLoggingStore.startedCollapsedTime?ls()-this._collapsibleVideoLoggingStore.startedCollapsedTime:0,this._collapsibleVideoLoggingStore.startedCollapsedTime=void 0})),Pm.uncollapseEvent.on((()=>{this._collapsibleVideoLoggingStore.totalTimeCollapsed+=this._collapsibleVideoLoggingStore.startedCollapsedTime?ls()-this._collapsibleVideoLoggingStore.startedCollapsedTime:0,this._collapsibleVideoLoggingStore.startedCollapsedTime=void 0}))),this._spaListeners.push(wm.closeEvent.on((()=>{this._collapsibleVideoLoggingStore.wasClosed=!0})),Pm.closeEvent.on((()=>{this._collapsibleVideoLoggingStore.wasClosed=!0}))),wm.startEvent.once((()=>{this._collapsibleVideoLoggingStore.wasStarted=!0})),Pm.startEvent.once((()=>{this._collapsibleVideoLoggingStore.wasStarted=!0})),this._spaListeners.push(this._userPageDataLoggingEvent.loggingData.on((()=>{this._collapsibleVideoLoggingStore.startedCollapsedTime&&(this._collapsibleVideoLoggingStore.totalTimeCollapsed+=ls()-this._collapsibleVideoLoggingStore.startedCollapsedTime)})))}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u,p,g,m,_,f,v,y,b,S,E){super(s.video,"VideoManagerComponent",r),this._auctionManagers=e,this._bootstrapConfig=t,this._collapsibleVideoLoggingStore=i,this._config=s,this._context=r,this._eventProxy=n,this._events=a,this._irisTvTracker=o,this._jwBoostExperiment=l,this._mediaType=d,this._ortb2=c,this._prebidEventBus=h,this._prebidMethods=u,this._spaEventBus=p,this._slotManagerEventBus=g,this._videoEventBus=m,this._raptiveDesktopPlayerExperiment=_,this._raptiveMobilePlayerExperiment=f,this._userPageDataLoggingEvent=v,this._videoCollapseScrollUpExperiment=y,this._videoCollapseScrollUpTopCenterExperiment=b,this._videoRequestManager=S,this._videoUrlBuilder=E,this._jwPlayers=[],this._html5Players=[],this._spaListeners=[],this._IN_POST_SELECTOR=".adthrive-video-player",this._desktopCollapseOnScrollUp=!1,this._mobileCollapseOnScrollUp="off",this._desktopRaptivePlayerEnabled=!1,this._mobileRaptivePlayerEnabled=!1,this._desktopCollapseOnScrollUp=this._videoCollapseScrollUpExperiment.result,this._mobileCollapseOnScrollUp=this._videoCollapseScrollUpTopCenterExperiment.result||"off";const C=R.resolve(bo).result;this._desktopRaptivePlayerEnabled=C||"mobile"!==this._device&&this._raptiveDesktopPlayerExperiment.result,this._mobileRaptivePlayerEnabled=C||"mobile"===this._device&&this._raptiveMobilePlayerExperiment.result}}qE=B([hs("VideoManagerComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===ag?Object:ag,void 0===tn?Object:tn,void 0===lg?Object:lg,void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===tu?Object:tu,void 0===th?Object:th,void 0===rd?Object:rd,void 0===Ja?Object:Ja,void 0===vu?Object:vu,void 0===Zc?Object:Zc,void 0===Ms?Object:Ms,void 0===Ss?Object:Ss,void 0===Ns?Object:Ns,void 0===Vs?Object:Vs,void 0===zs?Object:zs,void 0===_o?Object:_o,void 0===vo?Object:vo,void 0===ll?Object:ll,void 0===Do?Object:Do,void 0===Ro?Object:Ro,void 0===sd?Object:sd,void 0===VE?Object:VE])],qE);var GE,KE,WE,YE,QE,XE=-1,JE=function(e){addEventListener("pageshow",(function(t){t.persisted&&(XE=t.timeStamp,e(t))}),!0)},ZE=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},eC=function(){var e=ZE();return e&&e.activationStart||0},tC=function(e,t){var i=ZE(),s="navigate";return XE>=0?s="back-forward-cache":i&&(document.prerendering||eC()>0?s="prerender":document.wasDiscarded?s="restore":i.type&&(s=i.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:s}},iC=function(e,t,i){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var s=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return s.observe(Object.assign({type:e,buffered:!0},i||{})),s}}catch(e){}},sC=function(e,t,i,s){var r,n;return function(a){t.value>=0&&(a||s)&&((n=t.value-(r||0))||void 0===r)&&(r=t.value,t.delta=n,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,i),e(t))}},rC=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},nC=function(e){var t=function(t){"pagehide"!==t.type&&"hidden"!==document.visibilityState||e(t)};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)},aC=function(e){var t=!1;return function(i){t||(e(i),t=!0)}},oC=-1,lC=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},dC=function(e){"hidden"===document.visibilityState&&oC>-1&&(oC="visibilitychange"===e.type?e.timeStamp:0,hC())},cC=function(){addEventListener("visibilitychange",dC,!0),addEventListener("prerenderingchange",dC,!0)},hC=function(){removeEventListener("visibilitychange",dC,!0),removeEventListener("prerenderingchange",dC,!0)},uC=function(){return oC<0&&(oC=lC(),cC(),JE((function(){setTimeout((function(){oC=lC(),cC()}),0)}))),{get firstHiddenTime(){return oC}}},pC=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},gC=[1800,3e3],mC=function(e,t){t=t||{},pC((function(){var i,s=uC(),r=tC("FCP"),n=iC("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(n.disconnect(),e.startTime<s.firstHiddenTime&&(r.value=Math.max(e.startTime-eC(),0),r.entries.push(e),i(!0)))}))}));n&&(i=sC(e,r,gC,t.reportAllChanges),JE((function(s){r=tC("FCP"),i=sC(e,r,gC,t.reportAllChanges),rC((function(){r.value=performance.now()-s.timeStamp,i(!0)}))})))}))},_C=[.1,.25],fC={passive:!0,capture:!0},vC=new Date,yC=function(e,t){GE||(GE=t,KE=e,WE=new Date,EC(removeEventListener),bC())},bC=function(){if(KE>=0&&KE<WE-vC){var e={entryType:"first-input",name:GE.type,target:GE.target,cancelable:GE.cancelable,startTime:GE.timeStamp,processingStart:GE.timeStamp+KE};YE.forEach((function(t){t(e)})),YE=[]}},SC=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var i=function(){yC(e,t),r()},s=function(){r()},r=function(){removeEventListener("pointerup",i,fC),removeEventListener("pointercancel",s,fC)};addEventListener("pointerup",i,fC),addEventListener("pointercancel",s,fC)}(t,e):yC(t,e)}},EC=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,SC,fC)}))},CC=[100,300],TC=0,wC=1/0,AC=0,kC=function(e){e.forEach((function(e){e.interactionId&&(wC=Math.min(wC,e.interactionId),AC=Math.max(AC,e.interactionId),TC=AC?(AC-wC)/7+1:0)}))},IC=function(){return QE?TC:performance.interactionCount||0},PC=[200,500],OC=0,xC=function(){return IC()-OC},RC=[],DC={},LC=function(e){var t=RC[RC.length-1],i=DC[e.interactionId];if(i||RC.length<10||e.duration>t.latency){if(i)i.entries.push(e),i.latency=Math.max(i.latency,e.duration);else{var s={id:e.interactionId,latency:e.duration,entries:[e]};DC[s.id]=s,RC.push(s)}RC.sort((function(e,t){return t.latency-e.latency})),RC.splice(10).forEach((function(e){delete DC[e.id]}))}},MC=function(e,t){t=t||{},pC((function(){"interactionCount"in performance||QE||(QE=iC("event",kC,{type:"event",buffered:!0,durationThreshold:0}));var i,s=tC("INP"),r=function(e){e.forEach((function(e){e.interactionId&&LC(e),"first-input"===e.entryType&&!RC.some((function(t){return t.entries.some((function(t){return e.duration===t.duration&&e.startTime===t.startTime}))}))&&LC(e)}));var t,r=(t=Math.min(RC.length-1,Math.floor(xC()/50)),RC[t]);r&&r.latency!==s.value&&(s.value=r.latency,s.entries=r.entries,i())},n=iC("event",r,{durationThreshold:t.durationThreshold||40});i=sC(e,s,PC,t.reportAllChanges),n&&(n.observe({type:"first-input",buffered:!0}),nC((function(){r(n.takeRecords()),s.value<0&&xC()>0&&(s.value=0,s.entries=[]),i(!0)})),JE((function(){RC=[],OC=IC(),s=tC("INP"),i=sC(e,s,PC,t.reportAllChanges)})))}))},BC=[2500,4e3],FC={},jC=[800,1800],NC=function e(t){document.prerendering?pC((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},UC=function(e,t){t=t||{};var i=tC("TTFB"),s=sC(e,i,jC,t.reportAllChanges);NC((function(){var r=ZE();if(r){var n=r.responseStart;if(n<=0||n>performance.now())return;i.value=Math.max(n-eC(),0),i.entries=[r],s(!0),JE((function(){i=tC("TTFB",0),(s=sC(e,i,jC,t.reportAllChanges))(!0)}))}}))};class VC extends Cs{init(){this._visibilityChangeOff=this._pageManager.visibilityChange.on((()=>this.logWebVitals())),Ct().then((()=>{const e=this.addWebVital.bind(this);!function(e,t){t=t||{},pC((function(){var i,s=uC(),r=tC("FID"),n=function(e){e.startTime<s.firstHiddenTime&&(r.value=e.processingStart-e.startTime,r.entries.push(e),i(!0))},a=function(e){e.forEach(n)},o=iC("first-input",a);i=sC(e,r,CC,t.reportAllChanges),o&&nC(aC((function(){a(o.takeRecords()),o.disconnect()}))),o&&JE((function(){var s;r=tC("FID"),i=sC(e,r,CC,t.reportAllChanges),YE=[],KE=-1,GE=null,EC(addEventListener),s=n,YE.push(s),bC()}))}))}(e),function(e,t){t=t||{},mC(aC((function(){var i,s=tC("CLS",0),r=0,n=[],a=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=n[0],i=n[n.length-1];r&&e.startTime-i.startTime<1e3&&e.startTime-t.startTime<5e3?(r+=e.value,n.push(e)):(r=e.value,n=[e])}})),r>s.value&&(s.value=r,s.entries=n,i())},o=iC("layout-shift",a);o&&(i=sC(e,s,_C,t.reportAllChanges),nC((function(){a(o.takeRecords()),i(!0)})),JE((function(){r=0,s=tC("CLS",0),i=sC(e,s,_C,t.reportAllChanges),rC((function(){return i()}))})),setTimeout(i,0))})))}(e),function(e,t){t=t||{},pC((function(){var i,s=uC(),r=tC("LCP"),n=function(e){var t=e[e.length-1];t&&t.startTime<s.firstHiddenTime&&(r.value=Math.max(t.startTime-eC(),0),r.entries=[t],i())},a=iC("largest-contentful-paint",n);if(a){i=sC(e,r,BC,t.reportAllChanges);var o=aC((function(){FC[r.id]||(n(a.takeRecords()),a.disconnect(),FC[r.id]=!0,i(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,o,!0)})),nC(o),JE((function(s){r=tC("LCP"),i=sC(e,r,BC,t.reportAllChanges),rC((function(){r.value=performance.now()-s.timeStamp,FC[r.id]=!0,i(!0)}))}))}}))}(e),mC(e),MC(e),UC(e)})).catch((()=>!1)),setTimeout((()=>{this.logWebVitals()}),this._maxTimeOnPage)}addWebVital({name:e,delta:t,value:i,id:s}){this._webVitals.push({name:e,delta:t,value:i,id:s})}_getFlagTargeting(){try{return this._googleAdManager.getTargetingValuesForKey("flag")}catch(e){return[]}}logWebVitals(){if(this._webVitalsSent)return;const e=this._getFlagTargeting(),t={webVitals:this._webVitals,DOMSize:document.querySelectorAll("*").length,gptLoad:!0,gptv:googletag&&googletag.getVersion&&googletag.getVersion(),flagTargeting:e};this._webVitalsSent=!0,null==this._visibilityChangeOff||this._visibilityChangeOff.call(this),this._bootstrapConfig.gptLibFailedToLoad&&(t.gptLoad=!1),te.fetchEvent("WebVitalsComponent","logWebVital",t)}get enabled(){return this._bootstrapConfig.webVitalsEnabled}constructor(e,t,i){super(),this._bootstrapConfig=e,this._pageManager=t,this._googleAdManager=i,this._maxTimeOnPage=36e5,this._webVitals=[],this._webVitalsSent=!1}}VC=B([hs("WebVitalsComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===tn?Object:tn,void 0===wr?Object:wr,void 0===Vl?Object:Vl])],VC);class zC extends J{constructor(...e){super(...e),this.stickyContainerContentAdStylingApplied=new X}}zC=B([M()],zC);class $C extends nr{init(){this._key="ParallaxAdLogError",this._default=!1}}$C=B([hs("ParallaxAdLogErrorExperiment"),M()],$C);class HC extends Cs{get enabled(){return this.parallaxAdsExperiment.result}start(){this._setupListeners()}_setupListeners(){this._stickyContainerAdsEventBus.stickyContainerContentAdStylingApplied.on((()=>{this._stickyContainerAdsApplied=!0}),{handleEventsAlreadyEmitted:!0}),this._videoEventBus.topCenterVideoCollapsed.on((()=>{this._scrollStartPosition=500})),this._videoEventBus.topCenterVideoUnCollapsed.on((()=>{this._scrollStartPosition=300})),this._gamEventBus.slotOnload.on((({slot:e})=>this._parallaxSetup(e))),this._slotEventBus.adRenderedOutsideGAM.on((({slot:e})=>this._parallaxSetup(e))),this._slotManagerEventBus.refreshing.on((e=>{e.forEach((e=>{const t=e.element.id;e.location!==ge.Content||this._slotRebuildComplete.get(t)||this._parallaxSlotMap.get(t)||this._stickyContainerAdsApplied||this._rebuildSlot(e)}))}))}_parallaxSetup(e){if(e.location===ge.Content){const t=e.element;this._stickyContainerAdsApplied&&this._removeParallaxCSS(t),this._removeParallaxScrollEvent(t);if(this._isParallaxAd(t)){te.event("ParallaxComponent","_setupListeners","parallax_rendered",e.element.id,e.refreshCount);const i=t.firstChild?t.firstChild:null;this._parallaxSlotMap.set(t.id,!0),this._setParallaxSlotCSS(t,i),this._parallaxAdOnScroll(t),this._parallaxAdLogErrorExperiment.result&&this._checkParallaxAdVisibilityPercent(t,i)}}}_setParallaxSlotCSS(e,t){e.classList.add("adthrive-parallax-slot"),t&&t.classList.add("adthrive-parallax-ad")}_removeParallaxCSS(e){e.classList.remove("adthrive-parallax-slot");const t=e.firstChild;t&&t.classList.remove("adthrive-parallax-ad")}_removeParallaxScrollEvent(e){const t=this._parallaxScrollEventOffMap.get(e.id);t&&t()}_parallaxAdOnScroll(e){const t=Number(e.getBoundingClientRect().top)+window.pageYOffset,i=()=>{const i=e.firstChild?e.firstChild:void 0,s=this._isParallaxAd(e),r=t<window.pageYOffset+window.innerHeight,n=this._getScrollStartPosition(r,e),a=.5*(window.pageYOffset-t+n),o=a>205?205:a;i&&s&&(i.style.transform=`translateY(-${o}px)`)};this._parallaxScrollEventOffMap.set(e.id,this._pageManager.scroll.on((()=>i())))}_getScrollStartPosition(e,t){return e?this._slotScrollStartPosition.get(t.id)||this._scrollStartPosition:(this._slotScrollStartPosition.get(t.id)!==this._scrollStartPosition&&this._slotScrollStartPosition.set(t.id,this._scrollStartPosition),this._scrollStartPosition)}_isParallaxAd(e){const t=fg(e);return t>=600&&t<=750}_rebuildSlot(e){e.sizes=e.sizes.filter((e=>e[1]<600)),this._slotManager.rebuild(e),this._slotRebuildComplete.set(e.element.id,!0)}_checkParallaxAdVisibilityPercent(e,t){const i=new IntersectionObserver((s=>{s.forEach((s=>{const r=100*s.intersectionRatio,n=400/fg(e)*100;n-r>2&&this._logParallaxAdError(e,t,"adVisibility",Math.floor(n-r)),i.unobserve(s.target)}))}),{root:e});t&&i.observe(t)}_logParallaxAdError(e,t,i,s){te.error("ParallaxComponent","_logParallaxAdError",`parallax ad error: ${i}, visibility percent lost:`,s,`siteId: ${this._config.site.id}`,`pageUrl: ${window.location.href}`,`containerId: ${e.id}`,`creativeId: ${null==t?void 0:t.id}`)}constructor(e,t,i,s,r,n,a,o,l,d){super(),this.parallaxAdsExperiment=e,this._pageManager=t,this._slotManager=i,this._stickyContainerAdsEventBus=s,this._videoEventBus=r,this._config=n,this._parallaxAdLogErrorExperiment=a,this._gamEventBus=o,this._slotEventBus=l,this._slotManagerEventBus=d,this._parallaxSlotMap=new Map,this._parallaxScrollEventOffMap=new Map,this._slotRebuildComplete=new Map,this._stickyContainerAdsApplied=!1,this._scrollStartPosition=300,this._slotScrollStartPosition=new Map}}HC=B([L(),hs("ParallaxAdsComponent"),j("design:type",Function),j("design:paramtypes",[void 0===$a?Object:$a,void 0===wr?Object:wr,void 0===id?Object:id,void 0===zC?Object:zC,void 0===zs?Object:zs,void 0===Ol?Object:Ol,void 0===$C?Object:$C,void 0===jl?Object:jl,void 0===Es?Object:Es,void 0===Vs?Object:Vs])],HC);class qC extends nr{init(){this._key="Uid2TokenCleanup",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],qC.prototype,"run",null),qC=B([hs("Uid2TokenCleanupExperiment"),M()],qC);class GC extends Cs{init(){this._config.uid2TokenCleanup.active=!0;try{this._uid2TokenKeys.forEach((e=>{kr.readExternalLocalStorage(e)&&this._cleanUpToken(e)}))}catch(e){}}_cleanUpToken(e){kr.deleteLocalStorage(e)}get enabled(){return this._validExistingToken&&this._uid2TokenCleanupExperiment.result}constructor(e,t){if(super(),this._config=e,this._uid2TokenCleanupExperiment=t,this._validExistingToken=!1,this._uid2TokenKeys=["__uid2_advertising_token","__uid2_server_token"],this._config.user.hash&&this._config.user.source){const e=this._config.user.source.includes(pi.VALUES.TD)&&this._config.user.source.endsWith(pi.SUFFIXES.STORAGE),t=/^(?:l_i-l_i|l_i)$/,s=this._config.user.source.match(t),r=null!==s&&s.length>0;var i;this._validExistingToken=null!=(i=e||r)&&i}}}GC=B([hs("Uid2TokenCleanupComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===qC?Object:qC])],GC);class KC extends nr{init(){this._key="HemStorageCleanup",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],KC.prototype,"run",null),KC=B([hs("HemStorageCleanupExperiment"),M()],KC);class WC extends Cs{init(){const e=K.getLocalStorageValue(ui.KEY,!1);this._isStoredHemValid(e)||this._cleanUpStoredValue(e)}get enabled(){return this.experiment.result}_isStoredHemValid(e){var t;const i="object"==typeof e&&"object"==typeof(null==e?void 0:e.sha256Hash);var s;const r="string"==typeof e&&null!=(s=null==(t=e.match(/sha256Hash/g))?void 0:t.length)&&s;return!i&&!r}_cleanUpStoredValue(e){const t=JSON.stringify(e);let i="",s="";const r=/sha256Hash":"(\w+)"/.exec(t),n=/sha1Hash":"(\w+)"/.exec(t);r&&2===r.length&&(i=r[1]),n&&2===n.length&&(s=n[1]);const a={sha256Hash:i,sha1Hash:s};K.setLocalStorageValue(ui.KEY,a,!1)}constructor(e){super(),this.experiment=e}}WC=B([hs("HemStorageCleanupComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===KC?Object:KC])],WC);class YC extends Cs{get enabled(){const e=Rt().get("rptbt24"),t=this._context.invalidTraffic&&"true"!==e;return this._siteHasCloudflareWorker&&!t}async start(){const e=kr.readExternalCookie("_rcid");(!e&&this._isFirstPageview||e&&await this._shouldRefreshCookie(e))&&await this._requestRcid(),await this._logCookie()}async _shouldRefreshCookie(e){let t=e;if("string"==typeof t){t=await na(t,this._config.site.id);const e=new Date(t.metadata.capturedOn).getTime(),i=(new Date).getTime();return Math.floor((i-e)/864e5)>340}return!0}async _logCookie(){let e=kr.readExternalCookie("_rcid");if(!e)return;"string"==typeof e&&(e=await na(e,this._config.site.id)),te.event("RaptiveConnectedIdComponent","_logCookie","Raptive Connected ID",e);const t=await this._optableSdkWrapper.cid(e.value.sharedId,3);this._optableSdkWrapper.identify(t);const i=Ui(e.metadata.clientIp);i&&this._optableSdkWrapper.identify(i)}async _requestRcid(){te.event("RaptiveConnectedIdComponent","_requestRcid","Requesting Raptive Connected ID");try{const e=await fetch(this._cloudflareWorkerUrl,{credentials:"include"});e.ok||(404===e.status?te.error("RaptiveConnectedIdComponent","_requestRcid",`Handler not found at ${this._cloudflareWorkerUrl}`):te.error("RaptiveConnectedIdComponent","_requestRcid","Error fetching Raptive Connected ID"))}catch(e){te.error("RaptiveConnectedIdComponent","_requestRcid","Error fetching Raptive Connected ID",e)}}constructor(e,t,i){super(),this._config=e,this._context=t,this._optableSdkWrapper=i,this._cloudflareWorkerUrl="",this._isFirstPageview=!1,this._siteHasCloudflareWorker=!1;const s=this._config.site.id,r=window.location.origin;this._cloudflareWorkerUrl=r.replace("https://",`https://${s}.`).replace("www.",""),this._isFirstPageview=this._context.isFirstPageview,this._siteHasCloudflareWorker=null!==this._config.site.deployedCloudflareVersion}}YC=B([hs("RaptiveConnectedIdComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Wn?Object:Wn])],YC);class QC{constructor(){this.contentAdded=new Q}}QC=B([hs("InfiniteScrollEvents"),M()],QC);class XC extends Cs{start(){this.detectInfiniteScroll()}detectInfiniteScroll(){this.checkForCustomConfig();const e=new MutationObserver(((e,t)=>{e.filter((({type:e,addedNodes:t})=>"childList"===e&&t.length>0)).reduce(((e,{addedNodes:t})=>[...e,...Array.prototype.slice.call(t)]),[]).filter((e=>e instanceof HTMLElement&&e.clientHeight>this._heightThreshold)).forEach((e=>{e.parentElement&&(t.disconnect(),t.observe(e.parentElement,{childList:!0}),this._infiniteScrollElement&&t.observe(this._infiniteScrollElement,{childList:!0,subtree:!0}));try{this._events.contentAdded.emit(e)}catch(e){te.error("InfiniteScrollDetectionComponent","addMutationObserver","added",e)}}))}));this._infiniteScrollElement?e.observe(this._infiniteScrollElement,{childList:!0,subtree:!0}):Array.prototype.slice.call(document.querySelectorAll("body *")).filter((e=>e instanceof HTMLElement&&e.offsetHeight>this._heightThreshold)).forEach((t=>{e.observe(t,{childList:!0})}))}checkForCustomConfig(){const{heightThreshold:e,selector:t}=this._config.adOptions.infiniteScrollOptions,i=t?document.querySelector(t):null;if(i)this._infiniteScrollElement=i;else{const e=document.querySelector(this._ajaxSelector);e&&(this._config.infiniteScroll.ajaxType=!0,this._infiniteScrollElement=e)}e&&e>0&&(this._heightThreshold=e)}get enabled(){return this._config.adOptions.infiniteScroll&&"MutationObserver"in window}constructor(e,t){super(),this._config=e,this._events=t,this._ajaxSelector="#ajax-load-more",this._heightThreshold=1e3,this._infiniteScrollElement=null}}XC=B([hs("InfiniteScrollDetectionComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===QC?Object:QC])],XC);class JC extends Fg{getDynamicElementId(){return`${this._config.gam.prefix}_Infinite_${this._count++}`}constructor(e,t,i){super(t,i),this._config=e,this._adInjectionMap=t,this._context=i,this._count=1}}JC=B([hs("InfiniteScrollDynamicAdsInjector"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===mg?Object:mg,void 0===Pr?Object:Pr])],JC);class ZC extends Cs{init(){this._events.contentAdded.on((e=>{this._page++,this._context.pageviewKey=fs(),this._gam.setTargeting({key:"pvk",value:this._context.pageviewKey}),this.slotsAlreadyInjectedInElement(e)||this.addSlots(e)}))}slotsAlreadyInjectedInElement(e){return!!e.querySelector("[id*='AdThrive_Content']")}addSlots(e){const t=this._config.dynamicAds.filter((e=>!(this._config.infiniteScroll.ajaxType&&e.location===ge.Sidebar))).filter((e=>wt(this._config,e))).filter((e=>Tt(e,this._context.device))).filter((e=>At(e))),i=this._injector.inject(t,e);this._slotManager.add(i).then((e=>{e.forEach((e=>{Vl.pushToQueue((()=>{e.setTargeting({key:"inf_scroll",value:this._page.toString()})}))}))})).catch((e=>{te.error("InfiniteScrollDynamicAdsComponent","addSlots",e)}))}get enabled(){return this._config.adOptions.infiniteScroll}constructor(e,t,i,s,r,n){super(),this._config=e,this._context=t,this._events=i,this._injector=s,this._slotManager=r,this._gam=n,this._page=1}}ZC=B([hs("InfiniteScrollDynamicAdsComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===QC?Object:QC,void 0===JC?Object:JC,void 0===id?Object:id,void 0===Vl?Object:Vl])],ZC);class eT extends Cs{start(){this._observer=this.getIntersectionObserver(),this._events.contentAdded.on((e=>{this._observer&&this._observer.observe(e)}))}getIntersectionObserver(){return new IntersectionObserver((e=>{for(const t of e)t.intersectionRatio>0&&t.isIntersecting&&this._debounce.limit(t.target.id).then((()=>this.refresh())).catch((e=>{te.error("InfiniteScrollRefreshComponent","getIntersectionObserver","refresh",e)}))}),{threshold:[.08]})}refresh(){if(this._config.adOptions.infiniteScrollRefresh){this._slots.get().filter((e=>this._config.infiniteScroll.refreshSlots.has(e.location)&&e.isSticky&&!e.isRefreshing)).forEach((e=>{this._slotManager.updateRefreshTimeout(e,1001)}))}}get enabled(){return this._config.adOptions.infiniteScroll&&"IntersectionObserver"in window}constructor(e,t,i,s){super(),this._config=e,this._events=t,this._slotManager=i,this._slots=s,this._debounce=new ie(1e3)}}eT=B([hs("InfiniteScrollRefreshComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===QC?Object:QC,void 0===id?Object:id,void 0===zr?Object:zr])],eT);class tT extends Cs{init(){this.gamEventBus.slotResponseReceived.on((({slot:e})=>{this.slotResponseReceived(e)}))}slotResponseReceived(e){e.alwaysInView=e.location===ge.Footer||e.location===ge.Video_StickyOutstream}constructor(e){super(),this.gamEventBus=e}}tT=B([hs("AlwaysInViewComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===jl?Object:jl])],tT);class iT extends Cs{constructor(e){super(),this._slotManager=e;window.addEventListener("message",(e=>{e&&e.data&&"set_adthrive_slot_timeout"===e.data.message&&e.data.slot_id&&e.data.refresh_interval>=0&&this._slotManager.updateRefreshTimeout(e.data.slot_id,e.data.refresh_interval)}),!1)}}iT=B([hs("ChangeSlotRefreshComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===id?Object:id])],iT);class sT extends Cs{init(){this._pageManager.visibilityChange.on((()=>this.documentVisibilityChanged()))}documentVisibilityChanged(){const e=document.visibilityState,t=this._slots.get();"visible"===e?this._slotManager.resumeRefresh(t):"hidden"===e&&this._slotManager.pauseRefresh(t)}constructor(e,t,i){super(),this._slotManager=e,this._slots=t,this._pageManager=i}}sT=B([hs("DocumentHiddenPauseRefreshComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===id?Object:id,void 0===zr?Object:zr,void 0===wr?Object:wr])],sT);class rT extends Cs{init(){this._googleAgManagerEventBus.impressionViewable.on((({slot:e})=>{this.processImpressionViewable(e)})),this._googleAgManagerEventBus.slotVisibilityChanged.on((({slot:e,event:t})=>{this.processVisibilityChanged(e,t)}))}processImpressionViewable(e){e.outOfViewGPT=!1,this._slotManager.inView(e)}processVisibilityChanged(e,t){this.check(e,t.inViewPercentage)}check(e,t){t&&t>=this._inViewPercentage||e.location===ge.Video_StickyOutstream?(e.outOfViewGPT=!1,this._slotManager.inView(e)):(e.outOfViewGPT=!0,this._slotManager.outOfView(e))}constructor(e,t,i){super(),this._slotManager=e,this._googleAgManagerEventBus=t,this._slotEventBus=i,this._inViewPercentage=50}}rT=B([hs("ImpressionViewableRefreshComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===id?Object:id,void 0===jl?Object:jl,void 0===Es?Object:Es])],rT);class nT extends Cs{init(){const e=this._config.prebid.auctionThreshold;this._refreshObserver=this._getRefreshIntersectionObserver(),e&&(this._auctionObserver=this.getAuctionIntersectionObserver(e)),this._slotEventBus.googleAdManagerFallbackDivAdded.on((e=>{this.slotResponseReceived(e)})),this._gamEventBus.slotResponseReceived.on((({slot:e})=>{this.slotResponseReceived(e),this._trackSlotEvents.set(e.id,"slotResponseReceived")})),this._gamEventBus.slotRenderEnded.on((({slot:e})=>{this.slotResponseReceived(e),this._trackSlotEvents.delete(e.id)})),this._gamEventBus.slotRequested.on((({slot:e})=>{this._trackSlotEvents.set(e.id,"slotRequested")})),this._slotManagerEventBus.refreshing.on((e=>{for(const t of e)this._trackSlotEvents.get(t.id)&&(this._slotManager.rebuild(t),this._trackSlotEvents.delete(t.id));this.refreshing(e)}))}get enabled(){return"IntersectionObserver"in window}slotResponseReceived(e){e.auctionPromise=null;const t=!e.lazy||e.refreshCount;if(this._refreshObserver&&e.element&&this._refreshObserver.observe(e.element),this._auctionObserver&&t&&e.location!==ge.Video_StickyOutstream){const t=this._config,i=3e4,s=5e3,r=t.prebid.multiStageLimit,n=i-(r&&e.refreshCount>=r?1:this._config.prebid.refreshAuctionCount)*t.timeouts.refreshBidsRequest-s;setTimeout((()=>{e.alwaysInView?this._slotManager.triggerAuction(e):this._auctionObserver&&e.element&&this._auctionObserver.observe(e.element)}),n)}}refreshing(e){if(this._refreshObserver||this._auctionObserver)for(const i of e){var t;if(i.element)null==(t=this._refreshObserver)||t.unobserve(i.element);Array.from(i.element.children).forEach((e=>{var t;e.classList.contains("google-ad-manager-fallback-container")&&(null==(t=this._refreshObserver)||t.unobserve(e))}))}}_getRefreshIntersectionObserver(){return new IntersectionObserver((e=>{for(const t of e){const e=t.target.id.length?this._slots.get(t.target.id):null;if(e)this._check(e,100*t.intersectionRatio);else{const e=t.target.parentElement&&t.target.parentElement.classList.contains("adthrive-ad")&&this._slots.get(t.target.parentElement.id);e&&this._check(e,100*t.intersectionRatio)}}}),{threshold:[0,this._inViewPercentage/100]})}getAuctionIntersectionObserver(e){const t=window.innerHeight*e;return new IntersectionObserver((e=>{for(const t of e)this.processEntry(t)}),{rootMargin:`${t}px 0px`,threshold:[0]})}processEntry(e){var t;const i=this._slots.get(e.target.id);i&&(this._slotManager.triggerAuction(i),null==(t=this._auctionObserver)||t.unobserve(i.element))}_isInViewportManualCheck(e){const t=e.getBoundingClientRect();return t.top>=0&&t.top<=window.innerHeight}_check(e,t){t>=this._inViewPercentage||e.location===ge.Video_StickyOutstream?(e.outOfViewIO=!1,this._slotManager.inView(e)):(e.outOfViewIO=!0,this._slotManager.outOfView(e))}constructor(e,t,i,s,r,n){super(),this._config=e,this._slotManager=t,this._slots=i,this._gamEventBus=s,this._slotEventBus=r,this._slotManagerEventBus=n,this._inViewPercentage=50,this._trackSlotEvents=new Map}}nT=B([hs("IntersectionObserverRefreshComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===id?Object:id,void 0===zr?Object:zr,void 0===jl?Object:jl,void 0===Es?Object:Es,void 0===Vs?Object:Vs])],nT);class aT extends Cs{init(){this._eventBus.footerRefreshed.on(this.pollForFooterAdHeight.bind(this))}get enabled(){return this._stickyOutstreamFooterCollisionExperiment.result&&"phone"===this._context.device&&this._config.video.stickyOutstreamSettings.mobile.enabled&&"top-center"!==this._config.video.stickyOutstreamSettings.mobileLocation}pollForFooterAdHeight(){let e=0;const t=setInterval((()=>{this.checkForFooterAdHeightChange(),e++,e>=this._maxRetries&&clearInterval(t)}),500)}checkForFooterAdHeightChange(){const e=this.getFooterAdHeight();e!==this._lastAdHeight&&(this._eventBus.footerHeightChanged.emit(e),this._lastAdHeight=e)}isElementAtBottomOfPage(e){const t=e.getBoundingClientRect();if(t.width&&t.height){const e=t.bottom||(t.top||t.y)+t.height;if(Math.abs(window.innerHeight-e)<100)return!0}return!1}getFooterAdHeight(){let e=52;return this._config.footer.footerSelectorsForHeightCheck.forEach((t=>{const i=document.querySelector(t.trim());if(i&&Ri(i)&&this.isElementAtBottomOfPage(i)){const t=i.getBoundingClientRect().height;t>e&&(e=t)}})),e}constructor(e,t,i,s){super(),this._config=e,this._context=t,this._eventBus=i,this._stickyOutstreamFooterCollisionExperiment=s,this._lastAdHeight=52,this._maxRetries=12}}aT=B([hs("FooterAdRefreshComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===Ds?Object:Ds,void 0===Ao?Object:Ao])],aT);class oT extends nr{init(){this._key="SlotResize",this._default=!1}}oT=B([M()],oT);class lT extends Cs{get enabled(){return this.slotResizeExperiment.result}start(){this._setupListeners()}_setupListeners(){this._gamSlotOnLoad.on((({slot:e})=>{"Content"===e.location&&this._compareSlot(e)}))}_compareSlot(e){const t=this._slotSizeMap.get(e.id),i=getComputedStyle(e.element).height,s=Number(i.slice(0,-2));(!t||t<s)&&(this._resize(e.element,i),this._setSlotSizeMap(e.element.id,s)),this._stickyContentEnabled||this._align(e.element)}_resize(e,t){e.style.minHeight=t}_setSlotSizeMap(e,t){this._slotSizeMap.set(e,t)}_align(e){const{top:t,bottom:i}=e.getBoundingClientRect(),s=t,r=window.innerHeight-i;e.style.alignContent=s<r?"end":"start"}constructor(e,t,i){super(),this.slotResizeExperiment=t,this._slotSizeMap=new Map,this._gamSlotOnLoad=i.slotOnload,this._stickyContentEnabled=e.adOptions.stickyContentEnabled||!1}}lT=B([L(),hs("SlotResizeComponent"),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===oT?Object:oT,void 0===jl?Object:jl])],lT);const dT=e=>e.some((e=>null!==document.querySelector(e)));class cT{logOverflow(e){const t=document.querySelector(e);t&&ft(t)}getStickyAdTopProperty(e){const{playerContainer:t,topBackgroundElement:i,collapseMobileSubType:s,mobileHeaderSelector:r}=e;if("adthrive-collapse-bottom-left"===s||"adthrive-collapse-bottom-right"===s)return this.stickyHeaderHeight;{const e=Number(i?i.getBoundingClientRect().height:t.getBoundingClientRect().height),s=Vg([r||""]);return s?Number(s)+e:e}}constructor(e){this.stickyBlockedSelectors=[],this.stickyHeaderHeight=Vg(e.adOptions.stickyHeaderSelectors),this.stickyBlockedSelectors=e.adOptions.stickyBlockedSelectors||[]}}cT=B([hs("StickyContainerAdsUtil"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol])],cT);class hT extends nr{init(){this._key="StickyContainerAdsTopCenterVideoDependency",this._default=!1}isEnabled(){return super.isEnabled()&&Wt()}}hT=B([L(),hs("StickyContainerAdsTopCenterVideoDependencyExperiment")],hT);class uT extends Cs{get enabled(){return this._stickyContentEnabled&&this._stickyContainerAdsExperimentResult&&!dT(this._stickyContainerAdsUtil.stickyBlockedSelectors)}start(){this.setCSS(),this._stickyContainerAdsUtil.logOverflow(".adthrive-sticky-container"),this._stickyContainerAdEventBus.stickyContainerContentAdStylingApplied.emit()}setCSS(){Cg(`\n  .adthrive-device-phone .adthrive-sticky-content {\n    height: 450px !important;\n    margin-bottom: 100px !important;\n  }\n  .adthrive-content.adthrive-sticky {\n    position: -webkit-sticky;\n    position: sticky !important;\n    top: 42px !important;\n    margin-top: 42px !important;\n  }\n  .adthrive-content.adthrive-sticky:after {\n    content: " Advertisement. Scroll down to continue. ";\n    font-size: 10pt;\n    margin-top: 5px;\n    margin-bottom: 5px;\n    display:block;\n    color: #888;\n  }\n  .adthrive-sticky-container {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: center;\n    min-height:${this._stickyContentHeight||400}px !important;\n    margin: 10px 0 10px 0;\n    background-color: #FAFAFA;\n    padding-bottom:0px;\n  }\n  `),Ng(this._stickyContainerAdsUtil.stickyHeaderHeight),this._stickyContainerTopCenterVideoDependencyExperimentResult&&this.addListeners()}addListeners(){this._videoEventBus.topCenterVideoCollapsed.on((e=>{this._stickyAdTopProperty||(this._stickyAdTopProperty=this._stickyContainerAdsUtil.getStickyAdTopProperty(e)),Ng(this._stickyAdTopProperty)})),this._videoEventBus.topCenterVideoUnCollapsed.on((()=>{Ng(this._stickyContainerAdsUtil.stickyHeaderHeight)}))}constructor(e,t,i,s,r){super(),this._videoEventBus=t,this._stickyContainerAdEventBus=i,this._stickyContainerAdsExperiment=s,this._stickyContainerTopCenterVideoDependencyExperiment=r,this._stickyContainerAdsExperimentResult=!1,this._stickyContainerTopCenterVideoDependencyExperimentResult=!1,this._stickyContentEnabled=!1,this._stickyContainerAdsUtil=new cT(e),this._stickyContentHeight=e.adOptions.stickyContentHeight,this._stickyContainerAdsExperimentResult=this._stickyContainerAdsExperiment.result,this._stickyContainerTopCenterVideoDependencyExperimentResult=this._stickyContainerTopCenterVideoDependencyExperiment.result,this._stickyContentEnabled=e.adOptions.stickyContentEnabled||!1}}uT=B([hs("StickyContainerContentAdsComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===zs?Object:zs,void 0===zC?Object:zC,void 0===Pg?Object:Pg,void 0===hT?Object:hT])],uT);class pT extends Cs{get enabled(){return this._stickyContainerRecipeExperimentResult&&!dT(this._stickyContainerAdsUtil.stickyBlockedSelectors)}start(){this.setCSS(),this._stickyContainerAdsUtil.logOverflow(".adthrive-recipe-sticky-container")}setCSS(){Cg(`\n  .adthrive-recipe.adthrive-sticky {\n    position: -webkit-sticky;\n    position: sticky !important;\n    top: 42px !important;\n    margin-top: 42px !important;\n  }\n  .adthrive-recipe-sticky-container {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: center;\n    min-height:${this._stickyRecipeHeight||400}px !important;\n    margin: 10px 0 10px 0;\n    background-color: #FAFAFA;\n    padding-bottom:0px;\n  }\n  `),Ug(this._stickyContainerAdsUtil.stickyHeaderHeight),this._stickyContainerTopCenterVideoDependencyExperimentResult&&this.addListeners()}addListeners(){this._videoEventBus.topCenterVideoCollapsed.on((e=>{this._stickyAdTopProperty||(this._stickyAdTopProperty=this._stickyContainerAdsUtil.getStickyAdTopProperty(e)),Ug(this._stickyAdTopProperty)})),this._videoEventBus.topCenterVideoUnCollapsed.on((()=>{Ug(this._stickyContainerAdsUtil.stickyHeaderHeight)}))}constructor(e,t,i,s){super(),this._videoEventBus=t,this._stickyContainerRecipeExperiment=i,this._stickyContainerTopCenterVideoDependencyExperiment=s,this._stickyContainerRecipeExperimentResult=!1,this._stickyContainerTopCenterVideoDependencyExperimentResult=!1,this._stickyContainerAdsUtil=new cT(e),this._stickyRecipeHeight=e.adOptions.stickyRecipeHeight,this._stickyContainerRecipeExperimentResult=this._stickyContainerRecipeExperiment.result,this._stickyContainerTopCenterVideoDependencyExperimentResult=this._stickyContainerTopCenterVideoDependencyExperiment.result}}pT=B([hs("StickyContainerRecipeAdsComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===zs?Object:zs,void 0===Xl?Object:Xl,void 0===hT?Object:hT])],pT);class gT extends Cs{init(){this._spaEventBus.routeChanged.on((async()=>{const e=await(e=>{const t=`https://ads.adthrive.com/api/v1/marmalade?siteid=${e}&url=${encodeURIComponent(location.href)}&experiments=recencyFrequency`;return fetch?fetch(t).then((e=>e.json())).catch((e=>(te.error("getMarmaladeData","Unable to get marmalade data. Error:",e),null))):new Promise((e=>{const i=new XMLHttpRequest;i.onload=()=>{200===i.status&&e(i.response)},i.open("GET",t,!0),i.responseType="json",i.send()}))})(this._siteId);e&&(this._config.marmalade=new il(e,this._marmaladeEventBus),this._marmaladeEventBus.marmaladeResponseLoaded.emit(e))}))}get enabled(){return!0}constructor(e,t,i){super(),this._spaEventBus=e,this._marmaladeEventBus=t,this._config=i,this._siteId=this._config.site.id}}gT=B([hs("SPAMarmaladeComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ns?Object:Ns,void 0===js?Object:js,void 0===Ol?Object:Ol])],gT);class mT extends Cs{init(){this.checkGPPConsentForFacebook(),this._config.gdpr.enabled&&this._gdprEnforcement.checkConsentOnLoad().then((e=>{e&&e.tcString?this.checkGDPRConsentForFacebook():this.listenForUserActionComplete()})).catch((()=>{}))}checkGPPConsentForFacebook(){this.gppComponent.enabled&&(this._consent=this.gppComponent.gpcEnabled?"revoke":"grant",this._config.ccpa.consentChange.on((e=>{const t=e===this.gppComponent.ccpaOptOut;this._consent=t?"revoke":"grant",this.handleFacebookPixelConsent()})),this.handleFacebookPixelConsent())}checkGDPRConsentForFacebook(){this._gdprEnforcement.checkConsentForVendor(this._facebookVendorId,[1]).then((e=>{this._consent=e?"grant":"revoke",this.handleFacebookPixelConsent()})).catch((()=>{}))}listenForUserActionComplete(){window.__tcfapi("addEventListener",2,((e,t)=>{t&&e&&"useractioncomplete"===e.eventStatus&&this.checkGDPRConsentForFacebook()}))}checkFBEventsJSExists(){return Array.from(document.querySelectorAll("head > script:not([src]), body > script:not([src])")).some((e=>this._fbEventsUrlPattern.test(e.innerHTML)))}removeUserInteractionListeners(){this._cb&&(this._userInteractionEvents.forEach((e=>window.removeEventListener(e,this._cb))),this._cb=null)}addUserInteractionListeners(e){this._cb=kl((()=>{e()&&this.removeUserInteractionListeners()}),this._throttleInterval,{leading:!1}),this._userInteractionEvents.forEach((e=>window.addEventListener(e,this._cb)))}handleFacebookPixelConsent(){window.fbq&&"function"==typeof window.fbq?(window.fbq("consent",this._consent),this.removeUserInteractionListeners()):!this._cb&&this.checkFBEventsJSExists()&&this.addUserInteractionListeners(this.handleFacebookPixelConsent.bind(this))}get enabled(){return this._config.gdpr.enabled||this.gppComponent.enabled}constructor(e,t,i){super(),this._gdprEnforcement=e,this.gppComponent=t,this._config=i,this._cb=null,this._facebookVendorId="s7",this._fbEventsUrlPattern=/connect\.facebook\.net\/en_US\/fbevents.js/,this._userInteractionEvents=["mousemove","keydown","touchstart","wheel"],this._consent="revoke",this._throttleInterval=500}}mT=B([hs("FacebookPixelComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===ih?Object:ih,void 0===om?Object:om,void 0===Ol?Object:Ol])],mT);class _T extends nr{init(){this._key="SlickstreamAdUnits",this._default=!1}}_T=B([hs("SlickstreamAdsExperiment"),M()],_T);const fT=(e,t,i=0)=>{const s=[];for(let r=0;r<t;r++){const t=i+r;s.push({...e,sequence:t})}return s};class vT extends Fg{injectSlickstreamAdSlots(e,t=document,i){const s=[],r=Dg(".slick-search-ad-slot div",t);this._count=i+1;const n=fT(e,r.length,this._count).map((e=>(e.lazy=!0,e)));for(let e=0;e<r.length;e++){const t=r.item(e),i=n[e],a=`${i.location}_${i.sequence}`;if(s.some((e=>e.name===a)))continue;const o=this.getDynamicElementId(),l=`adthrive-${i.location.replace("_","-").toLowerCase()}`,d=[l,`${l}-${i.sequence}`,...i.classNames,"adthrive-slicksearch"],c=xg(t,o,i.position,d,i.location);if(c){const e=this._filterAdUnitSizes(i,c);e.length&&(s.push(Rg(i,c,e,!1)),this._count++)}}return s}getDynamicElementId(){return`${this._config.gam.prefix}_Content_${this._count}_${this._context.device}`}constructor(e,t,i){super(t,i),this._config=e,this._adInjectionMap=t,this._context=i,this._count=0}}vT=B([hs("SlickstreamAdsInjector"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===mg?Object:mg,void 0===Pr?Object:Pr])],vT);class yT extends Cs{get enabled(){return this._slickstreamAdsExperiment.result}init(){document.addEventListener("slick-search-panel-show",(()=>{const e=document.querySelector("slick-search-panel");e&&!this.slotsAlreadyInjectedInElement(e)&&this._addSlots(e)})),document.addEventListener("slick-search-panel-hide",(()=>{this._slickstreamAdSlots.length>0&&this._removeSlots()})),this._slotManagerEventBus.added.on((e=>{for(const t of e)t.location===ge.Content&&this._contentSlotsCount++}))}_addSlots(e){const t=this._config.dynamicAds.filter((e=>e.location===ge.Content)).filter((e=>wt(this._config,e))).filter((e=>Tt(e,this._context.device)));if(t.length>0){const i=this._injector.injectSlickstreamAdSlots(t[0],e,this._contentSlotsCount);this._slotManager.add(i).then((e=>{e.forEach((e=>{this._slickstreamAdSlots.push(e),Vl.pushToQueue((()=>{e.setTargeting({key:"slicksearch",value:"true"}),e.setSlotTargetingFlag("slicksearch",["true"])}))}))})).catch((e=>{te.error("SlickstreamAdsComponent","_addSlots",e)}))}}_removeSlots(){this._slotManager.destroy(this._slickstreamAdSlots),this._slotManager.removeElement(this._slickstreamAdSlots),this._contentSlotsCount=this._contentSlotsCount-this._slickstreamAdSlots.length,this._slickstreamAdSlots.length=0}slotsAlreadyInjectedInElement(e){return!!e.querySelector("[id*='AdThrive_Content']")}constructor(e,t,i,s,r,n){super(),this._config=e,this._context=t,this._injector=i,this._slotManager=s,this._slickstreamAdsExperiment=r,this._slotManagerEventBus=n,this._slickstreamAdSlots=[],this._contentSlotsCount=0}}yT=B([hs("SlickstreamAdsComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===vT?Object:vT,void 0===id?Object:id,void 0===_T?Object:_T,void 0===Vs?Object:Vs])],yT);const bT=e=>/^[-_a-zA-Z]+[-_a-zA-Z0-9]*$/.test(e);class ST extends qs{run(){if(!this.enabled)return te.error("AdLayoutSiteExperiment","run","() => %o","No experiment config found. Defaulting to empty class name."),"";const e=new Ps(this._mappedChoices).get();return this._isValidResult(e)?e:(te.error("AdLayoutSiteExperiment","run","() => %o","Invalid result from experiment choices. Defaulting to empty class name for result",e),"")}setExperimentTargeting(){if(!this.enabled||!this._isValidResult(this._result))return void te.error("AdLayoutSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config and valid result");const e=this.experimentConfig,t=`${e.key.toLowerCase()}-${e.id}`,i=this._result;this._pubabgroup.set(t,i)}_mapChoices(){return this._choices.map((({weight:e,value:t})=>({weight:e,choice:t})))}constructor(e,t,i,s){var r;super(),this._siteExperiments=e,this._pubabgroup=t,this._clsOptions=i,this._choices=[],this._mappedChoices=[],this._result="",this.key=pe.AdLayout,this._resultValidator=e=>{if("string"!=typeof e)return!1;const t=e.startsWith(".")?e.substring(1):e;return bT(t)},(null==(r=s.siteAds)?void 0:r.siteExperiments)?this.experimentConfig=new Gs(s.siteAds).getSiteExperimentByKey(this.key):this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);const n=this._clsOptions.getWeightedChoiceExperiment(this.key,!0);this.enabled&&this._isValidResult(n)?(this._result=n,this.setExperimentTargeting()):this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),this.setExperimentTargeting())}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ST.prototype,"run",null),ST=B([M(),F(3,D("AdthriveCLS")),j("design:type",Function),j("design:paramtypes",[void 0===Ks?Object:Ks,void 0===Xs?Object:Xs,void 0===Ba?Object:Ba,"undefined"==typeof AdthriveCLS?Object:AdthriveCLS])],ST);class ET extends Cs{get enabled(){return this._adLayoutSiteExperiment.enabled}init(){const e=this._adLayoutSiteExperiment.result,t=e.startsWith(".")?e.substring(1):e;if(bT(t))try{document.body.classList.add(t)}catch(e){te.error("AdLayoutComponent","init",`Uncaught CSS Class Name error: ${e}`)}else te.error("AdLayoutComponent","init",`Invalid class name: ${e}`)}constructor(e){super(),this._adLayoutSiteExperiment=e}}ET=B([hs("AdLayoutComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===ST?Object:ST])],ET);class CT extends Cs{init(){this._footerConfigEventBus.comscoreInitialized.on((e=>{e&&this._footerConfigEventBus.footerElementAdded.emit({order:2,element:"<span>A Raptive Partner Site</span>"})}),{handleEventsAlreadyEmitted:!0})}constructor(e){super(),this._footerConfigEventBus=e}}CT=B([L(),j("design:type",Function),j("design:paramtypes",[void 0===Ds?Object:Ds])],CT);class TT extends Cs{init(){this._slotManagerEventBus.added.on((e=>{e.forEach((e=>{e.element.classList.add("adthrive-ad-debug"),e.element.addEventListener("click",(()=>{console.warn(`%c Debug Info for ${e.id}`,"background: #6B65FF; color: #F0EDEB; padding: 1px; border-radius: 3px;",e)}))}))}))}get enabled(){const e=Ir("at_ui_debug");return"true"===e||"1"===e}constructor(e){super(),this._slotManagerEventBus=e}}TT=B([hs("UIDebugComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Vs?Object:Vs])],TT);class wT extends nr{init(){this._key="PageRefreshMonitorExperiment",this._default=!1}run(){return super.run()}}B([us(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],wT.prototype,"run",null),wT=B([hs("PageRefreshMonitorExperiment"),M()],wT);class AT extends Cs{get enabled(){return this._pageRefreshMonitorExperiment.result}start(){const e=kr.readSessionStorage("previousUrl"),t=kr.readSessionStorage("previousPVK"),i=kr.readSessionStorage("previousPageHide"),s=kr.readSessionStorage("previousUnload"),r=kr.readSessionStorage("previousBeforeUnload");this.pageManager.beforeUnload.on((()=>{kr.setSessionStorage("previousBeforeUnload",!0)})),window.addEventListener("unload",(()=>{kr.setSessionStorage("previousUnload",!0)})),this.pageManager.pageHide.on((()=>{kr.setSessionStorage("previousPageHide",!0)}));const n=(new Date).toISOString();if(e&&e===window.location.href){var a;const e=kr.readSessionStorage("previousLoadTime"),o=e?((e,t)=>{const i=new Date(e);return new Date(t)-i})(e,n):void 0;te.event("PageRefreshMonitor","refresh",{timeSinceLastLoad:o,navigationType:null==(a=performance.getEntriesByType("navigation")[0])?void 0:a.type,legacyNavigationType:window.performance.navigation.type,previousPVK:t,previousPageHide:i,previousUnload:s,previousBeforeUnload:r})}kr.setSessionStorage("previousUrl",window.location.href),kr.setSessionStorage("previousLoadTime",n),kr.setSessionStorage("previousPVK",this.pageviewKey),kr.setSessionStorage("previousPageHide",!1),kr.setSessionStorage("previousUnload",!1),kr.setSessionStorage("previousBeforeUnload",!1)}constructor(e,t,i){super(),this._pageRefreshMonitorExperiment=e,this.pageviewKey=t,this.pageManager=i}}AT=B([L(),F(1,D("PageviewKey")),j("design:type",Function),j("design:paramtypes",[void 0===wT?Object:wT,String,void 0===wr?Object:wr])],AT);class kT{setExperimentKey(e=!1){this._clsOptions.setExperiment(this.abgroup,this.result,e)}constructor(){this._clsOptions=new Ba,this.shouldUseCoreExperimentsConfig=!1}}class IT extends kT{get result(){return this._result}run(){return new Is(this.weight).get()}constructor(e){super(),this._result=!1,this.key="ParallaxAdsExperiment",this.abgroup="parallax",this._choices=[{choice:!0},{choice:!1}],this.weight=.5;!!Wt()&&e.largeFormatsMobile&&(this._result=this.run(),this.setExperimentKey())}}IT=B([hs("ParallaxAdsExperiment"),j("design:type",Function),j("design:paramtypes",["undefined"==typeof AdTypes?Object:AdTypes])],IT),new Map([[ge.Footer,1],[ge.Header,2],[ge.Sidebar,3],[ge.Content,4],[ge.Recipe,5],["Sidebar_sticky",6],["Below Post",7]]);const PT=(e,t)=>{const i=kt(t),s=e.sticky&&e.location===ge.Sidebar;return e.sizes.filter((t=>{const r=!e.autosize||(t[0]<=i||t[0]<=320),n=!s||t[1]<=window.innerHeight-100;return r&&n}))};class OT extends sr{init(){this._key="DynamicSidebarSlotsCap"}}OT=B([hs("DynamicSidebarSlotsCapExperiment"),M()],OT);const xT=(e,t,i=1200,s=25)=>{const r=e-(t.hasChildNodes()?(e=>{const t=e.lastChild;if(t instanceof HTMLElement)return t.offsetTop+t.offsetHeight;if(t instanceof Text){const i=t.previousElementSibling;return i?i.offsetTop+i.offsetHeight:e.offsetTop}return te.error("util","determineSidebar9ElementTop","Could not determine the top of the sidebar9 child element"),e.offsetTop})(t):t.offsetTop),n=Math.floor(r/(i+10));return Math.min(n,s)};class RT extends Cs{get enabled(){const e=this._config.adOptions.dynamicStickySidebarBlockedSelectors||[];return!dT(e)&&!!this._config.adOptions.dynamicStickySidebarEnabled&&this._essaExperiment.result}start(){const e=this._config.dynamicAds.filter((e=>e.location===ge.Sidebar)).filter((e=>9===e.sequence)).filter((e=>wt(this._config,e))).filter((e=>{return t=e,i=this._context.device,t.devices.includes(i);var t,i})).filter((e=>{return 0===(t=e).pageSelector.length||null!==document.querySelector(t.pageSelector);var t}))[0];if(!e)return;const t=this.insertDynamicStickySidebarAds(e);this._slotManager.add(t)}updateStylingForExistingStickySidebarAd(e){const t=this.getDynamicElementId(e),i=document.getElementById(t);null==i||i.classList.add("adthrive-sticky-sidebar")}getSidebarElement(e){return Dg(e.elementSelector,document).item(e.skip)}insertDynamicStickySidebarAds(e){const t=[],i=Dg(e.elementSelector,document).item(e.skip);if(null===i)return t;const s=this.repeatDynamicStickySidebar(e).filter((e=>null===document.querySelector(`#${this.getDynamicElementId(e)}`)));if(s.length<2)return t;this.updateStylingForExistingStickySidebarAd(e);for(let r=0;r<s.length;r++){const n=s[r],a=`${n.location}_${n.sequence}`;if(t.some((e=>e.name===a)))continue;const o=this.getDynamicElementId(n),l=Lg(n),d=Mg(n),c=[r===s.length-1?"":"adthrive-sticky-sidebar",l,d,...n.classNames],h=xg(i,o,n.position,c,e.location);if(h){const e=PT(n,h);e.length&&t.push(Rg(n,h,e,!1))}}return t}getSidebarSlotHeight(){const e=this._config.adOptions.dynamicStickySidebarHeight;return 0===e||void 0===e?(te.error("EnhancedStickySidebarComponent","_getSidebarSlotHeight","Dynamic sticky sidebar height is not set in config"),1800):e}calculateNumberOfDynamicStickySidebars(e){var t;const i=this.getSidebarElement(e);if(!i)return 0;const s=this.getSidebarSlotHeight(),r=e.stickyOverlapSelector&&(null==(t=document.querySelector(e.stickyOverlapSelector))?void 0:t.offsetTop)||document.body.scrollHeight,n=this._dynamicSidebarSlotsCapExperiment.result||0;return xT(r,i,s,n)}repeatDynamicStickySidebar(e){if(e.location!==ge.Sidebar||9!==e.sequence||!e.sticky)return[e];const t=this.calculateNumberOfDynamicStickySidebars(e);return fT(e,t,9).map((e=>(9!==e.sequence&&(e.lazy=!0),e)))}getDynamicElementId(e){return`${this._config.gam.prefix}_${e.location}_${e.sequence}_${this._context.device}`}constructor(e,t,i,s,r){super(),this._config=e,this._context=t,this._slotManager=i,this._dynamicSidebarSlotsCapExperiment=s,this._essaExperiment=r}}RT=B([hs("EnhancedStickySidebarComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===id?Object:id,void 0===OT?Object:OT,void 0===ym?Object:ym])],RT);class DT extends nr{init(){this._key="INPExperiment",this._default=!1}}var LT;DT=B([hs("INPExperiment"),M()],DT),function(e){e.good="good",e.needsImprovement="needs improvement",e.poor="poor"}(LT||(LT={}));class MT extends Cs{init(){this._observer=this._createPerformanceObserver(),this._observer.observe({type:"event",buffered:!0,durationThreshold:0}),this._pageManager.pageHide.on((()=>{this._logINPEventsData(),this._logINPCounts()})),this._currentContextualDataSize=encodeURIComponent(JSON.stringify(te.data)).length,this._setMaxCharsAvailableToLog(),this._loggerEventBus.newContextDataEncodingSize.on((e=>this._updateCharLimits(e)))}_createPerformanceObserver(){return new PerformanceObserver((e=>{e.getEntries().forEach((e=>{this._isEntryPerformanceEventTimingType(e)&&this._hasNonZeroInteractionId(e)&&this._processEntry(e)}))}))}_processEntry(e){const t=e.interactionId,i=this._getInteractionEventInfo(e),s=this._existingInteractions.get(t);(!s||i.inp>s.maxINP)&&this._updateINPForInteraction(t,i);const r={...i,interactionId:t};this._updateINPLog(r),this._totalInteractionEvents++}_isEntryPerformanceEventTimingType(e){return"event"===e.entryType}_hasNonZeroInteractionId(e){return!!e.interactionId&&0!==e.interactionId}_getInteractionEventInfo(e){const t=e.duration,i=e.startTime,s=e.processingStart,r=e.processingEnd,n=e.target;return{inp:t,startTime:i,startDelay:s-i,processingStart:s,processingEnd:r,processingTime:r-s,...this._getTargetIdentifiers(n),qualitativeScore:this._getQualitativeINPScore(t),eventType:e.name}}_updateINPForInteraction(e,t){const i={maxINP:t.inp,qualitativeScore:t.qualitativeScore};this._existingInteractions.set(e,i)}_setMaxCharsAvailableToLog(){const e=te.buildRequestUrl("event","INPComponent","_logINPEventsData",[]).length,t=this._calculateCharsOfEncodedDataObject(this._logData)+this._calculateCharsFromEncodedCommas(1);this._maxCharsAvailableInSendEvent=te.maxCloudFrontUrlSize-e-t}_updateCharLimits(e){const t=this._maxCharsAvailableInSendEvent;this._maxCharsAvailableInSendEvent+=this._currentContextualDataSize-e,this._currentContextualDataSize=e,this._maxCharsAvailableInSendEvent<t&&this._lengthOfCurrentLogRequest>=this._maxCharsAvailableInSendEvent&&this._saveExcessEventsAndLogRemaining()}_saveExcessEventsAndLogRemaining(){const e=[];for(;this._lengthOfCurrentLogRequest>=this._maxCharsAvailableInSendEvent;){const t=this._logData.INPData.pop();if(t){e.push(t);const i=this._countAdditionalEncodedChars(t);this._lengthOfCurrentLogRequest-=i}}e.forEach((e=>this._updateINPLog(e)))}_countAdditionalEncodedChars(e){const t=!!this._logData.INPData.length;return this._calculateCharsOfEncodedDataObject(e)+(t?this._calculateCharsFromEncodedCommas(1):0)}_updateINPLog(e){const t=this._countAdditionalEncodedChars(e);t+this._lengthOfCurrentLogRequest>this._maxCharsAvailableInSendEvent&&(this._logINPEventsData(),this._clearLogData(),this._lengthOfCurrentLogRequest=0),this._addINPData(e),this._lengthOfCurrentLogRequest+=t}_addINPData(e){this._logData.INPData.push(e)}_logINPEventsData(){te.event("INPComponent","_logINPEventsData",this._logData)}_logINPCounts(){let e=-1/0;for(const[,t]of this._existingInteractions.entries())t.maxINP>e&&(e=t.maxINP);te.event("INPComponent","_logINPCounts",{...this._getNumberOfEventsAndInteractions(),maxINP:e})}_clearLogData(){this._logData.INPData.length=0}_calculateCharsOfEncodedDataObject(e){return encodeURIComponent(JSON.stringify(e)).length}_calculateCharsFromEncodedCommas(e){return e*encodeURIComponent(",").length}_getTargetIdentifiers(e){const t={nodeIdentifier:"",innerText:""};return e instanceof HTMLElement?(t.nodeIdentifier=(i=e).id?`id:${i.id}`:i.classList&&i.classList.value?`class:${i.classList.value.split(" ").join(".")}`:`node:${i.nodeName.toLowerCase()}`,t.innerText=e.innerText&&e.innerText.length<300?e.innerText:"",t):(e instanceof Node&&(t.nodeIdentifier=`node:${e.nodeName}`),t);var i}_getQualitativeINPScore(e){return e<=200?"good":e<=500?"needs improvement":"poor"}_getNumberOfEventsAndInteractions(){return{totalInteractions:this._existingInteractions.size,totalInteractionEvents:this._totalInteractionEvents}}get enabled(){return"PerformanceObserver"in window&&PerformanceObserver&&PerformanceObserver.supportedEntryTypes.includes("event")&&"interactionId"in PerformanceEventTiming.prototype&&this._inpExperiment.result}constructor(e,t,i){super(),this._pageManager=e,this._loggerEventBus=t,this._inpExperiment=i,this._existingInteractions=new Map,this._totalInteractionEvents=0,this._maxCharsAvailableInSendEvent=0,this._currentContextualDataSize=0,this._lengthOfCurrentLogRequest=0,this._logData={INPData:[]}}}MT=B([hs("INPComponent"),L(),j("design:type",Function),j("design:paramtypes",[void 0===wr?Object:wr,void 0===Z?Object:Z,void 0===DT?Object:DT])],MT);var BT,FT=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},jT=function(e){if("loading"===document.readyState)return"loading";var t=FT();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},NT=function(e){var t=e.nodeName;return 1===e.nodeType?t.toLowerCase():t.toUpperCase().replace(/^#/,"")},UT=function(e,t){var i="";try{for(;e&&9!==e.nodeType;){var s=e,r=s.id?"#"+s.id:NT(s)+(s.classList&&s.classList.value&&s.classList.value.trim()&&s.classList.value.trim().length?"."+s.classList.value.trim().replace(/\s+/g,"."):"");if(i.length+r.length>(t||100)-1)return i||r;if(i=i?r+">"+i:r,s.id)break;e=s.parentNode}}catch(e){}return i},VT=-1,zT=function(e,t){var i=FT(),s="navigate";return VT>=0?s="back-forward-cache":i&&(document.prerendering||function(){var e=FT();return e&&e.activationStart||0}()>0?s="prerender":document.wasDiscarded?s="restore":i.type&&(s=i.type.replace(/_/g,"-"))),{name:e,value:-1,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:s}},$T=function(e,t,i){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var s=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return s.observe(Object.assign({type:e,buffered:!0},i||{})),s}}catch(e){}},HT=function(e,t,i,s){var r,n;return function(a){t.value>=0&&(a||s)&&((n=t.value-(r||0))||void 0===r)&&(r=t.value,t.delta=n,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,i),e(t))}},qT=0,GT=1/0,KT=0,WT=function(e){e.forEach((function(e){e.interactionId&&(GT=Math.min(GT,e.interactionId),KT=Math.max(KT,e.interactionId),qT=KT?(KT-GT)/7+1:0)}))},YT=function(){return BT?qT:performance.interactionCount||0},QT=function(){"interactionCount"in performance||BT||(BT=$T("event",WT,{type:"event",buffered:!0,durationThreshold:0}))},XT=[200,500],JT=0,ZT=function(){return YT()-JT},ew=[],tw={},iw=function(e){var t=ew[ew.length-1],i=tw[e.interactionId];if(i||ew.length<10||e.duration>t.latency){if(i)i.entries.push(e),i.latency=Math.max(i.latency,e.duration);else{var s={id:e.interactionId,latency:e.duration,entries:[e]};tw[s.id]=s,ew.push(s)}ew.sort((function(e,t){return t.latency-e.latency})),ew.splice(10).forEach((function(e){delete tw[e.id]}))}},sw=function(e,t){t=t||{},function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()}((function(){QT();var i,s=zT("INP"),r=function(e){e.forEach((function(e){e.interactionId&&iw(e),"first-input"===e.entryType&&!ew.some((function(t){return t.entries.some((function(t){return e.duration===t.duration&&e.startTime===t.startTime}))}))&&iw(e)}));var t,r=(t=Math.min(ew.length-1,Math.floor(ZT()/50)),ew[t]);r&&r.latency!==s.value&&(s.value=r.latency,s.entries=r.entries,i())},n=$T("event",r,{durationThreshold:t.durationThreshold||40});i=HT(e,s,XT,t.reportAllChanges),n&&(n.observe({type:"first-input",buffered:!0}),function(e){var t=function(t){"pagehide"!==t.type&&"hidden"!==document.visibilityState||e(t)};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)}((function(){r(n.takeRecords()),s.value<0&&ZT()>0&&(s.value=0,s.entries=[]),i(!0)})),function(e){addEventListener("pageshow",(function(t){t.persisted&&(VT=t.timeStamp,e(t))}),!0)}((function(){ew=[],JT=YT(),s=zT("INP"),i=HT(e,s,XT,t.reportAllChanges)})))}))};class rw extends Cs{init(){!function(e,t){sw((function(t){!function(e){if(e.entries.length){var t=e.entries.sort((function(e,t){return t.duration-e.duration||t.processingEnd-t.processingStart-(e.processingEnd-e.processingStart)}))[0];e.attribution={eventTarget:UT(t.target),eventType:t.name,eventTime:t.startTime,eventEntry:t,loadState:jT(t.startTime)}}else e.attribution={}}(t),e(t)}),t)}(this.logInpWithAttribution.bind(this),{reportAllChanges:!0})}logInpWithAttribution(e){te.event("AttributionINPComponent","logInpWithAttribution",e)}get enabled(){return lt()&&this.inpExperiment.result}constructor(e){super(),this.inpExperiment=e}}rw=B([hs("AttributionINPComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===DT?Object:DT])],rw);class nw extends Cs{init(){this._userIdEventBus.userIdNeedsRefresh.on((e=>{this._refreshRequests.push(e),this._processingRequests||(this._processingRequests=!0,this._triggerUserIdRefresh())}))}_triggerUserIdRefresh(){if(0===this._refreshRequests.length)return void(this._processingRequests=!1);const e=this._refreshRequests.shift();e&&this._prebidMethods.refreshUserIds(e.options,this._wrapCallback(e.callback).bind(this))}_wrapCallback(e){return()=>{e(),this._triggerUserIdRefresh()}}get enabled(){return!0}constructor(e,t){super(),this._userIdEventBus=e,this._prebidMethods=t,this._refreshRequests=[],this._processingRequests=!1}}nw=B([hs("RefreshUserIdsComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Fs?Object:Fs,void 0===Ss?Object:Ss])],nw);class aw extends Cs{init(){this._pageManager.visibilityChange.on(this._handleVisibilityChange.bind(this))}async start(){ct()?this._pageManager.setupOnceEvent("click",this._acquireWakeLock.bind(this)):await this._acquireWakeLock()}async _handleVisibilityChange(){null!==this._wakeLock&&"visible"===document.visibilityState&&await this._acquireWakeLock()}_getMaxDurationMinutes(){var e,t,i,s;return Bt()?null!=(t=null==(e=this._adOptions.wakeLock)?void 0:e.desktopValue)?t:this._desktopDefaultDuration:null!=(s=null==(i=this._adOptions.wakeLock)?void 0:i.mobileValue)?s:this._mobileDefaultDuration}async _acquireWakeLock(){try{this._wakeLock=await navigator.wakeLock.request("screen"),this._wakeLock.addEventListener("release",(()=>{this._timeoutId&&clearTimeout(this._timeoutId)}));const e=this._getMaxDurationMinutes();this._timeoutId=setTimeout((()=>{this._wakeLock&&this._wakeLock.release().then((()=>{this._wakeLock=null}))}),this.convertMinutesToMilliseconds(e))}catch(e){}}get enabled(){const e=!this._featureRolloutService.isRolloutEnabled(this._featureRolloutKey);return!!("wakeLock"in navigator)&&e&&this._wakeLockEnabledInAdOptions()}_wakeLockEnabledInAdOptions(){return void 0===this._adOptions.wakeLock||null!==this._adOptions.wakeLock&&(Wt()||Yt()?this._adOptions.wakeLock.mobileEnabled:!Bt()||this._adOptions.wakeLock.desktopEnabled)}constructor(e,t,i){super(),this._pageManager=e,this._featureRolloutService=t,this._adOptions=i,this._wakeLock=null,this._timeoutId=null,this._featureRolloutKey="disable-wake-lock",this._mobileDefaultDuration=15,this._desktopDefaultDuration=30,this.convertMinutesToMilliseconds=e=>60*e*1e3}}aw=B([M(),hs("WakeLockComponent"),j("design:type",Function),j("design:paramtypes",[void 0===wr?Object:wr,void 0===Cr?Object:Cr,void 0===Qr?Object:Qr])],aw);class ow{init(){this._components.forEach((e=>void 0!==e.init&&e.enabled&&e.init()))}start(){this._components.forEach((e=>void 0!==e.start&&e.enabled&&e.start()))}constructor(e,t,i,s,r,n,a,o,l,d,c,h,u,p,g,m,_,f,v,y,b,S,E,C,T,w,A,k,I,P,O,x,R,D,L,M,B,F,j,N,U,V,z,$,H,q,G,K,W,Y,Q,X,J,Z,ee,te,ie,se,re,ne,ae,oe,le,de,ce,he,ue,pe,ge,me,_e,fe,ve,ye,be,Se,Ee,Ce,Te,we){this._config=e,this._components=[t,i,s,r,n,a,o,l,d,c,h,u,p,g,m,_,ye,f,v,y,b,S,E,C,T,w,A,k,I,O,R,P,D,L,M,B,F,j,N,U,V,z,$,H,q,Ce,G,K,W,Y,Q,J,Z,ee,te,X,ie,se,re,ne,ae,oe,le,de,x,he,ce,ue,pe,ge,me,_e,fe,ve,be,Se,Ee,Te,we]}}ow=B([hs("Components"),L(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===vg?Object:vg,void 0===yg?Object:yg,void 0===tT?Object:tT,void 0===Sg?Object:Sg,void 0===Eg?Object:Eg,void 0===wg?Object:wg,void 0===iT?Object:iT,void 0===vm?Object:vm,void 0===CT?Object:CT,void 0===Fh?Object:Fh,void 0===Ag?Object:Ag,void 0===kg?Object:kg,void 0===Bh?Object:Bh,void 0===Ig?Object:Ig,void 0===sT?Object:sT,void 0===zg?Object:zg,void 0===_m?Object:_m,void 0===$g?Object:$g,void 0===mT?Object:mT,void 0===Hg?Object:Hg,void 0===cd?Object:cd,void 0===sm?Object:sm,void 0===rm?Object:rm,void 0===aT?Object:aT,void 0===nm?Object:nm,void 0===Lm?Object:Lm,void 0===om?Object:om,void 0===lm?Object:lm,void 0===dm?Object:dm,void 0===jh?Object:jh,void 0===WC?Object:WC,void 0===Mm?Object:Mm,void 0===rT?Object:rT,void 0===XC?Object:XC,void 0===ZC?Object:ZC,void 0===eT?Object:eT,void 0===nT?Object:nT,void 0===mm?Object:mm,void 0===Nh?Object:Nh,void 0===Fm?Object:Fm,void 0===Nm?Object:Nm,void 0===Uh?Object:Uh,void 0===Vh?Object:Vh,void 0===Vm?Object:Vm,void 0===$m?Object:$m,void 0===Zm?Object:Zm,void 0===e_?Object:e_,void 0===i_?Object:i_,void 0===s_?Object:s_,void 0===l_?Object:l_,void 0===lT?Object:lT,void 0===AT?Object:AT,void 0===a_?Object:a_,void 0===o_?Object:o_,void 0===gT?Object:gT,void 0===Jp?Object:Jp,void 0===Dm?Object:Dm,void 0===uT?Object:uT,void 0===pT?Object:pT,void 0===zh?Object:zh,void 0===$h?Object:$h,void 0===d_?Object:d_,void 0===GC?Object:GC,void 0===ug?Object:ug,void 0===qh?Object:qh,void 0===c_?Object:c_,void 0===qE?Object:qE,void 0===VC?Object:VC,void 0===yT?Object:yT,void 0===HC?Object:HC,void 0===ET?Object:ET,void 0===Bl?Object:Bl,void 0===RT?Object:RT,void 0===TT?Object:TT,void 0===MT?Object:MT,void 0===rw?Object:rw,void 0===nw?Object:nw,void 0===aw?Object:aw,void 0===YC?Object:YC])],ow);Cg('.adthrive-ad{clear:both;line-height:0;margin-bottom:10px;margin-top:10px;overflow-x:visible;text-align:center}.adthrive-ad-cls{align-items:center;display:flex;flex-wrap:wrap;justify-content:center}.adthrive-ad-cls>div,.adthrive-ad-cls>iframe{flex-basis:100%}.adthrive-interstitial{margin-bottom:0;margin-top:0}.adthrive-native-recipe{display:inline-block}.adthrive-recipe{min-width:300px;position:relative;z-index:1}.adthrive-device-desktop .adthrive-recipe,.adthrive-device-tablet .adthrive-recipe{max-width:320px}.adthrive-stuck.adthrive-sticky.adthrive-header,.adthrive-stuck.adthrive-sticky.adthrive-sidebar{position:fixed;top:0;z-index:9999}.adthrive-stuck.adthrive-header{margin-top:0}.adthrive-stuck.adthrive-sticky-outstream{display:none;overflow:hidden;position:fixed;z-index:2147483644}.adthrive-sticky.adthrive-footer{background-color:hsla(0,0%,100%,.8);border-top:2px solid hsla(0,0%,88%,.8);bottom:0;box-sizing:content-box;left:0;margin:0;max-height:100px;overflow:hidden;position:fixed;text-align:center;width:100%;z-index:1000001}.adthrive-sticky.adthrive-footer>.adthrive-close{background:#fff;border:1px solid #b2b2b2;border-radius:20px;color:#b2b2b2;cursor:pointer;display:inline-block;font-family:arial,sans-serif;font-size:20px;line-height:20px;padding:0 5px;position:absolute;right:5px;top:5px}.adthrive-device-desktop .adthrive-sticky.adthrive-footer>.adthrive-close{right:10px;top:10px}.adthrive-ccpa-link,.adthrive-footer-message,.adthrive-privacy-preferences{margin-top:5px;text-align:center}.adthrive-footer>div,.adthrive-header>div{max-width:1200px}.raptive-player-reset>*{background-color:transparent;border:0;box-shadow:none;box-sizing:border-box;clear:both;color:inherit;direction:ltr;display:block;float:none;font-family:Arial,Helvetica,sans-serif;font-size:16px;font-stretch:normal;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;line-height:1.2;margin:0;overflow-wrap:normal;padding:0;text-align:left;text-decoration:none;text-transform:none;white-space:normal;word-spacing:normal}#next-video,#stay-video{background-color:#333;color:#fff;cursor:pointer;height:40px;line-height:40px;margin:5px;opacity:.9;position:relative;text-align:center;text-transform:capitalize;width:100px}.adthrive-collapse-mobile #next-video,.adthrive-collapse-mobile #stay-video,.adthrive-player-position-mobile #next-video,.adthrive-player-position-mobile #stay-video,.jw-flag-small-player #next-video,.jw-flag-small-player #stay-video,.raptive-player-container-mobile #next-video,.raptive-player-container-mobile #stay-video{height:30px;line-height:30px;width:75px}#next-stay-container{bottom:0;display:flex;flex-flow:column;justify-content:center;margin:12px;position:absolute;right:0;top:0;z-index:1}.adthrive-collapse-mobile #next-stay-container,.adthrive-player-position-mobile #next-stay-container,.jw-flag-small-player #next-stay-container,.raptive-player-container-mobile #next-stay-container{margin:0}#next-video:before{animation:scaleInFromLeft 5s linear 0s 1;background-color:red;content:"";display:block;height:100%;position:absolute;transform-origin:left;width:100%;will-change:transform,opacity;z-index:1}#next-video span{position:relative;z-index:2}@keyframes scaleInFromLeft{0%{opacity:0;transform:scaleX(0)}to{opacity:1;transform:scaleX(1)}}.video-box-shadow{box-shadow:0 0 10px rgba(0,0,0,.5)}.adthrive-wrapper-bar{background-color:#595959;border-top-left-radius:5px;border-top-right-radius:5px;display:none;font-family:Arial,Helvetica,sans-serif;height:36px}.adthrive-video-title{color:#fff;font-size:13px;font-weight:700;text-decoration:none}.adthrive-wrapper-title-wrapper{align-items:center;border:none;box-shadow:none;display:inline-flex;justify-content:center;margin-left:10px;margin-right:10px;min-width:0}.adthrive-wrapper-title-wrapper>a>svg,.adthrive-wrapper-title-wrapper>div>svg{vertical-align:middle;fill:#fff;margin-right:5px}.adthrive-wrapper-title-wrapper>a{text-decoration:none}.adthrive-video-text-cutoff{color:#fff;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.adthrive-collapse-player{border-bottom:1px solid #dbdbdb;border-top:1px solid #dbdbdb;margin-left:auto;margin-right:auto;padding:8px!important;width:90%}.adthrive-outstream-container{flex-basis:unset!important;margin:0 auto;position:relative}.adthrive-player-idle{display:none;transition:all .5s ease-out;transition-delay:.5s}.raptive-player-ad-container-idle{display:none}.adthrive-player-playing{display:block;transition:all .5s ease-in;transition-delay:.5s}.adthrive-sticky-outstream-active.adthrive-new-outstream-player{animation-duration:.5s;animation-iteration-count:1;animation-name:adthrive-fade-in;animation-timing-function:ease-in;opacity:1}.adthrive-sticky-outstream-idle.adthrive-new-outstream-player{animation-duration:.5s;animation-iteration-count:1;animation-name:adthrive-fade-out;animation-timing-function:ease-out;display:block;opacity:0}@keyframes adthrive-fade-in{0%{opacity:0}to{opacity:1}}@keyframes adthrive-fade-out{0%{opacity:1}to{opacity:0}}.adthrive-player-ad-controls-play{margin:-5px 4px;z-index:1001}.adthrive-player-icon-play>svg{margin-left:4px}.adthrive-player-ad-controls-pause{display:flex;justify-content:center}.adthrive-player-ad-controls-volume-container{border-radius:36px;display:flex;flex-direction:column-reverse;height:36px;position:relative;top:-5px;z-index:1001}.adthrive-player-ad-controls-volume-with-slider{width:110px}.adthrive-player-ad-controls-volume-container>.adthrive-player-ad-controls-volume{display:flex;flex-direction:column-reverse;height:55px;position:relative}.adthrive-player-ad-controls-play>.adthrive-player-icon.adthrive-player-icon-pause,.adthrive-player-ad-controls-volume>.adthrive-player-icon-volume-muted,.adthrive-player-ad-controls-volume>.adthrive-player-icon.adthrive-player-icon-volume-unmuted,.adthrive-player-ad-controls-volume>.adthrive-player-volume-control,.adthrive-player-ad-controls>.adthrive-player-ad-controls-volume-container{margin-block-start:0}.adthrive-player-ad-controls-play,.adthrive-player-ad-controls-volume{border-radius:36px;display:inline-block;height:36px;width:36px}.adthrive-player-ad-controls-play.active,.adthrive-player-ad-controls-play:hover,.adthrive-player-ad-controls-volume-container:hover,.adthrive-player-icon-volume.active{background:rgba(0,0,0,.3)}.adthrive-player-ad-controls-volume-container.active{z-index:1001}.adthrive-player-icon{align-items:center;border-radius:100%;cursor:pointer;display:flex;height:36px;justify-content:center;margin-right:4px;width:36px}.adthrive-hidden{display:none!important}.adthrive-count-down{background:rgba(0,0,0,.5);border-bottom-right-radius:4px;color:#fff;font-size:12px;height:auto;line-height:1.2;outline:none;padding:4px;pointer-events:none;position:absolute;text-shadow:#000 0 0 1px,#000 0 0 1px,#000 0 0 1px,#000 0 0 1px;width:auto;z-index:1}.adthrive-collapse-medium>.adthrive-count-down,.adthrive-collapse-small>.adthrive-count-down{padding:2px}.adthrive-player-icon svg{filter:drop-shadow(3px 5px 3px rgb(0 0 0/.5));pointer-events:none}.adthrive-player-ad-container{bottom:0;margin:0;position:absolute}.adthrive-player-ad-container-loading{align-items:center;background-color:#000;display:flex;height:100%;justify-content:center}.adthrive-player-ad-container{overflow:hidden}.adthrive-loading-spinner-container{align-items:center;bottom:0;justify-content:center;left:0;position:absolute;right:0;top:0;z-index:9}.adthrive-loading-spinner{animation:spin 1s ease-in-out infinite;-webkit-animation:spin 1s ease-in-out infinite;border:3px solid hsla(0,0%,100%,.3);border-radius:50%;border-top-color:#fff;height:50px;width:50px}@keyframes spin{to{-webkit-transform:rotate(1turn)}}@-webkit-keyframes spin{to{-webkit-transform:rotate(1turn)}}.adthrive-title-overlay{align-items:center;background:rgba(0,0,0,.4);border-radius:0;box-sizing:border-box;color:#fff;display:flex;flex-direction:row;height:0;justify-content:flex-start;left:0;position:absolute;right:0;top:0;transition:background .3s ease-out;z-index:1}.adthrive-title-overlay.active{height:36px}.adthrive-title-overlay>.adthrive-wrapper-title-wrapper{align-items:center;display:none;flex-direction:row-reverse;height:100%;overflow:hidden;text-decoration:none;width:100%}.adthrive-title-overlay.active>.adthrive-wrapper-title-wrapper{display:flex}.adthrive-player-ad-container-loading~.adthrive-title-overlay,.adthrive-title-overlay.active>.adthrive-wrapper-title-wrapper:after{display:none}.adthrive-wrapper-bar a[target=_blank]:after{display:none!important}.adthrive-no-pointer-events{pointer-events:none}.adthrive-display-none{display:none}.adthrive-small-text{font-size:13px}.adthrive-video-title-description-container{display:flex;flex:1;flex-direction:column;font-size:1.2em;height:100%;line-height:1.1em}#adthrive-video-title-text{align-items:center;display:flex;flex:1}.adthrive-player-position-mobile #adthrive-video-title-text,.raptive-player-container-mobile #adthrive-video-title-text{font-size:.85em}#adthrive-video-description-text{align-items:center;display:flex;flex:1;font-size:1vw;margin:-4px 0 0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.adthrive-video-play-button{border-bottom:30px solid transparent;border-left:60px solid #fff;border-top:30px solid transparent;cursor:pointer;height:0;width:0;z-index:1}.adthrive-video-text{color:#fff;direction:unset;overflow:hidden;padding-bottom:.5em;padding-right:20px;text-overflow:ellipsis;white-space:nowrap;width:100%}.raptive-player-position{background-color:#000;clear:both;padding-top:56.25%;position:relative;width:100%}.raptive-player-container{bottom:0;left:0;position:absolute;right:0;top:0;z-index:1}.raptive-player-video{height:100%;margin-block:0!important;width:100%}.raptive-player-collapse{z-index:2147483644}.adthrive-video-overlay{align-items:center;background-color:rgba(0,0,0,.5);bottom:0;cursor:pointer;display:flex;justify-content:center;left:0;margin-block-start:unset;position:absolute;right:0;top:0;z-index:4}.adthrive-player-big-play-button{color:#6b65ff;font-size:48px}@media (max-width:480px){.adthrive-player-big-play-button{font-size:44px}}@media (min-width:481px) and (max-width:768px){.adthrive-player-big-play-button{font-size:77px}}@media (min-width:769px){.adthrive-player-big-play-button{font-size:88px}}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile .adthrive-player-ad-container{margin-bottom:2px;margin-top:2px}.adthrive-player-ad-controls.adthrive-player-ad-controls-hidden{opacity:0!important;pointer-events:none;transition:opacity .5s!important}.adthrive-player-ad-controls{bottom:0;display:flex;height:50px;left:0;line-height:18px;opacity:1;padding:0;position:absolute;text-align:left;transform:translateY(12px);transition:opacity .5s ease-out,transform .2s ease-out;width:auto;z-index:1000000}.adthrive-full-width{width:100%}.adthrive-player-ad-controls.adthrive-player-progress-bar-visible{transform:translateY(0)}.adthrive-player-progress-bar-container{bottom:0;cursor:pointer;display:none;height:20px;left:2%;pointer-events:all;position:absolute;width:96%;z-index:1000}.adthrive-collapse-mobile .adthrive-player-progress-bar-container{left:3%;width:94%}.adthrive-player-progress-bar-container.active{display:initial}.adthrive-player-progress-bar{background-color:#ccc;border-radius:36px;bottom:0;height:6px;margin:auto 0;overflow:hidden;position:absolute;top:0;width:100%}.adthrive-player-progress-bar div{background-color:#6b65ff;content:"";display:block;height:100%;transform-origin:left;width:100%}.adthrive-player-progress-bar-handle{background-color:#6b65ff;border-radius:50%;box-shadow:0 0 10px rgba(0,0,0,.4);height:12px;left:0;position:absolute;top:50%;touch-action:none;transform:translate(-50%,-50%) scale(1);width:12px;z-index:1001}.adthrive-player-progress-bar-handle:before{content:"";display:block;height:20px;transform:translate(-4px,-4px);width:20px}.adthrive-player-volume-control{align-items:center;border-radius:36px;display:flex;height:36px;justify-content:center;left:28px;margin:auto;opacity:0;position:absolute;width:80px;z-index:500}.adthrive-player-volume-control.adPlaying{top:20px}.adthrive-player-volume-control input[type=range]{-webkit-appearance:none;background-color:#777;border:0;border-radius:20px;box-shadow:none;cursor:pointer;height:10px;margin:0;outline:0;overflow:hidden;padding:0;position:relative;vertical-align:bottom;width:65px;z-index:1001}.adthrive-player-volume-control input[type=range]::-webkit-slider-runnable-track{-webkit-appearance:none;color:#777;height:10px;margin-top:-1px}.adthrive-player-volume-control input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;background:#fff;border-radius:50%;box-shadow:-325px 0 0 320px #6b65ff,inset 0 0 0 40px #fff;cursor:pointer;height:10px;position:relative;width:10px}.adthrive-player-volume-control input[type=range]:active::-webkit-slider-thumb{background:#fff;box-shadow:-325px 0 0 320px #6b65ff,inset 0 0 0 3px #fff}.adthrive-player-volume-control input[type=range]::-moz-range-thumb{height:10px;width:10px}.adthrive-player-volume-control input[type=range]::-moz-range-progress{background-color:#ddd;box-shadow:-325px 0 0 320px #6b65ff,inset 0 0 0 3px #6b65ff}.adthrive-player-volume-control input[type=range]::-moz-range-track{background-color:#777}.adthrive-player-volume-control input[type=range]::-ms-fill-lower{background-color:#ddd;box-shadow:-325px 0 0 320px #6b65ff,inset 0 0 0 3px #6b65ff}.adthrive-player-volume-control input[type=range]::-ms-fill-upper{background-color:#777}.adthrive-jw-player-collapse{z-index:2147483644}.adthrive-player-position.adthrive-collapse-float,.raptive-player-container.adthrive-collapse-float{position:fixed;width:300px!important}.adthrive-player-position.adthrive-collapse-float #adthrive-video-description-text,.raptive-player-container.adthrive-collapse-float #adthrive-video-description-text{display:none}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-right,.raptive-player-container.adthrive-collapse-float.adthrive-collapse-right{bottom:auto;left:auto;right:5px;top:0}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-bottom-right,.raptive-player-container.adthrive-collapse-float.adthrive-collapse-bottom-right{bottom:100px;left:auto;right:5px;top:auto}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-bottom-left,.raptive-player-container.adthrive-collapse-float.adthrive-collapse-bottom-left{bottom:100px;left:auto;top:auto}.adthrive-player-position.adthrive-collapse-float>.adthrive-player-title,.raptive-player-container.adthrive-collapse-float>.adthrive-player-title{display:none}.adthrive-player-position.adthrive-collapse-float>.adthrive-video-text,.raptive-player-container.adthrive-collapse-float>.adthrive-video-text{font-size:.67em}.adthrive-player-position.adthrive-collapse-sticky,.raptive-player-container.adthrive-collapse-sticky{padding-bottom:20px;padding-top:20px;position:fixed;z-index:9999}.adthrive-player-position.adthrive-collapse-sticky>.adthrive-player-title,.raptive-player-container.adthrive-collapse-sticky>.adthrive-player-title{display:none}.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile{bottom:auto!important;top:0;transform:translate(0)!important}body.adthrive-device-phone .adthrive-sticky-outstream.adthrive-sticky-outstream-active.adthrive-sticky-outstream-top-center{bottom:auto!important}.adthrive-collapse-mobile-background{left:0;position:fixed;top:0;z-index:99990}.adthrive-collapse-mobile-background.extra-height{height:163px!important}.adthrive-top-collapse-close{left:-30px;position:fixed;top:5px;z-index:1}.adthrive-sticky-outstream-top-center>.adthrive-top-collapse-close{left:10px;position:fixed;top:48px}.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile>.adthrive-top-collapse-close{top:10px}.adthrive-top-collapse-wrapper-bar>* .adthrive-top-collapse-close{left:0;position:relative;top:0}.adthrive-top-collapse-wrapper-bar>* .adthrive-wrapper-float-close{display:none;float:none;margin-bottom:0}.adthrive-top-collapse-close-spacer{line-height:1.2}.adthrive-player-position.adthrive-collapse-mobile,.raptive-player-container.adthrive-collapse-mobile{position:fixed;width:300px;z-index:99998}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-medium,.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-small{width:178px}.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-medium,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-small{height:101px;width:178px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-right,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-right{right:10px;top:26px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-left,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-left{left:5px;top:26px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-bottom-left,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-bottom-left{bottom:52px;left:5px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-bottom-right,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-bottom-right{bottom:52px;right:10px}.adthrive-player-position.adthrive-collapse-mobile>.adthrive-player-title,.raptive-player-container.adthrive-collapse-mobile>.adthrive-player-title{display:none}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center>.adthrive-wrapper-bar,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-center>.adthrive-wrapper-bar{display:none!important}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center>.adthrive-top-collapse-wrapper-bar,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-center>.adthrive-top-collapse-wrapper-bar{display:block}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center.adthrive-player-without-wrapper-text,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-center.adthrive-player-without-wrapper-text{bottom:auto;left:50%;padding-bottom:1px!important;padding-top:0!important;right:auto;top:0;transform:translateX(-50%)}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center.adthrive-player-with-wrapper-text,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-center.adthrive-player-with-wrapper-text{bottom:auto;left:auto;padding-bottom:1px!important;padding-top:0!important;right:5px;top:0}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-center{transition:none!important}.adthrive-top-collapse-wrapper-bar{color:#fff;display:none;left:5px;padding-bottom:5px;padding-top:5px;position:fixed;top:0;width:-webkit-calc(100% - 188px);width:-moz-calc(100% - 188px);width:calc(100% - 188px);z-index:99998}.adthrive-top-collapse-wrapper-video-title{color:#fff;display:-webkit-box;font-size:13px;font-weight:700;overflow:hidden;text-decoration:none;text-overflow:ellipsis;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical}.adthrive-top-collapse-wrapper-bar a a.adthrive-learn-more-link{color:#fff;display:inline-block;font-size:13px}.adthrive-top-collapse-wrapper-bar a a.raptive-player-learn-more-link{display:none}.adthrive-top-collapse-wrapper-bar a a.raptive-player-learn-more-link.raptive-player-learn-more-link-active{display:inline-block}h3.adthrive-player-title{margin:10px 0}.adthrive-wrapper-close{align-items:center;color:#fff;font-size:36px;height:36px;justify-content:center;margin-left:auto;margin-right:0;min-width:36px}.adthrive-wrapper-float-close{cursor:pointer;display:none;float:right;margin-bottom:5px}.adthrive-top-left-outer{height:78px;left:-30px;position:absolute;top:-55px;width:78px}.adthrive-top-left-outer>svg{bottom:30px;left:30px;position:absolute}.adthrive-top-left-inner{position:absolute;top:0}.adthrive-top-left-inner.adthrive-wrapper-float-close{background:rgba(0,0,0,.5);color:#fff;padding:2px;pointer-events:none;width:100%;z-index:99}.adthrive-new-outstream-player .adthrive-top-left-inner.adthrive-wrapper-float-close{z-index:10000}.adthrive-new-outstream-player .adthrive-ad{margin-bottom:0;margin-top:0}.adthrive-top-left-inner-wrapper.adthrive-wrapper-float-close{background:rgba(0,0,0,.5);color:#fff;padding:2px;pointer-events:none;position:absolute;top:36px;width:100%;z-index:10000}.adthrive-sticky-outstream>.adthrive-wrapper-float-close{position:absolute;right:1px;top:0}.adthrive-sticky-outstream>.adthrive-wrapper-float-close.adthrive-wrapper-close-outside-left{left:2px}.adthrive-sticky-outstream>.adthrive-wrapper-float-close.adthrive-wrapper-close-bkgd-50{background:rgba(0,0,0,.5);color:#fff;left:0;padding:2px;pointer-events:none;top:0}.adthrive-new-outstream-player{margin-bottom:20px;padding:0!important}.adthrive-new-outstream-player>.adthrive-wrapper-float-close.adthrive-wrapper-close-bkgd-50{top:0}#adthrive-sticky-outstream-close{line-height:0;position:relative}#adthrive-sticky-outstream-close.adthrive-top-collapse-close{position:inherit}.adthrive-sticky-outstream-idle>#adthrive-sticky-outstream-close{pointer-events:none}.adthrive-sticky-outstream-active>#adthrive-sticky-outstream-close{pointer-events:all}.adthrive-wrapper-close-bkgd-50>#adthrive-sticky-outstream-close{padding:2px 0 0 2px;pointer-events:all}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile{bottom:52px;transition-delay:0s;transition-duration:.25s;transition-property:transform}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile-right{right:10px}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile-left{left:10px;transform:none!important}.adthrive-sticky-outstream.adthrive-sticky-outstream-active.adthrive-sticky-outstream-top-center{background:#000;bottom:auto;left:0;right:0;top:0;transform:none}.adthrive-sticky-outstream.adthrive-sticky-outstream-desktop{bottom:100px;right:5px}.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-desktop,.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile{bottom:auto}.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile .adthrive-stickyoutstream-container{background-color:#000;margin:0 auto}.adthrive-sticky-outstream.adthrive-sticky-outstream-active{display:block}.adthrive-video-stickyoutstream{margin-top:0}.adthrive-video-stickyoutstream div:first-of-type{margin:-1px}.adthrive-video-stickyoutstream-new-player div:first-of-type{margin:0}.adthrive-instream-close{pointer-events:all}.adthrive-instream-close.adthrive-float-left{float:left}.adthrive-ccpa-link,.adthrive-ccpa-link span,.adthrive-footer-message span,.adthrive-privacy-preferences a{color:#a9a9a9;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;font-size:13px}.adthrive-ccpa-link a{cursor:pointer;text-decoration:underline}.adthrive-device-phone .adthrive-footer-message{margin-bottom:60px}.adthrive-footer-message{margin-bottom:100px}.adthrive-footer-message>span{border-top:1px solid #b2b2b2;padding-top:5px;text-transform:uppercase}.adthrive-parallax-slot{height:400px;overflow:hidden;padding-top:5px}.adthrive-parallax-ad{transform:translateY(0);transition:transform .3s ease-out}.adthrive-sticky-container.adthrive-parallax-slot{flex-direction:row;justify-content:center;padding-top:10px}#_inv_voicefive___{display:none}.adthrive-ad-debug{background-color:rgba(255,0,0,.5)!important;outline:1px solid red!important}.adthrive-ad-debug:hover{background-color:rgba(255,0,0,.8)!important;cursor:pointer;outline:1px solid red!important}.adthrive-player-ad-controls-volume:hover>.adthrive-player-volume-control,.adthrive-player-volume-control:focus{opacity:1}@media print{.adthrive-ad,.adthrive-comscore,.adthrive-native-recipe,.raptive-sales,body[data-gg-moat],div[class*=kargo-ad],div[data-gg-moat],iframe[data-gg-moat-ifr]{display:none!important;height:0;visibility:hidden;width:0}}');class lw{addHealthReport(e,t){this.healthReport[e]=this.healthReport[e]||{details:[]},this.healthReport[e].details.push(t)}log(){re.event("HealthReporter","log",this.healthReport)}constructor(){this.healthReport={}}}class dw extends lw{get enabled(){return!1}start(){this._clsType(),this._clsSlots()}_clsType(){const e=window.adthriveCLS,t=e&&e.injectedFromPlugin,i=e&&!e.injectedFromPlugin&&e.injectedFromSiteAds,s=(t?"plugin":i&&"nonplugin")||"none";this.addHealthReport(this._reporter,{metric:"clsType",value:s})}_clsSlots(){const e=window.adthriveCLS,t=e&&e.injectedSlots,i=e&&e.injectedVideoSlots,s=(t&&t.length||0)+(i&&i.length||0);this.addHealthReport(this._reporter,{metric:"clsSlots",value:s})}constructor(...e){super(...e),this._reporter="CLSReporter"}}class cw{start(){this._healthReporters.forEach((e=>{e.start(),e.log()}))}constructor(e){this._healthReporters=[e].filter((e=>e.enabled))}}cw=B([L(),j("design:type",Function),j("design:paramtypes",[void 0===dw?Object:dw])],cw);class hw extends tr{init(){this._setAbGroup=!1,this._key="DialDownLogsExperiment2",this._default=["none"]}}hw=B([M()],hw);Cg(".adthrive-act25-modal{background-color:#000;background-color:rgba(0,0,0,.4);display:none;height:100%;left:0;overflow:auto;position:fixed;top:0;width:100%;z-index:2147483647}.adthrive-act25-modal.show{display:block}.adthrive-act25-modal-content{background-color:#fefefe;border:1px solid #888;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.5);font-family:Verdana,Geneva,Tahoma,sans-serif;left:50%;margin:auto;max-width:592px;padding:20px 24px 24px;position:absolute;top:50%;transform:translate(-50%,-50%);width:80%}.adthrive-act25-modal-close{color:#000;font-size:28px;font-weight:700;position:fixed;right:3px;top:-10px}.adthrive-act25-modal-close:focus,.adthrive-act25-modal-close:hover{color:#000;cursor:pointer;text-decoration:none}.adthrive-act25-modal-header{padding:2px 16px}.adthrive-act25-modal-header h1{color:rgba(0,0,0,.87);font-size:20px;line-height:26px}.adthrive-act25-modal-body{margin-bottom:10px;max-height:50vh;overflow-y:auto;padding:10px 16px;position:relative}.adthrive-act25-modal-body p{font-size:14px;line-height:20px}.adthrive-act25-modal-footer{color:#fff;display:flex;flex-direction:column;justify-content:space-between;padding:2px 16px}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{border:none;border-radius:10px;color:#fff;cursor:pointer}.adthrive-act25-modal-accept{background-color:#010044}.adthrive-act25-modal-decline{background-color:#fff;color:#000}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{flex:1;margin:0 10px 10px 0;text-transform:uppercase}.adthrive-act25-modal-accept:focus,.adthrive-act25-modal-accept:hover{background-color:#010044;color:#c4c4c4}.adthrive-act25-modal-decline:focus,.adthrive-act25-modal-decline:hover{background-color:#fff;color:#000}@media (max-width:600px){.adthrive-act25-modal-content{width:90%}.adthrive-act25-modal-body{border-bottom:1px solid #c4c4c4;box-shadow:inset 0 -100px 30px -100px rgba(0,0,0,.1)}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{font-size:14px;line-height:14px}}@media (min-width:600px){.adthrive-act25-modal-footer{flex-direction:row}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{flex:0 0 auto;margin:0}}.adthrive-act25-footer{margin-bottom:30px}.adthrive-act25-footer-text{color:#a9a9a9;font-size:14px}.adthrive-act25-footer-text p{color:#a9a9a9;text-decoration:underline}.adthrive-act25-footer-link{cursor:pointer;font-size:14px;text-decoration:underline}");class uw extends Cs{get consented(){return this._consented}get modal(){return this._modal}get footer(){return this._footer}init(){var e;(this._modal=this._createConsentModal(),this._footer=this._createFooterElement(),null===this._consented)?(null==(e=this._modal)||e.classList.add("show"),this._startTimer()):this._consentEventBus.act25consentCaptured.emit(this._consented);this._injectFooterElement()}checkConsent(){return new Promise((e=>{null!==this._consented&&e(this._consented),this._consentEventBus.act25consentCaptured.on((t=>{this._timer&&(clearTimeout(this._timer),this._timer=null),e(t)}))}))}_createConsentModal(){if(this._modal)return this._modal;const e=document.createElement("div");e.className=`${this._cssPrefix}-modal`;const t=document.createElement("div");t.className=`${this._cssPrefix}-modal-content`;const i=document.createElement("span");i.className=`${this._cssPrefix}-modal-close`,i.innerText="",i.addEventListener("click",(()=>this._handleClose()));const s=document.createElement("div");s.className=`${this._cssPrefix}-modal-body`,s.innerHTML='\n    <p>\n    Soucieux doffrir une exprience optimale, nous et nos partenaires utilisons des technologies telles que les cookies pour enregistrer et/ou accder\n    aux informations des appareils. Le consentement  ces technologies nous permettra,  nous et  nos partenaires, de traiter des donnes personnelles\n    telles que le comportement de navigation ou les identifiants uniques sur ce site. Les cookies dposs par nos partenaires ou fournisseurs tiers sont\n    des cookies tiers dposs dans le but de placer des publicits sur nos produits et Services sur dautres sites web. Lutilisation des cookies par\n    ces tiers est rgie par leurs politiques de confidentialit.\n    </p>\n    <p>\n    Cliquez sur  accepter  ou  dclin  ci-dessous. Vous pouvez mettre  jour vos choix  tout moment en cliquant sur ne vendez pas en\n    bas de la page.\n    </p>\n\n    <br />\n\n    <p>\n    To provide the best experiences, we and our partners use technologies like cookies to store and/or access device information.\n    Consenting to these technologies will allow us and our partners to process personal data such as browsing behavior or unique IDs on this site.\n    Cookies placed by our partners or third-party suppliers are third-party cookies placed for the purpose of placing advertisements on our products\n    and Services on other websites. The use of cookies by these third parties is governed by their privacy policies.\n    </p>\n    <p>\n    Click "accept" or decline" below. You can update your choices at any time by clicking on the Do not sell link in the bottom of the page.\n    </p>\n    ';const r=document.createElement("div");r.className=`${this._cssPrefix}-modal-footer`;const n=document.createElement("button");n.className=`${this._cssPrefix}-modal-accept`,n.innerText="Accepter/Accept",n.addEventListener("click",(()=>this._handleAccept()));const a=document.createElement("button");return a.className=`${this._cssPrefix}-modal-decline`,a.innerText="Dclin/Decline",a.addEventListener("click",(()=>this._handleDecline())),s.appendChild(i),r.appendChild(a),r.appendChild(n),t.appendChild(s),t.appendChild(r),e.appendChild(t),document.body.appendChild(e),e}_createFooterElement(){if(this._footer)return this._footer;const e=document.createElement("div");e.className=`${this._cssPrefix}-footer`;const t=document.createElement("p");t.className=`${this._cssPrefix}-footer-text`,t.innerText="\n    Les informations de votre appareil peuvent tre utilises pour personnaliser votre exprience publicitaire. /\n      Information from your device can be used to personalize your ad experience.";const i=document.createElement("a");return i.innerText=this._consented?this._footerLinkOptOutText:this._footerLinkOptInText,i.className=`${this._cssPrefix}-footer-link`,i.addEventListener("click",(()=>{var e;return this._handleFooterLinkClick(null!=(e=this._consented)&&e)})),this._footerLink=i,e.appendChild(t),e.appendChild(i),e}_injectFooterElement(){const e=this._config.footer.elements;!!this._footer&&e.find((e=>e.element===this._footer))||e.push({order:1,element:this._footer})}_destroyConsentModal(){var e;null==(e=this._modal)||e.classList.remove("show")}_handleAccept(){this._toggleConsent(!0),te.event("Act25EnforcementComponent","handleUserAction","qbccmp:acc")}_handleDecline(){this._toggleConsent(!1),te.event("Act25EnforcementComponent","handleUserAction","qbccmp:dec")}_handleClose(){this._toggleConsent(!1),te.event("Act25EnforcementComponent","handleUserAction","qbccmp:clo")}_handleTimeout(){this._toggleConsent(!1),te.event("Act25EnforcementComponent","handleUserAction","qbccmp:tim")}_handleFooterLinkClick(e){var t;e?this._handleDecline():null==(t=this._modal)||t.classList.add("show")}_toggleConsent(e){K.setLocalStorageValue(this._storageKey,e),this._consented=e,this._destroyConsentModal(),this._updateFooterLink(e),this._consentEventBus.act25consentCaptured.emit(e)}_updateFooterLink(e){this._footerLink&&(this._footerLink.innerText=e?this._footerLinkOptOutText:this._footerLinkOptInText)}_startTimer(){this._timer=window.setTimeout((()=>{this._handleTimeout()}),this._timeout)}constructor(e,t){super(),this._config=e,this._consentEventBus=t,this._cssPrefix="adthrive-act25",this._modal=null,this._footer=null,this._footerLink=null,this._footerLinkOptOutText="Ne vendez pas ou ne partagez pas mes informations personnelles / Do not sell or share my personal information",this._footerLinkOptInText="Personnalisez mon exprience publicitaire / Customize my ad experience",this._storageKey="act25-consent",this._timer=null,this._timeout=3e4,this._consented=this._config.act25.consented}}uw=B([hs("Act25EnforcementComponent"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Rs?Object:Rs])],uw);class pw{init(){this._slotEventBus.requestingBids.once((()=>this._setTimeToFirstAdRequest())),this._slotEventBus.requestingBids.on((()=>this._adRequested())),this._slotEventBus.addSlots.on((e=>this._addSlots(e.length))),this._gamEventBus.slotRenderEnded.on((({event:e})=>{e&&!e.isEmpty&&this._addDisplaySlotImpression()})),this._videoEventProxy.videoSlotRendered.on((e=>{e&&!e.isEmpty&&this._addVideoSlotImpression()})),this._trackDomContentLoaded(),this._pageManager.beforeUnload.on((()=>{this._calculateTimeOnPage(),this._sendCounts()})),this._prebidEventBus.bidWon.on((e=>{this._prebidResponses++,this._prebidResponseCPMs.push(Number(e.cpm.toFixed(2)))}))}_setTimeToFirstAdRequest(){this._timeToFirstAdReq=this._domContentLoaded!==-1/0?os.now()-this._domContentLoaded:-1/0}_adRequested(){this._adRequests++}_addSlots(e){this._adSlots+=e}_addDisplaySlotImpression(){this._displayImpressions++}_addVideoSlotImpression(){this._videoImpressions++}_trackDomContentLoaded(){const e=performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation");e&&e[0]&&e[0].domContentLoadedEventEnd&&(this._domContentLoaded=e[0].domContentLoadedEventEnd)}_calculateTimeOnPage(){this._timeOnPage=this._domContentLoaded!==-1/0?os.now()-this._domContentLoaded:-1/0}_sendCounts(){re.event("SystemPulse","counts",{adRequests:this._adRequests,prebidsWon:this._prebidResponses,prebidCPMs:this._prebidResponseCPMs,adSlots:this._adSlots,displayImps:this._displayImpressions,videoImps:this._videoImpressions,timeToFirstAdReq:this._timeToFirstAdReq,timeOnPage:this._timeOnPage})}constructor(e,t,i,s,r){this._slotEventBus=e,this._pageManager=t,this._prebidEventBus=i,this._gamEventBus=s,this._videoEventProxy=r,this._adRequests=0,this._adSlots=0,this._prebidResponses=0,this._prebidResponseCPMs=[],this._domContentLoaded=-1/0,this._timeOnPage=-1/0,this._timeToFirstAdReq=-1/0,this._displayImpressions=0,this._videoImpressions=0}}pw=B([M(),j("design:type",Function),j("design:paramtypes",[void 0===Es?Object:Es,void 0===wr?Object:wr,void 0===Ms?Object:Ms,void 0===jl?Object:jl,void 0===tu?Object:tu])],pw);let gw=class{async init(){const e=Ul.markStartTask("microtask",["index","setupAdthrive","after-yield"]),t=Li(window.adthrive.bucket)||Math.random()<.01;t&&this.cmd.push((()=>re.event("AdThrive","init","hcstart"))),this._apiReady=new Promise((e=>this.config.identityApi.apiReady.on((()=>e(!0))))),this._adDensityReady=new Promise((e=>this._realizedAdDensityEventBus.realizedAdDensityCompReady.on((()=>e(!0)))));const i=e=>{e.data={abgroup:this.config.abGroup.groupsAsObject,pubab:this.config.pubAbGroup.groupsAsObject,sess:this.context.sessionKey,pvk:this.context.pageviewKey,hbho:this.config.hbho.bidders,vbho:this.config.vbho.bidders,spa:this.config.adOptions.spa,...this.context.deliveryVersion&&{lmdv:this.context.deliveryVersion},...this.config.clsOptions&&this.config.clsOptions.branch&&{clsBranch:this.config.clsOptions.branch},...this.config.clsOptions&&this.config.clsOptions.bucket&&{clsBucket:this.config.clsOptions.bucket}}},s=R.resolve(hw);R.resolve(Z).dialDownLogs.emit({result:s.result,choices:s._choices}),i(te),te.sending.on((()=>i(te))),re.sending.on((()=>i(re))),this.cmd.init(),this._auctionManagers.init(),this._googleAdManager.init();if(R.resolve(pw).init(),this.config.act25.required){const e=R.resolve(uw);e.init(),await e.checkConsent()}this._components.init(),this._googleAdManager.start(),this._components.start(),window.adthriveCLS&&window.adthriveCLS.error&&te.error("AdThrive","init","Problem with AdThriveCLS SiteAds. CLS Disabled"),this._healthReporters.start(),t&&re.event("AdThrive","init","hcend"),e.markEndTask()}identityApi(e,t){return this._apiReady.then((()=>{this.config.identityApi.optIn.emit({data:e,cb:t})}))}disableAds(e){this.config.disableAds.disableAllAds(e)}disableContentAds(e){this.config.disableAds.disableContentAds(e)}disablePlaylistPlayers(e){this.config.disableAds.disablePlaylistPlayers(e)}showPrivacyPreferences(){window.__tcfapi&&window.__tcfapi("showGDPRScreenAdvanced")}getConsentData(){window.__tcfapi&&window.__tcfapi("getTCData",2,(e=>{}))}getAdthriveFlippData(){return this.config.marmalade.flpProdIds.filter(Mt)}setTargetingFlag(e,t,i=!1){e&&"string"==typeof e&&t&&Array.isArray(t)&&0!==t.length&&this._googleAdManager.setTargetingFlag(e,t,i)}setTargeting(e){this._googleAdManager.setTargeting(e)}getTargeting(){return this._googleAdManager.getTargeting()}getTargetingMap(){return this._googleAdManager.getTargetingMap()}logError(e,t,i){te.error(e,t,i)}log(e,t,i,s){switch(e){case"error":te.error(t,i,s);break;case"info":break;case"log":te.log(t,i,s)}}refreshSlots(e){let t=this.slots.get();e&&e.length&&(t=t.filter((t=>e.includes(t.id)))),t.forEach((e=>{this.slotManager.refresh(e,!1).then((()=>{this.slotManager.clearRefreshTimeout(e,!0)})).catch((()=>{}))}))}nmr(){return te.event("adthrive","nmr","adthrive.nmr() has been called"),this.slotManager.updateRefreshTimeout(this.slots.get(),0)}clearSticky(){te.event("adthrive","clearSticky","adthrive.clearSticky() has been called"),K.removeLocalStorageValue("abgroup"),kr.deleteLocalStorage("adt_pe")}async getAdDensity(){let e=null;return await this._adDensityReady.then((()=>{this._realizedAdDensityEventBus.metricsRequested.emit((t=>e=t))})).catch((()=>{})),e}logAdDensity(){this._adDensityReady.then((()=>{this._realizedAdDensityEventBus.metricsRequested.emit((e=>{}))})).catch((()=>{}))}constructor(e,t,i,s,r,n,a,o,l,d,c,h){this.config=e,this.context=t,this.cmd=i,this.slotManager=s,this.slots=r,this._auctionManagers=n,this._coreExperimentConfig=a,this._googleAdManager=o,this._components=l,this._healthReporters=d,this._siteExperimentEventBus=c,this._realizedAdDensityEventBus=h,this.marmalade={mcmp:null},this.marmaladeFinished=e=>e,this.raptiveFloorsFinished=e=>e,this.rubiconFloorsFinished=e=>e,this.optimalBiddersFinished=e=>e,this.api={browserStorage:{setLocalStorage:kr.setExternalLocalStorage.bind(kr),readLocalStorage:kr.readExternalLocalStorage.bind(kr)}},this._apiReady=new Promise((e=>e(!1))),this._adDensityReady=new Promise((e=>e(!1))),this.bucket=this.context.bucket,this.branch=this.context.branch,this.invalidTraffic=this.context.invalidTraffic,this.deployment=this.context.deployment,this.abgroup=this.config.abGroup.groups,this.pubab=this.config.pubAbGroup.groups,this.siteAds=window.adthrive.siteAds,this.buildDate=window.adthrive.buildDate,this.windowPerformance=window.adthrive.windowPerformance,this.marmaladeFinished=window.adthrive.marmaladeFinished||this.marmaladeFinished,this.raptiveFloorsFinished=window.adthrive.raptiveFloorsFinished||this.raptiveFloorsFinished,this.optimalBiddersFinished=window.adthrive.optimalBiddersFinished||this.optimalBiddersFinished,this.coreExperiments=this._coreExperimentConfig.coreExperiments,this.deliveryFeatures=window.adthrive.deliveryFeatures,this.cookieDeprecationLabel=window.adthrive.cookieDeprecationLabel,this.siteAds.targeting={push:e=>this._googleAdManager.setTargeting(e)},this._siteExperimentEventBus.targetingReady.on((()=>{this.pubab=this.config.pubAbGroup.groups,this._googleAdManager.setTargeting({key:"pubab",value:this.pubab})}));"off"===Rt().get("at_sticky")&&this.clearSticky()}};gw=B([hs("AdThrive"),M(),j("design:type",Function),j("design:paramtypes",[void 0===Ol?Object:Ol,void 0===Pr?Object:Pr,void 0===og?Object:og,void 0===id?Object:id,void 0===zr?Object:zr,void 0===ag?Object:ag,void 0===Js?Object:Js,void 0===Vl?Object:Vl,void 0===ow?Object:ow,void 0===cw?Object:cw,void 0===Us?Object:Us,void 0===$s?Object:$s])],gw);const mw={domain:"ads.adthrive.com",branch:"main",bucket:"prod",cmp:!0};class _w extends As{get result(){return this._result}run(){return new Is(0).get()}constructor(){super(),this.classList=["EmailCaptureHandler"],this._result=!1,this._choices=[{choice:!0},{choice:!1}],this.abgroup="logfltr",this.key="LoggerFilter",this._result=this.run()}}_w=B([hs("LoggerFilterExperiment"),M(),j("design:type",Function),j("design:paramtypes",[])],_w);const fw=()=>!(!navigator.userAgent||!(navigator.userAgent.search(/GTmetrix/i)>-1||navigator.userAgent.search(/pingdom/i)>-1||navigator.userAgent.search(/Google Page Speed Insights/i)>-1||navigator.userAgent.search(/Chrome-Lighthouse/i)>-1))||!!["__nativePromise","__nativeURL","__nativePerformance","__nativeFetch","__ElementMatches","__HTMLElementBoundingClientRect"].some((e=>window.hasOwnProperty(e)));var vw;!function(e){e.SetInterestGroupsData="adthrive_SetInterestGroupsData"}(vw||(vw={}));class yw{get enabled(){return this._fledgeConfig.enabled}setInterestGroups(e){try{if(this._frame.contentWindow){const t={action:vw.SetInterestGroupsData,groupNames:e};this._frame.contentWindow.postMessage(t,this._host)}}catch(e){te.error("PrivacySandboxIframeManager","setInterestGroups","Failed to set interest groups.",e)}}_addIframeToPage(){return new Promise((e=>{this._frame.src=this._frameSrc,this._frame.id="adthrive-privacy-sandbox",this._frame.style.display="none",this._frame.onload=()=>{e()},document.body.appendChild(this._frame)}))}_setupEventListeners(){this._browserTopicsAPIEventBus.topicsReceived.on((e=>{const t=e.map((e=>`${e.id}`));this.setInterestGroups(t)}),{handleEventsAlreadyEmitted:!0}),this._marmaladeEventBus.marmaladeResponseLoaded.on((({recencyFrequency:e})=>{var t;const i=null!=(t=null==e?void 0:e.map((({rf_code:e})=>e)))?t:[];this.setInterestGroups(i)}),{handleEventsAlreadyEmitted:!0})}constructor(e,t,i,s,r){this._bootstrapConfig=e,this._fledgeConfig=t,this._privacySandboxEventBus=i,this._browserTopicsAPIEventBus=s,this._marmaladeEventBus=r,this._host=`https://${this._bootstrapConfig.host}`,this._frame=document.createElement("iframe"),this._baseUrl=this._bootstrapConfig.baseUrl,this._frameSrc=`${this._baseUrl.replace("/gdpr","")}/html/ps.html`,this.enabled&&this._addIframeToPage().then((()=>{this._privacySandboxEventBus.iframeReady.emit(),this._setupEventListeners()})).catch((e=>{te.error("PrivacySandboxIframeManager","constructor","Failed to initialize Privacy Sandbox iframe",e)}))}}yw=B([hs("PrivacySandboxIframeManager"),M(),j("design:type",Function),j("design:paramtypes",[void 0===tn?Object:tn,void 0===Uo?Object:Uo,void 0===Bs?Object:Bs,void 0===xs?Object:xs,void 0===js?Object:js])],yw);class bw{static isValidExperiment(e){return 100===e.reduce(((e,t)=>e+t),0)}static setExperimentABGroup(e,t){const i=`${e}_${t.id}`;this._experimentABGroup=i}static getExperimentConfig(e){const t=e.experimentChoices,i=this.getStickyResult(e);if(i)return this.setExperimentABGroup(e.id,i),i;const s=t.map((e=>e.weight));if(!this.isValidExperiment(s))return;const r=(e=>{const t={index:-1,weight:-1};if(!e||0===e.length)return t;const i=e.reduce(((e,t)=>e+t),0);if(0===i)return t;const s=Math.random()*i;let r=0,n=e[r];for(;s>n;)n+=e[++r];return{index:r,weight:e[r]}})(s);this.setExperimentABGroup(e.id,t[r.index]);const n=t[r.index];return this.setStickyResult(e.id,n),n}static get experimentABGroup(){return this._experimentABGroup}static getStickyResult(e){try{const t=kr.readInternalLocalStorage(this._localStorageKey);if(!t)return null;const i=t[e.id];return i&&e.experimentChoices.find((e=>e.id===i.id))?i:null}catch(e){return te.error("ProfileExperimentsUtil","unabled to parse sticky experiment value"),null}}static setStickyResult(e,t){const i=kr.readInternalLocalStorage(this._localStorageKey)||{};i[e]=t,kr.setInternalLocalStorage(this._localStorageKey,i)}}bw._localStorageKey="adt_pe",bw._experimentABGroup=null;class Sw{static getSiteAdsProfile(e){const t=gt(),i=(()=>{const e=Wt()?"mobile":"tablet";return Bt(st)?"desktop":e})(),s=e.siteAdsProfiles;let r=null;if(s&&s.length)for(const e of s){const s=e.targeting.device,n=e.targeting.browserEngine,a=s&&s.length&&s.includes(i),o=n&&n.length&&n.includes(t);a&&o&&(r=e,this._profileID=r.profileId.toString())}return r}static updateSiteAds(e){const t=this.getSiteAdsProfile(e.siteAds),i=t&&t.experiment?bw.getExperimentConfig(t.experiment):void 0;if(t){const s={adOptions:t.adOptions,adTypes:t.adTypes,videoPlayers:t.videoPlayers};e.siteAds.adOptions=Object.assign(e.siteAds.adOptions,s.adOptions,null==i?void 0:i.adOptions),e.siteAds.adTypes&&Object.assign(e.siteAds.adTypes,s.adTypes,null==i?void 0:i.adTypes),e.siteAds.videoPlayers&&t.videoPlayers&&(e.siteAds.videoPlayers=Object.assign(e.siteAds.videoPlayers,t.videoPlayers,null==i?void 0:i.videoPlayers)),this._profileID=t.profileId.toString(),this.setTargeting(i)}}static get profileID(){return this._profileID}static setTargeting(e){const t=R.resolve(Qs);t.set("aprf",this._profileID),e&&bw.experimentABGroup&&t.set("pe",bw.experimentABGroup)}}Sw._profileID="def";const Ew=R.resolve(dl),Cw=async(e,t,i,s)=>{const r=Ul.markStartTask("microtask",["index","setupAdthrive","before-yield"]),n=ls();return R.register("RecencyFrequencyMarmaladeResponse",{useValue:i.result}),window.adthrive=R.resolve(gw),((e,t,i,s,r)=>{Ew.loading=e,Ew.bootstrapFinished=t,Ew.gamStarted=i.started,Ew.gamFinished=i.finished,Ew.gamDuration=i.duration,Ew.marmaladeStarted=s.started,Ew.marmaladeFinished=s.finished,Ew.marmaladeDuration=s.duration,Ew.floorsStarted=r.started,Ew.floorsFinished=r.finished,Ew.floorsDuration=r.duration})(e,n,t,i,s),r.markEndTask(),await Jl(),window.adthrive.init()},Tw=async e=>{const t=ls(),i=window.adthrive.branch,s=K.getLocalStorageValue("branch"),r=i===(null==s?void 0:s.branch);K.setLocalStorageValue("branch",{branch:i,enabled:r}),K.setSessionFpv(),R.register("Build",{useValue:mw}),R.register("AdThrive",{useValue:e}),R.resolve(on),R.resolve(yw),"true"===e.gdpr&&(()=>{try{const e=window.localStorage.getItem("adthrive_abgroup");if(e){const t=JSON.parse(e);t.value&&t.value[0]&&(window.localStorage.removeItem("adthrive_abgroup"),te.event("ADA-807","checkAbGroupLocalStorage","malformedAbgroup","Invalid abgroup set"))}}catch(e){window.localStorage.removeItem("adthrive_abgroup"),te.event("ADA-807","checkAbGroupLocalStorage",e)}})();const n=R.resolve(Ra);return await n.run().then((({gam:e,marmalade:i,floors:s})=>Cw(t,e,i,s))).catch((e=>(e=>{const t=e.marmalade,i=e.message||e;return t&&Object.prototype.hasOwnProperty.call(t,"result")&&R.register("RecencyFrequencyMarmaladeResponse",{useValue:t.result}),R.resolve(VC).init(),window.adthrive=R.resolve(gw),window.adthrive.init(),Promise.reject(i)})(e)))},ww=e=>{let t;if(bt(e.siteAds.adOptions.delayLoading,!1)){const i=e.siteAds.adOptions.delayLoadingTime,s=(e=>{const t=R.resolve(wr).setupOnceEventWithPromise,i=[t("scroll"),t("mousemove"),t("keyup")];Bt()||i.push(t("touchstart"));const s=[t("load").then((()=>St(e)))];return fw()?i:s.concat(i)})(i?1e3*i:50);t=Promise.race(s)}else t=Promise.resolve();return t},Aw=()=>{R.register("PageviewKey",{useValue:fs()});const e=window.adthrive;window.adthriveCLS&&!window.adthriveCLS.error?(R.register("AdthriveCLS",{useValue:window.adthriveCLS}),(()=>{const e=window.adthrive.siteAds,t=window.adthriveCLS,i=t&&t.siteAds,s=window.adthrive.siteAds.videoPlayers&&window.adthrive.siteAds.videoPlayers.contentSpecificPlaylists,r=s?[...s]:[];i&&as(i)&&(e.adUnits=i.adUnits,e.video=i.video,e.videoPlayers=i.videoPlayers,e.breakpoints=i.breakpoints,e.videoPlayers&&(e.videoPlayers.contentSpecificPlaylists=r.filter((e=>!e.isDraft))))})()):R.register("AdthriveCLS",{useValue:{}}),R.register("CoreExperimentValues",{useValue:e.core.coreExperiments});const t=(({gdpr:e,baseUrl:t})=>"true"===e?`${t}/gdpr`:t)(e),i=(()=>{const e=[Ii(),wi(),ki(),Ai(),Pi(),Oi()].filter((e=>!!e));return e.length?e:void 0})(),s=Li(e.bucket),r=i||s?"unsupported":e.bucket,n=R.resolve(_w),a=n.result?[]:n.classList,o={...e,bucket:r,baseUrl:t,invalidTraffic:i,loggerFilters:a};kr.init(o),K.init(o),re.init(o),te.init(o),Sw.updateSiteAds(o);const l=ls();ww(o).then((()=>{const e=Ul.markStartTask("microtask",["handleDelayLoading"]),t=ls()-l;Ew.delay=t;const i=Tw(o);return e.markEndTask(),i})).then((()=>{})).catch((e=>{"string"==typeof e?te.error("index","load",new Error(e)):te.error("index","load",e)}))};try{(e=>e instanceof gw||e instanceof Promise)(window.adthrive)||Aw()}catch(e){te.error("index","pre-init",e)}return window.adthrive}();if(adtpm){const e=Date.now();adtpm.duration=e-adtpm.startTime;const t="TaskMonitor::_logData",i=[{timingData:adtpm,taskMetadata:{}},{abgroup:"taskmonitor-log",pubab:"taskmonitor-log",sess:"taskmonitor-log",pvk:"taskmonitor-log",hbho:["taskmonitor-log"],vbho:["taskmonitor-log"],spa:!1}],s="https://logger.adthrive.com/event?"+["siteId="+encodeURIComponent(window.adthrive.siteAds.siteId||""),"siteName="+encodeURIComponent(window.adthrive.siteAds.siteName||""),"bucket="+encodeURIComponent(window.adthrive.bucket||""),"branch="+encodeURIComponent(window.adthrive.branch||""),"deployment="+encodeURIComponent(window.adthrive.deployment||""),"message="+encodeURIComponent(t),"pageurl="+encodeURIComponent(window.location.origin+window.location.pathname),"body="+encodeURIComponent(JSON.stringify(i))].join("&"),r=new XMLHttpRequest;r.open("get",s,!0),r.send()}
;